module.exports=[20916,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ReadonlyURLSearchParams",{enumerable:!0,get:function(){return e}});class d extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class e extends URLSearchParams{append(){throw new d}delete(){throw new d}set(){throw new d}sort(){throw new d}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},21170,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"RedirectStatusCode",{enumerable:!0,get:function(){return e}});var d,e=((d={})[d.SeeOther=303]="SeeOther",d[d.TemporaryRedirect=307]="TemporaryRedirect",d[d.PermanentRedirect=308]="PermanentRedirect",d);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},28859,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={REDIRECT_ERROR_CODE:function(){return h},RedirectType:function(){return i},isRedirectError:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(21170),h="NEXT_REDIRECT";var i=((d={}).push="push",d.replace="replace",d);function j(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let b=a.digest.split(";"),[c,d]=b,e=b.slice(2,-2).join(";"),f=Number(b.at(-2));return c===h&&("replace"===d||"push"===d)&&"string"==typeof e&&!isNaN(f)&&f in g.RedirectStatusCode}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},44868,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getRedirectError:function(){return i},getRedirectStatusCodeFromError:function(){return n},getRedirectTypeFromError:function(){return m},getURLFromRedirectError:function(){return l},permanentRedirect:function(){return k},redirect:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(21170),g=a.r(28859),h=a.r(20635).actionAsyncStorage;function i(a,b,c=f.RedirectStatusCode.TemporaryRedirect){let d=Object.defineProperty(Error(g.REDIRECT_ERROR_CODE),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return d.digest=`${g.REDIRECT_ERROR_CODE};${b};${a};${c};`,d}function j(a,b){throw i(a,b??=h?.getStore()?.isAction?g.RedirectType.push:g.RedirectType.replace,f.RedirectStatusCode.TemporaryRedirect)}function k(a,b=g.RedirectType.replace){throw i(a,b,f.RedirectStatusCode.PermanentRedirect)}function l(a){return(0,g.isRedirectError)(a)?a.digest.split(";").slice(2,-2).join(";"):null}function m(a){if(!(0,g.isRedirectError)(a))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return a.digest.split(";",2)[1]}function n(a){if(!(0,g.isRedirectError)(a))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return Number(a.digest.split(";").at(-2))}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},89798,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={HTTPAccessErrorStatus:function(){return f},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return h},getAccessFallbackErrorTypeByStatus:function(){return k},getAccessFallbackHTTPStatus:function(){return j},isHTTPAccessFallbackError:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},g=new Set(Object.values(f)),h="NEXT_HTTP_ERROR_FALLBACK";function i(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let[b,c]=a.digest.split(";");return b===h&&g.has(Number(c))}function j(a){return Number(a.digest.split(";")[1])}function k(a){switch(a){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},16155,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"notFound",{enumerable:!0,get:function(){return f}});let d=a.r(89798),e=`${d.HTTP_ERROR_FALLBACK_ERROR_CODE};404`;function f(){let a=Object.defineProperty(Error(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});throw a.digest=e,a}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},34557,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`forbidden()` is experimental and only allowed to be enabled when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E488",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"forbidden",{enumerable:!0,get:function(){return d}}),a.r(89798).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},93845,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`unauthorized()` is experimental and only allowed to be used when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E411",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unauthorized",{enumerable:!0,get:function(){return d}}),a.r(89798).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},13091,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={isHangingPromiseRejectionError:function(){return f},makeDevtoolsIOAwarePromise:function(){return l},makeHangingPromise:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===g}let g="HANGING_PROMISE_REJECTION";class h extends Error{constructor(a,b){super(`During prerendering, ${b} rejects when the prerender is complete. Typically these errors are handled by React but if you move ${b} to a different context by using \`setTimeout\`, \`after\`, or similar functions you may observe this error and you should handle it in that context. This occurred at route "${a}".`),this.route=a,this.expression=b,this.digest=g}}let i=new WeakMap;function j(a,b,c){if(a.aborted)return Promise.reject(new h(b,c));{let d=new Promise((d,e)=>{let f=e.bind(null,new h(b,c)),g=i.get(a);if(g)g.push(f);else{let b=[f];i.set(a,b),a.addEventListener("abort",()=>{for(let a=0;a<b.length;a++)b[a]()},{once:!0})}});return d.catch(k),d}}function k(){}function l(a,b,c){return b.stagedRendering?b.stagedRendering.delayUntilStage(c,void 0,a):new Promise(b=>{setTimeout(()=>{b(a)},0)})}},73808,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isPostpone",{enumerable:!0,get:function(){return e}});let d=Symbol.for("react.postpone");function e(a){return"object"==typeof a&&null!==a&&a.$$typeof===d}},49640,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={BailoutToCSRError:function(){return g},isBailoutToCSRError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="BAILOUT_TO_CLIENT_SIDE_RENDERING";class g extends Error{constructor(a){super(`Bail out to client-side rendering: ${a}`),this.reason=a,this.digest=f}}function h(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===f}},1567,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isNextRouterError",{enumerable:!0,get:function(){return f}});let d=a.r(89798),e=a.r(28859);function f(a){return(0,e.isRedirectError)(a)||(0,d.isHTTPAccessFallbackError)(a)}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},96556,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DynamicServerError:function(){return g},isDynamicServerError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="DYNAMIC_SERVER_USAGE";class g extends Error{constructor(a){super(`Dynamic server usage: ${a}`),this.description=a,this.digest=f}}function h(a){return"object"==typeof a&&null!==a&&"digest"in a&&"string"==typeof a.digest&&a.digest===f}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},60312,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={StaticGenBailoutError:function(){return g},isStaticGenBailoutError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="NEXT_STATIC_GEN_BAILOUT";class g extends Error{constructor(...a){super(...a),this.code=f}}function h(a){return"object"==typeof a&&null!==a&&"code"in a&&a.code===f}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},17491,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={METADATA_BOUNDARY_NAME:function(){return f},OUTLET_BOUNDARY_NAME:function(){return h},ROOT_LAYOUT_BOUNDARY_NAME:function(){return i},VIEWPORT_BOUNDARY_NAME:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="__next_metadata_boundary__",g="__next_viewport_boundary__",h="__next_outlet_boundary__",i="__next_root_layout_boundary__"},61933,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={atLeastOneTask:function(){return h},scheduleImmediate:function(){return g},scheduleOnNextTick:function(){return f},waitAtLeastOneReactRenderTask:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a=>{Promise.resolve().then(()=>{process.nextTick(a)})},g=a=>{setImmediate(a)};function h(){return new Promise(a=>g(a))}function i(){return new Promise(a=>setImmediate(a))}},28340,(a,b,c)=>{"use strict";function d(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return{resolve:a,reject:b,promise:c}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createPromiseWithResolvers",{enumerable:!0,get:function(){return d}})},31382,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={RenderStage:function(){return i},StagedRenderingController:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(50640),h=a.r(28340);var i=((d={})[d.Static=1]="Static",d[d.Runtime=2]="Runtime",d[d.Dynamic=3]="Dynamic",d);class j{constructor(a=null){this.abortSignal=a,this.currentStage=1,this.runtimeStagePromise=(0,h.createPromiseWithResolvers)(),this.dynamicStagePromise=(0,h.createPromiseWithResolvers)(),a&&a.addEventListener("abort",()=>{let{reason:b}=a;this.currentStage<2&&(this.runtimeStagePromise.promise.catch(k),this.runtimeStagePromise.reject(b)),this.currentStage<3&&(this.dynamicStagePromise.promise.catch(k),this.dynamicStagePromise.reject(b))},{once:!0})}advanceStage(a){!(this.currentStage>=a)&&(this.currentStage=a,a>=2&&this.runtimeStagePromise.resolve(),a>=3&&this.dynamicStagePromise.resolve())}getStagePromise(a){switch(a){case 2:return this.runtimeStagePromise.promise;case 3:return this.dynamicStagePromise.promise;default:throw Object.defineProperty(new g.InvariantError(`Invalid render stage: ${a}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}}waitForStage(a){return this.getStagePromise(a)}delayUntilStage(a,b,c){var d,e,f;let g,h=(d=this.getStagePromise(a),e=b,f=c,g=new Promise((a,b)=>{d.then(a.bind(null,f),b)}),void 0!==e&&(g.displayName=e),g);return this.abortSignal&&h.catch(k),h}}function k(){}},60384,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e,f={Postpone:function(){return D},PreludeState:function(){return Z},abortAndThrowOnSynchronousRequestDataAccess:function(){return C},abortOnSynchronousPlatformIOAccess:function(){return A},accessedDynamicData:function(){return L},annotateDynamicAccess:function(){return Q},consumeDynamicAccess:function(){return M},createDynamicTrackingState:function(){return t},createDynamicValidationState:function(){return u},createHangingInputAbortSignal:function(){return P},createRenderInBrowserAbortSignal:function(){return O},delayUntilRuntimeStage:function(){return aa},formatDynamicAPIAccesses:function(){return N},getFirstDynamicReason:function(){return v},isDynamicPostpone:function(){return G},isPrerenderInterruptedError:function(){return K},logDisallowedDynamicError:function(){return $},markCurrentScopeAsDynamic:function(){return w},postponeWithTracking:function(){return E},throwIfDisallowedDynamic:function(){return _},throwToInterruptStaticGeneration:function(){return x},trackAllowedDynamicAccess:function(){return Y},trackDynamicDataInDynamicRender:function(){return y},trackSynchronousPlatformIOAccessInDev:function(){return B},useDynamicRouteParams:function(){return R},useDynamicSearchParams:function(){return S}};for(var g in f)Object.defineProperty(c,g,{enumerable:!0,get:f[g]});let h=(d=a.r(717))&&d.__esModule?d:{default:d},i=a.r(96556),j=a.r(60312),k=a.r(32319),l=a.r(56704),m=a.r(13091),n=a.r(17491),o=a.r(61933),p=a.r(49640),q=a.r(50640),r=a.r(31382),s="function"==typeof h.default.unstable_postpone;function t(a){return{isDebugDynamicAccesses:a,dynamicAccesses:[],syncDynamicErrorWithStack:null}}function u(){return{hasSuspenseAboveBody:!1,hasDynamicMetadata:!1,hasDynamicViewport:!1,hasAllowedDynamic:!1,dynamicErrors:[]}}function v(a){var b;return null==(b=a.dynamicAccesses[0])?void 0:b.expression}function w(a,b,c){if(b)switch(b.type){case"cache":case"unstable-cache":case"private-cache":return}if(!a.forceDynamic&&!a.forceStatic){if(a.dynamicShouldError)throw Object.defineProperty(new j.StaticGenBailoutError(`Route ${a.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${c}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(b)switch(b.type){case"prerender-ppr":return E(a.route,c,b.dynamicTracking);case"prerender-legacy":b.revalidate=0;let d=Object.defineProperty(new i.DynamicServerError(`Route ${a.route} couldn't be rendered statically because it used ${c}. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E550",enumerable:!1,configurable:!0});throw a.dynamicUsageDescription=c,a.dynamicUsageStack=d.stack,d}}}function x(a,b,c){let d=Object.defineProperty(new i.DynamicServerError(`Route ${b.route} couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw c.revalidate=0,b.dynamicUsageDescription=a,b.dynamicUsageStack=d.stack,d}function y(a){switch(a.type){case"cache":case"unstable-cache":case"private-cache":return}}function z(a,b,c){let d=J(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`);c.controller.abort(d);let e=c.dynamicTracking;e&&e.dynamicAccesses.push({stack:e.isDebugDynamicAccesses?Error().stack:void 0,expression:b})}function A(a,b,c,d){let e=d.dynamicTracking;z(a,b,d),e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}function B(a){a.stagedRendering&&a.stagedRendering.advanceStage(r.RenderStage.Dynamic)}function C(a,b,c,d){if(!1===d.controller.signal.aborted){z(a,b,d);let e=d.dynamicTracking;e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}throw J(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`)}function D({reason:a,route:b}){let c=k.workUnitAsyncStorage.getStore();E(b,a,c&&"prerender-ppr"===c.type?c.dynamicTracking:null)}function E(a,b,c){(function(){if(!s)throw Object.defineProperty(Error("Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E224",enumerable:!1,configurable:!0})})(),c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:b}),h.default.unstable_postpone(F(a,b))}function F(a,b){return`Route ${a} needs to bail out of prerendering at this point because it used ${b}. React throws this special object to indicate where. It should not be caught by your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`}function G(a){return"object"==typeof a&&null!==a&&"string"==typeof a.message&&H(a.message)}function H(a){return a.includes("needs to bail out of prerendering at this point because it used")&&a.includes("Learn more: https://nextjs.org/docs/messages/ppr-caught-error")}if(!1===H(F("%%%","^^^")))throw Object.defineProperty(Error("Invariant: isDynamicPostpone misidentified a postpone reason. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E296",enumerable:!1,configurable:!0});let I="NEXT_PRERENDER_INTERRUPTED";function J(a){let b=Object.defineProperty(Error(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return b.digest=I,b}function K(a){return"object"==typeof a&&null!==a&&a.digest===I&&"name"in a&&"message"in a&&a instanceof Error}function L(a){return a.length>0}function M(a,b){return a.dynamicAccesses.push(...b.dynamicAccesses),a.dynamicAccesses}function N(a){return a.filter(a=>"string"==typeof a.stack&&a.stack.length>0).map(({expression:a,stack:b})=>(b=b.split("\n").slice(4).filter(a=>!(a.includes("node_modules/next/")||a.includes(" (<anonymous>)")||a.includes(" (node:"))).join("\n"),`Dynamic API Usage Debug - ${a}:
${b}`))}function O(){let a=new AbortController;return a.abort(Object.defineProperty(new p.BailoutToCSRError("Render in Browser"),"__NEXT_ERROR_CODE",{value:"E721",enumerable:!1,configurable:!0})),a.signal}function P(a){switch(a.type){case"prerender":case"prerender-runtime":let b=new AbortController;if(a.cacheSignal)a.cacheSignal.inputReady().then(()=>{b.abort()});else{let c=(0,k.getRuntimeStagePromise)(a);c?c.then(()=>(0,o.scheduleOnNextTick)(()=>b.abort())):(0,o.scheduleOnNextTick)(()=>b.abort())}return b.signal;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":return}}function Q(a,b){let c=b.dynamicTracking;c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:a})}function R(a){let b=l.workAsyncStorage.getStore(),c=k.workUnitAsyncStorage.getStore();if(b&&c)switch(c.type){case"prerender-client":case"prerender":{let d=c.fallbackRouteParams;d&&d.size>0&&h.default.use((0,m.makeHangingPromise)(c.renderSignal,b.route,a));break}case"prerender-ppr":{let d=c.fallbackRouteParams;if(d&&d.size>0)return E(b.route,a,c.dynamicTracking);break}case"prerender-runtime":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called during a runtime prerender. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E771",enumerable:!1,configurable:!0});case"cache":case"private-cache":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called inside a cache scope. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E745",enumerable:!1,configurable:!0})}}function S(a){let b=l.workAsyncStorage.getStore(),c=k.workUnitAsyncStorage.getStore();if(b)switch(!c&&(0,k.throwForMissingRequestStore)(a),c.type){case"prerender-client":h.default.use((0,m.makeHangingPromise)(c.renderSignal,b.route,a));break;case"prerender-legacy":case"prerender-ppr":if(b.forceStatic)return;throw Object.defineProperty(new p.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called from a Server Component. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E795",enumerable:!1,configurable:!0});case"cache":case"unstable-cache":case"private-cache":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called inside a cache scope. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E745",enumerable:!1,configurable:!0});case"request":return}}let T=/\n\s+at Suspense \(<anonymous>\)/,U=RegExp(`\\n\\s+at Suspense \\(<anonymous>\\)(?:(?!\\n\\s+at (?:body|div|main|section|article|aside|header|footer|nav|form|p|span|h1|h2|h3|h4|h5|h6) \\(<anonymous>\\))[\\s\\S])*?\\n\\s+at ${n.ROOT_LAYOUT_BOUNDARY_NAME} \\([^\\n]*\\)`),V=RegExp(`\\n\\s+at ${n.METADATA_BOUNDARY_NAME}[\\n\\s]`),W=RegExp(`\\n\\s+at ${n.VIEWPORT_BOUNDARY_NAME}[\\n\\s]`),X=RegExp(`\\n\\s+at ${n.OUTLET_BOUNDARY_NAME}[\\n\\s]`);function Y(a,b,c,d){if(!X.test(b)){if(V.test(b)){c.hasDynamicMetadata=!0;return}if(W.test(b)){c.hasDynamicViewport=!0;return}if(U.test(b)){c.hasAllowedDynamic=!0,c.hasSuspenseAboveBody=!0;return}else if(T.test(b)){c.hasAllowedDynamic=!0;return}else{var e,f;let g;if(d.syncDynamicErrorWithStack)return void c.dynamicErrors.push(d.syncDynamicErrorWithStack);let h=(e=`Route "${a.route}": Uncached data was accessed outside of <Suspense>. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/blocking-route`,f=b,(g=Object.defineProperty(Error(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})).stack=g.name+": "+e+f,g);return void c.dynamicErrors.push(h)}}}var Z=((e={})[e.Full=0]="Full",e[e.Empty=1]="Empty",e[e.Errored=2]="Errored",e);function $(a,b){console.error(b),a.dev||(a.hasReadableErrorStacks?console.error(`To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.`):console.error(`To get a more detailed stack trace and pinpoint the issue, try one of the following:
  - Start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.
  - Rerun the production build with \`next build --debug-prerender\` to generate better stack traces.`))}function _(a,b,c,d){if(d.syncDynamicErrorWithStack)throw $(a,d.syncDynamicErrorWithStack),new j.StaticGenBailoutError;if(0!==b){if(c.hasSuspenseAboveBody)return;let d=c.dynamicErrors;if(d.length>0){for(let b=0;b<d.length;b++)$(a,d[b]);throw new j.StaticGenBailoutError}if(c.hasDynamicViewport)throw console.error(`Route "${a.route}" has a \`generateViewport\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) without explicitly allowing fully dynamic rendering. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`),new j.StaticGenBailoutError;if(1===b)throw console.error(`Route "${a.route}" did not produce a static shell and Next.js was unable to determine a reason. This is a bug in Next.js.`),new j.StaticGenBailoutError}else if(!1===c.hasAllowedDynamic&&c.hasDynamicMetadata)throw console.error(`Route "${a.route}" has a \`generateMetadata\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) when the rest of the route does not. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`),new j.StaticGenBailoutError}function aa(a,b){return a.runtimeStagePromise?a.runtimeStagePromise.then(()=>b):b}},94783,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_rethrow",{enumerable:!0,get:function(){return function a(b){if((0,g.isNextRouterError)(b)||(0,f.isBailoutToCSRError)(b)||(0,i.isDynamicServerError)(b)||(0,h.isDynamicPostpone)(b)||(0,e.isPostpone)(b)||(0,d.isHangingPromiseRejectionError)(b)||(0,h.isPrerenderInterruptedError)(b))throw b;b instanceof Error&&"cause"in b&&a(b.cause)}}});let d=a.r(13091),e=a.r(73808),f=a.r(49640),g=a.r(1567),h=a.r(60384),i=a.r(96556);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},60968,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_rethrow",{enumerable:!0,get:function(){return d}});let d=a.r(94783).unstable_rethrow;("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},73727,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ReadonlyURLSearchParams:function(){return f.ReadonlyURLSearchParams},RedirectType:function(){return h.RedirectType},forbidden:function(){return j.forbidden},notFound:function(){return i.notFound},permanentRedirect:function(){return g.permanentRedirect},redirect:function(){return g.redirect},unauthorized:function(){return k.unauthorized},unstable_isUnrecognizedActionError:function(){return m},unstable_rethrow:function(){return l.unstable_rethrow}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(20916),g=a.r(44868),h=a.r(28859),i=a.r(16155),j=a.r(34557),k=a.r(93845),l=a.r(60968);function m(){throw Object.defineProperty(Error("`unstable_isUnrecognizedActionError` can only be used on the client."),"__NEXT_ERROR_CODE",{value:"E776",enumerable:!1,configurable:!0})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},70396,a=>{"use strict";a.i(73727),a.s([])},98841,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},21318,(a,b,c)=>{b.exports=function(a){return a&&a.__esModule?a:{default:a}},b.exports.__esModule=!0,b.exports.default=b.exports},73653,(a,b,c)=>{b.exports=function(a,b){this.v=a,this.k=b},b.exports.__esModule=!0,b.exports.default=b.exports},5847,(a,b,c)=>{function d(a,c,e,f){var g=Object.defineProperty;try{g({},"",{})}catch(a){g=0}b.exports=d=function(a,b,c,e){function f(b,c){d(a,b,function(a){return this._invoke(b,c,a)})}b?g?g(a,b,{value:c,enumerable:!e,configurable:!e,writable:!e}):a[b]=c:(f("next",0),f("throw",1),f("return",2))},b.exports.__esModule=!0,b.exports.default=b.exports,d(a,c,e,f)}b.exports=d,b.exports.__esModule=!0,b.exports.default=b.exports},24113,(a,b,c)=>{var d=a.r(5847);function e(){var a,c,f="function"==typeof Symbol?Symbol:{},g=f.iterator||"@@iterator",h=f.toStringTag||"@@toStringTag";function i(b,e,f,g){var h=Object.create((e&&e.prototype instanceof k?e:k).prototype);return d(h,"_invoke",function(b,d,e){var f,g,h,i=0,k=e||[],l=!1,m={p:0,n:0,v:a,a:n,f:n.bind(a,4),d:function(b,c){return f=b,g=0,h=a,m.n=c,j}};function n(b,d){for(g=b,h=d,c=0;!l&&i&&!e&&c<k.length;c++){var e,f=k[c],n=m.p,o=f[2];b>3?(e=o===d)&&(h=f[(g=f[4])?5:(g=3,3)],f[4]=f[5]=a):f[0]<=n&&((e=b<2&&n<f[1])?(g=0,m.v=d,m.n=f[1]):n<o&&(e=b<3||f[0]>d||d>o)&&(f[4]=b,f[5]=d,m.n=o,g=0))}if(e||b>1)return j;throw l=!0,d}return function(e,k,o){if(i>1)throw TypeError("Generator is already running");for(l&&1===k&&n(k,o),g=k,h=o;(c=g<2?a:h)||!l;){f||(g?g<3?(g>1&&(m.n=-1),n(g,h)):m.n=h:m.v=h);try{if(i=2,f){if(g||(e="next"),c=f[e]){if(!(c=c.call(f,h)))throw TypeError("iterator result is not an object");if(!c.done)return c;h=c.value,g<2&&(g=0)}else 1===g&&(c=f.return)&&c.call(f),g<2&&(h=TypeError("The iterator does not provide a '"+e+"' method"),g=1);f=a}else if((c=(l=m.n<0)?h:b.call(d,m))!==j)break}catch(b){f=a,g=1,h=b}finally{i=1}}return{value:c,done:l}}}(b,f,g),!0),h}var j={};function k(){}function l(){}function m(){}c=Object.getPrototypeOf;var n=m.prototype=k.prototype=Object.create([][g]?c(c([][g]())):(d(c={},g,function(){return this}),c));function o(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,m):(a.__proto__=m,d(a,h,"GeneratorFunction")),a.prototype=Object.create(n),a}return l.prototype=m,d(n,"constructor",m),d(m,"constructor",l),l.displayName="GeneratorFunction",d(m,h,"GeneratorFunction"),d(n),d(n,h,"Generator"),d(n,g,function(){return this}),d(n,"toString",function(){return"[object Generator]"}),(b.exports=e=function(){return{w:i,m:o}},b.exports.__esModule=!0,b.exports.default=b.exports)()}b.exports=e,b.exports.__esModule=!0,b.exports.default=b.exports},15769,(a,b,c)=>{var d=a.r(73653),e=a.r(5847);b.exports=function a(b,c){var f;this.next||(e(a.prototype),e(a.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),e(this,"_invoke",function(a,e,g){function h(){return new c(function(e,f){!function a(e,f,g,h){try{var i=b[e](f),j=i.value;return j instanceof d?c.resolve(j.v).then(function(b){a("next",b,g,h)},function(b){a("throw",b,g,h)}):c.resolve(j).then(function(a){i.value=a,g(i)},function(b){return a("throw",b,g,h)})}catch(a){h(a)}}(a,g,e,f)})}return f=f?f.then(h,h):h()},!0)},b.exports.__esModule=!0,b.exports.default=b.exports},74603,(a,b,c)=>{var d=a.r(24113),e=a.r(15769);b.exports=function(a,b,c,f,g){return new e(d().w(a,b,c,f),g||Promise)},b.exports.__esModule=!0,b.exports.default=b.exports},77182,(a,b,c)=>{var d=a.r(74603);b.exports=function(a,b,c,e,f){var g=d(a,b,c,e,f);return g.next().then(function(a){return a.done?a.value:g.next()})},b.exports.__esModule=!0,b.exports.default=b.exports},40263,(a,b,c)=>{b.exports=function(a){var b=Object(a),c=[];for(var d in b)c.unshift(d);return function a(){for(;c.length;)if((d=c.pop())in b)return a.value=d,a.done=!1,a;return a.done=!0,a}},b.exports.__esModule=!0,b.exports.default=b.exports},75530,(a,b,c)=>{function d(a){return b.exports=d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b.exports.__esModule=!0,b.exports.default=b.exports,d(a)}b.exports=d,b.exports.__esModule=!0,b.exports.default=b.exports},87480,(a,b,c)=>{var d=a.r(75530).default;b.exports=function(a){if(null!=a){var b=a["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],c=0;if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length))return{next:function(){return a&&c>=a.length&&(a=void 0),{value:a&&a[c++],done:!a}}}}throw TypeError(d(a)+" is not iterable")},b.exports.__esModule=!0,b.exports.default=b.exports},93207,(a,b,c)=>{var d=a.r(73653),e=a.r(24113),f=a.r(77182),g=a.r(74603),h=a.r(15769),i=a.r(40263),j=a.r(87480);function k(){"use strict";var a=e(),c=a.m(k),l=(Object.getPrototypeOf?Object.getPrototypeOf(c):c.__proto__).constructor;function m(a){var b="function"==typeof a&&a.constructor;return!!b&&(b===l||"GeneratorFunction"===(b.displayName||b.name))}var n={throw:1,return:2,break:3,continue:3};function o(a){var b,c;return function(d){b||(b={stop:function(){return c(d.a,2)},catch:function(){return d.v},abrupt:function(a,b){return c(d.a,n[a],b)},delegateYield:function(a,e,f){return b.resultName=e,c(d.d,j(a),f)},finish:function(a){return c(d.f,a)}},c=function(a,c,e){d.p=b.prev,d.n=b.next;try{return a(c,e)}finally{b.next=d.n}}),b.resultName&&(b[b.resultName]=d.v,b.resultName=void 0),b.sent=d.v,b.next=d.n;try{return a.call(this,b)}finally{d.p=b.prev,d.n=b.next}}}return(b.exports=k=function(){return{wrap:function(b,c,d,e){return a.w(o(b),c,d,e&&e.reverse())},isGeneratorFunction:m,mark:a.m,awrap:function(a,b){return new d(a,b)},AsyncIterator:h,async:function(a,b,c,d,e){return(m(b)?g:f)(o(a),b,c,d,e)},keys:i,values:j}},b.exports.__esModule=!0,b.exports.default=b.exports)()}b.exports=k,b.exports.__esModule=!0,b.exports.default=b.exports},71909,(a,b,c)=>{var d=a.r(93207)();b.exports=d;try{regeneratorRuntime=d}catch(a){"object"==typeof globalThis?globalThis.regeneratorRuntime=d:Function("r","regeneratorRuntime = r")(d)}},42509,(a,b,c)=>{var d=a.r(75530).default;b.exports=function(a,b){if("object"!=d(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var e=c.call(a,b||"default");if("object"!=d(e))return e;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)},b.exports.__esModule=!0,b.exports.default=b.exports},70208,(a,b,c)=>{var d=a.r(75530).default,e=a.r(42509);b.exports=function(a){var b=e(a,"string");return"symbol"==d(b)?b:b+""},b.exports.__esModule=!0,b.exports.default=b.exports},75211,(a,b,c)=>{var d=a.r(70208);b.exports=function(a,b,c){return(b=d(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a},b.exports.__esModule=!0,b.exports.default=b.exports},8167,(a,b,c)=>{function d(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}b.exports=function(a){return function(){var b=this,c=arguments;return new Promise(function(e,f){var g=a.apply(b,c);function h(a){d(g,e,f,h,i,"next",a)}function i(a){d(g,e,f,h,i,"throw",a)}h(void 0)})}},b.exports.__esModule=!0,b.exports.default=b.exports},11927,(a,b,c)=>{b.exports=function(a,b){if(!(a instanceof b))throw TypeError("Cannot call a class as a function")},b.exports.__esModule=!0,b.exports.default=b.exports},96670,(a,b,c)=>{var d=a.r(70208);function e(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(a,d(e.key),e)}}b.exports=function(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a},b.exports.__esModule=!0,b.exports.default=b.exports},38363,(a,b,c)=>{b.exports=function(a){if(void 0===a)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return a},b.exports.__esModule=!0,b.exports.default=b.exports},12030,(a,b,c)=>{var d=a.r(75530).default,e=a.r(38363);b.exports=function(a,b){if(b&&("object"==d(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");return e(a)},b.exports.__esModule=!0,b.exports.default=b.exports},62456,(a,b,c)=>{function d(a){return b.exports=d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},b.exports.__esModule=!0,b.exports.default=b.exports,d(a)}b.exports=d,b.exports.__esModule=!0,b.exports.default=b.exports},86363,(a,b,c)=>{function d(a,c){return b.exports=d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a},b.exports.__esModule=!0,b.exports.default=b.exports,d(a,c)}b.exports=d,b.exports.__esModule=!0,b.exports.default=b.exports},77047,(a,b,c)=>{var d=a.r(86363);b.exports=function(a,b){if("function"!=typeof b&&null!==b)throw TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),b&&d(a,b)},b.exports.__esModule=!0,b.exports.default=b.exports},12997,(a,b,c)=>{b.exports=function(a){try{return -1!==Function.toString.call(a).indexOf("[native code]")}catch(b){return"function"==typeof a}},b.exports.__esModule=!0,b.exports.default=b.exports},72769,(a,b,c)=>{function d(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(b.exports=d=function(){return!!a},b.exports.__esModule=!0,b.exports.default=b.exports)()}b.exports=d,b.exports.__esModule=!0,b.exports.default=b.exports},55292,(a,b,c)=>{var d=a.r(72769),e=a.r(86363);b.exports=function(a,b,c){if(d())return Reflect.construct.apply(null,arguments);var f=[null];f.push.apply(f,b);var g=new(a.bind.apply(a,f));return c&&e(g,c.prototype),g},b.exports.__esModule=!0,b.exports.default=b.exports},64051,(a,b,c)=>{var d=a.r(62456),e=a.r(86363),f=a.r(12997),g=a.r(55292);function h(a){var c="function"==typeof Map?new Map:void 0;return b.exports=h=function(a){if(null===a||!f(a))return a;if("function"!=typeof a)throw TypeError("Super expression must either be null or a function");if(void 0!==c){if(c.has(a))return c.get(a);c.set(a,b)}function b(){return g(a,arguments,d(this).constructor)}return b.prototype=Object.create(a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),e(b,a)},b.exports.__esModule=!0,b.exports.default=b.exports,h(a)}b.exports=h,b.exports.__esModule=!0,b.exports.default=b.exports},18673,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0}),c.UnsupportedStrategy=c.UnknownError=c.OAuthCallbackError=c.MissingSecret=c.MissingAuthorize=c.MissingAdapterMethods=c.MissingAdapter=c.MissingAPIRoute=c.InvalidCallbackUrl=c.AccountNotLinkedError=void 0,c.adapterErrorHandler=function(a,b){if(a)return Object.keys(a).reduce(function(c,d){return c[d]=(0,f.default)(e.default.mark(function c(){var f,g,h,i,j,k=arguments;return e.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:for(c.prev=0,g=Array(f=k.length),h=0;h<f;h++)g[h]=k[h];return b.debug("adapter_".concat(d),{args:g}),i=a[d],c.next=6,i.apply(void 0,g);case 6:return c.abrupt("return",c.sent);case 9:throw c.prev=9,c.t0=c.catch(0),b.error("adapter_error_".concat(d),c.t0),(j=new o(c.t0)).name="".concat(q(d),"Error"),j;case 15:case"end":return c.stop()}},c,null,[[0,9]])})),c},{})},c.capitalize=q,c.eventsErrorHandler=function(a,b){return Object.keys(a).reduce(function(c,d){return c[d]=(0,f.default)(e.default.mark(function c(){var f,g=arguments;return e.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,f=a[d],c.next=4,f.apply(void 0,g);case 4:return c.abrupt("return",c.sent);case 7:c.prev=7,c.t0=c.catch(0),b.error("".concat(p(d),"_EVENT_ERROR"),c.t0);case 10:case"end":return c.stop()}},c,null,[[0,7]])})),c},{})},c.upperSnake=p;var e=d(a.r(71909)),f=d(a.r(8167)),g=d(a.r(75211)),h=d(a.r(11927)),i=d(a.r(96670)),j=d(a.r(12030)),k=d(a.r(62456)),l=d(a.r(77047));function m(a,b,c){return b=(0,k.default)(b),(0,j.default)(a,n()?Reflect.construct(b,c||[],(0,k.default)(a).constructor):b.apply(a,c))}function n(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(n=function(){return!!a})()}var o=c.UnknownError=function(a){function b(a){var c,d;return(0,h.default)(this,b),(d=m(this,b,[null!=(c=null==a?void 0:a.message)?c:a])).name="UnknownError",d.code=a.code,a instanceof Error&&(d.stack=a.stack),d}return(0,l.default)(b,a),(0,i.default)(b,[{key:"toJSON",value:function(){return{name:this.name,message:this.message,stack:this.stack}}}])}((0,d(a.r(64051)).default)(Error));function p(a){return a.replace(/([A-Z])/g,"_$1").toUpperCase()}function q(a){return"".concat(a[0].toUpperCase()).concat(a.slice(1))}c.OAuthCallbackError=function(a){function b(){var a;(0,h.default)(this,b);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return a=m(this,b,[].concat(d)),(0,g.default)(a,"name","OAuthCallbackError"),a}return(0,l.default)(b,a),(0,i.default)(b)}(o),c.AccountNotLinkedError=function(a){function b(){var a;(0,h.default)(this,b);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return a=m(this,b,[].concat(d)),(0,g.default)(a,"name","AccountNotLinkedError"),a}return(0,l.default)(b,a),(0,i.default)(b)}(o),c.MissingAPIRoute=function(a){function b(){var a;(0,h.default)(this,b);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return a=m(this,b,[].concat(d)),(0,g.default)(a,"name","MissingAPIRouteError"),(0,g.default)(a,"code","MISSING_NEXTAUTH_API_ROUTE_ERROR"),a}return(0,l.default)(b,a),(0,i.default)(b)}(o),c.MissingSecret=function(a){function b(){var a;(0,h.default)(this,b);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return a=m(this,b,[].concat(d)),(0,g.default)(a,"name","MissingSecretError"),(0,g.default)(a,"code","NO_SECRET"),a}return(0,l.default)(b,a),(0,i.default)(b)}(o),c.MissingAuthorize=function(a){function b(){var a;(0,h.default)(this,b);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return a=m(this,b,[].concat(d)),(0,g.default)(a,"name","MissingAuthorizeError"),(0,g.default)(a,"code","CALLBACK_CREDENTIALS_HANDLER_ERROR"),a}return(0,l.default)(b,a),(0,i.default)(b)}(o),c.MissingAdapter=function(a){function b(){var a;(0,h.default)(this,b);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return a=m(this,b,[].concat(d)),(0,g.default)(a,"name","MissingAdapterError"),(0,g.default)(a,"code","EMAIL_REQUIRES_ADAPTER_ERROR"),a}return(0,l.default)(b,a),(0,i.default)(b)}(o),c.MissingAdapterMethods=function(a){function b(){var a;(0,h.default)(this,b);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return a=m(this,b,[].concat(d)),(0,g.default)(a,"name","MissingAdapterMethodsError"),(0,g.default)(a,"code","MISSING_ADAPTER_METHODS_ERROR"),a}return(0,l.default)(b,a),(0,i.default)(b)}(o),c.UnsupportedStrategy=function(a){function b(){var a;(0,h.default)(this,b);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return a=m(this,b,[].concat(d)),(0,g.default)(a,"name","UnsupportedStrategyError"),(0,g.default)(a,"code","CALLBACK_CREDENTIALS_JWT_ERROR"),a}return(0,l.default)(b,a),(0,i.default)(b)}(o),c.InvalidCallbackUrl=function(a){function b(){var a;(0,h.default)(this,b);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return a=m(this,b,[].concat(d)),(0,g.default)(a,"name","InvalidCallbackUrl"),(0,g.default)(a,"code","INVALID_CALLBACK_URL_ERROR"),a}return(0,l.default)(b,a),(0,i.default)(b)}(o)},96946,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0,c.proxyLogger=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;arguments.length>1&&arguments[1];try{return a}catch(a){return f}},c.setLogger=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=arguments.length>1?arguments[1]:void 0;b||(f.debug=function(){}),a.error&&(f.error=a.error),a.warn&&(f.warn=a.warn),a.debug&&(f.debug=a.debug)},d(a.r(71909)),d(a.r(75211)),d(a.r(8167));var e=a.r(18673),f={error:function(a,b){b=function a(b){var c,d;if(b instanceof Error&&!(b instanceof e.UnknownError))return{message:b.message,stack:b.stack,name:b.name};if(null!=(c=b)&&c.error){b.error=a(b.error),b.message=null!=(d=b.message)?d:b.error.message}return b}(b),console.error("[next-auth][error][".concat(a,"]"),"\nhttps://next-auth.js.org/errors#".concat(a.toLowerCase()),b.message,b)},warn:function(a){console.warn("[next-auth][warn][".concat(a,"]"),"\nhttps://next-auth.js.org/warnings#".concat(a.toLowerCase()))},debug:function(a,b){console.log("[next-auth][debug][".concat(a,"]"),b)}};c.default=f},93368,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.detectOrigin=function(a,b){var c;return(null!=(c=process.env.VERCEL)?c:process.env.AUTH_TRUST_HOST)?`${"http"===b?"http":"https"}://${a}`:process.env.NEXTAUTH_URL}},56780,(a,b,c)=>{let{format:d}=a.r(24361);b.exports={OPError:class extends Error{constructor({error_description:a,error:b,error_uri:c,session_state:d,state:e,scope:f},g){super(a?`${b} (${a})`:b),Object.assign(this,{error:b},a&&{error_description:a},c&&{error_uri:c},e&&{state:e},f&&{scope:f},d&&{session_state:d}),g&&Object.defineProperty(this,"response",{value:g}),this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}},RPError:class extends Error{constructor(...a){if("string"==typeof a[0])super(d(...a));else{const{message:b,printf:c,response:e,...f}=a[0];c?super(d(...c)):super(b),Object.assign(this,f),e&&Object.defineProperty(this,"response",{value:e})}this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}}}},79709,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799);c.default=(a,b)=>(0,d.createHash)(a).update(b).digest()},2962,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.concatKdf=c.lengthAndInput=c.uint32be=c.uint64be=c.p2s=c.concat=c.decoder=c.encoder=void 0;let d=a.r(79709);function e(...a){let b=new Uint8Array(a.reduce((a,{length:b})=>a+b,0)),c=0;return a.forEach(a=>{b.set(a,c),c+=a.length}),b}function f(a,b,c){if(b<0||b>=0x100000000)throw RangeError(`value must be >= 0 and <= ${0x100000000-1}. Received ${b}`);a.set([b>>>24,b>>>16,b>>>8,255&b],c)}function g(a){let b=new Uint8Array(4);return f(b,a),b}c.encoder=new TextEncoder,c.decoder=new TextDecoder,c.concat=e,c.p2s=function(a,b){return e(c.encoder.encode(a),new Uint8Array([0]),b)},c.uint64be=function(a){let b=Math.floor(a/0x100000000),c=new Uint8Array(8);return f(c,b,0),f(c,a%0x100000000,4),c},c.uint32be=g,c.lengthAndInput=function(a){return e(g(a.length),a)},c.concatKdf=async function(a,b,c){let e=Math.ceil((b>>3)/32),f=new Uint8Array(32*e);for(let b=0;b<e;b++){let e=new Uint8Array(4+a.length+c.length);e.set(g(b+1)),e.set(a,4),e.set(c,4+a.length),f.set(await (0,d.default)("sha256",e),32*b)}return f.slice(0,b>>3)}},74627,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decode=c.encode=c.encodeBase64=c.decodeBase64=void 0;let d=a.r(874),e=a.r(2962);d.Buffer.isEncoding("base64url")?c.encode=a=>d.Buffer.from(a).toString("base64url"):c.encode=a=>d.Buffer.from(a).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),c.decodeBase64=a=>d.Buffer.from(a,"base64"),c.encodeBase64=a=>d.Buffer.from(a).toString("base64"),c.decode=a=>{let b;return d.Buffer.from(((b=a)instanceof Uint8Array&&(b=e.decoder.decode(b)),b),"base64")}},37713,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWSSignatureVerificationFailed=c.JWKSTimeout=c.JWKSMultipleMatchingKeys=c.JWKSNoMatchingKey=c.JWKSInvalid=c.JWKInvalid=c.JWTInvalid=c.JWSInvalid=c.JWEInvalid=c.JWEDecompressionFailed=c.JWEDecryptionFailed=c.JOSENotSupported=c.JOSEAlgNotAllowed=c.JWTExpired=c.JWTClaimValidationFailed=c.JOSEError=void 0;class d extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(a){var b;super(a),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null==(b=Error.captureStackTrace)||b.call(Error,this,this.constructor)}}c.JOSEError=d,c.JWTClaimValidationFailed=class extends d{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(a,b="unspecified",c="unspecified"){super(a),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=b,this.reason=c}},c.JWTExpired=class extends d{static get code(){return"ERR_JWT_EXPIRED"}constructor(a,b="unspecified",c="unspecified"){super(a),this.code="ERR_JWT_EXPIRED",this.claim=b,this.reason=c}},c.JOSEAlgNotAllowed=class extends d{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}},c.JOSENotSupported=class extends d{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}},c.JWEDecryptionFailed=class extends d{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}},c.JWEDecompressionFailed=class extends d{constructor(){super(...arguments),this.code="ERR_JWE_DECOMPRESSION_FAILED",this.message="decompression operation failed"}static get code(){return"ERR_JWE_DECOMPRESSION_FAILED"}},c.JWEInvalid=class extends d{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}},c.JWSInvalid=class extends d{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}},c.JWTInvalid=class extends d{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}},c.JWKInvalid=class extends d{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}},c.JWKSInvalid=class extends d{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}},c.JWKSNoMatchingKey=class extends d{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}},c.JWKSMultipleMatchingKeys=class extends d{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}},c.JWKSTimeout=class extends d{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}},c.JWSSignatureVerificationFailed=class extends d{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}},74442,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a.r(54799);Object.defineProperty(c,"default",{enumerable:!0,get:function(){return d.randomFillSync}})},89390,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.bitLength=void 0;let d=a.r(37713),e=a.r(74442);function f(a){switch(a){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new d.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}c.bitLength=f,c.default=a=>(0,e.default)(new Uint8Array(f(a)>>3))},6297,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(37713),e=a.r(89390);c.default=(a,b)=>{if(b.length<<3!==(0,e.bitLength)(a))throw new d.JWEInvalid("Invalid Initialization Vector length")}},18346,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(24361);c.default=e.types.isKeyObject?a=>e.types.isKeyObject(a):a=>null!=a&&a instanceof d.KeyObject},59218,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(37713),e=a.r(18346);c.default=(a,b)=>{let c;switch(a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(a.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(a.slice(1,4),10);break;default:throw new d.JOSENotSupported(`Content Encryption Algorithm ${a} is not supported either by JOSE or your javascript runtime`)}if(b instanceof Uint8Array){let a=b.byteLength<<3;if(a!==c)throw new d.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${a} bits`);return}if((0,e.default)(b)&&"secret"===b.type){let a=b.symmetricKeySize<<3;if(a!==c)throw new d.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${a} bits`);return}throw TypeError("Invalid Content Encryption Key type")}},20363,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=a.r(54799).timingSafeEqual},41139,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(2962);c.default=function(a,b,c,f,g,h){let i=(0,e.concat)(a,b,c,(0,e.uint64be)(a.length<<3)),j=(0,d.createHmac)(`sha${f}`,g);return j.update(i),j.digest().slice(0,h>>3)}},12957,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.isCryptoKey=void 0;let d=a.r(54799),e=a.r(24361);c.default=d.webcrypto,c.isCryptoKey=e.types.isCryptoKey?a=>e.types.isCryptoKey(a):a=>!1},48648,(a,b,c)=>{"use strict";function d(a,b="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${b} must be ${a}`)}function e(a,b){return a.name===b}function f(a){return parseInt(a.name.slice(4),10)}function g(a,b){if(b.length&&!b.some(b=>a.usages.includes(b))){let a="CryptoKey does not support this operation, its usages must include ";if(b.length>2){let c=b.pop();a+=`one of ${b.join(", ")}, or ${c}.`}else 2===b.length?a+=`one of ${b[0]} or ${b[1]}.`:a+=`${b[0]}.`;throw TypeError(a)}}Object.defineProperty(c,"__esModule",{value:!0}),c.checkEncCryptoKey=c.checkSigCryptoKey=void 0,c.checkSigCryptoKey=function(a,b,...c){switch(b){case"HS256":case"HS384":case"HS512":{if(!e(a.algorithm,"HMAC"))throw d("HMAC");let c=parseInt(b.slice(2),10);if(f(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!e(a.algorithm,"RSASSA-PKCS1-v1_5"))throw d("RSASSA-PKCS1-v1_5");let c=parseInt(b.slice(2),10);if(f(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!e(a.algorithm,"RSA-PSS"))throw d("RSA-PSS");let c=parseInt(b.slice(2),10);if(f(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==a.algorithm.name&&"Ed448"!==a.algorithm.name)throw d("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!e(a.algorithm,"ECDSA"))throw d("ECDSA");let c=function(a){switch(a){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(b);if(a.algorithm.namedCurve!==c)throw d(c,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}g(a,c)},c.checkEncCryptoKey=function(a,b,...c){switch(b){case"A128GCM":case"A192GCM":case"A256GCM":{if(!e(a.algorithm,"AES-GCM"))throw d("AES-GCM");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw d(c,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!e(a.algorithm,"AES-KW"))throw d("AES-KW");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw d(c,"algorithm.length");break}case"ECDH":switch(a.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw d("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!e(a.algorithm,"PBKDF2"))throw d("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!e(a.algorithm,"RSA-OAEP"))throw d("RSA-OAEP");let c=parseInt(b.slice(9),10)||1;if(f(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}g(a,c)}},91213,(a,b,c)=>{"use strict";function d(a,b,...c){if(c.length>2){let b=c.pop();a+=`one of type ${c.join(", ")}, or ${b}.`}else 2===c.length?a+=`one of type ${c[0]} or ${c[1]}.`:a+=`of type ${c[0]}.`;return null==b?a+=` Received ${b}`:"function"==typeof b&&b.name?a+=` Received function ${b.name}`:"object"==typeof b&&null!=b&&b.constructor&&b.constructor.name&&(a+=` Received an instance of ${b.constructor.name}`),a}Object.defineProperty(c,"__esModule",{value:!0}),c.withAlg=void 0,c.default=(a,...b)=>d("Key must be ",a,...b),c.withAlg=function(a,b,...c){return d(`Key for the ${a} algorithm must be `,b,...c)}},339,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});let e=a.r(54799);c.default=a=>(d||(d=new Set((0,e.getCiphers)())),d.has(a))},58099,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.types=void 0;let d=a.r(12957),e=a.r(18346);c.default=a=>(0,e.default)(a)||(0,d.isCryptoKey)(a);let f=["KeyObject"];c.types=f,(globalThis.CryptoKey||(null===d.default||void 0===d.default?void 0:d.default.CryptoKey))&&f.push("CryptoKey")},75342,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(6297),f=a.r(59218),g=a.r(2962),h=a.r(37713),i=a.r(20363),j=a.r(41139),k=a.r(12957),l=a.r(48648),m=a.r(18346),n=a.r(91213),o=a.r(339),p=a.r(58099);c.default=(a,b,c,q,r,s)=>{let t;if((0,k.isCryptoKey)(b))(0,l.checkEncCryptoKey)(b,a,"decrypt"),t=d.KeyObject.from(b);else if(b instanceof Uint8Array||(0,m.default)(b))t=b;else throw TypeError((0,n.default)(b,...p.types,"Uint8Array"));switch((0,f.default)(a,t),(0,e.default)(a,q),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(a,b,c,e,f,k){let l,n,p=parseInt(a.slice(1,4),10);(0,m.default)(b)&&(b=b.export());let q=b.subarray(p>>3),r=b.subarray(0,p>>3),s=parseInt(a.slice(-3),10),t=`aes-${p}-cbc`;if(!(0,o.default)(t))throw new h.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let u=(0,j.default)(k,e,c,s,r,p);try{l=(0,i.default)(f,u)}catch{}if(!l)throw new h.JWEDecryptionFailed;try{let a=(0,d.createDecipheriv)(t,q,e);n=(0,g.concat)(a.update(c),a.final())}catch{}if(!n)throw new h.JWEDecryptionFailed;return n}(a,t,c,q,r,s);case"A128GCM":case"A192GCM":case"A256GCM":var u=t;let v=parseInt(a.slice(1,4),10),w=`aes-${v}-gcm`;if(!(0,o.default)(w))throw new h.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);try{let a=(0,d.createDecipheriv)(w,u,q,{authTagLength:16});a.setAuthTag(r),s.byteLength&&a.setAAD(s,{plaintextLength:c.length});let b=a.update(c);return a.final(),b}catch{throw new h.JWEDecryptionFailed}default:throw new h.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},67839,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.deflate=c.inflate=void 0;let d=a.r(24361),e=a.r(6461),f=a.r(37713),g=(0,d.promisify)(e.inflateRaw),h=(0,d.promisify)(e.deflateRaw);c.inflate=a=>g(a,{maxOutputLength:25e4}).catch(()=>{throw new f.JWEDecompressionFailed}),c.deflate=a=>h(a)},32585,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=(...a)=>{let b,c=a.filter(Boolean);if(0===c.length||1===c.length)return!0;for(let a of c){let c=Object.keys(a);if(!b||0===b.size){b=new Set(c);continue}for(let a of c){if(b.has(a))return!1;b.add(a)}}return!0}},69508,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){if("object"!=typeof a||null===a||"[object Object]"!==Object.prototype.toString.call(a))return!1;if(null===Object.getPrototypeOf(a))return!0;let b=a;for(;null!==Object.getPrototypeOf(b);)b=Object.getPrototypeOf(b);return Object.getPrototypeOf(a)===b}},46427,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.unwrap=c.wrap=void 0;let d=a.r(874),e=a.r(54799),f=a.r(37713),g=a.r(2962),h=a.r(12957),i=a.r(48648),j=a.r(18346),k=a.r(91213),l=a.r(339),m=a.r(58099);function n(a,b){if(a.symmetricKeySize<<3!==parseInt(b.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${b}`)}function o(a,b,c){if((0,j.default)(a))return a;if(a instanceof Uint8Array)return(0,e.createSecretKey)(a);if((0,h.isCryptoKey)(a))return(0,i.checkEncCryptoKey)(a,b,c),e.KeyObject.from(a);throw TypeError((0,k.default)(a,...m.types,"Uint8Array"))}c.wrap=(a,b,c)=>{let h=parseInt(a.slice(1,4),10),i=`aes${h}-wrap`;if(!(0,l.default)(i))throw new f.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`);let j=o(b,a,"wrapKey");n(j,a);let k=(0,e.createCipheriv)(i,j,d.Buffer.alloc(8,166));return(0,g.concat)(k.update(c),k.final())},c.unwrap=(a,b,c)=>{let h=parseInt(a.slice(1,4),10),i=`aes${h}-wrap`;if(!(0,l.default)(i))throw new f.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`);let j=o(b,a,"unwrapKey");n(j,a);let k=(0,e.createDecipheriv)(i,j,d.Buffer.alloc(8,166));return(0,g.concat)(k.update(c),k.final())}},13406,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.setCurve=c.weakMap=void 0;let d=a.r(874),e=a.r(54799),f=a.r(37713),g=a.r(12957),h=a.r(18346),i=a.r(91213),j=a.r(58099),k=d.Buffer.from([42,134,72,206,61,3,1,7]),l=d.Buffer.from([43,129,4,0,34]),m=d.Buffer.from([43,129,4,0,35]),n=d.Buffer.from([43,129,4,0,10]);c.weakMap=new WeakMap;let o=(a,b)=>{var d;let p;if((0,g.isCryptoKey)(a))p=e.KeyObject.from(a);else if((0,h.default)(a))p=a;else throw TypeError((0,i.default)(a,...j.types));if("secret"===p.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(p.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${p.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${p.asymmetricKeyType.slice(1)}`;case"ec":{if(c.weakMap.has(p))return c.weakMap.get(p);let a=null==(d=p.asymmetricKeyDetails)?void 0:d.namedCurve;if(a||"private"!==p.type){if(!a){let b=p.export({format:"der",type:"spki"}),c=b[1]<128?14:15,d=b[c],e=b.slice(c+1,c+1+d);if(e.equals(k))a="prime256v1";else if(e.equals(l))a="secp384r1";else if(e.equals(m))a="secp521r1";else if(e.equals(n))a="secp256k1";else throw new f.JOSENotSupported("Unsupported key curve for this operation")}}else a=o((0,e.createPublicKey)(p),!0);if(b)return a;let g=(a=>{switch(a){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new f.JOSENotSupported("Unsupported key curve for this operation")}})(a);return c.weakMap.set(p,g),g}default:throw TypeError("Invalid asymmetric key type for this operation")}};c.setCurve=function(a,b){c.weakMap.set(a,b)},c.default=o},15682,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ecdhAllowed=c.generateEpk=c.deriveKey=void 0;let d=a.r(54799),e=a.r(24361),f=a.r(13406),g=a.r(2962),h=a.r(37713),i=a.r(12957),j=a.r(48648),k=a.r(18346),l=a.r(91213),m=a.r(58099),n=(0,e.promisify)(d.generateKeyPair);c.deriveKey=async function(a,b,c,e,f=new Uint8Array(0),h=new Uint8Array(0)){let n,o;if((0,i.isCryptoKey)(a))(0,j.checkEncCryptoKey)(a,"ECDH"),n=d.KeyObject.from(a);else if((0,k.default)(a))n=a;else throw TypeError((0,l.default)(a,...m.types));if((0,i.isCryptoKey)(b))(0,j.checkEncCryptoKey)(b,"ECDH","deriveBits"),o=d.KeyObject.from(b);else if((0,k.default)(b))o=b;else throw TypeError((0,l.default)(b,...m.types));let p=(0,g.concat)((0,g.lengthAndInput)(g.encoder.encode(c)),(0,g.lengthAndInput)(f),(0,g.lengthAndInput)(h),(0,g.uint32be)(e)),q=(0,d.diffieHellman)({privateKey:o,publicKey:n});return(0,g.concatKdf)(q,e,p)},c.generateEpk=async function(a){let b;if((0,i.isCryptoKey)(a))b=d.KeyObject.from(a);else if((0,k.default)(a))b=a;else throw TypeError((0,l.default)(a,...m.types));switch(b.asymmetricKeyType){case"x25519":return n("x25519");case"x448":return n("x448");case"ec":return n("ec",{namedCurve:(0,f.default)(b)});default:throw new h.JOSENotSupported("Invalid or unsupported EPK")}},c.ecdhAllowed=a=>["P-256","P-384","P-521","X25519","X448"].includes((0,f.default)(a))},22902,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(37713);c.default=function(a){if(!(a instanceof Uint8Array)||a.length<8)throw new d.JWEInvalid("PBES2 Salt Input must be 8 or more octets")}},7984,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decrypt=c.encrypt=void 0;let d=a.r(24361),e=a.r(54799),f=a.r(74442),g=a.r(2962),h=a.r(74627),i=a.r(46427),j=a.r(22902),k=a.r(12957),l=a.r(48648),m=a.r(18346),n=a.r(91213),o=a.r(58099),p=(0,d.promisify)(e.pbkdf2);function q(a,b){if((0,m.default)(a))return a.export();if(a instanceof Uint8Array)return a;if((0,k.isCryptoKey)(a))return(0,l.checkEncCryptoKey)(a,b,"deriveBits","deriveKey"),e.KeyObject.from(a).export();throw TypeError((0,n.default)(a,...o.types,"Uint8Array"))}c.encrypt=async(a,b,c,d=2048,e=(0,f.default)(new Uint8Array(16)))=>{(0,j.default)(e);let k=(0,g.p2s)(a,e),l=parseInt(a.slice(13,16),10)>>3,m=q(b,a),n=await p(m,k,d,l,`sha${a.slice(8,11)}`);return{encryptedKey:await (0,i.wrap)(a.slice(-6),n,c),p2c:d,p2s:(0,h.encode)(e)}},c.decrypt=async(a,b,c,d,e)=>{(0,j.default)(e);let f=(0,g.p2s)(a,e),h=parseInt(a.slice(13,16),10)>>3,k=q(b,a),l=await p(k,f,d,h,`sha${a.slice(8,11)}`);return(0,i.unwrap)(a.slice(-6),l,c)}},33587,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.setModulusLength=c.weakMap=void 0,c.weakMap=new WeakMap;let d=(a,b)=>{let c=a.readUInt8(1);if((128&c)==0)return 0===b?c:d(a.subarray(2+c),b-1);let e=127&c;c=0;for(let b=0;b<e;b++)c<<=8,c|=a.readUInt8(2+b);return 0===b?c:d(a.subarray(2+c),b-1)};c.setModulusLength=(a,b)=>{c.weakMap.set(a,b)},c.default=(a,b)=>{if(2048>(a=>{var b,e,f,g;let h;if(c.weakMap.has(a))return c.weakMap.get(a);let i=null!=(e=null==(b=a.asymmetricKeyDetails)?void 0:b.modulusLength)?e:(f=a.export({format:"der",type:"pkcs1"}),g=+("private"===a.type),((128&(h=f.readUInt8(1)))==0?d(f.subarray(2),g):d(f.subarray(2+(127&h)),g))-1<<3);return c.weakMap.set(a,i),i})(a))throw TypeError(`${b} requires key modulusLength to be 2048 bits or larger`)}},84659,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decrypt=c.encrypt=void 0;let d=a.r(54799),e=a.r(33587),f=a.r(12957),g=a.r(48648),h=a.r(18346),i=a.r(91213),j=a.r(58099),k=(a,b)=>{if("rsa"!==a.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");(0,e.default)(a,b)},l=a=>{switch(a){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return d.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return d.constants.RSA_PKCS1_PADDING;default:return}},m=a=>{switch(a){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function n(a,b,...c){if((0,h.default)(a))return a;if((0,f.isCryptoKey)(a))return(0,g.checkEncCryptoKey)(a,b,...c),d.KeyObject.from(a);throw TypeError((0,i.default)(a,...j.types))}c.encrypt=(a,b,c)=>{let e=l(a),f=m(a),g=n(b,a,"wrapKey","encrypt");return k(g,a),(0,d.publicEncrypt)({key:g,oaepHash:f,padding:e},c)},c.decrypt=(a,b,c)=>{let e=l(a),f=m(a),g=n(b,a,"unwrapKey","decrypt");return k(g,a),(0,d.privateDecrypt)({key:g,oaepHash:f,padding:e},c)}},3927,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.bitLength=void 0;let d=a.r(37713),e=a.r(74442);function f(a){switch(a){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new d.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}c.bitLength=f,c.default=a=>(0,e.default)(new Uint8Array(f(a)>>3))},67782,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.fromX509=c.fromSPKI=c.fromPKCS8=c.toPKCS8=c.toSPKI=void 0;let d=a.r(54799),e=a.r(874),f=a.r(12957),g=a.r(18346),h=a.r(91213),i=a.r(58099),j=(a,b,c)=>{let e;if((0,f.isCryptoKey)(c)){if(!c.extractable)throw TypeError("CryptoKey is not extractable");e=d.KeyObject.from(c)}else if((0,g.default)(c))e=c;else throw TypeError((0,h.default)(c,...i.types));if(e.type!==a)throw TypeError(`key is not a ${a} key`);return e.export({format:"pem",type:b})};c.toSPKI=a=>j("public","spki",a),c.toPKCS8=a=>j("private","pkcs8",a),c.fromPKCS8=a=>(0,d.createPrivateKey)({key:e.Buffer.from(a.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"}),c.fromSPKI=a=>(0,d.createPublicKey)({key:e.Buffer.from(a.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"}),c.fromX509=a=>(0,d.createPublicKey)({key:a,type:"spki",format:"pem"})},18932,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(874),e=a.r(37713),f=d.Buffer.from([0]),g=d.Buffer.from([2]),h=d.Buffer.from([3]),i=d.Buffer.from([48]),j=d.Buffer.from([4]),k=a=>{if(a<128)return d.Buffer.from([a]);let b=d.Buffer.alloc(5);b.writeUInt32BE(a,1);let c=1;for(;0===b[c];)c++;return b[c-1]=128|5-c,b.slice(c-1)},l=new Map([["P-256",d.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",d.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",d.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",d.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",d.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",d.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",d.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",d.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",d.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);c.default=class{constructor(){this.length=0,this.elements=[]}oidFor(a){let b=l.get(a);if(!b)throw new e.JOSENotSupported("Invalid or unsupported OID");this.elements.push(b),this.length+=b.length}zero(){this.elements.push(g,d.Buffer.from([1]),f),this.length+=3}one(){this.elements.push(g,d.Buffer.from([1]),d.Buffer.from([1])),this.length+=3}unsignedInteger(a){if(128&a[0]){let b=k(a.length+1);this.elements.push(g,b,f,a),this.length+=2+b.length+a.length}else{let b=0;for(;0===a[b]&&(128&a[b+1])==0;)b++;let c=k(a.length-b);this.elements.push(g,k(a.length-b),a.slice(b)),this.length+=1+c.length+a.length-b}}octStr(a){let b=k(a.length);this.elements.push(j,k(a.length),a),this.length+=1+b.length+a.length}bitStr(a){let b=k(a.length+1);this.elements.push(h,k(a.length+1),f,a),this.length+=1+b.length+a.length+1}add(a){this.elements.push(a),this.length+=a.length}end(a=i){let b=k(this.length);return d.Buffer.concat([a,b,...this.elements],1+b.length+this.length)}}},42984,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.jwkImport=c.jwkExport=c.rsaPssParams=c.oneShotCallback=void 0;let[d,e]=process.versions.node.split(".").map(a=>parseInt(a,10));c.oneShotCallback=d>=16||15===d&&e>=13,c.rsaPssParams=!("electron"in process.versions)&&(d>=17||16===d&&e>=9),c.jwkExport=d>=16||15===d&&e>=9,c.jwkImport=d>=16||15===d&&e>=12},79238,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(874),e=a.r(54799),f=a.r(74627),g=a.r(37713),h=a.r(13406),i=a.r(33587),j=a.r(18932),k=a.r(42984);c.default=a=>{if(k.jwkImport&&"oct"!==a.kty)return a.d?(0,e.createPrivateKey)({format:"jwk",key:a}):(0,e.createPublicKey)({format:"jwk",key:a});switch(a.kty){case"oct":return(0,e.createSecretKey)((0,f.decode)(a.k));case"RSA":{let b=new j.default,c=void 0!==a.d,f=d.Buffer.from(a.n,"base64"),g=d.Buffer.from(a.e,"base64");c?(b.zero(),b.unsignedInteger(f),b.unsignedInteger(g),b.unsignedInteger(d.Buffer.from(a.d,"base64")),b.unsignedInteger(d.Buffer.from(a.p,"base64")),b.unsignedInteger(d.Buffer.from(a.q,"base64")),b.unsignedInteger(d.Buffer.from(a.dp,"base64")),b.unsignedInteger(d.Buffer.from(a.dq,"base64")),b.unsignedInteger(d.Buffer.from(a.qi,"base64"))):(b.unsignedInteger(f),b.unsignedInteger(g));let h={key:b.end(),format:"der",type:"pkcs1"},k=c?(0,e.createPrivateKey)(h):(0,e.createPublicKey)(h);return(0,i.setModulusLength)(k,f.length<<3),k}case"EC":{let b=new j.default,c=void 0!==a.d,f=d.Buffer.concat([d.Buffer.alloc(1,4),d.Buffer.from(a.x,"base64"),d.Buffer.from(a.y,"base64")]);if(c){b.zero();let c=new j.default;c.oidFor("ecPublicKey"),c.oidFor(a.crv),b.add(c.end());let g=new j.default;g.one(),g.octStr(d.Buffer.from(a.d,"base64"));let i=new j.default;i.bitStr(f);let k=i.end(d.Buffer.from([161]));g.add(k);let l=g.end(),m=new j.default;m.add(l);let n=m.end(d.Buffer.from([4]));b.add(n);let o=b.end(),p=(0,e.createPrivateKey)({key:o,format:"der",type:"pkcs8"});return(0,h.setCurve)(p,a.crv),p}let g=new j.default;g.oidFor("ecPublicKey"),g.oidFor(a.crv),b.add(g.end()),b.bitStr(f);let i=b.end(),k=(0,e.createPublicKey)({key:i,format:"der",type:"spki"});return(0,h.setCurve)(k,a.crv),k}case"OKP":{let b=new j.default;if(void 0!==a.d){b.zero();let c=new j.default;c.oidFor(a.crv),b.add(c.end());let f=new j.default;f.octStr(d.Buffer.from(a.d,"base64"));let g=f.end(d.Buffer.from([4]));b.add(g);let h=b.end();return(0,e.createPrivateKey)({key:h,format:"der",type:"pkcs8"})}let c=new j.default;c.oidFor(a.crv),b.add(c.end()),b.bitStr(d.Buffer.from(a.x,"base64"));let f=b.end();return(0,e.createPublicKey)({key:f,format:"der",type:"spki"})}default:throw new g.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}}},27398,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.importJWK=c.importPKCS8=c.importX509=c.importSPKI=void 0;let d=a.r(74627),e=a.r(67782),f=a.r(79238),g=a.r(37713),h=a.r(69508);c.importSPKI=async function(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,e.fromSPKI)(a,b,c)},c.importX509=async function(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,e.fromX509)(a,b,c)},c.importPKCS8=async function(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,e.fromPKCS8)(a,b,c)},c.importJWK=async function(a,b,c){var e;if(!(0,h.default)(a))throw TypeError("JWK must be an object");switch(b||(b=a.alg),a.kty){case"oct":if("string"!=typeof a.k||!a.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=c||(c=!0!==a.ext),c)return(0,f.default)({...a,alg:b,ext:null!=(e=a.ext)&&e});return(0,d.decode)(a.k);case"RSA":if(void 0!==a.oth)throw new g.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return(0,f.default)({...a,alg:b});default:throw new g.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}},77976,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(91213),e=a.r(58099);c.default=(a,b,c)=>{if(a.startsWith("HS")||"dir"===a||a.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(a)){if(!(b instanceof Uint8Array)){if(!(0,e.default)(b))throw TypeError((0,d.withAlg)(a,b,...e.types,"Uint8Array"));if("secret"!==b.type)throw TypeError(`${e.types.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}}else{if(!(0,e.default)(b))throw TypeError((0,d.withAlg)(a,b,...e.types));if("secret"===b.type)throw TypeError(`${e.types.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===c&&"public"===b.type)throw TypeError(`${e.types.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===c&&"public"===b.type)throw TypeError(`${e.types.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(b.algorithm&&"verify"===c&&"private"===b.type)throw TypeError(`${e.types.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(b.algorithm&&"encrypt"===c&&"private"===b.type)throw TypeError(`${e.types.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)}}},10396,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(6297),f=a.r(59218),g=a.r(2962),h=a.r(41139),i=a.r(12957),j=a.r(48648),k=a.r(18346),l=a.r(91213),m=a.r(37713),n=a.r(339),o=a.r(58099);c.default=(a,b,c,p,q)=>{let r;if((0,i.isCryptoKey)(c))(0,j.checkEncCryptoKey)(c,a,"encrypt"),r=d.KeyObject.from(c);else if(c instanceof Uint8Array||(0,k.default)(c))r=c;else throw TypeError((0,l.default)(c,...o.types,"Uint8Array"));switch((0,f.default)(a,r),(0,e.default)(a,p),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(a,b,c,e,f){let i=parseInt(a.slice(1,4),10);(0,k.default)(c)&&(c=c.export());let j=c.subarray(i>>3),l=c.subarray(0,i>>3),o=`aes-${i}-cbc`;if(!(0,n.default)(o))throw new m.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let p=(0,d.createCipheriv)(o,j,e),q=(0,g.concat)(p.update(b),p.final()),r=parseInt(a.slice(-3),10),s=(0,h.default)(f,e,q,r,l,i);return{ciphertext:q,tag:s}}(a,b,r,p,q);case"A128GCM":case"A192GCM":case"A256GCM":var s=r;let t=parseInt(a.slice(1,4),10),u=`aes-${t}-gcm`;if(!(0,n.default)(u))throw new m.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let v=(0,d.createCipheriv)(u,s,p,{authTagLength:16});q.byteLength&&v.setAAD(q,{plaintextLength:b.length});let w=v.update(b);return v.final(),{ciphertext:w,tag:v.getAuthTag()};default:throw new m.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},12738,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.unwrap=c.wrap=void 0;let d=a.r(10396),e=a.r(75342),f=a.r(89390),g=a.r(74627);c.wrap=async function(a,b,c,e){let h=a.slice(0,7);e||(e=(0,f.default)(h));let{ciphertext:i,tag:j}=await (0,d.default)(h,c,b,e,new Uint8Array(0));return{encryptedKey:i,iv:(0,g.encode)(e),tag:(0,g.encode)(j)}},c.unwrap=async function(a,b,c,d,f){let g=a.slice(0,7);return(0,e.default)(g,b,c,d,f,new Uint8Array(0))}},38341,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(46427),e=a.r(15682),f=a.r(7984),g=a.r(84659),h=a.r(74627),i=a.r(37713),j=a.r(3927),k=a.r(27398),l=a.r(77976),m=a.r(69508),n=a.r(12738);c.default=async function(a,b,c,o,p){switch((0,l.default)(a,b,"decrypt"),a){case"dir":if(void 0!==c)throw new i.JWEInvalid("Encountered unexpected JWE Encrypted Key");return b;case"ECDH-ES":if(void 0!==c)throw new i.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let f,g;if(!(0,m.default)(o.epk))throw new i.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!e.ecdhAllowed(b))throw new i.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let l=await (0,k.importJWK)(o.epk,a);if(void 0!==o.apu){if("string"!=typeof o.apu)throw new i.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{f=(0,h.decode)(o.apu)}catch{throw new i.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==o.apv){if("string"!=typeof o.apv)throw new i.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{g=(0,h.decode)(o.apv)}catch{throw new i.JWEInvalid("Failed to base64url decode the apv")}}let n=await e.deriveKey(l,b,"ECDH-ES"===a?o.enc:a,"ECDH-ES"===a?(0,j.bitLength)(o.enc):parseInt(a.slice(-5,-2),10),f,g);if("ECDH-ES"===a)return n;if(void 0===c)throw new i.JWEInvalid("JWE Encrypted Key missing");return(0,d.unwrap)(a.slice(-6),n,c)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===c)throw new i.JWEInvalid("JWE Encrypted Key missing");return(0,g.decrypt)(a,b,c);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let d;if(void 0===c)throw new i.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof o.p2c)throw new i.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let e=(null==p?void 0:p.maxPBES2Count)||1e4;if(o.p2c>e)throw new i.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof o.p2s)throw new i.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{d=(0,h.decode)(o.p2s)}catch{throw new i.JWEInvalid("Failed to base64url decode the p2s")}return(0,f.decrypt)(a,b,c,o.p2c,d)}case"A128KW":case"A192KW":case"A256KW":if(void 0===c)throw new i.JWEInvalid("JWE Encrypted Key missing");return(0,d.unwrap)(a,b,c);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let d,e;if(void 0===c)throw new i.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof o.iv)throw new i.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof o.tag)throw new i.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{d=(0,h.decode)(o.iv)}catch{throw new i.JWEInvalid("Failed to base64url decode the iv")}try{e=(0,h.decode)(o.tag)}catch{throw new i.JWEInvalid("Failed to base64url decode the tag")}return(0,n.unwrap)(a,b,c,d,e)}default:throw new i.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}},57831,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(37713);c.default=function(a,b,c,e,f){let g;if(void 0!==f.crit&&void 0===e.crit)throw new a('"crit" (Critical) Header Parameter MUST be integrity protected');if(!e||void 0===e.crit)return new Set;if(!Array.isArray(e.crit)||0===e.crit.length||e.crit.some(a=>"string"!=typeof a||0===a.length))throw new a('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let h of(g=void 0!==c?new Map([...Object.entries(c),...b.entries()]):b,e.crit)){if(!g.has(h))throw new d.JOSENotSupported(`Extension Header Parameter "${h}" is not recognized`);if(void 0===f[h])throw new a(`Extension Header Parameter "${h}" is missing`);if(g.get(h)&&void 0===e[h])throw new a(`Extension Header Parameter "${h}" MUST be integrity protected`)}return new Set(e.crit)}},80541,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=(a,b)=>{if(void 0!==b&&(!Array.isArray(b)||b.some(a=>"string"!=typeof a)))throw TypeError(`"${a}" option must be an array of strings`);if(b)return new Set(b)}},75524,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.flattenedDecrypt=void 0;let d=a.r(74627),e=a.r(75342),f=a.r(67839),g=a.r(37713),h=a.r(32585),i=a.r(69508),j=a.r(38341),k=a.r(2962),l=a.r(3927),m=a.r(57831),n=a.r(80541);c.flattenedDecrypt=async function(a,b,c){var o;let p,q,r,s,t,u,v;if(!(0,i.default)(a))throw new g.JWEInvalid("Flattened JWE must be an object");if(void 0===a.protected&&void 0===a.header&&void 0===a.unprotected)throw new g.JWEInvalid("JOSE Header missing");if("string"!=typeof a.iv)throw new g.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof a.ciphertext)throw new g.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof a.tag)throw new g.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==a.protected&&"string"!=typeof a.protected)throw new g.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==a.encrypted_key&&"string"!=typeof a.encrypted_key)throw new g.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==a.aad&&"string"!=typeof a.aad)throw new g.JWEInvalid("JWE AAD incorrect type");if(void 0!==a.header&&!(0,i.default)(a.header))throw new g.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==a.unprotected&&!(0,i.default)(a.unprotected))throw new g.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(a.protected)try{let b=(0,d.decode)(a.protected);p=JSON.parse(k.decoder.decode(b))}catch{throw new g.JWEInvalid("JWE Protected Header is invalid")}if(!(0,h.default)(p,a.header,a.unprotected))throw new g.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let w={...p,...a.header,...a.unprotected};if((0,m.default)(g.JWEInvalid,new Map,null==c?void 0:c.crit,p,w),void 0!==w.zip){if(!p||!p.zip)throw new g.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==w.zip)throw new g.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:x,enc:y}=w;if("string"!=typeof x||!x)throw new g.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof y||!y)throw new g.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let z=c&&(0,n.default)("keyManagementAlgorithms",c.keyManagementAlgorithms),A=c&&(0,n.default)("contentEncryptionAlgorithms",c.contentEncryptionAlgorithms);if(z&&!z.has(x))throw new g.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(A&&!A.has(y))throw new g.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==a.encrypted_key)try{q=(0,d.decode)(a.encrypted_key)}catch{throw new g.JWEInvalid("Failed to base64url decode the encrypted_key")}let B=!1;"function"==typeof b&&(b=await b(p,a),B=!0);try{r=await (0,j.default)(x,b,q,w,c)}catch(a){if(a instanceof TypeError||a instanceof g.JWEInvalid||a instanceof g.JOSENotSupported)throw a;r=(0,l.default)(y)}try{s=(0,d.decode)(a.iv)}catch{throw new g.JWEInvalid("Failed to base64url decode the iv")}try{t=(0,d.decode)(a.tag)}catch{throw new g.JWEInvalid("Failed to base64url decode the tag")}let C=k.encoder.encode(null!=(o=a.protected)?o:"");u=void 0!==a.aad?(0,k.concat)(C,k.encoder.encode("."),k.encoder.encode(a.aad)):C;try{v=(0,d.decode)(a.ciphertext)}catch{throw new g.JWEInvalid("Failed to base64url decode the ciphertext")}let D=await (0,e.default)(y,r,v,s,t,u);"DEF"===w.zip&&(D=await ((null==c?void 0:c.inflateRaw)||f.inflate)(D));let E={plaintext:D};if(void 0!==a.protected&&(E.protectedHeader=p),void 0!==a.aad)try{E.additionalAuthenticatedData=(0,d.decode)(a.aad)}catch{throw new g.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==a.unprotected&&(E.sharedUnprotectedHeader=a.unprotected),void 0!==a.header&&(E.unprotectedHeader=a.header),B)?{...E,key:b}:E}},74550,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.compactDecrypt=void 0;let d=a.r(75524),e=a.r(37713),f=a.r(2962);c.compactDecrypt=async function(a,b,c){if(a instanceof Uint8Array&&(a=f.decoder.decode(a)),"string"!=typeof a)throw new e.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:g,1:h,2:i,3:j,4:k,length:l}=a.split(".");if(5!==l)throw new e.JWEInvalid("Invalid Compact JWE");let m=await (0,d.flattenedDecrypt)({ciphertext:j,iv:i||void 0,protected:g||void 0,tag:k||void 0,encrypted_key:h||void 0},b,c),n={plaintext:m.plaintext,protectedHeader:m.protectedHeader};return"function"==typeof b?{...n,key:m.key}:n}},83600,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generalDecrypt=void 0;let d=a.r(75524),e=a.r(37713),f=a.r(69508);c.generalDecrypt=async function(a,b,c){if(!(0,f.default)(a))throw new e.JWEInvalid("General JWE must be an object");if(!Array.isArray(a.recipients)||!a.recipients.every(f.default))throw new e.JWEInvalid("JWE Recipients missing or incorrect type");if(!a.recipients.length)throw new e.JWEInvalid("JWE Recipients has no members");for(let e of a.recipients)try{return await (0,d.flattenedDecrypt)({aad:a.aad,ciphertext:a.ciphertext,encrypted_key:e.encrypted_key,header:e.header,iv:a.iv,protected:a.protected,tag:a.tag,unprotected:a.unprotected},b,c)}catch{}throw new e.JWEDecryptionFailed}},85521,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=class{constructor(a){if(48!==a[0]||(this.buffer=a,this.offset=1,this.decodeLength()!==a.length-this.offset))throw TypeError()}decodeLength(){let a=this.buffer[this.offset++];if(128&a){let b=-129&a;a=0;for(let c=0;c<b;c++)a=a<<8|this.buffer[this.offset+c];this.offset+=b}return a}unsignedInteger(){if(2!==this.buffer[this.offset++])throw TypeError();let a=this.decodeLength();0===this.buffer[this.offset]&&(this.offset++,a--);let b=this.buffer.slice(this.offset,this.offset+a);return this.offset+=a,b}end(){if(this.offset!==this.buffer.length)throw TypeError()}}},47620,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(74627),f=a.r(85521),g=a.r(37713),h=a.r(13406),i=a.r(12957),j=a.r(18346),k=a.r(91213),l=a.r(58099),m=a.r(42984),n=a=>{let b;if((0,i.isCryptoKey)(a)){if(!a.extractable)throw TypeError("CryptoKey is not extractable");b=d.KeyObject.from(a)}else if((0,j.default)(a))b=a;else if(a instanceof Uint8Array)return{kty:"oct",k:(0,e.encode)(a)};else throw TypeError((0,k.default)(a,...l.types,"Uint8Array"));if(m.jwkExport){if("secret"!==b.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(b.asymmetricKeyType))throw new g.JOSENotSupported("Unsupported key asymmetricKeyType");return b.export({format:"jwk"})}switch(b.type){case"secret":return{kty:"oct",k:(0,e.encode)(b.export())};case"private":case"public":switch(b.asymmetricKeyType){case"rsa":{let a,c=b.export({format:"der",type:"pkcs1"}),d=new f.default(c);"private"===b.type&&d.unsignedInteger();let g=(0,e.encode)(d.unsignedInteger()),h=(0,e.encode)(d.unsignedInteger());return"private"===b.type&&(a={d:(0,e.encode)(d.unsignedInteger()),p:(0,e.encode)(d.unsignedInteger()),q:(0,e.encode)(d.unsignedInteger()),dp:(0,e.encode)(d.unsignedInteger()),dq:(0,e.encode)(d.unsignedInteger()),qi:(0,e.encode)(d.unsignedInteger())}),d.end(),{kty:"RSA",n:g,e:h,...a}}case"ec":{let a,c,f,i=(0,h.default)(b);switch(i){case"secp256k1":a=64,c=33,f=-1;break;case"P-256":a=64,c=36,f=-1;break;case"P-384":a=96,c=35,f=-3;break;case"P-521":a=132,c=35,f=-3;break;default:throw new g.JOSENotSupported("Unsupported curve")}if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"EC",crv:i,x:(0,e.encode)(c.subarray(-a,-a/2)),y:(0,e.encode)(c.subarray(-a/2))}}let j=b.export({type:"pkcs8",format:"der"});return j.length<100&&(c+=f),{...n((0,d.createPublicKey)(b)),d:(0,e.encode)(j.subarray(c,c+a/2))}}case"ed25519":case"x25519":{let a=(0,h.default)(b);if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"OKP",crv:a,x:(0,e.encode)(c.subarray(-32))}}let c=b.export({type:"pkcs8",format:"der"});return{...n((0,d.createPublicKey)(b)),d:(0,e.encode)(c.subarray(-32))}}case"ed448":case"x448":{let a=(0,h.default)(b);if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"OKP",crv:a,x:(0,e.encode)(c.subarray("Ed448"===a?-57:-56))}}let c=b.export({type:"pkcs8",format:"der"});return{...n((0,d.createPublicKey)(b)),d:(0,e.encode)(c.subarray("Ed448"===a?-57:-56))}}default:throw new g.JOSENotSupported("Unsupported key asymmetricKeyType")}default:throw new g.JOSENotSupported("Unsupported key type")}};c.default=n},21775,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.exportJWK=c.exportPKCS8=c.exportSPKI=void 0;let d=a.r(67782),e=a.r(67782),f=a.r(47620);c.exportSPKI=async function(a){return(0,d.toSPKI)(a)},c.exportPKCS8=async function(a){return(0,e.toPKCS8)(a)},c.exportJWK=async function(a){return(0,f.default)(a)}},72695,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(46427),e=a.r(15682),f=a.r(7984),g=a.r(84659),h=a.r(74627),i=a.r(3927),j=a.r(37713),k=a.r(21775),l=a.r(77976),m=a.r(12738);c.default=async function(a,b,c,n,o={}){let p,q,r;switch((0,l.default)(a,c,"encrypt"),a){case"dir":r=c;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!e.ecdhAllowed(c))throw new j.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:f,apv:g}=o,{epk:l}=o;l||(l=(await e.generateEpk(c)).privateKey);let{x:m,y:s,crv:t,kty:u}=await (0,k.exportJWK)(l),v=await e.deriveKey(c,l,"ECDH-ES"===a?b:a,"ECDH-ES"===a?(0,i.bitLength)(b):parseInt(a.slice(-5,-2),10),f,g);if(q={epk:{x:m,crv:t,kty:u}},"EC"===u&&(q.epk.y=s),f&&(q.apu=(0,h.encode)(f)),g&&(q.apv=(0,h.encode)(g)),"ECDH-ES"===a){r=v;break}r=n||(0,i.default)(b);let w=a.slice(-6);p=await (0,d.wrap)(w,v,r);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":r=n||(0,i.default)(b),p=await (0,g.encrypt)(a,c,r);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{r=n||(0,i.default)(b);let{p2c:d,p2s:e}=o;({encryptedKey:p,...q}=await (0,f.encrypt)(a,c,r,d,e));break}case"A128KW":case"A192KW":case"A256KW":r=n||(0,i.default)(b),p=await (0,d.wrap)(a,c,r);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{r=n||(0,i.default)(b);let{iv:d}=o;({encryptedKey:p,...q}=await (0,m.wrap)(a,c,r,d));break}default:throw new j.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:r,encryptedKey:p,parameters:q}}},12019,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.FlattenedEncrypt=c.unprotected=void 0;let d=a.r(74627),e=a.r(10396),f=a.r(67839),g=a.r(89390),h=a.r(72695),i=a.r(37713),j=a.r(32585),k=a.r(2962),l=a.r(57831);c.unprotected=Symbol(),c.FlattenedEncrypt=class{constructor(a){if(!(a instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=a}setKeyManagementParameters(a){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=a,this}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setSharedUnprotectedHeader(a){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=a,this}setUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}setAdditionalAuthenticatedData(a){return this._aad=a,this}setContentEncryptionKey(a){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=a,this}setInitializationVector(a){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=a,this}async encrypt(a,b){let m,n,o,p,q,r,s;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new i.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!(0,j.default)(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new i.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let t={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if((0,l.default)(i.JWEInvalid,new Map,null==b?void 0:b.crit,this._protectedHeader,t),void 0!==t.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new i.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==t.zip)throw new i.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:u,enc:v}=t;if("string"!=typeof u||!u)throw new i.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof v||!v)throw new i.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===u){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===u&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let d;({cek:n,encryptedKey:m,parameters:d}=await (0,h.default)(u,v,a,this._cek,this._keyManagementParameters)),d&&(b&&c.unprotected in b?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...d}:this.setUnprotectedHeader(d):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...d}:this.setProtectedHeader(d))}if(this._iv||(this._iv=(0,g.default)(v)),p=this._protectedHeader?k.encoder.encode((0,d.encode)(JSON.stringify(this._protectedHeader))):k.encoder.encode(""),this._aad?(q=(0,d.encode)(this._aad),o=(0,k.concat)(p,k.encoder.encode("."),k.encoder.encode(q))):o=p,"DEF"===t.zip){let a=await ((null==b?void 0:b.deflateRaw)||f.deflate)(this._plaintext);({ciphertext:r,tag:s}=await (0,e.default)(v,a,n,this._iv,o))}else({ciphertext:r,tag:s}=await (0,e.default)(v,this._plaintext,n,this._iv,o));let w={ciphertext:(0,d.encode)(r),iv:(0,d.encode)(this._iv),tag:(0,d.encode)(s)};return m&&(w.encrypted_key=(0,d.encode)(m)),q&&(w.aad=q),this._protectedHeader&&(w.protected=k.decoder.decode(p)),this._sharedUnprotectedHeader&&(w.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(w.header=this._unprotectedHeader),w}}},82096,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GeneralEncrypt=void 0;let d=a.r(12019),e=a.r(37713),f=a.r(3927),g=a.r(32585),h=a.r(72695),i=a.r(74627),j=a.r(57831);class k{constructor(a,b,c){this.parent=a,this.key=b,this.options=c}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addRecipient(...a){return this.parent.addRecipient(...a)}encrypt(...a){return this.parent.encrypt(...a)}done(){return this.parent}}c.GeneralEncrypt=class{constructor(a){this._recipients=[],this._plaintext=a}addRecipient(a,b){let c=new k(this,a,{crit:null==b?void 0:b.crit});return this._recipients.push(c),c}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setSharedUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}setAdditionalAuthenticatedData(a){return this._aad=a,this}async encrypt(a){var b,c,k;let l;if(!this._recipients.length)throw new e.JWEInvalid("at least one recipient must be added");if(a={deflateRaw:null==a?void 0:a.deflateRaw},1===this._recipients.length){let[b]=this._recipients,c=await new d.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(b.unprotectedHeader).encrypt(b.key,{...b.options,...a}),e={ciphertext:c.ciphertext,iv:c.iv,recipients:[{}],tag:c.tag};return c.aad&&(e.aad=c.aad),c.protected&&(e.protected=c.protected),c.unprotected&&(e.unprotected=c.unprotected),c.encrypted_key&&(e.recipients[0].encrypted_key=c.encrypted_key),c.header&&(e.recipients[0].header=c.header),e}for(let a=0;a<this._recipients.length;a++){let b=this._recipients[a];if(!(0,g.default)(this._protectedHeader,this._unprotectedHeader,b.unprotectedHeader))throw new e.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let c={...this._protectedHeader,...this._unprotectedHeader,...b.unprotectedHeader},{alg:d}=c;if("string"!=typeof d||!d)throw new e.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===d||"ECDH-ES"===d)throw new e.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof c.enc||!c.enc)throw new e.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(l){if(l!==c.enc)throw new e.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else l=c.enc;if((0,j.default)(e.JWEInvalid,new Map,b.options.crit,this._protectedHeader,c),void 0!==c.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new e.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let m=(0,f.default)(l),n={ciphertext:"",iv:"",recipients:[],tag:""};for(let e=0;e<this._recipients.length;e++){let f=this._recipients[e],g={};n.recipients.push(g);let j=({...this._protectedHeader,...this._unprotectedHeader,...f.unprotectedHeader}).alg.startsWith("PBES2")?2048+e:void 0;if(0===e){let b=await new d.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(m).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(f.unprotectedHeader).setKeyManagementParameters({p2c:j}).encrypt(f.key,{...f.options,...a,[d.unprotected]:!0});n.ciphertext=b.ciphertext,n.iv=b.iv,n.tag=b.tag,b.aad&&(n.aad=b.aad),b.protected&&(n.protected=b.protected),b.unprotected&&(n.unprotected=b.unprotected),g.encrypted_key=b.encrypted_key,b.header&&(g.header=b.header);continue}let{encryptedKey:o,parameters:p}=await (0,h.default)((null==(b=f.unprotectedHeader)?void 0:b.alg)||(null==(c=this._protectedHeader)?void 0:c.alg)||(null==(k=this._unprotectedHeader)?void 0:k.alg),l,f.key,m,{p2c:j});g.encrypted_key=(0,i.encode)(o),(f.unprotectedHeader||p)&&(g.header={...f.unprotectedHeader,...p})}return n}}},91100,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(37713);c.default=function(a){switch(a){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new d.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}},97777,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(13406),f=a.r(37713),g=a.r(33587),h=a.r(42984),i={padding:d.constants.RSA_PKCS1_PSS_PADDING,saltLength:d.constants.RSA_PSS_SALTLEN_DIGEST},j=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);c.default=function(a,b){switch(a){case"EdDSA":if(!["ed25519","ed448"].includes(b.asymmetricKeyType))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");return b;case"RS256":case"RS384":case"RS512":if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,g.default)(b,a),b;case h.rsaPssParams&&"PS256":case h.rsaPssParams&&"PS384":case h.rsaPssParams&&"PS512":if("rsa-pss"===b.asymmetricKeyType){let{hashAlgorithm:c,mgf1HashAlgorithm:d,saltLength:e}=b.asymmetricKeyDetails,f=parseInt(a.slice(-3),10);if(void 0!==c&&(c!==`sha${f}`||d!==c))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${a}`);if(void 0!==e&&e>f>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${a}`)}else if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");return(0,g.default)(b,a),{key:b,...i};case!h.rsaPssParams&&"PS256":case!h.rsaPssParams&&"PS384":case!h.rsaPssParams&&"PS512":if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,g.default)(b,a),{key:b,...i};case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let c=(0,e.default)(b),d=j.get(a);if(c!==d)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${d}, got ${c}`);return{dsaEncoding:"ieee-p1363",key:b}}default:throw new f.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}},58800,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(37713);c.default=function(a){switch(a){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new d.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}},80471,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(12957),f=a.r(48648),g=a.r(91213),h=a.r(58099);c.default=function(a,b,c){if(b instanceof Uint8Array){if(!a.startsWith("HS"))throw TypeError((0,g.default)(b,...h.types));return(0,d.createSecretKey)(b)}if(b instanceof d.KeyObject)return b;if((0,e.isCryptoKey)(b))return(0,f.checkSigCryptoKey)(b,a,c),d.KeyObject.from(b);throw TypeError((0,g.default)(b,...h.types,"Uint8Array"))}},94535,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});let e=a.r(54799),f=a.r(24361),g=a.r(91100),h=a.r(58800),i=a.r(97777),j=a.r(80471);d=e.sign.length>3?(0,f.promisify)(e.sign):e.sign,c.default=async(a,b,c)=>{let f=(0,j.default)(a,b,"sign");if(a.startsWith("HS")){let b=e.createHmac((0,h.default)(a),f);return b.update(c),b.digest()}return d((0,g.default)(a),c,(0,i.default)(a,f))}},38523,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});let e=a.r(54799),f=a.r(24361),g=a.r(91100),h=a.r(97777),i=a.r(94535),j=a.r(80471),k=a.r(42984);d=e.verify.length>4&&k.oneShotCallback?(0,f.promisify)(e.verify):e.verify,c.default=async(a,b,c,f)=>{let k=(0,j.default)(a,b,"verify");if(a.startsWith("HS")){let b=await (0,i.default)(a,k,f);try{return e.timingSafeEqual(c,b)}catch{return!1}}let l=(0,g.default)(a),m=(0,h.default)(a,k);try{return await d(l,f,m,c)}catch{return!1}}},35148,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.flattenedVerify=void 0;let d=a.r(74627),e=a.r(38523),f=a.r(37713),g=a.r(2962),h=a.r(32585),i=a.r(69508),j=a.r(77976),k=a.r(57831),l=a.r(80541);c.flattenedVerify=async function(a,b,c){var m;let n,o;if(!(0,i.default)(a))throw new f.JWSInvalid("Flattened JWS must be an object");if(void 0===a.protected&&void 0===a.header)throw new f.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==a.protected&&"string"!=typeof a.protected)throw new f.JWSInvalid("JWS Protected Header incorrect type");if(void 0===a.payload)throw new f.JWSInvalid("JWS Payload missing");if("string"!=typeof a.signature)throw new f.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==a.header&&!(0,i.default)(a.header))throw new f.JWSInvalid("JWS Unprotected Header incorrect type");let p={};if(a.protected)try{let b=(0,d.decode)(a.protected);p=JSON.parse(g.decoder.decode(b))}catch{throw new f.JWSInvalid("JWS Protected Header is invalid")}if(!(0,h.default)(p,a.header))throw new f.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let q={...p,...a.header},r=(0,k.default)(f.JWSInvalid,new Map([["b64",!0]]),null==c?void 0:c.crit,p,q),s=!0;if(r.has("b64")&&"boolean"!=typeof(s=p.b64))throw new f.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:t}=q;if("string"!=typeof t||!t)throw new f.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let u=c&&(0,l.default)("algorithms",c.algorithms);if(u&&!u.has(t))throw new f.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(s){if("string"!=typeof a.payload)throw new f.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof a.payload&&!(a.payload instanceof Uint8Array))throw new f.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let v=!1;"function"==typeof b&&(b=await b(p,a),v=!0),(0,j.default)(t,b,"verify");let w=(0,g.concat)(g.encoder.encode(null!=(m=a.protected)?m:""),g.encoder.encode("."),"string"==typeof a.payload?g.encoder.encode(a.payload):a.payload);try{n=(0,d.decode)(a.signature)}catch{throw new f.JWSInvalid("Failed to base64url decode the signature")}if(!await (0,e.default)(t,b,n,w))throw new f.JWSSignatureVerificationFailed;if(s)try{o=(0,d.decode)(a.payload)}catch{throw new f.JWSInvalid("Failed to base64url decode the payload")}else o="string"==typeof a.payload?g.encoder.encode(a.payload):a.payload;let x={payload:o};return(void 0!==a.protected&&(x.protectedHeader=p),void 0!==a.header&&(x.unprotectedHeader=a.header),v)?{...x,key:b}:x}},85739,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.compactVerify=void 0;let d=a.r(35148),e=a.r(37713),f=a.r(2962);c.compactVerify=async function(a,b,c){if(a instanceof Uint8Array&&(a=f.decoder.decode(a)),"string"!=typeof a)throw new e.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:g,1:h,2:i,length:j}=a.split(".");if(3!==j)throw new e.JWSInvalid("Invalid Compact JWS");let k=await (0,d.flattenedVerify)({payload:h,protected:g,signature:i},b,c),l={payload:k.payload,protectedHeader:k.protectedHeader};return"function"==typeof b?{...l,key:k.key}:l}},88868,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generalVerify=void 0;let d=a.r(35148),e=a.r(37713),f=a.r(69508);c.generalVerify=async function(a,b,c){if(!(0,f.default)(a))throw new e.JWSInvalid("General JWS must be an object");if(!Array.isArray(a.signatures)||!a.signatures.every(f.default))throw new e.JWSInvalid("JWS Signatures missing or incorrect type");for(let e of a.signatures)try{return await (0,d.flattenedVerify)({header:e.header,payload:a.payload,protected:e.protected,signature:e.signature},b,c)}catch{}throw new e.JWSSignatureVerificationFailed}},57046,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=a=>Math.floor(a.getTime()/1e3)},83040,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;c.default=a=>{let b=d.exec(a);if(!b)throw TypeError("Invalid time period format");let c=parseFloat(b[1]);switch(b[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(c);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*c);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*c);case"day":case"days":case"d":return Math.round(86400*c);case"week":case"weeks":case"w":return Math.round(604800*c);default:return Math.round(0x1e187e0*c)}}},33717,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(37713),e=a.r(2962),f=a.r(57046),g=a.r(83040),h=a.r(69508),i=a=>a.toLowerCase().replace(/^application\//,"");c.default=(a,b,c={})=>{var j,k;let l,m,{typ:n}=c;if(n&&("string"!=typeof a.typ||i(a.typ)!==i(n)))throw new d.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{l=JSON.parse(e.decoder.decode(b))}catch{}if(!(0,h.default)(l))throw new d.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:o=[],issuer:p,subject:q,audience:r,maxTokenAge:s}=c;for(let a of(void 0!==s&&o.push("iat"),void 0!==r&&o.push("aud"),void 0!==q&&o.push("sub"),void 0!==p&&o.push("iss"),new Set(o.reverse())))if(!(a in l))throw new d.JWTClaimValidationFailed(`missing required "${a}" claim`,a,"missing");if(p&&!(Array.isArray(p)?p:[p]).includes(l.iss))throw new d.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(q&&l.sub!==q)throw new d.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(r&&(j=l.aud,k="string"==typeof r?[r]:r,"string"==typeof j?!k.includes(j):!(Array.isArray(j)&&k.some(Set.prototype.has.bind(new Set(j))))))throw new d.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof c.clockTolerance){case"string":m=(0,g.default)(c.clockTolerance);break;case"number":m=c.clockTolerance;break;case"undefined":m=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:t}=c,u=(0,f.default)(t||new Date);if((void 0!==l.iat||s)&&"number"!=typeof l.iat)throw new d.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==l.nbf){if("number"!=typeof l.nbf)throw new d.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(l.nbf>u+m)throw new d.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==l.exp){if("number"!=typeof l.exp)throw new d.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(l.exp<=u-m)throw new d.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(s){let a=u-l.iat;if(a-m>("number"==typeof s?s:(0,g.default)(s)))throw new d.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(a<0-m)throw new d.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return l}},94500,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.jwtVerify=void 0;let d=a.r(85739),e=a.r(33717),f=a.r(37713);c.jwtVerify=async function(a,b,c){var g;let h=await (0,d.compactVerify)(a,b,c);if((null==(g=h.protectedHeader.crit)?void 0:g.includes("b64"))&&!1===h.protectedHeader.b64)throw new f.JWTInvalid("JWTs MUST NOT use unencoded payload");let i={payload:(0,e.default)(h.protectedHeader,h.payload,c),protectedHeader:h.protectedHeader};return"function"==typeof b?{...i,key:h.key}:i}},47435,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.jwtDecrypt=void 0;let d=a.r(74550),e=a.r(33717),f=a.r(37713);c.jwtDecrypt=async function(a,b,c){let g=await (0,d.compactDecrypt)(a,b,c),h=(0,e.default)(g.protectedHeader,g.plaintext,c),{protectedHeader:i}=g;if(void 0!==i.iss&&i.iss!==h.iss)throw new f.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==i.sub&&i.sub!==h.sub)throw new f.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==i.aud&&JSON.stringify(i.aud)!==JSON.stringify(h.aud))throw new f.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let j={payload:h,protectedHeader:i};return"function"==typeof b?{...j,key:g.key}:j}},45393,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CompactEncrypt=void 0;let d=a.r(12019);c.CompactEncrypt=class{constructor(a){this._flattened=new d.FlattenedEncrypt(a)}setContentEncryptionKey(a){return this._flattened.setContentEncryptionKey(a),this}setInitializationVector(a){return this._flattened.setInitializationVector(a),this}setProtectedHeader(a){return this._flattened.setProtectedHeader(a),this}setKeyManagementParameters(a){return this._flattened.setKeyManagementParameters(a),this}async encrypt(a,b){let c=await this._flattened.encrypt(a,b);return[c.protected,c.encrypted_key,c.iv,c.ciphertext,c.tag].join(".")}}},79008,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.FlattenedSign=void 0;let d=a.r(74627),e=a.r(94535),f=a.r(32585),g=a.r(37713),h=a.r(2962),i=a.r(77976),j=a.r(57831);c.FlattenedSign=class{constructor(a){if(!(a instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=a}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}async sign(a,b){let c;if(!this._protectedHeader&&!this._unprotectedHeader)throw new g.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,f.default)(this._protectedHeader,this._unprotectedHeader))throw new g.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let k={...this._protectedHeader,...this._unprotectedHeader},l=(0,j.default)(g.JWSInvalid,new Map([["b64",!0]]),null==b?void 0:b.crit,this._protectedHeader,k),m=!0;if(l.has("b64")&&"boolean"!=typeof(m=this._protectedHeader.b64))throw new g.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:n}=k;if("string"!=typeof n||!n)throw new g.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,i.default)(n,a,"sign");let o=this._payload;m&&(o=h.encoder.encode((0,d.encode)(o))),c=this._protectedHeader?h.encoder.encode((0,d.encode)(JSON.stringify(this._protectedHeader))):h.encoder.encode("");let p=(0,h.concat)(c,h.encoder.encode("."),o),q=await (0,e.default)(n,a,p),r={signature:(0,d.encode)(q),payload:""};return m&&(r.payload=h.decoder.decode(o)),this._unprotectedHeader&&(r.header=this._unprotectedHeader),this._protectedHeader&&(r.protected=h.decoder.decode(c)),r}}},68775,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CompactSign=void 0;let d=a.r(79008);c.CompactSign=class{constructor(a){this._flattened=new d.FlattenedSign(a)}setProtectedHeader(a){return this._flattened.setProtectedHeader(a),this}async sign(a,b){let c=await this._flattened.sign(a,b);if(void 0===c.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${c.protected}.${c.payload}.${c.signature}`}}},87717,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GeneralSign=void 0;let d=a.r(79008),e=a.r(37713);class f{constructor(a,b,c){this.parent=a,this.key=b,this.options=c}setProtectedHeader(a){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=a,this}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addSignature(...a){return this.parent.addSignature(...a)}sign(...a){return this.parent.sign(...a)}done(){return this.parent}}c.GeneralSign=class{constructor(a){this._signatures=[],this._payload=a}addSignature(a,b){let c=new f(this,a,b);return this._signatures.push(c),c}async sign(){if(!this._signatures.length)throw new e.JWSInvalid("at least one signature must be added");let a={signatures:[],payload:""};for(let b=0;b<this._signatures.length;b++){let c=this._signatures[b],f=new d.FlattenedSign(this._payload);f.setProtectedHeader(c.protectedHeader),f.setUnprotectedHeader(c.unprotectedHeader);let{payload:g,...h}=await f.sign(c.key,c.options);if(0===b)a.payload=g;else if(a.payload!==g)throw new e.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");a.signatures.push(h)}return a}}},74687,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ProduceJWT=void 0;let d=a.r(57046),e=a.r(69508),f=a.r(83040);c.ProduceJWT=class{constructor(a){if(!(0,e.default)(a))throw TypeError("JWT Claims Set MUST be an object");this._payload=a}setIssuer(a){return this._payload={...this._payload,iss:a},this}setSubject(a){return this._payload={...this._payload,sub:a},this}setAudience(a){return this._payload={...this._payload,aud:a},this}setJti(a){return this._payload={...this._payload,jti:a},this}setNotBefore(a){return"number"==typeof a?this._payload={...this._payload,nbf:a}:this._payload={...this._payload,nbf:(0,d.default)(new Date)+(0,f.default)(a)},this}setExpirationTime(a){return"number"==typeof a?this._payload={...this._payload,exp:a}:this._payload={...this._payload,exp:(0,d.default)(new Date)+(0,f.default)(a)},this}setIssuedAt(a){return void 0===a?this._payload={...this._payload,iat:(0,d.default)(new Date)}:this._payload={...this._payload,iat:a},this}}},85492,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SignJWT=void 0;let d=a.r(68775),e=a.r(37713),f=a.r(2962),g=a.r(74687);class h extends g.ProduceJWT{setProtectedHeader(a){return this._protectedHeader=a,this}async sign(a,b){var c;let g=new d.CompactSign(f.encoder.encode(JSON.stringify(this._payload)));if(g.setProtectedHeader(this._protectedHeader),Array.isArray(null==(c=this._protectedHeader)?void 0:c.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new e.JWTInvalid("JWTs MUST NOT use unencoded payload");return g.sign(a,b)}}c.SignJWT=h},22530,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.EncryptJWT=void 0;let d=a.r(45393),e=a.r(2962),f=a.r(74687);class g extends f.ProduceJWT{setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setKeyManagementParameters(a){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=a,this}setContentEncryptionKey(a){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=a,this}setInitializationVector(a){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=a,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(a,b){let c=new d.CompactEncrypt(e.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),c.setProtectedHeader(this._protectedHeader),this._iv&&c.setInitializationVector(this._iv),this._cek&&c.setContentEncryptionKey(this._cek),this._keyManagementParameters&&c.setKeyManagementParameters(this._keyManagementParameters),c.encrypt(a,b)}}c.EncryptJWT=g},41773,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.calculateJwkThumbprintUri=c.calculateJwkThumbprint=void 0;let d=a.r(79709),e=a.r(74627),f=a.r(37713),g=a.r(2962),h=a.r(69508),i=(a,b)=>{if("string"!=typeof a||!a)throw new f.JWKInvalid(`${b} missing or invalid`)};async function j(a,b){let c;if(!(0,h.default)(a))throw TypeError("JWK must be an object");if(null!=b||(b="sha256"),"sha256"!==b&&"sha384"!==b&&"sha512"!==b)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(a.kty){case"EC":i(a.crv,'"crv" (Curve) Parameter'),i(a.x,'"x" (X Coordinate) Parameter'),i(a.y,'"y" (Y Coordinate) Parameter'),c={crv:a.crv,kty:a.kty,x:a.x,y:a.y};break;case"OKP":i(a.crv,'"crv" (Subtype of Key Pair) Parameter'),i(a.x,'"x" (Public Key) Parameter'),c={crv:a.crv,kty:a.kty,x:a.x};break;case"RSA":i(a.e,'"e" (Exponent) Parameter'),i(a.n,'"n" (Modulus) Parameter'),c={e:a.e,kty:a.kty,n:a.n};break;case"oct":i(a.k,'"k" (Key Value) Parameter'),c={k:a.k,kty:a.kty};break;default:throw new f.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let j=g.encoder.encode(JSON.stringify(c));return(0,e.encode)(await (0,d.default)(b,j))}c.calculateJwkThumbprint=j,c.calculateJwkThumbprintUri=async function(a,b){null!=b||(b="sha256");let c=await j(a,b);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${b.slice(-3)}:${c}`}},52375,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.EmbeddedJWK=void 0;let d=a.r(27398),e=a.r(69508),f=a.r(37713);c.EmbeddedJWK=async function(a,b){let c={...a,...null==b?void 0:b.header};if(!(0,e.default)(c.jwk))throw new f.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let g=await (0,d.importJWK)({...c.jwk,ext:!0},c.alg,!0);if(g instanceof Uint8Array||"public"!==g.type)throw new f.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return g}},20172,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.createLocalJWKSet=c.LocalJWKSet=c.isJWKSLike=void 0;let d=a.r(27398),e=a.r(37713),f=a.r(69508);function g(a){return a&&"object"==typeof a&&Array.isArray(a.keys)&&a.keys.every(h)}function h(a){return(0,f.default)(a)}c.isJWKSLike=g;class i{constructor(a){if(this._cached=new WeakMap,!g(a))throw new e.JWKSInvalid("JSON Web Key Set malformed");this._jwks=function(a){return"function"==typeof structuredClone?structuredClone(a):JSON.parse(JSON.stringify(a))}(a)}async getKey(a,b){let{alg:c,kid:d}={...a,...null==b?void 0:b.header},f=function(a){switch("string"==typeof a&&a.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new e.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}(c),g=this._jwks.keys.filter(a=>{let b=f===a.kty;if(b&&"string"==typeof d&&(b=d===a.kid),b&&"string"==typeof a.alg&&(b=c===a.alg),b&&"string"==typeof a.use&&(b="sig"===a.use),b&&Array.isArray(a.key_ops)&&(b=a.key_ops.includes("verify")),b&&"EdDSA"===c&&(b="Ed25519"===a.crv||"Ed448"===a.crv),b)switch(c){case"ES256":b="P-256"===a.crv;break;case"ES256K":b="secp256k1"===a.crv;break;case"ES384":b="P-384"===a.crv;break;case"ES512":b="P-521"===a.crv}return b}),{0:h,length:i}=g;if(0===i)throw new e.JWKSNoMatchingKey;if(1!==i){let a=new e.JWKSMultipleMatchingKeys,{_cached:b}=this;throw a[Symbol.asyncIterator]=async function*(){for(let a of g)try{yield await j(b,a,c)}catch{continue}},a}return j(this._cached,h,c)}}async function j(a,b,c){let f=a.get(b)||a.set(b,{}).get(b);if(void 0===f[c]){let a=await (0,d.importJWK)({...b,ext:!0},c);if(a instanceof Uint8Array||"public"!==a.type)throw new e.JWKSInvalid("JSON Web Key Set members must be public keys");f[c]=a}return f[c]}c.LocalJWKSet=i,c.createLocalJWKSet=function(a){let b=new i(a);return async function(a,c){return b.getKey(a,c)}}},67294,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(21517),e=a.r(24836),f=a.r(27699),g=a.r(37713),h=a.r(2962);c.default=async(a,b,c)=>{let i;switch(a.protocol){case"https:":i=e.get;break;case"http:":i=d.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:j,headers:k}=c,l=i(a.href,{agent:j,timeout:b,headers:k}),[m]=await Promise.race([(0,f.once)(l,"response"),(0,f.once)(l,"timeout")]);if(!m)throw l.destroy(),new g.JWKSTimeout;if(200!==m.statusCode)throw new g.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let n=[];for await(let a of m)n.push(a);try{return JSON.parse(h.decoder.decode((0,h.concat)(...n)))}catch{throw new g.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}}},19771,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.createRemoteJWKSet=void 0;let d=a.r(67294),e=a.r(37713),f=a.r(20172);class g extends f.LocalJWKSet{constructor(a,b){if(super({keys:[]}),this._jwks=void 0,!(a instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(a.href),this._options={agent:null==b?void 0:b.agent,headers:null==b?void 0:b.headers},this._timeoutDuration="number"==typeof(null==b?void 0:b.timeoutDuration)?null==b?void 0:b.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==b?void 0:b.cooldownDuration)?null==b?void 0:b.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==b?void 0:b.cacheMaxAge)?null==b?void 0:b.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(a,b){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(a,b)}catch(c){if(c instanceof e.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(a,b);throw c}}async reload(){this._pendingFetch&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=(0,d.default)(this._url,this._timeoutDuration,this._options).then(a=>{if(!(0,f.isJWKSLike)(a))throw new e.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:a.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(a=>{throw this._pendingFetch=void 0,a})),await this._pendingFetch}}c.createRemoteJWKSet=function(a,b){let c=new g(a,b);return async function(a,b){return c.getKey(a,b)}}},83174,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UnsecuredJWT=void 0;let d=a.r(74627),e=a.r(2962),f=a.r(37713),g=a.r(33717),h=a.r(74687);class i extends h.ProduceJWT{encode(){let a=d.encode(JSON.stringify({alg:"none"})),b=d.encode(JSON.stringify(this._payload));return`${a}.${b}.`}static decode(a,b){let c;if("string"!=typeof a)throw new f.JWTInvalid("Unsecured JWT must be a string");let{0:h,1:i,2:j,length:k}=a.split(".");if(3!==k||""!==j)throw new f.JWTInvalid("Invalid Unsecured JWT");try{if(c=JSON.parse(e.decoder.decode(d.decode(h))),"none"!==c.alg)throw Error()}catch{throw new f.JWTInvalid("Invalid Unsecured JWT")}return{payload:(0,g.default)(c,d.decode(i),b),header:c}}}c.UnsecuredJWT=i},34112,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decode=c.encode=void 0;let d=a.r(74627);c.encode=d.encode,c.decode=d.decode},17869,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decodeProtectedHeader=void 0;let d=a.r(34112),e=a.r(2962),f=a.r(69508);c.decodeProtectedHeader=function(a){let b;if("string"==typeof a){let c=a.split(".");(3===c.length||5===c.length)&&([b]=c)}else if("object"==typeof a&&a)if("protected"in a)b=a.protected;else throw TypeError("Token does not contain a Protected Header");try{if("string"!=typeof b||!b)throw Error();let a=JSON.parse(e.decoder.decode((0,d.decode)(b)));if(!(0,f.default)(a))throw Error();return a}catch{throw TypeError("Invalid Token or Protected Header formatting")}}},3767,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decodeJwt=void 0;let d=a.r(34112),e=a.r(2962),f=a.r(69508),g=a.r(37713);c.decodeJwt=function(a){let b,c;if("string"!=typeof a)throw new g.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:h,length:i}=a.split(".");if(5===i)throw new g.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==i)throw new g.JWTInvalid("Invalid JWT");if(!h)throw new g.JWTInvalid("JWTs must contain a payload");try{b=(0,d.decode)(h)}catch{throw new g.JWTInvalid("Failed to base64url decode the payload")}try{c=JSON.parse(e.decoder.decode(b))}catch{throw new g.JWTInvalid("Failed to parse the decoded payload as JSON")}if(!(0,f.default)(c))throw new g.JWTInvalid("Invalid JWT Claims Set");return c}},10233,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generateKeyPair=c.generateSecret=void 0;let d=a.r(54799),e=a.r(24361),f=a.r(74442),g=a.r(33587),h=a.r(37713),i=(0,e.promisify)(d.generateKeyPair);c.generateSecret=async function(a,b){let c;switch(a){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(a.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(a.slice(1,4),10);break;default:throw new h.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,d.createSecretKey)((0,f.default)(new Uint8Array(c>>3)))},c.generateKeyPair=async function(a,b){var c,d;switch(a){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let a=null!=(c=null==b?void 0:b.modulusLength)?c:2048;if("number"!=typeof a||a<2048)throw new h.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");let d=await i("rsa",{modulusLength:a,publicExponent:65537});return(0,g.setModulusLength)(d.privateKey,a),(0,g.setModulusLength)(d.publicKey,a),d}case"ES256":return i("ec",{namedCurve:"P-256"});case"ES256K":return i("ec",{namedCurve:"secp256k1"});case"ES384":return i("ec",{namedCurve:"P-384"});case"ES512":return i("ec",{namedCurve:"P-521"});case"EdDSA":switch(null==b?void 0:b.crv){case void 0:case"Ed25519":return i("ed25519");case"Ed448":return i("ed448");default:throw new h.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":let e=null!=(d=null==b?void 0:b.crv)?d:"P-256";switch(e){case void 0:case"P-256":case"P-384":case"P-521":return i("ec",{namedCurve:e});case"X25519":return i("x25519");case"X448":return i("x448");default:throw new h.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}default:throw new h.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}},67064,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generateKeyPair=void 0;let d=a.r(10233);c.generateKeyPair=async function(a,b){return(0,d.generateKeyPair)(a,b)}},83592,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generateSecret=void 0;let d=a.r(10233);c.generateSecret=async function(a,b){return(0,d.generateSecret)(a,b)}},47023,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default="node:crypto"},60287,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=a.r(47023).default},66597,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.cryptoRuntime=c.base64url=c.generateSecret=c.generateKeyPair=c.errors=c.decodeJwt=c.decodeProtectedHeader=c.importJWK=c.importX509=c.importPKCS8=c.importSPKI=c.exportJWK=c.exportSPKI=c.exportPKCS8=c.UnsecuredJWT=c.createRemoteJWKSet=c.createLocalJWKSet=c.EmbeddedJWK=c.calculateJwkThumbprintUri=c.calculateJwkThumbprint=c.EncryptJWT=c.SignJWT=c.GeneralSign=c.FlattenedSign=c.CompactSign=c.FlattenedEncrypt=c.CompactEncrypt=c.jwtDecrypt=c.jwtVerify=c.generalVerify=c.flattenedVerify=c.compactVerify=c.GeneralEncrypt=c.generalDecrypt=c.flattenedDecrypt=c.compactDecrypt=void 0;var d=a.r(74550);Object.defineProperty(c,"compactDecrypt",{enumerable:!0,get:function(){return d.compactDecrypt}});var e=a.r(75524);Object.defineProperty(c,"flattenedDecrypt",{enumerable:!0,get:function(){return e.flattenedDecrypt}});var f=a.r(83600);Object.defineProperty(c,"generalDecrypt",{enumerable:!0,get:function(){return f.generalDecrypt}});var g=a.r(82096);Object.defineProperty(c,"GeneralEncrypt",{enumerable:!0,get:function(){return g.GeneralEncrypt}});var h=a.r(85739);Object.defineProperty(c,"compactVerify",{enumerable:!0,get:function(){return h.compactVerify}});var i=a.r(35148);Object.defineProperty(c,"flattenedVerify",{enumerable:!0,get:function(){return i.flattenedVerify}});var j=a.r(88868);Object.defineProperty(c,"generalVerify",{enumerable:!0,get:function(){return j.generalVerify}});var k=a.r(94500);Object.defineProperty(c,"jwtVerify",{enumerable:!0,get:function(){return k.jwtVerify}});var l=a.r(47435);Object.defineProperty(c,"jwtDecrypt",{enumerable:!0,get:function(){return l.jwtDecrypt}});var m=a.r(45393);Object.defineProperty(c,"CompactEncrypt",{enumerable:!0,get:function(){return m.CompactEncrypt}});var n=a.r(12019);Object.defineProperty(c,"FlattenedEncrypt",{enumerable:!0,get:function(){return n.FlattenedEncrypt}});var o=a.r(68775);Object.defineProperty(c,"CompactSign",{enumerable:!0,get:function(){return o.CompactSign}});var p=a.r(79008);Object.defineProperty(c,"FlattenedSign",{enumerable:!0,get:function(){return p.FlattenedSign}});var q=a.r(87717);Object.defineProperty(c,"GeneralSign",{enumerable:!0,get:function(){return q.GeneralSign}});var r=a.r(85492);Object.defineProperty(c,"SignJWT",{enumerable:!0,get:function(){return r.SignJWT}});var s=a.r(22530);Object.defineProperty(c,"EncryptJWT",{enumerable:!0,get:function(){return s.EncryptJWT}});var t=a.r(41773);Object.defineProperty(c,"calculateJwkThumbprint",{enumerable:!0,get:function(){return t.calculateJwkThumbprint}}),Object.defineProperty(c,"calculateJwkThumbprintUri",{enumerable:!0,get:function(){return t.calculateJwkThumbprintUri}});var u=a.r(52375);Object.defineProperty(c,"EmbeddedJWK",{enumerable:!0,get:function(){return u.EmbeddedJWK}});var v=a.r(20172);Object.defineProperty(c,"createLocalJWKSet",{enumerable:!0,get:function(){return v.createLocalJWKSet}});var w=a.r(19771);Object.defineProperty(c,"createRemoteJWKSet",{enumerable:!0,get:function(){return w.createRemoteJWKSet}});var x=a.r(83174);Object.defineProperty(c,"UnsecuredJWT",{enumerable:!0,get:function(){return x.UnsecuredJWT}});var y=a.r(21775);Object.defineProperty(c,"exportPKCS8",{enumerable:!0,get:function(){return y.exportPKCS8}}),Object.defineProperty(c,"exportSPKI",{enumerable:!0,get:function(){return y.exportSPKI}}),Object.defineProperty(c,"exportJWK",{enumerable:!0,get:function(){return y.exportJWK}});var z=a.r(27398);Object.defineProperty(c,"importSPKI",{enumerable:!0,get:function(){return z.importSPKI}}),Object.defineProperty(c,"importPKCS8",{enumerable:!0,get:function(){return z.importPKCS8}}),Object.defineProperty(c,"importX509",{enumerable:!0,get:function(){return z.importX509}}),Object.defineProperty(c,"importJWK",{enumerable:!0,get:function(){return z.importJWK}});var A=a.r(17869);Object.defineProperty(c,"decodeProtectedHeader",{enumerable:!0,get:function(){return A.decodeProtectedHeader}});var B=a.r(3767);Object.defineProperty(c,"decodeJwt",{enumerable:!0,get:function(){return B.decodeJwt}}),c.errors=a.r(37713);var C=a.r(67064);Object.defineProperty(c,"generateKeyPair",{enumerable:!0,get:function(){return C.generateKeyPair}});var D=a.r(83592);Object.defineProperty(c,"generateSecret",{enumerable:!0,get:function(){return D.generateSecret}}),c.base64url=a.r(34112);var E=a.r(60287);Object.defineProperty(c,"cryptoRuntime",{enumerable:!0,get:function(){return E.default}})},89014,(a,b,c)=>{let d,{strict:e}=a.r(49719),{createHash:f}=a.r(54799),{format:g}=a.r(24361);function h(a,b,c){let e=(function(a,b){switch(a){case"HS256":case"RS256":case"PS256":case"ES256":case"ES256K":return f("sha256");case"HS384":case"RS384":case"PS384":case"ES384":return f("sha384");case"HS512":case"RS512":case"PS512":case"ES512":case"Ed25519":return f("sha512");case"Ed448":return f("shake256",{outputLength:114});case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return f("shake256",{outputLength:64});case"EdDSA":switch(b){case"Ed25519":return f("sha512");case"Ed448":return f("shake256",{outputLength:114});default:throw TypeError("unrecognized or invalid EdDSA curve provided")}default:throw TypeError("unrecognized or invalid JWS algorithm provided")}})(b,c).update(a).digest();return d(e.slice(0,e.length/2))}d=Buffer.isEncoding("base64url")?a=>a.toString("base64url"):a=>a.toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),b.exports={validate:function(a,b,c,d,f){let i,j;if("string"!=typeof a.claim||!a.claim)throw TypeError("names.claim must be a non-empty string");if("string"!=typeof a.source||!a.source)throw TypeError("names.source must be a non-empty string");e("string"==typeof b&&b,`${a.claim} must be a non-empty string`),e("string"==typeof c&&c,`${a.source} must be a non-empty string`);try{i=h(c,d,f)}catch(b){j=g("%s could not be validated (%s)",a.claim,b.message)}j=j||g("%s mismatch, expected %s, got: %s",a.claim,i,b),e.equal(i,b,j)},generate:h}},47575,(a,b,c)=>{let d=a.r(24361),e=a.r(54799);b.exports=d.types.isKeyObject||(a=>a&&a instanceof e.KeyObject)},1250,(a,b,c)=>{let d;d=Buffer.isEncoding("base64url")?(a,b="utf8")=>Buffer.from(a,b).toString("base64url"):(a,b="utf8")=>Buffer.from(a,b).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),b.exports.decode=a=>Buffer.from(a,"base64"),b.exports.encode=d},59019,(a,b,c)=>{let d=a.r(1250);b.exports=a=>{if("string"!=typeof a||!a)throw TypeError("JWT must be a string");let{0:b,1:c,2:e,length:f}=a.split(".");if(5===f)throw TypeError("encrypted JWTs cannot be decoded");if(3!==f)throw Error("JWTs must have three components");try{return{header:JSON.parse(d.decode(b)),payload:JSON.parse(d.decode(c)),signature:e}}catch(a){throw Error("JWT is malformed")}}},35121,(a,b,c)=>{b.exports=a=>!!a&&a.constructor===Object},29953,(a,b,c)=>{let d=a.r(35121);function e(a,b,...c){for(let f of c)if(d(f))for(let[c,g]of Object.entries(f))"__proto__"!==c&&"constructor"!==c&&(void 0===b[c]&&void 0!==g&&(b[c]=g),a&&d(b[c])&&d(g)&&e(!0,b[c],g));return b}b.exports=e.bind(void 0,!1),b.exports.deep=e.bind(void 0,!0)},76310,(a,b,c)=>{let d=/(\w+)=("[^"]*")/g;b.exports=a=>{let b={};try{for(;null!==d.exec(a);)RegExp.$1&&RegExp.$2&&(b[RegExp.$1]=RegExp.$2.slice(1,-1))}catch(a){}return b}},42095,(a,b,c)=>{b.exports={assertSigningAlgValuesSupport:function(a,b,c){if(!b[`${a}_endpoint`])return;let d=`${a}_endpoint_auth_method`,e=`${a}_endpoint_auth_signing_alg`,f=`${a}_endpoint_auth_signing_alg_values_supported`;if(c[d]&&c[d].endsWith("_jwt")&&!c[e]&&!b[f])throw TypeError(`${f} must be configured on the issuer if ${e} is not defined on a client`)},assertIssuerConfiguration:function(a,b){if(!a[b])throw TypeError(`${b} must be configured on the issuer`)}}},85412,(a,b,c)=>{b.exports=function(a,...b){let c={};for(let d of b)void 0!==a[d]&&(c[d]=a[d]);return c}},45499,(a,b,c)=>{let{STATUS_CODES:d}=a.r(21517),{format:e}=a.r(24361),{OPError:f}=a.r(56780),g=a.r(76310);b.exports=function(a,{statusCode:b=200,body:c=!0,bearer:h=!1}={}){if(a.statusCode!==b){if(h&&(a=>{let b=g(a.headers["www-authenticate"]);if(b.error)throw new f(b,a)})(a),(a=>{let b=!1;try{let c;c="object"!=typeof a.body||Buffer.isBuffer(a.body)?JSON.parse(a.body):a.body,(b="string"==typeof c.error&&c.error.length)&&Object.defineProperty(a,"body",{value:c,configurable:!0})}catch(a){}return b})(a))throw new f(a.body,a);throw new f({error:e("expected %i %s, got: %i %s",b,d[b],a.statusCode,d[a.statusCode])},a)}if(c&&!a.body)throw new f({error:e("expected %i %s with body but no body was returned",b,d[b])},a);return a.body}},3976,(a,b,c)=>{b.exports=()=>Math.floor(Date.now()/1e3)},27317,(a,b,c)=>{let d=a.r(1250),e=a.r(3976);b.exports=class{constructor(a){Object.assign(this,a);const{constructor:b,...c}=Object.getOwnPropertyDescriptors(this.constructor.prototype);Object.defineProperties(this,c)}set expires_in(a){this.expires_at=e()+Number(a)}get expires_in(){return Math.max.apply(null,[this.expires_at-e(),0])}expired(){return 0===this.expires_in}claims(){if(!this.id_token)throw TypeError("id_token not present in TokenSet");return JSON.parse(d.decode(this.id_token.split(".")[1]))}}},7182,(a,b,c)=>{let{createHash:d,randomBytes:e}=a.r(54799),f=a.r(1250),g=(a=32)=>f.encode(e(a));b.exports={random:g,state:g,nonce:g,codeVerifier:g,codeChallenge:a=>f.encode(d("sha256").update(a).digest())}},6368,(a,b,c)=>{"use strict";b.exports=function(a){a.prototype[Symbol.iterator]=function*(){for(let a=this.head;a;a=a.next)yield a.value}}},78471,(a,b,c)=>{"use strict";function d(a){var b=this;if(b instanceof d||(b=new d),b.tail=null,b.head=null,b.length=0,a&&"function"==typeof a.forEach)a.forEach(function(a){b.push(a)});else if(arguments.length>0)for(var c=0,e=arguments.length;c<e;c++)b.push(arguments[c]);return b}function e(a,b,c,d){if(!(this instanceof e))return new e(a,b,c,d);this.list=d,this.value=a,b?(b.next=this,this.prev=b):this.prev=null,c?(c.prev=this,this.next=c):this.next=null}b.exports=d,d.Node=e,d.create=d,d.prototype.removeNode=function(a){if(a.list!==this)throw Error("removing node which does not belong to this list");var b=a.next,c=a.prev;return b&&(b.prev=c),c&&(c.next=b),a===this.head&&(this.head=b),a===this.tail&&(this.tail=c),a.list.length--,a.next=null,a.prev=null,a.list=null,b},d.prototype.unshiftNode=function(a){if(a!==this.head){a.list&&a.list.removeNode(a);var b=this.head;a.list=this,a.next=b,b&&(b.prev=a),this.head=a,this.tail||(this.tail=a),this.length++}},d.prototype.pushNode=function(a){if(a!==this.tail){a.list&&a.list.removeNode(a);var b=this.tail;a.list=this,a.prev=b,b&&(b.next=a),this.tail=a,this.head||(this.head=a),this.length++}},d.prototype.push=function(){for(var a,b,c=0,d=arguments.length;c<d;c++){a=this,b=arguments[c],a.tail=new e(b,a.tail,null,a),a.head||(a.head=a.tail),a.length++}return this.length},d.prototype.unshift=function(){for(var a,b,c=0,d=arguments.length;c<d;c++){a=this,b=arguments[c],a.head=new e(b,null,a.head,a),a.tail||(a.tail=a.head),a.length++}return this.length},d.prototype.pop=function(){if(this.tail){var a=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,a}},d.prototype.shift=function(){if(this.head){var a=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,a}},d.prototype.forEach=function(a,b){b=b||this;for(var c=this.head,d=0;null!==c;d++)a.call(b,c.value,d,this),c=c.next},d.prototype.forEachReverse=function(a,b){b=b||this;for(var c=this.tail,d=this.length-1;null!==c;d--)a.call(b,c.value,d,this),c=c.prev},d.prototype.get=function(a){for(var b=0,c=this.head;null!==c&&b<a;b++)c=c.next;if(b===a&&null!==c)return c.value},d.prototype.getReverse=function(a){for(var b=0,c=this.tail;null!==c&&b<a;b++)c=c.prev;if(b===a&&null!==c)return c.value},d.prototype.map=function(a,b){b=b||this;for(var c=new d,e=this.head;null!==e;)c.push(a.call(b,e.value,this)),e=e.next;return c},d.prototype.mapReverse=function(a,b){b=b||this;for(var c=new d,e=this.tail;null!==e;)c.push(a.call(b,e.value,this)),e=e.prev;return c},d.prototype.reduce=function(a,b){var c,d=this.head;if(arguments.length>1)c=b;else if(this.head)d=this.head.next,c=this.head.value;else throw TypeError("Reduce of empty list with no initial value");for(var e=0;null!==d;e++)c=a(c,d.value,e),d=d.next;return c},d.prototype.reduceReverse=function(a,b){var c,d=this.tail;if(arguments.length>1)c=b;else if(this.tail)d=this.tail.prev,c=this.tail.value;else throw TypeError("Reduce of empty list with no initial value");for(var e=this.length-1;null!==d;e--)c=a(c,d.value,e),d=d.prev;return c},d.prototype.toArray=function(){for(var a=Array(this.length),b=0,c=this.head;null!==c;b++)a[b]=c.value,c=c.next;return a},d.prototype.toArrayReverse=function(){for(var a=Array(this.length),b=0,c=this.tail;null!==c;b++)a[b]=c.value,c=c.prev;return a},d.prototype.slice=function(a,b){(b=b||this.length)<0&&(b+=this.length),(a=a||0)<0&&(a+=this.length);var c=new d;if(b<a||b<0)return c;a<0&&(a=0),b>this.length&&(b=this.length);for(var e=0,f=this.head;null!==f&&e<a;e++)f=f.next;for(;null!==f&&e<b;e++,f=f.next)c.push(f.value);return c},d.prototype.sliceReverse=function(a,b){(b=b||this.length)<0&&(b+=this.length),(a=a||0)<0&&(a+=this.length);var c=new d;if(b<a||b<0)return c;a<0&&(a=0),b>this.length&&(b=this.length);for(var e=this.length,f=this.tail;null!==f&&e>b;e--)f=f.prev;for(;null!==f&&e>a;e--,f=f.prev)c.push(f.value);return c},d.prototype.splice=function(a,b,...c){a>this.length&&(a=this.length-1),a<0&&(a=this.length+a);for(var d=0,f=this.head;null!==f&&d<a;d++)f=f.next;for(var g=[],d=0;f&&d<b;d++)g.push(f.value),f=this.removeNode(f);null===f&&(f=this.tail),f!==this.head&&f!==this.tail&&(f=f.prev);for(var d=0;d<c.length;d++)f=function(a,b,c){var d=b===a.head?new e(c,null,b,a):new e(c,b,b.next,a);return null===d.next&&(a.tail=d),null===d.prev&&(a.head=d),a.length++,d}(this,f,c[d]);return g},d.prototype.reverse=function(){for(var a=this.head,b=this.tail,c=a;null!==c;c=c.prev){var d=c.prev;c.prev=c.next,c.next=d}return this.head=b,this.tail=a,this};try{a.r(6368)(d)}catch(a){}},90124,(a,b,c)=>{"use strict";let d=a.r(78471),e=Symbol("max"),f=Symbol("length"),g=Symbol("lengthCalculator"),h=Symbol("allowStale"),i=Symbol("maxAge"),j=Symbol("dispose"),k=Symbol("noDisposeOnSet"),l=Symbol("lruList"),m=Symbol("cache"),n=Symbol("updateAgeOnGet"),o=()=>1,p=(a,b,c)=>{let d=a[m].get(b);if(d){let b=d.value;if(q(a,b)){if(s(a,d),!a[h])return}else c&&(a[n]&&(d.value.now=Date.now()),a[l].unshiftNode(d));return b.value}},q=(a,b)=>{if(!b||!b.maxAge&&!a[i])return!1;let c=Date.now()-b.now;return b.maxAge?c>b.maxAge:a[i]&&c>a[i]},r=a=>{if(a[f]>a[e])for(let b=a[l].tail;a[f]>a[e]&&null!==b;){let c=b.prev;s(a,b),b=c}},s=(a,b)=>{if(b){let c=b.value;a[j]&&a[j](c.key,c.value),a[f]-=c.length,a[m].delete(c.key),a[l].removeNode(b)}};class t{constructor(a,b,c,d,e){this.key=a,this.value=b,this.length=c,this.now=d,this.maxAge=e||0}}let u=(a,b,c,d)=>{let e=c.value;q(a,e)&&(s(a,c),a[h]||(e=void 0)),e&&b.call(d,e.value,e.key,a)};b.exports=class{constructor(a){if("number"==typeof a&&(a={max:a}),a||(a={}),a.max&&("number"!=typeof a.max||a.max<0))throw TypeError("max must be a non-negative number");this[e]=a.max||1/0;const b=a.length||o;if(this[g]="function"!=typeof b?o:b,this[h]=a.stale||!1,a.maxAge&&"number"!=typeof a.maxAge)throw TypeError("maxAge must be a number");this[i]=a.maxAge||0,this[j]=a.dispose,this[k]=a.noDisposeOnSet||!1,this[n]=a.updateAgeOnGet||!1,this.reset()}set max(a){if("number"!=typeof a||a<0)throw TypeError("max must be a non-negative number");this[e]=a||1/0,r(this)}get max(){return this[e]}set allowStale(a){this[h]=!!a}get allowStale(){return this[h]}set maxAge(a){if("number"!=typeof a)throw TypeError("maxAge must be a non-negative number");this[i]=a,r(this)}get maxAge(){return this[i]}set lengthCalculator(a){"function"!=typeof a&&(a=o),a!==this[g]&&(this[g]=a,this[f]=0,this[l].forEach(a=>{a.length=this[g](a.value,a.key),this[f]+=a.length})),r(this)}get lengthCalculator(){return this[g]}get length(){return this[f]}get itemCount(){return this[l].length}rforEach(a,b){b=b||this;for(let c=this[l].tail;null!==c;){let d=c.prev;u(this,a,c,b),c=d}}forEach(a,b){b=b||this;for(let c=this[l].head;null!==c;){let d=c.next;u(this,a,c,b),c=d}}keys(){return this[l].toArray().map(a=>a.key)}values(){return this[l].toArray().map(a=>a.value)}reset(){this[j]&&this[l]&&this[l].length&&this[l].forEach(a=>this[j](a.key,a.value)),this[m]=new Map,this[l]=new d,this[f]=0}dump(){return this[l].map(a=>!q(this,a)&&{k:a.key,v:a.value,e:a.now+(a.maxAge||0)}).toArray().filter(a=>a)}dumpLru(){return this[l]}set(a,b,c){if((c=c||this[i])&&"number"!=typeof c)throw TypeError("maxAge must be a number");let d=c?Date.now():0,h=this[g](b,a);if(this[m].has(a)){if(h>this[e])return s(this,this[m].get(a)),!1;let g=this[m].get(a).value;return this[j]&&!this[k]&&this[j](a,g.value),g.now=d,g.maxAge=c,g.value=b,this[f]+=h-g.length,g.length=h,this.get(a),r(this),!0}let n=new t(a,b,h,d,c);return n.length>this[e]?(this[j]&&this[j](a,b),!1):(this[f]+=n.length,this[l].unshift(n),this[m].set(a,this[l].head),r(this),!0)}has(a){return!!this[m].has(a)&&!q(this,this[m].get(a).value)}get(a){return p(this,a,!0)}peek(a){return p(this,a,!1)}pop(){let a=this[l].tail;return a?(s(this,a),a.value):null}del(a){s(this,this[m].get(a))}load(a){this.reset();let b=Date.now();for(let c=a.length-1;c>=0;c--){let d=a[c],e=d.e||0;if(0===e)this.set(d.k,d.v);else{let a=e-b;a>0&&this.set(d.k,d.v,a)}}}prune(){this[m].forEach((a,b)=>p(this,b,!1))}}},82471,(a,b,c)=>{let d=Symbol();b.exports={CLOCK_TOLERANCE:Symbol(),HTTP_OPTIONS:d}},42262,(a,b,c)=>{let d,e=a.r(49719),f=a.r(45706),g=a.r(21517),h=a.r(24836),{once:i}=a.r(27699),{URL:j}=a.r(92509),k=a.r(90124),l=a.r(75096),{RPError:m}=a.r(56780),n=a.r(85412),{deep:o}=a.r(29953),{HTTP_OPTIONS:p}=a.r(82471),q=/^[\x21\x23-\x5B\x5D-\x7E]+$/,r=["agent","ca","cert","crl","headers","key","lookup","passphrase","pfx","timeout"],s=(a,b)=>{d=o({},a.length?n(b,...a):b,d)};function t(a,b,c){c&&(a.removeHeader("content-type"),a.setHeader("content-type",c)),b&&(a.removeHeader("content-length"),a.setHeader("content-length",Buffer.byteLength(b)),a.write(b)),a.end()}s([],{headers:{"User-Agent":`${l.name}/${l.version} (${l.homepage})`,"Accept-Encoding":"identity"},timeout:3500});let u=new k({max:100});b.exports=async function(a,{accessToken:b,mTLS:c=!1,DPoP:k}={}){let l,s,v,w,x,y,z;try{l=new j(a.url),delete a.url,e(/^(https?:)$/.test(l.protocol))}catch(a){throw TypeError("only valid absolute URLs can be requested")}let A=this[p],B=a,C=`${l.origin}${l.pathname}`;if(k&&"dpopProof"in this&&(B.headers=B.headers||{},B.headers.DPoP=await this.dpopProof({htu:`${l.origin}${l.pathname}`,htm:a.method||"GET",nonce:u.get(C)},k,b)),A&&(s=n(A.call(this,l,o({},B,d)),...r)),B=o({},s,B,d),c&&!B.pfx&&!(B.key&&B.cert))throw TypeError("mutual-TLS certificate and key not set");if(B.searchParams)for(let[a,b]of Object.entries(B.searchParams))l.searchParams.delete(a),l.searchParams.set(a,b);for(let[a,b]of({form:w,responseType:v,json:x,body:y,...B}=B,Object.entries(B.headers||{})))void 0===b&&delete B.headers[a];let D=("https:"===l.protocol?h.request:g.request)(l.href,B);return(async()=>{if(x?t(D,JSON.stringify(x),"application/json"):w?t(D,f.stringify(w),"application/x-www-form-urlencoded"):y?t(D,y):t(D),[z]=await Promise.race([i(D,"response"),i(D,"timeout")]),!z)throw D.destroy(),new m(`outgoing request timed out after ${B.timeout}ms`);let a=[];for await(let b of z)a.push(b);if(a.length)switch(v){case"json":Object.defineProperty(z,"body",{get(){let b=Buffer.concat(a);try{b=JSON.parse(b)}catch(a){throw Object.defineProperty(a,"response",{value:z}),a}finally{Object.defineProperty(z,"body",{value:b,configurable:!0})}return b},configurable:!0});break;case void 0:case"buffer":Object.defineProperty(z,"body",{get(){let b=Buffer.concat(a);return Object.defineProperty(z,"body",{value:b,configurable:!0}),b},configurable:!0});break;default:throw TypeError("unsupported responseType request option")}return z})().catch(a=>{throw z&&Object.defineProperty(a,"response",{value:z}),a}).finally(()=>{let a=z&&z.headers["dpop-nonce"];a&&q.test(a)&&u.set(C,a)})},b.exports.setDefaults=s.bind(void 0,r)},17717,(a,b,c)=>{b.exports.keystores=new WeakMap},23400,(a,b,c)=>{b.exports=globalThis.structuredClone||(a=>JSON.parse(JSON.stringify(a)))},21570,(a,b,c)=>{let d=a.r(66597),e=a.r(23400),f=a.r(35121),g=Symbol(),h=(a,{alg:b,use:c})=>{let d=0;return b&&a.alg&&d++,c&&a.use&&d++,d};b.exports=class{#a;constructor(a,b){if(a!==g)throw Error("invalid constructor call");this.#a=b}toJWKS(){return{keys:this.map(({jwk:{d:a,p:b,q:c,dp:d,dq:e,qi:f,...g}})=>g)}}all({alg:a,kid:b,use:c}={}){if(!c||!a)throw Error();let d=function(a){switch("string"==typeof a&&a.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:return}}(a),e={alg:a,use:c};return this.filter(e=>{let f=!0;return void 0!==d&&e.jwk.kty!==d&&(f=!1),f&&void 0!==b&&e.jwk.kid!==b&&(f=!1),f&&void 0!==c&&void 0!==e.jwk.use&&e.jwk.use!==c&&(f=!1),f&&e.jwk.alg&&e.jwk.alg!==a?f=!1:e.algorithms.has(a)||(f=!1),f}).sort((a,b)=>h(b,e)-h(a,e))}get(...a){return this.all(...a)[0]}static async fromJWKS(a,{onlyPublic:b=!1,onlyPrivate:c=!1}={}){if(!f(a)||!Array.isArray(a.keys)||a.keys.some(a=>!f(a)||!("kty"in a)))throw TypeError("jwks must be a JSON Web Key Set formatted object");let h=[];for(let f of a.keys){let{kty:a,kid:g,crv:i}=f=e(f),{alg:j,use:k}=f;if("string"==typeof a&&a&&(void 0===k||"sig"===k||"enc"===k)&&("string"==typeof j||void 0===j)&&("string"==typeof g||void 0===g)){if("EC"===a&&"sig"===k)switch(i){case"P-256":j="ES256";break;case"P-384":j="ES384";break;case"P-521":j="ES512"}if("secp256k1"===i&&(k="sig",j="ES256K"),"OKP"===a)switch(i){case"Ed25519":case"Ed448":k="sig",j="EdDSA";break;case"X25519":case"X448":k="enc"}if(j&&!k)switch(!0){case j.startsWith("ECDH"):case j.startsWith("RSA"):k="enc"}if(c&&("oct"===f.kty||!f.d))throw Error("jwks must only contain private keys");b&&(f.d||f.k)||h.push({jwk:{...f,alg:j,use:k},async keyObject(a){if(this[a])return this[a];let b=await d.importJWK(this.jwk,a);return this[a]=b,b},get algorithms(){return Object.defineProperty(this,"algorithms",{value:function(a,b,c,e){if(b)return new Set([b]);switch(c){case"EC":{let b=[];if(("enc"===a||void 0===a)&&(b=b.concat(["ECDH-ES","ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"])),"sig"===a||void 0===a)switch(e){case"P-256":case"P-384":b=b.concat([`ES${e.slice(-3)}`]);break;case"P-521":b=b.concat(["ES512"]);break;case"secp256k1":"node:crypto"===d.cryptoRuntime&&(b=b.concat(["ES256K"]))}return new Set(b)}case"OKP":return new Set(["ECDH-ES","ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"]);case"RSA":{let b=[];return("enc"===a||void 0===a)&&(b=b.concat(["RSA-OAEP","RSA-OAEP-256","RSA-OAEP-384","RSA-OAEP-512"]),"node:crypto"===d.cryptoRuntime&&(b=b.concat(["RSA1_5"]))),("sig"===a||void 0===a)&&(b=b.concat(["PS256","PS384","PS512","RS256","RS384","RS512"])),new Set(b)}default:throw Error("unreachable")}}(this.jwk.use,this.jwk.alg,this.jwk.kty,this.jwk.crv),enumerable:!0,configurable:!1}),this.algorithms}})}}return new this(g,h)}filter(...a){return this.#a.filter(...a)}find(...a){return this.#a.find(...a)}every(...a){return this.#a.every(...a)}some(...a){return this.#a.some(...a)}map(...a){return this.#a.map(...a)}forEach(...a){return this.#a.forEach(...a)}reduce(...a){return this.#a.reduce(...a)}sort(...a){return this.#a.sort(...a)}*[Symbol.iterator](){for(let a of this.#a)yield a}}},99142,(a,b,c)=>{let d=a.r(35121);b.exports=function a(b,...c){for(let e of c)if(d(e))for(let[c,f]of Object.entries(e))"__proto__"!==c&&"constructor"!==c&&(d(b[c])&&d(f)?b[c]=a(b[c],f):void 0!==f&&(b[c]=f));return b}},7647,(a,b,c)=>{let d=a.r(66597),{RPError:e}=a.r(56780),{assertIssuerConfiguration:f}=a.r(42095),{random:g}=a.r(7182),h=a.r(3976),i=a.r(42262),{keystores:j}=a.r(17717),k=a.r(99142),l=a=>encodeURIComponent(a).replace(/%20/g,"+");async function m(a,b){let c=this[`${a}_endpoint_auth_signing_alg`];if(c||f(this.issuer,`${a}_endpoint_auth_signing_alg_values_supported`),"client_secret_jwt"===this[`${a}_endpoint_auth_method`]){if(!c){let b=this.issuer[`${a}_endpoint_auth_signing_alg_values_supported`];c=Array.isArray(b)&&b.find(a=>/^HS(?:256|384|512)/.test(a))}if(!c)throw new e(`failed to determine a JWS Algorithm to use for ${this[`${a}_endpoint_auth_method`]} Client Assertion`);return new d.CompactSign(Buffer.from(JSON.stringify(b))).setProtectedHeader({alg:c}).sign(this.secretForAlg(c))}let g=await j.get(this);if(!g)throw TypeError("no client jwks provided for signing a client assertion with");if(!c){let b=this.issuer[`${a}_endpoint_auth_signing_alg_values_supported`];c=Array.isArray(b)&&b.find(a=>g.get({alg:a,use:"sig"}))}if(!c)throw new e(`failed to determine a JWS Algorithm to use for ${this[`${a}_endpoint_auth_method`]} Client Assertion`);let h=g.get({alg:c,use:"sig"});if(!h)throw new e(`no key found in client jwks to sign a client assertion with using alg ${c}`);return new d.CompactSign(Buffer.from(JSON.stringify(b))).setProtectedHeader({alg:c,kid:h.jwk&&h.jwk.kid}).sign(await h.keyObject(c))}async function n(a,{clientAssertionPayload:b}={}){switch(this[`${a}_endpoint_auth_method`]){case"self_signed_tls_client_auth":case"tls_client_auth":case"none":return{form:{client_id:this.client_id}};case"client_secret_post":if("string"!=typeof this.client_secret)throw TypeError("client_secret_post client authentication method requires a client_secret");return{form:{client_id:this.client_id,client_secret:this.client_secret}};case"private_key_jwt":case"client_secret_jwt":{let c=h(),d=await m.call(this,a,{iat:c,exp:c+60,jti:g(),iss:this.client_id,sub:this.client_id,aud:this.issuer.issuer,...b});return{form:{client_id:this.client_id,client_assertion:d,client_assertion_type:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer"}}}case"client_secret_basic":{if("string"!=typeof this.client_secret)throw TypeError("client_secret_basic client authentication method requires a client_secret");let a=`${l(this.client_id)}:${l(this.client_secret)}`,b=Buffer.from(a).toString("base64");return{headers:{Authorization:`Basic ${b}`}}}default:throw TypeError(`missing, or unsupported, ${a}_endpoint_auth_method`)}}async function o(a,b,{clientAssertionPayload:c,endpointAuthMethod:d=a,DPoP:e}={}){let f,g=k(b,await n.call(this,d,{clientAssertionPayload:c})),h=this[`${d}_endpoint_auth_method`].includes("tls_client_auth")||"token"===a&&this.tls_client_certificate_bound_access_tokens;if(h&&this.issuer.mtls_endpoint_aliases&&(f=this.issuer.mtls_endpoint_aliases[`${a}_endpoint`]),f=f||this.issuer[`${a}_endpoint`],"form"in g)for(let[a,b]of Object.entries(g.form))void 0===b&&delete g.form[a];return i.call(this,{...g,method:"POST",url:f,headers:{..."revocation"!==a?{Accept:"application/json"}:void 0,...g.headers}},{mTLS:h,DPoP:e})}b.exports={resolveResponseType:function(){let{length:a,0:b}=this.response_types;if(1===a)return b},resolveRedirectUri:function(){let{length:a,0:b}=this.redirect_uris||[];if(1===a)return b},authFor:n,authenticatedPost:o}},20161,(a,b,c)=>{"use strict";var d=a.r(54799);function e(a,b){return b=h(a,b),function(a,b){if(void 0===(c="passthrough"!==b.algorithm?d.createHash(b.algorithm):new k).write&&(c.write=c.update,c.end=c.update),j(b,c).dispatch(a),c.update||c.end(""),c.digest)return c.digest("buffer"===b.encoding?void 0:b.encoding);var c,e=c.read();return"buffer"===b.encoding?e:e.toString(b.encoding)}(a,b)}(c=b.exports=e).sha1=function(a){return e(a)},c.keys=function(a){return e(a,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},c.MD5=function(a){return e(a,{algorithm:"md5",encoding:"hex"})},c.keysMD5=function(a){return e(a,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var f=d.getHashes?d.getHashes().slice():["sha1","md5"];f.push("passthrough");var g=["buffer","hex","binary","base64"];function h(a,b){var c={};if(c.algorithm=(b=b||{}).algorithm||"sha1",c.encoding=b.encoding||"hex",c.excludeValues=!!b.excludeValues,c.algorithm=c.algorithm.toLowerCase(),c.encoding=c.encoding.toLowerCase(),c.ignoreUnknown=!0===b.ignoreUnknown,c.respectType=!1!==b.respectType,c.respectFunctionNames=!1!==b.respectFunctionNames,c.respectFunctionProperties=!1!==b.respectFunctionProperties,c.unorderedArrays=!0===b.unorderedArrays,c.unorderedSets=!1!==b.unorderedSets,c.unorderedObjects=!1!==b.unorderedObjects,c.replacer=b.replacer||void 0,c.excludeKeys=b.excludeKeys||void 0,void 0===a)throw Error("Object argument required.");for(var d=0;d<f.length;++d)f[d].toLowerCase()===c.algorithm.toLowerCase()&&(c.algorithm=f[d]);if(-1===f.indexOf(c.algorithm))throw Error('Algorithm "'+c.algorithm+'"  not supported. supported values: '+f.join(", "));if(-1===g.indexOf(c.encoding)&&"passthrough"!==c.algorithm)throw Error('Encoding "'+c.encoding+'"  not supported. supported values: '+g.join(", "));return c}function i(a){return"function"==typeof a&&null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(a))}function j(a,b,c){c=c||[];var d=function(a){return b.update?b.update(a,"utf8"):b.write(a,"utf8")};return{dispatch:function(b){a.replacer&&(b=a.replacer(b));var c=typeof b;return null===b&&(c="null"),this["_"+c](b)},_object:function(b){var e=Object.prototype.toString.call(b),f=/\[object (.*)\]/i.exec(e);f=(f=f?f[1]:"unknown:["+e+"]").toLowerCase();var g=null;if((g=c.indexOf(b))>=0)return this.dispatch("[CIRCULAR:"+g+"]");if(c.push(b),"undefined"!=typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(b))return d("buffer:"),d(b);if("object"!==f&&"function"!==f&&"asyncfunction"!==f)if(this["_"+f])this["_"+f](b);else if(a.ignoreUnknown)return d("["+f+"]");else throw Error('Unknown object type "'+f+'"');else{var h=Object.keys(b);a.unorderedObjects&&(h=h.sort()),!1===a.respectType||i(b)||h.splice(0,0,"prototype","__proto__","constructor"),a.excludeKeys&&(h=h.filter(function(b){return!a.excludeKeys(b)})),d("object:"+h.length+":");var j=this;return h.forEach(function(c){j.dispatch(c),d(":"),a.excludeValues||j.dispatch(b[c]),d(",")})}},_array:function(b,e){e=void 0!==e?e:!1!==a.unorderedArrays;var f=this;if(d("array:"+b.length+":"),!e||b.length<=1)return b.forEach(function(a){return f.dispatch(a)});var g=[],h=b.map(function(b){var d=new k,e=c.slice();return j(a,d,e).dispatch(b),g=g.concat(e.slice(c.length)),d.read().toString()});return c=c.concat(g),h.sort(),this._array(h,!1)},_date:function(a){return d("date:"+a.toJSON())},_symbol:function(a){return d("symbol:"+a.toString())},_error:function(a){return d("error:"+a.toString())},_boolean:function(a){return d("bool:"+a.toString())},_string:function(a){d("string:"+a.length+":"),d(a.toString())},_function:function(b){d("fn:"),i(b)?this.dispatch("[native]"):this.dispatch(b.toString()),!1!==a.respectFunctionNames&&this.dispatch("function-name:"+String(b.name)),a.respectFunctionProperties&&this._object(b)},_number:function(a){return d("number:"+a.toString())},_xml:function(a){return d("xml:"+a.toString())},_null:function(){return d("Null")},_undefined:function(){return d("Undefined")},_regexp:function(a){return d("regex:"+a.toString())},_uint8array:function(a){return d("uint8array:"),this.dispatch(Array.prototype.slice.call(a))},_uint8clampedarray:function(a){return d("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(a))},_int8array:function(a){return d("uint8array:"),this.dispatch(Array.prototype.slice.call(a))},_uint16array:function(a){return d("uint16array:"),this.dispatch(Array.prototype.slice.call(a))},_int16array:function(a){return d("uint16array:"),this.dispatch(Array.prototype.slice.call(a))},_uint32array:function(a){return d("uint32array:"),this.dispatch(Array.prototype.slice.call(a))},_int32array:function(a){return d("uint32array:"),this.dispatch(Array.prototype.slice.call(a))},_float32array:function(a){return d("float32array:"),this.dispatch(Array.prototype.slice.call(a))},_float64array:function(a){return d("float64array:"),this.dispatch(Array.prototype.slice.call(a))},_arraybuffer:function(a){return d("arraybuffer:"),this.dispatch(new Uint8Array(a))},_url:function(a){return d("url:"+a.toString(),"utf8")},_map:function(b){d("map:");var c=Array.from(b);return this._array(c,!1!==a.unorderedSets)},_set:function(b){d("set:");var c=Array.from(b);return this._array(c,!1!==a.unorderedSets)},_file:function(a){return d("file:"),this.dispatch([a.name,a.size,a.type,a.lastModfied])},_blob:function(){if(a.ignoreUnknown)return d("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return d("domwindow")},_bigint:function(a){return d("bigint:"+a.toString())},_process:function(){return d("process")},_timer:function(){return d("timer")},_pipe:function(){return d("pipe")},_tcp:function(){return d("tcp")},_udp:function(){return d("udp")},_tty:function(){return d("tty")},_statwatcher:function(){return d("statwatcher")},_securecontext:function(){return d("securecontext")},_connection:function(){return d("connection")},_zlib:function(){return d("zlib")},_context:function(){return d("context")},_nodescript:function(){return d("nodescript")},_httpparser:function(){return d("httpparser")},_dataview:function(){return d("dataview")},_signal:function(){return d("signal")},_fsevent:function(){return d("fsevent")},_tlswrap:function(){return d("tlswrap")}}}function k(){return{buf:"",write:function(a){this.buf+=a},end:function(a){this.buf+=a},read:function(){return this.buf}}}c.writeToStream=function(a,b,c){return void 0===c&&(c=b,b={}),j(b=h(a,b),c).dispatch(a)}},4859,(a,b,c)=>{let d=a.r(20161),e=a.r(90124),{RPError:f}=a.r(56780),{assertIssuerConfiguration:g}=a.r(42095),h=a.r(21570),{keystores:i}=a.r(17717),j=a.r(45499),k=a.r(42262),l=new WeakMap,m=new WeakMap,n=a=>(m.has(a)||m.set(a,new e({max:100})),m.get(a));async function o(a=!1){g(this,"jwks_uri");let b=i.get(this),c=n(this);return a||!b?(l.has(this)||(c.reset(),l.set(this,(async()=>{let a=j(await k.call(this,{method:"GET",responseType:"json",url:this.jwks_uri,headers:{Accept:"application/json, application/jwk-set+json"}}).finally(()=>{l.delete(this)})),b=h.fromJWKS(a,{onlyPublic:!0});return c.set("throttle",!0,6e4),i.set(this,b),b})())),l.get(this)):b}async function p({kid:a,kty:b,alg:c,use:e},{allowMulti:g=!1}={}){let h=n(this),i={kid:a,kty:b,alg:c,use:e},j=d(i,{algorithm:"sha256",ignoreUnknown:!0,unorderedArrays:!0,unorderedSets:!0,respectType:!1}),k=h.get(j)||h.get("throttle"),l=await o.call(this,!k),m=l.all(i);if(delete i.use,0===m.length)throw new f({printf:["no valid key found in issuer's jwks_uri for key parameters %j",i],jwks:l});if(!g&&m.length>1&&!a)throw new f({printf:["multiple matching keys found in issuer's jwks_uri for key parameters %j, kid must be provided in this case",i],jwks:l});return h.set(j,!0),m}b.exports.queryKeyStore=p,b.exports.keystore=o},8889,(a,b,c)=>{let{inspect:d}=a.r(24361),{RPError:e,OPError:f}=a.r(56780),g=a.r(3976);class h{#b;#c;#d;#e;#f;#g;#h;#i;#j;constructor({client:a,exchangeBody:b,clientAssertionPayload:c,response:d,maxAge:f,DPoP:h}){if(["verification_uri","user_code","device_code"].forEach(a=>{if("string"!=typeof d[a]||!d[a])throw new e(`expected ${a} string to be returned by Device Authorization Response, got %j`,d[a])}),!Number.isSafeInteger(d.expires_in))throw new e("expected expires_in number to be returned by Device Authorization Response, got %j",d.expires_in);this.#g=g()+d.expires_in,this.#c=a,this.#e=h,this.#i=f,this.#f=b,this.#d=c,this.#j=d,this.#h=1e3*d.interval||5e3}abort(){this.#b=!0}async poll({signal:a}={}){let b;if(a&&a.aborted||this.#b)throw new e("polling aborted");if(this.expired())throw new e("the device code %j has expired and the device authorization session has concluded",this.device_code);await new Promise(a=>setTimeout(a,this.#h));try{b=await this.#c.grant({...this.#f,grant_type:"urn:ietf:params:oauth:grant-type:device_code",device_code:this.device_code},{clientAssertionPayload:this.#d,DPoP:this.#e})}catch(b){switch(b instanceof f&&b.error){case"slow_down":this.#h+=5e3;case"authorization_pending":return this.poll({signal:a});default:throw b}}return"id_token"in b&&(await this.#c.decryptIdToken(b),await this.#c.validateIdToken(b,void 0,"token",this.#i)),b}get device_code(){return this.#j.device_code}get user_code(){return this.#j.user_code}get verification_uri(){return this.#j.verification_uri}get verification_uri_complete(){return this.#j.verification_uri_complete}get expires_in(){return Math.max.apply(null,[this.#g-g(),0])}expired(){return 0===this.expires_in}[d.custom](){return`${this.constructor.name} ${d(this.#j,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}}b.exports=h},21108,(a,b,c)=>{let d,{inspect:e}=a.r(24361),f=a.r(21517),g=a.r(54799),{strict:h}=a.r(49719),i=a.r(45706),j=a.r(92509),{URL:k,URLSearchParams:l}=a.r(92509),m=a.r(66597),n=a.r(89014),o=a.r(47575),p=a.r(59019),q=a.r(1250),r=a.r(29953),s=a.r(76310),{assertSigningAlgValuesSupport:t,assertIssuerConfiguration:u}=a.r(42095),v=a.r(85412),w=a.r(35121),x=a.r(45499),y=a.r(27317),{OPError:z,RPError:A}=a.r(56780),B=a.r(3976),{random:C}=a.r(7182),D=a.r(42262),{CLOCK_TOLERANCE:E}=a.r(82471),{keystores:F}=a.r(17717),G=a.r(21570),H=a.r(23400),{authenticatedPost:I,resolveResponseType:J,resolveRedirectUri:K}=a.r(7647),{queryKeyStore:L}=a.r(4859),M=a.r(8889),[N,O]=process.version.slice(1).split(".").map(a=>parseInt(a,10)),P=N>=17||16===N&&O>=9,Q=Symbol(),R=Symbol(),S=Symbol();function T(a){return v(a,"access_token","code","error_description","error_uri","error","expires_in","id_token","iss","response","session_state","state","token_type")}function U(a,b="Bearer"){return`${b} ${a}`}function V(a){let b=j.parse(a);return b.search?i.parse(b.search.substring(1)):{}}function W(a,b,c){if(void 0===a[c])throw new A({message:`missing required JWT property ${c}`,jwt:b})}function X(a){let b={client_id:this.client_id,scope:"openid",response_type:J.call(this),redirect_uri:K.call(this),...a};return Object.entries(b).forEach(([a,c])=>{null==c?delete b[a]:"claims"===a&&"object"==typeof c?b[a]=JSON.stringify(c):"resource"===a&&Array.isArray(c)?b[a]=c:"string"!=typeof c&&(b[a]=String(c))}),b}function Y(a){if(!w(a)||!Array.isArray(a.keys)||a.keys.some(a=>!w(a)||!("kty"in a)))throw TypeError("jwks must be a JSON Web Key Set formatted object");return G.fromJWKS(a,{onlyPrivate:!0})}class Z{#k;#l;#m;#n;constructor(a,b,c={},d,e){if(this.#k=new Map,this.#l=a,this.#m=b,"string"!=typeof c.client_id||!c.client_id)throw TypeError("client_id is required");const f={grant_types:["authorization_code"],id_token_signed_response_alg:"RS256",authorization_signed_response_alg:"RS256",response_types:["code"],token_endpoint_auth_method:"client_secret_basic",...this.fapi1()?{grant_types:["authorization_code","implicit"],id_token_signed_response_alg:"PS256",authorization_signed_response_alg:"PS256",response_types:["code id_token"],tls_client_certificate_bound_access_tokens:!0,token_endpoint_auth_method:void 0}:void 0,...this.fapi2()?{id_token_signed_response_alg:"PS256",authorization_signed_response_alg:"PS256",token_endpoint_auth_method:void 0}:void 0,...c};if(this.fapi())switch(f.token_endpoint_auth_method){case"self_signed_tls_client_auth":case"tls_client_auth":break;case"private_key_jwt":if(!d)throw TypeError("jwks is required");break;case void 0:throw TypeError("token_endpoint_auth_method is required");default:throw TypeError("invalid or unsupported token_endpoint_auth_method")}if(this.fapi2()&&(f.tls_client_certificate_bound_access_tokens&&f.dpop_bound_access_tokens||!f.tls_client_certificate_bound_access_tokens&&!f.dpop_bound_access_tokens))throw TypeError("either tls_client_certificate_bound_access_tokens or dpop_bound_access_tokens must be set to true");if(!function(a,b,c){if(b.token_endpoint_auth_method||function(a,b){try{let c=a.issuer.token_endpoint_auth_methods_supported;!c.includes(b.token_endpoint_auth_method)&&c.includes("client_secret_post")&&(b.token_endpoint_auth_method="client_secret_post")}catch(a){}}(a,c),b.redirect_uri){if(b.redirect_uris)throw TypeError("provide a redirect_uri or redirect_uris, not both");c.redirect_uris=[b.redirect_uri],delete c.redirect_uri}if(b.response_type){if(b.response_types)throw TypeError("provide a response_type or response_types, not both");c.response_types=[b.response_type],delete c.response_type}}(this,c,f),t("token",this.issuer,f),["introspection","revocation"].forEach(a=>{!function(a,b,c){if(!b[`${a}_endpoint`])return;let d=c.token_endpoint_auth_method,e=c.token_endpoint_auth_signing_alg,f=`${a}_endpoint_auth_method`,g=`${a}_endpoint_auth_signing_alg`;void 0===c[f]&&void 0===c[g]&&(void 0!==d&&(c[f]=d),void 0!==e&&(c[g]=e))}(a,this.issuer,f),t(a,this.issuer,f)}),Object.entries(f).forEach(([a,b])=>{this.#k.set(a,b),this[a]||Object.defineProperty(this,a,{get(){return this.#k.get(a)},enumerable:!0})}),void 0!==d){const a=Y.call(this,d);F.set(this,a)}null!=e&&e.additionalAuthorizedParties&&(this.#n=H(e.additionalAuthorizedParties)),this[E]=0}authorizationUrl(a={}){if(!w(a))throw TypeError("params must be a plain object");u(this.issuer,"authorization_endpoint");let b=new k(this.issuer.authorization_endpoint);for(let[c,d]of Object.entries(X.call(this,a)))if(Array.isArray(d))for(let a of(b.searchParams.delete(c),d))b.searchParams.append(c,a);else b.searchParams.set(c,d);return b.href.replace(/\+/g,"%20")}authorizationPost(a={}){if(!w(a))throw TypeError("params must be a plain object");let b=X.call(this,a),c=Object.keys(b).map(a=>`<input type="hidden" name="${a}" value="${b[a]}"/>`).join("\n");return`<!DOCTYPE html>
<head>
<title>Requesting Authorization</title>
</head>
<body onload="javascript:document.forms[0].submit()">
<form method="post" action="${this.issuer.authorization_endpoint}">
  ${c}
</form>
</body>
</html>`}endSessionUrl(a={}){let b;u(this.issuer,"end_session_endpoint");let{0:c,length:d}=this.post_logout_redirect_uris||[],{post_logout_redirect_uri:e=1===d?c:void 0}=a;if({id_token_hint:b,...a}=a,b instanceof y){if(!b.id_token)throw TypeError("id_token not present in TokenSet");b=b.id_token}let f=j.parse(this.issuer.end_session_endpoint),g=r(V(this.issuer.end_session_endpoint),a,{post_logout_redirect_uri:e,client_id:this.client_id},{id_token_hint:b});return Object.entries(g).forEach(([a,b])=>{null==b&&delete g[a]}),f.search=null,f.query=g,j.format(f)}callbackParams(a){let b=a instanceof f.IncomingMessage||a&&a.method&&a.url;if("string"!=typeof a&&!b)throw TypeError("#callbackParams only accepts string urls, http.IncomingMessage or a lookalike");if(!b)return T(V(a));switch(a.method){case"GET":return T(V(a.url));case"POST":if(void 0===a.body)throw TypeError("incoming message body missing, include a body parser prior to this method call");switch(typeof a.body){case"object":case"string":if(Buffer.isBuffer(a.body))return T(i.parse(a.body.toString("utf-8")));if("string"==typeof a.body)return T(i.parse(a.body));return T(a.body);default:throw TypeError("invalid IncomingMessage body object")}default:throw TypeError("invalid IncomingMessage method")}}async callback(a,b,c={},{exchangeBody:d,clientAssertionPayload:e,DPoP:f}={}){let g=T(b);if(!c.jarm||"response"in b){if("response"in b){let a=await this.decryptJARM(g.response);g=await this.validateJARM(a)}}else throw new A({message:"expected a JARM response",checks:c,params:g});if(this.default_max_age&&!c.max_age&&(c.max_age=this.default_max_age),g.state&&!c.state)throw TypeError("checks.state argument is missing");if(!g.state&&c.state)throw new A({message:"state missing from the response",checks:c,params:g});if(c.state!==g.state)throw new A({printf:["state mismatch, expected %s, got: %s",c.state,g.state],checks:c,params:g});if("iss"in g){if(u(this.issuer,"issuer"),g.iss!==this.issuer.issuer)throw new A({printf:["iss mismatch, expected %s, got: %s",this.issuer.issuer,g.iss],params:g})}else if(this.issuer.authorization_response_iss_parameter_supported&&!("id_token"in g)&&!("response"in b))throw new A({message:"iss missing from the response",params:g});if(g.error)throw new z(g);let h={code:["code"],id_token:["id_token"],token:["access_token","token_type"]};if(c.response_type){for(let a of c.response_type.split(" "))if("none"===a){if(g.code||g.id_token||g.access_token)throw new A({message:'unexpected params encountered for "none" response',checks:c,params:g})}else for(let b of h[a])if(!g[b])throw new A({message:`${b} missing from response`,checks:c,params:g})}if(g.id_token){let a=new y(g);if(await this.decryptIdToken(a),await this.validateIdToken(a,c.nonce,"authorization",c.max_age,c.state),!g.code)return a}if(g.code){let b=await this.grant({...d,grant_type:"authorization_code",code:g.code,redirect_uri:a,code_verifier:c.code_verifier},{clientAssertionPayload:e,DPoP:f});return await this.decryptIdToken(b),await this.validateIdToken(b,c.nonce,"token",c.max_age),g.session_state&&(b.session_state=g.session_state),b}return new y(g)}async oauthCallback(a,b,c={},{exchangeBody:d,clientAssertionPayload:e,DPoP:f}={}){let g=T(b);if(!c.jarm||"response"in b){if("response"in b){let a=await this.decryptJARM(g.response);g=await this.validateJARM(a)}}else throw new A({message:"expected a JARM response",checks:c,params:g});if(g.state&&!c.state)throw TypeError("checks.state argument is missing");if(!g.state&&c.state)throw new A({message:"state missing from the response",checks:c,params:g});if(c.state!==g.state)throw new A({printf:["state mismatch, expected %s, got: %s",c.state,g.state],checks:c,params:g});if("iss"in g){if(u(this.issuer,"issuer"),g.iss!==this.issuer.issuer)throw new A({printf:["iss mismatch, expected %s, got: %s",this.issuer.issuer,g.iss],params:g})}else if(this.issuer.authorization_response_iss_parameter_supported&&!("id_token"in g)&&!("response"in b))throw new A({message:"iss missing from the response",params:g});if(g.error)throw new z(g);if("string"==typeof g.id_token&&g.id_token.length)throw new A({message:"id_token detected in the response, you must use client.callback() instead of client.oauthCallback()",params:g});delete g.id_token;let h={code:["code"],token:["access_token","token_type"]};if(c.response_type)for(let a of c.response_type.split(" ")){if("none"===a&&(g.code||g.id_token||g.access_token))throw new A({message:'unexpected params encountered for "none" response',checks:c,params:g});if(h[a]){for(let b of h[a])if(!g[b])throw new A({message:`${b} missing from response`,checks:c,params:g})}}if(g.code){let b=await this.grant({...d,grant_type:"authorization_code",code:g.code,redirect_uri:a,code_verifier:c.code_verifier},{clientAssertionPayload:e,DPoP:f});if("string"==typeof b.id_token&&b.id_token.length)throw new A({message:"id_token detected in the response, you must use client.callback() instead of client.oauthCallback()",params:g});return delete b.id_token,b}return new y(g)}async decryptIdToken(a){if(!this.id_token_encrypted_response_alg)return a;let b=a;if(b instanceof y){if(!b.id_token)throw TypeError("id_token not present in TokenSet");b=b.id_token}let c=this.id_token_encrypted_response_alg,d=this.id_token_encrypted_response_enc,e=await this.decryptJWE(b,c,d);return a instanceof y?(a.id_token=e,a):e}async validateJWTUserinfo(a){let b=this.userinfo_signed_response_alg;return this.validateJWT(a,b,[])}async decryptJARM(a){if(!this.authorization_encrypted_response_alg)return a;let b=this.authorization_encrypted_response_alg,c=this.authorization_encrypted_response_enc;return this.decryptJWE(a,b,c)}async decryptJWTUserinfo(a){if(!this.userinfo_encrypted_response_alg)return a;let b=this.userinfo_encrypted_response_alg,c=this.userinfo_encrypted_response_enc;return this.decryptJWE(a,b,c)}async decryptJWE(a,b,c="A128CBC-HS256"){let d,e=JSON.parse(q.decode(a.split(".")[0]));if(e.alg!==b)throw new A({printf:["unexpected JWE alg received, expected %s, got: %s",b,e.alg],jwt:a});if(e.enc!==c)throw new A({printf:["unexpected JWE enc received, expected %s, got: %s",c,e.enc],jwt:a});let f=a=>new TextDecoder().decode(a.plaintext);if(b.match(/^(?:RSA|ECDH)/)){let b=await F.get(this),c=m.decodeProtectedHeader(a);for(let e of b.all({...c,use:"enc"}))if(d=await m.compactDecrypt(a,await e.keyObject(c.alg)).then(f,()=>{}))break}else d=await m.compactDecrypt(a,this.secretForAlg("dir"===b?c:b)).then(f,()=>{});if(!d)throw new A({message:"failed to decrypt JWE",jwt:a});return d}async validateIdToken(a,b,c,d,e){let f=a,g=this.id_token_signed_response_alg;if(f instanceof y){if(!f.id_token)throw TypeError("id_token not present in TokenSet");f=f.id_token}f=String(f);let h=B(),{protected:i,payload:j,key:k}=await this.validateJWT(f,g);if("number"==typeof d||d!==S&&this.require_auth_time){if(!j.auth_time)throw new A({message:"missing required JWT property auth_time",jwt:f});if("number"!=typeof j.auth_time)throw new A({message:"JWT auth_time claim must be a JSON numeric value",jwt:f})}if("number"==typeof d&&j.auth_time+d<h-this[E])throw new A({printf:["too much time has elapsed since the last End-User authentication, max_age %i, auth_time: %i, now %i",d,j.auth_time,h-this[E]],now:h,tolerance:this[E],auth_time:j.auth_time,jwt:f});if(b!==R&&(j.nonce||void 0!==b)&&j.nonce!==b)throw new A({printf:["nonce mismatch, expected %s, got: %s",b,j.nonce],jwt:f});if("authorization"===c){if(!j.at_hash&&a.access_token)throw new A({message:"missing required property at_hash",jwt:f});if(!j.c_hash&&a.code)throw new A({message:"missing required property c_hash",jwt:f});if(this.fapi1()&&!j.s_hash&&(a.state||e))throw new A({message:"missing required property s_hash",jwt:f});if(j.s_hash){if(!e)throw TypeError('cannot verify s_hash, "checks.state" property not provided');try{n.validate({claim:"s_hash",source:"state"},j.s_hash,e,i.alg,k.jwk&&k.jwk.crv)}catch(a){throw new A({message:a.message,jwt:f})}}}if(this.fapi()&&j.iat<h-3600)throw new A({printf:["JWT issued too far in the past, now %i, iat %i",h,j.iat],now:h,tolerance:this[E],iat:j.iat,jwt:f});if(a.access_token&&void 0!==j.at_hash)try{n.validate({claim:"at_hash",source:"access_token"},j.at_hash,a.access_token,i.alg,k.jwk&&k.jwk.crv)}catch(a){throw new A({message:a.message,jwt:f})}if(a.code&&void 0!==j.c_hash)try{n.validate({claim:"c_hash",source:"code"},j.c_hash,a.code,i.alg,k.jwk&&k.jwk.crv)}catch(a){throw new A({message:a.message,jwt:f})}return a}async validateJWT(a,b,c=["iss","sub","aud","exp","iat"]){let d,e,f,g="https://self-issued.me"===this.issuer.issuer,i=B();try{({header:d,payload:e}=p(a,{complete:!0}))}catch(b){throw new A({printf:["failed to decode JWT (%s: %s)",b.name,b.message],jwt:a})}if(d.alg!==b)throw new A({printf:["unexpected JWT alg received, expected %s, got: %s",b,d.alg],jwt:a});if(g&&(c=[...c,"sub_jwk"]),c.forEach(W.bind(void 0,e,a)),void 0!==e.iss){let b=this.issuer.issuer;if(this.#m&&(b=this.issuer.issuer.replace("{tenantid}",e.tid)),e.iss!==b)throw new A({printf:["unexpected iss value, expected %s, got: %s",b,e.iss],jwt:a})}if(void 0!==e.iat&&"number"!=typeof e.iat)throw new A({message:"JWT iat claim must be a JSON numeric value",jwt:a});if(void 0!==e.nbf){if("number"!=typeof e.nbf)throw new A({message:"JWT nbf claim must be a JSON numeric value",jwt:a});if(e.nbf>i+this[E])throw new A({printf:["JWT not active yet, now %i, nbf %i",i+this[E],e.nbf],now:i,tolerance:this[E],nbf:e.nbf,jwt:a})}if(void 0!==e.exp){if("number"!=typeof e.exp)throw new A({message:"JWT exp claim must be a JSON numeric value",jwt:a});if(i-this[E]>=e.exp)throw new A({printf:["JWT expired, now %i, exp %i",i-this[E],e.exp],now:i,tolerance:this[E],exp:e.exp,jwt:a})}if(void 0!==e.aud){if(Array.isArray(e.aud)){if(e.aud.length>1&&!e.azp)throw new A({message:"missing required JWT property azp",jwt:a});if(!e.aud.includes(this.client_id))throw new A({printf:["aud is missing the client_id, expected %s to be included in %j",this.client_id,e.aud],jwt:a})}else if(e.aud!==this.client_id)throw new A({printf:["aud mismatch, expected %s, got: %s",this.client_id,e.aud],jwt:a})}if(void 0!==e.azp){let b=this.#n;if(!(b="string"==typeof b?[this.client_id,b]:Array.isArray(b)?[this.client_id,...b]:[this.client_id]).includes(e.azp))throw new A({printf:["azp mismatch, got: %s",e.azp],jwt:a})}if(g){try{h(w(e.sub_jwk));let a=await m.importJWK(e.sub_jwk,d.alg);h.equal(a.type,"public"),f=[{keyObject:()=>a}]}catch(b){throw new A({message:"failed to use sub_jwk claim as an asymmetric JSON Web Key",jwt:a})}if(await m.calculateJwkThumbprint(e.sub_jwk)!==e.sub)throw new A({message:"failed to match the subject with sub_jwk",jwt:a})}else d.alg.startsWith("HS")?f=[this.secretForAlg(d.alg)]:"none"!==d.alg&&(f=await L.call(this.issuer,{...d,use:"sig"}));if(!f&&"none"===d.alg)return{protected:d,payload:e};for(let b of f){let c=await m.compactVerify(a,b instanceof Uint8Array?b:await b.keyObject(d.alg)).catch(()=>{});if(c)return{payload:e,protected:c.protectedHeader,key:b}}throw new A({message:"failed to validate JWT signature",jwt:a})}async refresh(a,{exchangeBody:b,clientAssertionPayload:c,DPoP:d}={}){let e=a;if(e instanceof y){if(!e.refresh_token)throw TypeError("refresh_token not present in TokenSet");e=e.refresh_token}let f=await this.grant({...b,grant_type:"refresh_token",refresh_token:String(e)},{clientAssertionPayload:c,DPoP:d});if(f.id_token&&(await this.decryptIdToken(f),await this.validateIdToken(f,R,"token",S),a instanceof y&&a.id_token)){let b=a.claims().sub,c=f.claims().sub;if(c!==b)throw new A({printf:["sub mismatch, expected %s, got: %s",b,c],jwt:f.id_token})}return f}async requestResource(a,b,{method:c,headers:d,body:e,DPoP:f,tokenType:g=f?"DPoP":b instanceof y?b.token_type:"Bearer"}={},h){if(b instanceof y){if(!b.access_token)throw TypeError("access_token not present in TokenSet");b=b.access_token}if(b){if("string"!=typeof b)throw TypeError("invalid access token provided")}else throw TypeError("no access token provided");let i={headers:{Authorization:U(b,g),...d},body:e},j=!!this.tls_client_certificate_bound_access_tokens,k=await D.call(this,{...i,responseType:"buffer",method:c,url:a},{accessToken:b,mTLS:j,DPoP:f}),l=k.headers["www-authenticate"];return h!==Q&&l&&l.toLowerCase().startsWith("dpop ")&&"use_dpop_nonce"===s(l).error?this.requestResource(a,b,{method:c,headers:d,body:e,DPoP:f,tokenType:g}):k}async userinfo(a,{method:b="GET",via:c="header",tokenType:d,params:e,DPoP:f}={}){let g;u(this.issuer,"userinfo_endpoint");let i={tokenType:d,method:String(b).toUpperCase(),DPoP:f};if("GET"!==i.method&&"POST"!==i.method)throw TypeError("#userinfo() method can only be POST or a GET");if("body"===c&&"POST"!==i.method)throw TypeError("can only send body on POST");let j=!!(this.userinfo_signed_response_alg||this.userinfo_encrypted_response_alg);j?i.headers={Accept:"application/jwt"}:i.headers={Accept:"application/json"},this.tls_client_certificate_bound_access_tokens&&this.issuer.mtls_endpoint_aliases&&(g=this.issuer.mtls_endpoint_aliases.userinfo_endpoint),g=new k(g||this.issuer.userinfo_endpoint),"body"===c&&(i.headers.Authorization=void 0,i.headers["Content-Type"]="application/x-www-form-urlencoded",i.body=new l,i.body.append("access_token",a instanceof y?a.access_token:a)),e&&("GET"===i.method?Object.entries(e).forEach(([a,b])=>{g.searchParams.append(a,b)}):i.body?Object.entries(e).forEach(([a,b])=>{i.body.append(a,b)}):(i.body=new l,i.headers["Content-Type"]="application/x-www-form-urlencoded",Object.entries(e).forEach(([a,b])=>{i.body.append(a,b)}))),i.body&&(i.body=i.body.toString());let m=await this.requestResource(g,a,i),n=x(m,{bearer:!0});if(j){if(!/^application\/jwt/.test(m.headers["content-type"]))throw new A({message:"expected application/jwt response from the userinfo_endpoint",response:m});let a=m.body.toString(),b=await this.decryptJWTUserinfo(a);if(this.userinfo_signed_response_alg)({payload:n}=await this.validateJWTUserinfo(b));else try{n=JSON.parse(b),h(w(n))}catch(a){throw new A({message:"failed to parse userinfo JWE payload as JSON",jwt:b})}}else try{n=JSON.parse(m.body)}catch(a){throw Object.defineProperty(a,"response",{value:m}),a}if(a instanceof y&&a.id_token){let b=a.claims().sub;if(n.sub!==b)throw new A({printf:["userinfo sub mismatch, expected %s, got: %s",b,n.sub],body:n,jwt:a.id_token})}return n}encryptionSecret(a){let b=a<=256?"sha256":a<=384?"sha384":a<=512&&"sha512";if(!b)throw Error("unsupported symmetric encryption key derivation");return g.createHash(b).update(this.client_secret).digest().slice(0,a/8)}secretForAlg(a){if(!this.client_secret)throw TypeError("client_secret is required");return/^A(\d{3})(?:GCM)?KW$/.test(a)?this.encryptionSecret(parseInt(RegExp.$1,10)):/^A(\d{3})(?:GCM|CBC-HS(\d{3}))$/.test(a)?this.encryptionSecret(parseInt(RegExp.$2||RegExp.$1,10)):new TextEncoder().encode(this.client_secret)}async grant(a,{clientAssertionPayload:b,DPoP:c}={},d){let e;u(this.issuer,"token_endpoint");let f=await I.call(this,"token",{form:a,responseType:"json"},{clientAssertionPayload:b,DPoP:c});try{e=x(f)}catch(e){if(d!==Q&&e instanceof z&&"use_dpop_nonce"===e.error)return this.grant(a,{clientAssertionPayload:b,DPoP:c},Q);throw e}return new y(e)}async deviceAuthorization(a={},{exchangeBody:b,clientAssertionPayload:c,DPoP:d}={}){u(this.issuer,"device_authorization_endpoint"),u(this.issuer,"token_endpoint");let e=X.call(this,{client_id:this.client_id,redirect_uri:null,response_type:null,...a}),f=x(await I.call(this,"device_authorization",{responseType:"json",form:e},{clientAssertionPayload:c,endpointAuthMethod:"token"}));return new M({client:this,exchangeBody:b,clientAssertionPayload:c,response:f,maxAge:a.max_age,DPoP:d})}async revoke(a,b,{revokeBody:c,clientAssertionPayload:d}={}){if(u(this.issuer,"revocation_endpoint"),void 0!==b&&"string"!=typeof b)throw TypeError("hint must be a string");let e={...c,token:a};b&&(e.token_type_hint=b),x(await I.call(this,"revocation",{form:e},{clientAssertionPayload:d}),{body:!1})}async introspect(a,b,{introspectBody:c,clientAssertionPayload:d}={}){if(u(this.issuer,"introspection_endpoint"),void 0!==b&&"string"!=typeof b)throw TypeError("hint must be a string");let e={...c,token:a};return b&&(e.token_type_hint=b),x(await I.call(this,"introspection",{form:e,responseType:"json"},{clientAssertionPayload:d}))}static async register(a,b={}){let{initialAccessToken:c,jwks:d,...e}=b;return u(this.issuer,"registration_endpoint"),void 0===d||a.jwks||a.jwks_uri||(a.jwks=(await Y.call(this,d)).toJWKS()),new this(x(await D.call(this,{headers:{Accept:"application/json",...c?{Authorization:U(c)}:void 0},responseType:"json",json:a,url:this.issuer.registration_endpoint,method:"POST"}),{statusCode:201,bearer:!0}),d,e)}get metadata(){return H(Object.fromEntries(this.#k.entries()))}static async fromUri(a,b,c,d){return new this(x(await D.call(this,{method:"GET",url:a,responseType:"json",headers:{Authorization:U(b),Accept:"application/json"}}),{bearer:!0}),c,d)}async requestObject(a={},{sign:b=this.request_object_signing_alg||"none",encrypt:{alg:c=this.request_object_encryption_alg,enc:d=this.request_object_encryption_enc||"A128CBC-HS256"}={}}={}){let e,f;if(!w(a))throw TypeError("requestObject must be a plain object");let g=B(),h={alg:b,typ:"oauth-authz-req+jwt"},i=JSON.stringify(r({},a,{iss:this.client_id,aud:this.issuer.issuer,client_id:this.client_id,jti:C(),iat:g,exp:g+300,...this.fapi()?{nbf:g}:void 0}));if("none"===b)e=[q.encode(JSON.stringify(h)),q.encode(i),""].join(".");else{let a=b.startsWith("HS");if(a)f=this.secretForAlg(b);else{let a=await F.get(this);if(!a)throw TypeError(`no keystore present for client, cannot sign using alg ${b}`);if(!(f=a.get({alg:b,use:"sig"})))throw TypeError(`no key to sign with found for alg ${b}`)}e=await new m.CompactSign(new TextEncoder().encode(i)).setProtectedHeader({...h,kid:a?void 0:f.jwk.kid}).sign(a?f:await f.keyObject(b))}if(!c)return e;let j={alg:c,enc:d,cty:"oauth-authz-req+jwt"};return j.alg.match(/^(RSA|ECDH)/)?[f]=await L.call(this.issuer,{alg:j.alg,use:"enc"},{allowMulti:!0}):f=this.secretForAlg("dir"===j.alg?j.enc:j.alg),new m.CompactEncrypt(new TextEncoder().encode(e)).setProtectedHeader({...j,kid:f instanceof Uint8Array?void 0:f.jwk.kid}).encrypt(f instanceof Uint8Array?f:await f.keyObject(j.alg))}async pushedAuthorizationRequest(a={},{clientAssertionPayload:b}={}){u(this.issuer,"pushed_authorization_request_endpoint");let c={..."request"in a?a:X.call(this,a),client_id:this.client_id},d=await I.call(this,"pushed_authorization_request",{responseType:"json",form:c},{clientAssertionPayload:b,endpointAuthMethod:"token"}),e=x(d,{statusCode:201});if(!("expires_in"in e))throw new A({message:"expected expires_in in Pushed Authorization Successful Response",response:d});if("number"!=typeof e.expires_in)throw new A({message:"invalid expires_in value in Pushed Authorization Successful Response",response:d});if(!("request_uri"in e))throw new A({message:"expected request_uri in Pushed Authorization Successful Response",response:d});if("string"!=typeof e.request_uri)throw new A({message:"invalid request_uri value in Pushed Authorization Successful Response",response:d});return e}get issuer(){return this.#l}[e.custom](){return`${this.constructor.name} ${e(this.metadata,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}fapi(){return this.fapi1()||this.fapi2()}fapi1(){return"FAPI1Client"===this.constructor.name}fapi2(){return"FAPI2Client"===this.constructor.name}async validateJARM(a){let b=this.authorization_signed_response_alg,{payload:c}=await this.validateJWT(a,b,["iss","exp","aud"]);return T(c)}async dpopProof(a,b,c){let e;if(!w(a))throw TypeError("payload must be a plain object");if(o(b))e=b;else if("CryptoKey"===b[Symbol.toStringTag])e=b;else if("node:crypto"===m.cryptoRuntime)e=g.createPrivateKey(b);else throw TypeError("unrecognized crypto runtime");if("private"!==e.type)throw TypeError('"DPoP" option must be a private key');let f=d.call(this,e,b);if(!f)throw TypeError("could not determine DPoP JWS Algorithm");return new m.SignJWT({ath:c?q.encode(g.createHash("sha256").update(c).digest()):void 0,...a}).setProtectedHeader({alg:f,typ:"dpop+jwt",jwk:await aa(e,b)}).setIssuedAt().setJti(C()).sign(e)}}function $(a){switch(a.algorithm.name){case"Ed25519":case"Ed448":return"EdDSA";case"ECDSA":switch(a.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512"}break;case"RSASSA-PKCS1-v1_5":return`RS${a.algorithm.hash.name.slice(4)}`;case"RSA-PSS":return`PS${a.algorithm.hash.name.slice(4)}`;default:throw TypeError("unsupported DPoP private key")}}if("node:crypto"===m.cryptoRuntime){d=function(d,g){if("CryptoKey"===g[Symbol.toStringTag])return $(d);switch(d.asymmetricKeyType){case"ed25519":case"ed448":return"EdDSA";case"ec":var h=d,i=g;switch("object"==typeof i&&"object"==typeof i.key&&i.key.crv){case"P-256":return"ES256";case"secp256k1":return"ES256K";case"P-384":return"ES384";case"P-512":return"ES512"}let j=h.export({format:"der",type:"pkcs8"}),k=j[1]<128?17:18,l=j[k],m=j.slice(k+1,k+1+l);if(m.equals(b))return"ES256";if(m.equals(c))return"ES384";if(m.equals(e))return"ES512";if(m.equals(f))return"ES256K";throw TypeError("unsupported DPoP private key curve");case"rsa":case P&&"rsa-pss":var n=d,o=g,p=this.issuer.dpop_signing_alg_values_supported;if("object"==typeof o&&"jwk"===o.format&&o.key&&o.key.alg)return o.key.alg;if(Array.isArray(p)){let b=p.filter(RegExp.prototype.test.bind(a));return"rsa-pss"===n.asymmetricKeyType&&(b=b.filter(a=>a.startsWith("PS"))),["PS256","PS384","PS512","RS256","RS384","RS384"].find(a=>b.includes(a))}return"PS256";default:throw TypeError("unsupported DPoP private key")}};let a=/^(?:RS|PS)(?:256|384|512)$/,b=Buffer.from([42,134,72,206,61,3,1,7]),c=Buffer.from([43,129,4,0,34]),e=Buffer.from([43,129,4,0,35]),f=Buffer.from([43,129,4,0,10])}else d=$;let _=new WeakMap;async function aa(a,b){if("node:crypto"===m.cryptoRuntime&&"object"==typeof b&&"object"==typeof b.key&&"jwk"===b.format)return v(b.key,"kty","crv","x","y","e","n");if(_.has(b))return _.get(b);let c=v(await m.exportJWK(a),"kty","crv","x","y","e","n");return(o(b)||"WebCryptoAPI"===m.cryptoRuntime)&&_.set(b,c),c}b.exports=(a,b=!1)=>class extends Z{constructor(...c){super(a,b,...c)}static get issuer(){return a}},b.exports.BaseClient=Z},15707,(a,b,c)=>{b.exports=new(a.r(90124))({max:100})},28376,(a,b,c)=>{let d=/^\d+$/;b.exports=function(a){if("string"!=typeof a)throw TypeError("input must be a string");return(!function(a){if(a.includes("://"))return!0;let b=a.replace(/(\/|\?)/g,"#").split("#")[0];if(b.includes(":")){let a=b.indexOf(":"),c=b.slice(a+1);if(!d.test(c))return!0}return!1}(a)?!function(a){if(!a.includes("@"))return!1;let b=a.split("@"),c=b[b.length-1];return!(c.includes(":")||c.includes("/")||c.includes("?"))}(a)?`https://${a}`:`acct:${a}`:a).split("#")[0]}},65744,(a,b,c)=>{let{inspect:d}=a.r(24361),e=a.r(92509),{RPError:f}=a.r(56780),g=a.r(21108),h=a.r(15707),i=a.r(45499),j=a.r(28376),k=a.r(42262),l=a.r(23400),{keystore:m}=a.r(4859),n=["https://login.microsoftonline.com/common/.well-known/openid-configuration","https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration"],o=Symbol(),p={claim_types_supported:["normal"],claims_parameter_supported:!1,grant_types_supported:["authorization_code","implicit"],request_parameter_supported:!1,request_uri_parameter_supported:!0,require_request_uri_registration:!1,response_modes_supported:["query","fragment"],token_endpoint_auth_methods_supported:["client_secret_basic"]};class q{#k;constructor(a={}){const b=a[o];delete a[o],["introspection","revocation"].forEach(b=>{a[`${b}_endpoint`]&&void 0===a[`${b}_endpoint_auth_methods_supported`]&&void 0===a[`${b}_endpoint_auth_signing_alg_values_supported`]&&(a.token_endpoint_auth_methods_supported&&(a[`${b}_endpoint_auth_methods_supported`]=a.token_endpoint_auth_methods_supported),a.token_endpoint_auth_signing_alg_values_supported&&(a[`${b}_endpoint_auth_signing_alg_values_supported`]=a.token_endpoint_auth_signing_alg_values_supported))}),this.#k=new Map,Object.entries(a).forEach(([a,b])=>{this.#k.set(a,b),this[a]||Object.defineProperty(this,a,{get(){return this.#k.get(a)},enumerable:!0})}),h.set(this.issuer,this);const c=g(this,b);Object.defineProperties(this,{Client:{value:c,enumerable:!0},FAPI1Client:{value:class extends c{},enumerable:!0},FAPI2Client:{value:class extends c{},enumerable:!0}})}get metadata(){return l(Object.fromEntries(this.#k.entries()))}static async webfinger(a){let b=j(a),{host:c}=e.parse(b),d=`https://${c}/.well-known/webfinger`,g=i(await k.call(this,{method:"GET",url:d,responseType:"json",searchParams:{resource:b,rel:"http://openid.net/specs/connect/1.0/issuer"},headers:{Accept:"application/json"}})),l=Array.isArray(g.links)&&g.links.find(a=>"object"==typeof a&&"http://openid.net/specs/connect/1.0/issuer"===a.rel&&a.href);if(!l)throw new f({message:"no issuer found in webfinger response",body:g});if("string"!=typeof l.href||!l.href.startsWith("https://"))throw new f({printf:["invalid issuer location %s",l.href],body:g});let m=l.href;if(h.has(m))return h.get(m);let n=await this.discover(m);if(n.issuer!==m)throw h.del(n.issuer),new f("discovered issuer mismatch, expected %s, got: %s",m,n.issuer);return n}static async discover(a){let b=function(a){let b=e.parse(a);if(b.pathname.includes("/.well-known/"))return a;{let a;return a=b.pathname.endsWith("/")?`${b.pathname}.well-known/openid-configuration`:`${b.pathname}/.well-known/openid-configuration`,e.format({...b,pathname:a})}}(a),c=i(await k.call(this,{method:"GET",responseType:"json",url:b,headers:{Accept:"application/json"}}));return new q({...p,...c,[o]:!!n.find(a=>b.startsWith(a))})}async reloadJwksUri(){await m.call(this,!0)}[d.custom](){return`${this.constructor.name} ${d(this.metadata,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}}b.exports=q},88854,(a,b,c)=>{let d=a.r(92509),{format:e}=a.r(24361),f=a.r(23400),{RPError:g,OPError:h}=a.r(56780),{BaseClient:i}=a.r(21108),{random:j,codeChallenge:k}=a.r(7182),l=a.r(85412),{resolveResponseType:m,resolveRedirectUri:n}=a.r(7647);function o(a,b,c={}){a?this.error(a):b?this.success(b,c):this.fail(c)}function p({client:a,params:b={},passReqToCallback:c=!1,sessionKey:e,usePKCE:g=!0,extras:h={}}={},j){if(!(a instanceof i))throw TypeError("client must be an instance of openid-client Client");if("function"!=typeof j)throw TypeError("verify callback must be a function");if(!a.issuer||!a.issuer.issuer)throw TypeError("client must have an issuer with an identifier");if(this._client=a,this._issuer=a.issuer,this._verify=j,this._passReqToCallback=c,this._usePKCE=g,this._key=e||`oidc:${d.parse(this._issuer.issuer).hostname}`,this._params=f(b),delete this._params.state,delete this._params.nonce,this._extras=f(h),this._params.response_type||(this._params.response_type=m.call(a)),this._params.redirect_uri||(this._params.redirect_uri=n.call(a)),this._params.scope||(this._params.scope="openid"),!0===this._usePKCE){let a=!!Array.isArray(this._issuer.code_challenge_methods_supported)&&this._issuer.code_challenge_methods_supported;if(a&&a.includes("S256"))this._usePKCE="S256";else if(a&&a.includes("plain"))this._usePKCE="plain";else if(a)throw TypeError("neither code_challenge_method supported by the client is supported by the issuer");else this._usePKCE="S256"}else if("string"==typeof this._usePKCE&&!["plain","S256"].includes(this._usePKCE))throw TypeError(`${this._usePKCE} is not valid/implemented PKCE code_challenge_method`);this.name=d.parse(a.issuer.issuer).hostname}p.prototype.authenticate=function(a,b){(async()=>{let c=this._client;if(!a.session)throw TypeError("authentication requires session support");let d=c.callbackParams(a),f=this._key,{0:h,length:i}=Object.keys(d);if(0===i||1===i&&"iss"===h){let d={state:j(),...this._params,...b};if(!d.nonce&&d.response_type.includes("id_token")&&(d.nonce=j()),a.session[f]=l(d,"nonce","state","max_age","response_type"),this._usePKCE&&d.response_type.includes("code")){let b=j();switch(a.session[f].code_verifier=b,this._usePKCE){case"S256":d.code_challenge=k(b),d.code_challenge_method="S256";break;case"plain":d.code_challenge=b}}this.redirect(c.authorizationUrl(d));return}let m=a.session[f];if(0===Object.keys(m||{}).length)throw Error(e('did not find expected authorization request details in session, req.session["%s"] is %j',f,m));let{state:n,nonce:p,max_age:q,code_verifier:r,response_type:s}=m;try{delete a.session[f]}catch(a){}let t={redirect_uri:this._params.redirect_uri,...b},u=await c.callback(t.redirect_uri,d,{state:n,nonce:p,max_age:q,code_verifier:r,response_type:s},this._extras),v=this._passReqToCallback,w=this._verify.length>(v?3:2)&&c.issuer.userinfo_endpoint,x=[u,o.bind(this)];if(w){if(!u.access_token)throw new g({message:"expected access_token to be returned when asking for userinfo in verify callback",tokenset:u});let a=await c.userinfo(u);x.splice(1,0,a)}v&&x.unshift(a),this._verify(...x)})().catch(a=>{a instanceof h&&"server_error"!==a.error&&!a.error.startsWith("invalid")||a instanceof g?this.fail(a):this.error(a)})},b.exports=p},22475,(a,b,c)=>{let d=a.r(65744),{OPError:e,RPError:f}=a.r(56780),g=a.r(88854),h=a.r(27317),{CLOCK_TOLERANCE:i,HTTP_OPTIONS:j}=a.r(82471),k=a.r(7182),{setDefaults:l}=a.r(42262);b.exports={Issuer:d,Strategy:g,TokenSet:h,errors:{OPError:e,RPError:f},custom:{setHttpOptionsDefaults:l,http_options:j,clock_tolerance:i},generators:k}},23242,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.openidClient=e;var d=a.r(22475);async function e(a){let b,c=a.provider;if(c.httpOptions&&d.custom.setHttpOptionsDefaults(c.httpOptions),c.wellKnown)b=await d.Issuer.discover(c.wellKnown);else{var e,f,g;b=new d.Issuer({issuer:c.issuer,authorization_endpoint:null==(e=c.authorization)?void 0:e.url,token_endpoint:null==(f=c.token)?void 0:f.url,userinfo_endpoint:null==(g=c.userinfo)?void 0:g.url,jwks_uri:c.jwks_endpoint})}let h=new b.Client({client_id:c.clientId,client_secret:c.clientSecret,redirect_uris:[c.callbackUrl],...c.client},c.jwks);return h[d.custom.clock_tolerance]=10,h}},22417,(a,b,c)=>{function d(a){for(var b,c,d="",e=-1;++e<a.length;)b=a.charCodeAt(e),c=e+1<a.length?a.charCodeAt(e+1):0,55296<=b&&b<=56319&&56320<=c&&c<=57343&&(b=65536+((1023&b)<<10)+(1023&c),e++),b<=127?d+=String.fromCharCode(b):b<=2047?d+=String.fromCharCode(192|b>>>6&31,128|63&b):b<=65535?d+=String.fromCharCode(224|b>>>12&15,128|b>>>6&63,128|63&b):b<=2097151&&(d+=String.fromCharCode(240|b>>>18&7,128|b>>>12&63,128|b>>>6&63,128|63&b));return d}function e(a){for(var b=Array(a.length>>2),c=0;c<b.length;c++)b[c]=0;for(var c=0;c<8*a.length;c+=8)b[c>>5]|=(255&a.charCodeAt(c/8))<<24-c%32;return b}function f(a,b){a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;for(var c=Array(80),d=0x67452301,e=-0x10325477,f=-0x67452302,i=0x10325476,j=-0x3c2d1e10,k=0;k<a.length;k+=16){for(var l=d,m=e,n=f,o=i,p=j,q=0;q<80;q++){q<16?c[q]=a[k+q]:c[q]=h(c[q-3]^c[q-8]^c[q-14]^c[q-16],1);var r,s,t,u,v,w=g(g(h(d,5),(r=q,s=e,t=f,u=i,r<20?s&t|~s&u:r<40?s^t^u:r<60?s&t|s&u|t&u:s^t^u)),g(g(j,c[q]),(v=q)<20?0x5a827999:v<40?0x6ed9eba1:v<60?-0x70e44324:-0x359d3e2a));j=i,i=f,f=h(e,30),e=d,d=w}d=g(d,l),e=g(e,m),f=g(f,n),i=g(i,o),j=g(j,p)}return[d,e,f,i,j]}function g(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c}function h(a,b){return a<<b|a>>>32-b}c.HMACSHA1=function(a,b){return function(a){for(var b="",c=a.length,d=0;d<c;d+=3)for(var e=a.charCodeAt(d)<<16|(d+1<c?a.charCodeAt(d+1)<<8:0)|(d+2<c?a.charCodeAt(d+2):0),f=0;f<4;f++)8*d+6*f>8*a.length?b+="=":b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6*(3-f)&63);return b}(function(a,b){var c=e(a);c.length>16&&(c=f(c,8*a.length));for(var d=Array(16),g=Array(16),h=0;h<16;h++)d[h]=0x36363636^c[h],g[h]=0x5c5c5c5c^c[h];for(var i=f(d.concat(e(b)),512+8*b.length),j=f(g.concat(i),672),k="",l=0;l<32*j.length;l+=8)k+=String.fromCharCode(j[l>>5]>>>24-l%32&255);return k}(d(a),d(b)))}},38647,(a,b,c)=>{b.exports.isAnEarlyCloseHost=function(a){return a&&a.match(".*google(apis)?.com$")}},51957,(a,b,c)=>{var d=a.r(54799),e=a.r(22417),f=a.r(21517),g=a.r(24836),h=a.r(92509),i=a.r(45706),j=a.r(38647);c.OAuth=function(a,b,c,d,e,f,g,h,i){if(this._isEcho=!1,this._requestUrl=a,this._accessUrl=b,this._consumerKey=c,this._consumerSecret=this._encodeData(d),"RSA-SHA1"==g&&(this._privateKey=d),this._version=e,void 0===f?this._authorize_callback="oob":this._authorize_callback=f,"PLAINTEXT"!=g&&"HMAC-SHA1"!=g&&"RSA-SHA1"!=g)throw Error("Un-supported signature method: "+g);this._signatureMethod=g,this._nonceSize=h||32,this._headers=i||{Accept:"*/*",Connection:"close","User-Agent":"Node authentication"},this._clientOptions=this._defaultClientOptions={requestTokenHttpMethod:"POST",accessTokenHttpMethod:"POST",followRedirects:!0},this._oauthParameterSeperator=","},c.OAuthEcho=function(a,b,c,d,e,f,g,h){if(this._isEcho=!0,this._realm=a,this._verifyCredentials=b,this._consumerKey=c,this._consumerSecret=this._encodeData(d),"RSA-SHA1"==f&&(this._privateKey=d),this._version=e,"PLAINTEXT"!=f&&"HMAC-SHA1"!=f&&"RSA-SHA1"!=f)throw Error("Un-supported signature method: "+f);this._signatureMethod=f,this._nonceSize=g||32,this._headers=h||{Accept:"*/*",Connection:"close","User-Agent":"Node authentication"},this._oauthParameterSeperator=","},c.OAuthEcho.prototype=c.OAuth.prototype,c.OAuth.prototype._getTimestamp=function(){return Math.floor(new Date().getTime()/1e3)},c.OAuth.prototype._encodeData=function(a){return null==a||""==a?"":encodeURIComponent(a).replace(/\!/g,"%21").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")},c.OAuth.prototype._decodeData=function(a){return null!=a&&(a=a.replace(/\+/g," ")),decodeURIComponent(a)},c.OAuth.prototype._getSignature=function(a,b,c,d){var e=this._createSignatureBase(a,b,c);return this._createSignature(e,d)},c.OAuth.prototype._normalizeUrl=function(a){var b=h.parse(a,!0),c="";return b.port&&("http:"==b.protocol&&"80"!=b.port||"https:"==b.protocol&&"443"!=b.port)&&(c=":"+b.port),b.pathname&&""!=b.pathname||(b.pathname="/"),b.protocol+"//"+b.hostname+c+b.pathname},c.OAuth.prototype._isParameterNameAnOAuthParameter=function(a){var b=a.match("^oauth_");return!!b&&"oauth_"===b[0]},c.OAuth.prototype._buildAuthorizationHeaders=function(a){var b="OAuth ";this._isEcho&&(b+='realm="'+this._realm+'",');for(var c=0;c<a.length;c++)this._isParameterNameAnOAuthParameter(a[c][0])&&(b+=""+this._encodeData(a[c][0])+'="'+this._encodeData(a[c][1])+'"'+this._oauthParameterSeperator);return b.substring(0,b.length-this._oauthParameterSeperator.length)},c.OAuth.prototype._makeArrayOfArgumentsHash=function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];if(Array.isArray(d))for(var e=0;e<d.length;e++)b[b.length]=[c,d[e]];else b[b.length]=[c,d]}return b},c.OAuth.prototype._sortRequestParams=function(a){return a.sort(function(a,b){return a[0]==b[0]?a[1]<b[1]?-1:1:a[0]<b[0]?-1:1}),a},c.OAuth.prototype._normaliseRequestParams=function(a){for(var b=this._makeArrayOfArgumentsHash(a),c=0;c<b.length;c++)b[c][0]=this._encodeData(b[c][0]),b[c][1]=this._encodeData(b[c][1]);b=this._sortRequestParams(b);for(var a="",c=0;c<b.length;c++)a+=b[c][0],a+="=",a+=b[c][1],c<b.length-1&&(a+="&");return a},c.OAuth.prototype._createSignatureBase=function(a,b,c){return b=this._encodeData(this._normalizeUrl(b)),c=this._encodeData(c),a.toUpperCase()+"&"+b+"&"+c},c.OAuth.prototype._createSignature=function(a,b){if(void 0===b)var b="";else b=this._encodeData(b);var c=this._consumerSecret+"&"+b,f="";return"PLAINTEXT"==this._signatureMethod?f=c:"RSA-SHA1"==this._signatureMethod?(c=this._privateKey||"",f=d.createSign("RSA-SHA1").update(a).sign(c,"base64")):f=d.Hmac?d.createHmac("sha1",c).update(a).digest("base64"):e.HMACSHA1(c,a),f},c.OAuth.prototype.NONCE_CHARS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9"],c.OAuth.prototype._getNonce=function(a){for(var b,c=[],d=this.NONCE_CHARS,e=d.length,f=0;f<a;f++)b=Math.floor(Math.random()*e),c[f]=d[b];return c.join("")},c.OAuth.prototype._createClient=function(a,b,c,d,e,h){return(h?g:f).request({host:b,port:a,path:d,method:c,headers:e})},c.OAuth.prototype._prepareParameters=function(a,b,c,d,e){var f={oauth_timestamp:this._getTimestamp(),oauth_nonce:this._getNonce(this._nonceSize),oauth_version:this._version,oauth_signature_method:this._signatureMethod,oauth_consumer_key:this._consumerKey};if(a&&(f.oauth_token=a),this._isEcho)k=this._getSignature("GET",this._verifyCredentials,this._normaliseRequestParams(f),b);else{if(e)for(var g in e)e.hasOwnProperty(g)&&(f[g]=e[g]);var j=h.parse(d,!1);if(j.query){var k,l,m=i.parse(j.query);for(var g in m){var n=m[g];if("object"==typeof n)for(l in n)f[g+"["+l+"]"]=n[l];else f[g]=n}}k=this._getSignature(c,d,this._normaliseRequestParams(f),b)}var o=this._sortRequestParams(this._makeArrayOfArgumentsHash(f));return o[o.length]=["oauth_signature",k],o},c.OAuth.prototype._performSecureRequest=function(a,b,c,d,e,f,g,k){var l,m,n=this._prepareParameters(a,b,c,d,e);g||(g="application/x-www-form-urlencoded");var o=h.parse(d,!1);"http:"!=o.protocol||o.port||(o.port=80),"https:"!=o.protocol||o.port||(o.port=443);var p={},q=this._buildAuthorizationHeaders(n);for(var r in this._isEcho?p["X-Verify-Credentials-Authorization"]=q:p.Authorization=q,p.Host=o.host,this._headers)this._headers.hasOwnProperty(r)&&(p[r]=this._headers[r]);for(var r in e)this._isParameterNameAnOAuthParameter(r)&&delete e[r];("POST"==c||"PUT"==c)&&null==f&&null!=e&&(f=i.stringify(e).replace(/\!/g,"%21").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")),f?Buffer.isBuffer(f)?p["Content-length"]=f.length:p["Content-length"]=Buffer.byteLength(f):p["Content-length"]=0,p["Content-Type"]=g,o.pathname&&""!=o.pathname||(o.pathname="/"),l=o.query?o.pathname+"?"+o.query:o.pathname,m="https:"==o.protocol?this._createClient(o.port,o.hostname,c,l,p,!0):this._createClient(o.port,o.hostname,c,l,p);var s=this._clientOptions;if(!k)return("POST"==c||"PUT"==c)&&null!=f&&""!=f&&m.write(f),m;var t="",u=this,v=j.isAnEarlyCloseHost(o.hostname),w=!1,x=function(d){w||(w=!0,d.statusCode>=200&&d.statusCode<=299?k(null,t,d):(301==d.statusCode||302==d.statusCode)&&s.followRedirects&&d.headers&&d.headers.location?u._performSecureRequest(a,b,c,d.headers.location,e,f,g,k):k({statusCode:d.statusCode,data:t},t,d))};m.on("response",function(a){a.setEncoding("utf8"),a.on("data",function(a){t+=a}),a.on("end",function(){x(a)}),a.on("close",function(){v&&x(a)})}),m.on("error",function(a){w||(w=!0,k(a))}),("POST"==c||"PUT"==c)&&null!=f&&""!=f&&m.write(f),m.end()},c.OAuth.prototype.setClientOptions=function(a){var b,c={},d=Object.prototype.hasOwnProperty;for(b in this._defaultClientOptions)d.call(a,b)?c[b]=a[b]:c[b]=this._defaultClientOptions[b];this._clientOptions=c},c.OAuth.prototype.getOAuthAccessToken=function(a,b,c,d){var e={};"function"==typeof c?d=c:e.oauth_verifier=c,this._performSecureRequest(a,b,this._clientOptions.accessTokenHttpMethod,this._accessUrl,e,null,null,function(a,b,c){if(a)d(a);else{var e=i.parse(b),f=e.oauth_token;delete e.oauth_token;var g=e.oauth_token_secret;delete e.oauth_token_secret,d(null,f,g,e)}})},c.OAuth.prototype.getProtectedResource=function(a,b,c,d,e){this._performSecureRequest(c,d,b,a,null,"",null,e)},c.OAuth.prototype.delete=function(a,b,c,d){return this._performSecureRequest(b,c,"DELETE",a,null,"",null,d)},c.OAuth.prototype.get=function(a,b,c,d){return this._performSecureRequest(b,c,"GET",a,null,"",null,d)},c.OAuth.prototype._putOrPost=function(a,b,c,d,e,f,g){var h=null;return"function"==typeof f&&(g=f,f=null),"string"==typeof e||Buffer.isBuffer(e)||(f="application/x-www-form-urlencoded",h=e,e=null),this._performSecureRequest(c,d,a,b,h,e,f,g)},c.OAuth.prototype.put=function(a,b,c,d,e,f){return this._putOrPost("PUT",a,b,c,d,e,f)},c.OAuth.prototype.post=function(a,b,c,d,e,f){return this._putOrPost("POST",a,b,c,d,e,f)},c.OAuth.prototype.getOAuthRequestToken=function(a,b){"function"==typeof a&&(b=a,a={}),this._authorize_callback&&(a.oauth_callback=this._authorize_callback),this._performSecureRequest(null,null,this._clientOptions.requestTokenHttpMethod,this._requestUrl,a,null,null,function(a,c,d){if(a)b(a);else{var e=i.parse(c),f=e.oauth_token,g=e.oauth_token_secret;delete e.oauth_token,delete e.oauth_token_secret,b(null,f,g,e)}})},c.OAuth.prototype.signUrl=function(a,b,c,d){if(void 0===d)var d="GET";for(var e=this._prepareParameters(b,c,d,a,{}),f=h.parse(a,!1),g="",i=0;i<e.length;i++)g+=e[i][0]+"="+this._encodeData(e[i][1])+"&";return g=g.substring(0,g.length-1),f.protocol+"//"+f.host+f.pathname+"?"+g},c.OAuth.prototype.authHeader=function(a,b,c,d){if(void 0===d)var d="GET";var e=this._prepareParameters(b,c,d,a,{});return this._buildAuthorizationHeaders(e)}},93257,(a,b,c)=>{var d=a.r(45706),e=(a.r(54799),a.r(24836)),f=a.r(21517),g=a.r(92509),h=a.r(38647);c.OAuth2=function(a,b,c,d,e,f){this._clientId=a,this._clientSecret=b,this._baseSite=c,this._authorizeUrl=d||"/oauth/authorize",this._accessTokenUrl=e||"/oauth/access_token",this._accessTokenName="access_token",this._authMethod="Bearer",this._customHeaders=f||{},this._useAuthorizationHeaderForGET=!1,this._agent=void 0},c.OAuth2.prototype.setAgent=function(a){this._agent=a},c.OAuth2.prototype.setAccessTokenName=function(a){this._accessTokenName=a},c.OAuth2.prototype.setAuthMethod=function(a){this._authMethod=a},c.OAuth2.prototype.useAuthorizationHeaderforGET=function(a){this._useAuthorizationHeaderForGET=a},c.OAuth2.prototype._getAccessTokenUrl=function(){return this._baseSite+this._accessTokenUrl},c.OAuth2.prototype.buildAuthHeader=function(a){return this._authMethod+" "+a},c.OAuth2.prototype._chooseHttpLibrary=function(a){var b=e;return"https:"!=a.protocol&&(b=f),b},c.OAuth2.prototype._request=function(a,b,c,e,f,h){var i=g.parse(b,!0);"https:"!=i.protocol||i.port||(i.port=443);var j=this._chooseHttpLibrary(i),k={};for(var l in this._customHeaders)k[l]=this._customHeaders[l];if(c)for(var l in c)k[l]=c[l];k.Host=i.host,k["User-Agent"]||(k["User-Agent"]="Node-oauth"),e?Buffer.isBuffer(e)?k["Content-Length"]=e.length:k["Content-Length"]=Buffer.byteLength(e):k["Content-length"]=0,!f||"Authorization"in k||(i.query||(i.query={}),i.query[this._accessTokenName]=f);var m=d.stringify(i.query);m&&(m="?"+m);var n={host:i.hostname,port:i.port,path:i.pathname+m,method:a,headers:k};this._executeRequest(j,n,e,h)},c.OAuth2.prototype._executeRequest=function(a,b,c,d){var e=h.isAnEarlyCloseHost(b.host),f=!1;function g(a,b){f||(f=!0,a.statusCode>=200&&a.statusCode<=299||301==a.statusCode||302==a.statusCode?d(null,b,a):d({statusCode:a.statusCode,data:b}))}var i="";this._agent&&(b.agent=this._agent);var j=a.request(b);j.on("response",function(a){a.on("data",function(a){i+=a}),a.on("close",function(b){e&&g(a,i)}),a.addListener("end",function(){g(a,i)})}),j.on("error",function(a){f=!0,d(a)}),("POST"==b.method||"PUT"==b.method)&&c&&j.write(c),j.end()},c.OAuth2.prototype.getAuthorizeUrl=function(a){var a=a||{};return a.client_id=this._clientId,this._baseSite+this._authorizeUrl+"?"+d.stringify(a)},c.OAuth2.prototype.getOAuthAccessToken=function(a,b,c){var b=b||{};b.client_id=this._clientId,b.client_secret=this._clientSecret;var e="refresh_token"===b.grant_type?"refresh_token":"code";b[e]=a;var f=d.stringify(b);this._request("POST",this._getAccessTokenUrl(),{"Content-Type":"application/x-www-form-urlencoded"},f,null,function(a,b,e){if(a)c(a);else{try{f=JSON.parse(b)}catch(a){f=d.parse(b)}var f,g=f.access_token,h=f.refresh_token;delete f.refresh_token,c(null,g,h,f)}})},c.OAuth2.prototype.getProtectedResource=function(a,b,c){this._request("GET",a,{},"",b,c)},c.OAuth2.prototype.get=function(a,b,c){if(this._useAuthorizationHeaderForGET){var d={Authorization:this.buildAuthHeader(b)};b=null}else d={};this._request("GET",a,d,"",b,c)}},74362,(a,b,c)=>{c.OAuth=a.r(51957).OAuth,c.OAuthEcho=a.r(51957).OAuthEcho,c.OAuth2=a.r(93257).OAuth2},52702,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.oAuth1Client=function(a){var b,c;let e=a.provider,f=new d.OAuth(e.requestTokenUrl,e.accessTokenUrl,e.clientId,e.clientSecret,null!=(b=e.version)?b:"1.0",e.callbackUrl,null!=(c=e.encoding)?c:"HMAC-SHA1"),g=f.get.bind(f);f.get=async(...a)=>await new Promise((b,c)=>{g(...a,(a,d)=>{if(a)return c(a);b(d)})});let h=f.getOAuthAccessToken.bind(f);f.getOAuthAccessToken=async(...a)=>await new Promise((b,c)=>{h(...a,(a,d,e)=>{if(a)return c(a);b({oauth_token:d,oauth_token_secret:e})})});let i=f.getOAuthRequestToken.bind(f);return f.getOAuthRequestToken=async(a={})=>await new Promise((b,c)=>{i(a,(a,d,e,f)=>{if(a)return c(a);b({oauth_token:d,oauth_token_secret:e,params:f})})}),f},c.oAuth1TokenStore=void 0;var d=a.r(74362);c.oAuth1TokenStore=new Map},36933,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799);c.default=(a,b)=>(0,d.createHash)(a).update(b).digest()},77504,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.concatKdf=c.lengthAndInput=c.uint32be=c.uint64be=c.p2s=c.concat=c.decoder=c.encoder=void 0;let d=a.r(36933);function e(...a){let b=new Uint8Array(a.reduce((a,{length:b})=>a+b,0)),c=0;return a.forEach(a=>{b.set(a,c),c+=a.length}),b}function f(a,b,c){if(b<0||b>=0x100000000)throw RangeError(`value must be >= 0 and <= ${0x100000000-1}. Received ${b}`);a.set([b>>>24,b>>>16,b>>>8,255&b],c)}function g(a){let b=new Uint8Array(4);return f(b,a),b}c.encoder=new TextEncoder,c.decoder=new TextDecoder,c.concat=e,c.p2s=function(a,b){return e(c.encoder.encode(a),new Uint8Array([0]),b)},c.uint64be=function(a){let b=Math.floor(a/0x100000000),c=new Uint8Array(8);return f(c,b,0),f(c,a%0x100000000,4),c},c.uint32be=g,c.lengthAndInput=function(a){return e(g(a.length),a)},c.concatKdf=async function(a,b,c){let e=Math.ceil((b>>3)/32),f=new Uint8Array(32*e);for(let b=0;b<e;b++){let e=new Uint8Array(4+a.length+c.length);e.set(g(b+1)),e.set(a,4),e.set(c,4+a.length),f.set(await (0,d.default)("sha256",e),32*b)}return f.slice(0,b>>3)}},53214,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decode=c.encode=c.encodeBase64=c.decodeBase64=void 0;let d=a.r(874),e=a.r(77504);d.Buffer.isEncoding("base64url")?c.encode=a=>d.Buffer.from(a).toString("base64url"):c.encode=a=>d.Buffer.from(a).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),c.decodeBase64=a=>d.Buffer.from(a,"base64"),c.encodeBase64=a=>d.Buffer.from(a).toString("base64"),c.decode=a=>{let b;return d.Buffer.from(((b=a)instanceof Uint8Array&&(b=e.decoder.decode(b)),b),"base64")}},57706,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWSSignatureVerificationFailed=c.JWKSTimeout=c.JWKSMultipleMatchingKeys=c.JWKSNoMatchingKey=c.JWKSInvalid=c.JWKInvalid=c.JWTInvalid=c.JWSInvalid=c.JWEInvalid=c.JWEDecompressionFailed=c.JWEDecryptionFailed=c.JOSENotSupported=c.JOSEAlgNotAllowed=c.JWTExpired=c.JWTClaimValidationFailed=c.JOSEError=void 0;class d extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(a){var b;super(a),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null==(b=Error.captureStackTrace)||b.call(Error,this,this.constructor)}}c.JOSEError=d,c.JWTClaimValidationFailed=class extends d{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(a,b="unspecified",c="unspecified"){super(a),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=b,this.reason=c}},c.JWTExpired=class extends d{static get code(){return"ERR_JWT_EXPIRED"}constructor(a,b="unspecified",c="unspecified"){super(a),this.code="ERR_JWT_EXPIRED",this.claim=b,this.reason=c}},c.JOSEAlgNotAllowed=class extends d{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}},c.JOSENotSupported=class extends d{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}},c.JWEDecryptionFailed=class extends d{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}},c.JWEDecompressionFailed=class extends d{constructor(){super(...arguments),this.code="ERR_JWE_DECOMPRESSION_FAILED",this.message="decompression operation failed"}static get code(){return"ERR_JWE_DECOMPRESSION_FAILED"}},c.JWEInvalid=class extends d{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}},c.JWSInvalid=class extends d{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}},c.JWTInvalid=class extends d{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}},c.JWKInvalid=class extends d{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}},c.JWKSInvalid=class extends d{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}},c.JWKSNoMatchingKey=class extends d{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}},c.JWKSMultipleMatchingKeys=class extends d{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}},c.JWKSTimeout=class extends d{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}},c.JWSSignatureVerificationFailed=class extends d{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}},71742,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=a.r(54799);Object.defineProperty(c,"default",{enumerable:!0,get:function(){return d.randomFillSync}})},61061,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.bitLength=void 0;let d=a.r(57706),e=a.r(71742);function f(a){switch(a){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new d.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}c.bitLength=f,c.default=a=>(0,e.default)(new Uint8Array(f(a)>>3))},57790,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(57706),e=a.r(61061);c.default=(a,b)=>{if(b.length<<3!==(0,e.bitLength)(a))throw new d.JWEInvalid("Invalid Initialization Vector length")}},98331,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(24361);c.default=e.types.isKeyObject?a=>e.types.isKeyObject(a):a=>null!=a&&a instanceof d.KeyObject},50926,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(57706),e=a.r(98331);c.default=(a,b)=>{let c;switch(a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(a.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(a.slice(1,4),10);break;default:throw new d.JOSENotSupported(`Content Encryption Algorithm ${a} is not supported either by JOSE or your javascript runtime`)}if(b instanceof Uint8Array){let a=b.byteLength<<3;if(a!==c)throw new d.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${a} bits`);return}if((0,e.default)(b)&&"secret"===b.type){let a=b.symmetricKeySize<<3;if(a!==c)throw new d.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${a} bits`);return}throw TypeError("Invalid Content Encryption Key type")}},78247,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=a.r(54799).timingSafeEqual},65879,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(77504);c.default=function(a,b,c,f,g,h){let i=(0,e.concat)(a,b,c,(0,e.uint64be)(a.length<<3)),j=(0,d.createHmac)(`sha${f}`,g);return j.update(i),j.digest().slice(0,h>>3)}},76663,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.isCryptoKey=void 0;let d=a.r(54799),e=a.r(24361);c.default=d.webcrypto,c.isCryptoKey=e.types.isCryptoKey?a=>e.types.isCryptoKey(a):a=>!1},70823,(a,b,c)=>{"use strict";function d(a,b="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${b} must be ${a}`)}function e(a,b){return a.name===b}function f(a){return parseInt(a.name.slice(4),10)}function g(a,b){if(b.length&&!b.some(b=>a.usages.includes(b))){let a="CryptoKey does not support this operation, its usages must include ";if(b.length>2){let c=b.pop();a+=`one of ${b.join(", ")}, or ${c}.`}else 2===b.length?a+=`one of ${b[0]} or ${b[1]}.`:a+=`${b[0]}.`;throw TypeError(a)}}Object.defineProperty(c,"__esModule",{value:!0}),c.checkEncCryptoKey=c.checkSigCryptoKey=void 0,c.checkSigCryptoKey=function(a,b,...c){switch(b){case"HS256":case"HS384":case"HS512":{if(!e(a.algorithm,"HMAC"))throw d("HMAC");let c=parseInt(b.slice(2),10);if(f(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!e(a.algorithm,"RSASSA-PKCS1-v1_5"))throw d("RSASSA-PKCS1-v1_5");let c=parseInt(b.slice(2),10);if(f(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!e(a.algorithm,"RSA-PSS"))throw d("RSA-PSS");let c=parseInt(b.slice(2),10);if(f(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==a.algorithm.name&&"Ed448"!==a.algorithm.name)throw d("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!e(a.algorithm,"ECDSA"))throw d("ECDSA");let c=function(a){switch(a){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(b);if(a.algorithm.namedCurve!==c)throw d(c,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}g(a,c)},c.checkEncCryptoKey=function(a,b,...c){switch(b){case"A128GCM":case"A192GCM":case"A256GCM":{if(!e(a.algorithm,"AES-GCM"))throw d("AES-GCM");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw d(c,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!e(a.algorithm,"AES-KW"))throw d("AES-KW");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw d(c,"algorithm.length");break}case"ECDH":switch(a.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw d("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!e(a.algorithm,"PBKDF2"))throw d("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!e(a.algorithm,"RSA-OAEP"))throw d("RSA-OAEP");let c=parseInt(b.slice(9),10)||1;if(f(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}g(a,c)}},46061,(a,b,c)=>{"use strict";function d(a,b,...c){if(c.length>2){let b=c.pop();a+=`one of type ${c.join(", ")}, or ${b}.`}else 2===c.length?a+=`one of type ${c[0]} or ${c[1]}.`:a+=`of type ${c[0]}.`;return null==b?a+=` Received ${b}`:"function"==typeof b&&b.name?a+=` Received function ${b.name}`:"object"==typeof b&&null!=b&&b.constructor&&b.constructor.name&&(a+=` Received an instance of ${b.constructor.name}`),a}Object.defineProperty(c,"__esModule",{value:!0}),c.withAlg=void 0,c.default=(a,...b)=>d("Key must be ",a,...b),c.withAlg=function(a,b,...c){return d(`Key for the ${a} algorithm must be `,b,...c)}},97066,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});let e=a.r(54799);c.default=a=>(d||(d=new Set((0,e.getCiphers)())),d.has(a))},60419,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.types=void 0;let d=a.r(76663),e=a.r(98331);c.default=a=>(0,e.default)(a)||(0,d.isCryptoKey)(a);let f=["KeyObject"];c.types=f,(globalThis.CryptoKey||(null===d.default||void 0===d.default?void 0:d.default.CryptoKey))&&f.push("CryptoKey")},14380,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(57790),f=a.r(50926),g=a.r(77504),h=a.r(57706),i=a.r(78247),j=a.r(65879),k=a.r(76663),l=a.r(70823),m=a.r(98331),n=a.r(46061),o=a.r(97066),p=a.r(60419);c.default=(a,b,c,q,r,s)=>{let t;if((0,k.isCryptoKey)(b))(0,l.checkEncCryptoKey)(b,a,"decrypt"),t=d.KeyObject.from(b);else if(b instanceof Uint8Array||(0,m.default)(b))t=b;else throw TypeError((0,n.default)(b,...p.types,"Uint8Array"));switch((0,f.default)(a,t),(0,e.default)(a,q),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(a,b,c,e,f,k){let l,n,p=parseInt(a.slice(1,4),10);(0,m.default)(b)&&(b=b.export());let q=b.subarray(p>>3),r=b.subarray(0,p>>3),s=parseInt(a.slice(-3),10),t=`aes-${p}-cbc`;if(!(0,o.default)(t))throw new h.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let u=(0,j.default)(k,e,c,s,r,p);try{l=(0,i.default)(f,u)}catch{}if(!l)throw new h.JWEDecryptionFailed;try{let a=(0,d.createDecipheriv)(t,q,e);n=(0,g.concat)(a.update(c),a.final())}catch{}if(!n)throw new h.JWEDecryptionFailed;return n}(a,t,c,q,r,s);case"A128GCM":case"A192GCM":case"A256GCM":var u=t;let v=parseInt(a.slice(1,4),10),w=`aes-${v}-gcm`;if(!(0,o.default)(w))throw new h.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);try{let a=(0,d.createDecipheriv)(w,u,q,{authTagLength:16});a.setAuthTag(r),s.byteLength&&a.setAAD(s,{plaintextLength:c.length});let b=a.update(c);return a.final(),b}catch{throw new h.JWEDecryptionFailed}default:throw new h.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},40739,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.deflate=c.inflate=void 0;let d=a.r(24361),e=a.r(6461),f=a.r(57706),g=(0,d.promisify)(e.inflateRaw),h=(0,d.promisify)(e.deflateRaw);c.inflate=a=>g(a,{maxOutputLength:25e4}).catch(()=>{throw new f.JWEDecompressionFailed}),c.deflate=a=>h(a)},62262,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=(...a)=>{let b,c=a.filter(Boolean);if(0===c.length||1===c.length)return!0;for(let a of c){let c=Object.keys(a);if(!b||0===b.size){b=new Set(c);continue}for(let a of c){if(b.has(a))return!1;b.add(a)}}return!0}},75478,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){if("object"!=typeof a||null===a||"[object Object]"!==Object.prototype.toString.call(a))return!1;if(null===Object.getPrototypeOf(a))return!0;let b=a;for(;null!==Object.getPrototypeOf(b);)b=Object.getPrototypeOf(b);return Object.getPrototypeOf(a)===b}},10556,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.unwrap=c.wrap=void 0;let d=a.r(874),e=a.r(54799),f=a.r(57706),g=a.r(77504),h=a.r(76663),i=a.r(70823),j=a.r(98331),k=a.r(46061),l=a.r(97066),m=a.r(60419);function n(a,b){if(a.symmetricKeySize<<3!==parseInt(b.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${b}`)}function o(a,b,c){if((0,j.default)(a))return a;if(a instanceof Uint8Array)return(0,e.createSecretKey)(a);if((0,h.isCryptoKey)(a))return(0,i.checkEncCryptoKey)(a,b,c),e.KeyObject.from(a);throw TypeError((0,k.default)(a,...m.types,"Uint8Array"))}c.wrap=(a,b,c)=>{let h=parseInt(a.slice(1,4),10),i=`aes${h}-wrap`;if(!(0,l.default)(i))throw new f.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`);let j=o(b,a,"wrapKey");n(j,a);let k=(0,e.createCipheriv)(i,j,d.Buffer.alloc(8,166));return(0,g.concat)(k.update(c),k.final())},c.unwrap=(a,b,c)=>{let h=parseInt(a.slice(1,4),10),i=`aes${h}-wrap`;if(!(0,l.default)(i))throw new f.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`);let j=o(b,a,"unwrapKey");n(j,a);let k=(0,e.createDecipheriv)(i,j,d.Buffer.alloc(8,166));return(0,g.concat)(k.update(c),k.final())}},31720,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.setCurve=c.weakMap=void 0;let d=a.r(874),e=a.r(54799),f=a.r(57706),g=a.r(76663),h=a.r(98331),i=a.r(46061),j=a.r(60419),k=d.Buffer.from([42,134,72,206,61,3,1,7]),l=d.Buffer.from([43,129,4,0,34]),m=d.Buffer.from([43,129,4,0,35]),n=d.Buffer.from([43,129,4,0,10]);c.weakMap=new WeakMap;let o=(a,b)=>{var d;let p;if((0,g.isCryptoKey)(a))p=e.KeyObject.from(a);else if((0,h.default)(a))p=a;else throw TypeError((0,i.default)(a,...j.types));if("secret"===p.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(p.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${p.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${p.asymmetricKeyType.slice(1)}`;case"ec":{if(c.weakMap.has(p))return c.weakMap.get(p);let a=null==(d=p.asymmetricKeyDetails)?void 0:d.namedCurve;if(a||"private"!==p.type){if(!a){let b=p.export({format:"der",type:"spki"}),c=b[1]<128?14:15,d=b[c],e=b.slice(c+1,c+1+d);if(e.equals(k))a="prime256v1";else if(e.equals(l))a="secp384r1";else if(e.equals(m))a="secp521r1";else if(e.equals(n))a="secp256k1";else throw new f.JOSENotSupported("Unsupported key curve for this operation")}}else a=o((0,e.createPublicKey)(p),!0);if(b)return a;let g=(a=>{switch(a){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new f.JOSENotSupported("Unsupported key curve for this operation")}})(a);return c.weakMap.set(p,g),g}default:throw TypeError("Invalid asymmetric key type for this operation")}};c.setCurve=function(a,b){c.weakMap.set(a,b)},c.default=o},96144,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ecdhAllowed=c.generateEpk=c.deriveKey=void 0;let d=a.r(54799),e=a.r(24361),f=a.r(31720),g=a.r(77504),h=a.r(57706),i=a.r(76663),j=a.r(70823),k=a.r(98331),l=a.r(46061),m=a.r(60419),n=(0,e.promisify)(d.generateKeyPair);c.deriveKey=async function(a,b,c,e,f=new Uint8Array(0),h=new Uint8Array(0)){let n,o;if((0,i.isCryptoKey)(a))(0,j.checkEncCryptoKey)(a,"ECDH"),n=d.KeyObject.from(a);else if((0,k.default)(a))n=a;else throw TypeError((0,l.default)(a,...m.types));if((0,i.isCryptoKey)(b))(0,j.checkEncCryptoKey)(b,"ECDH","deriveBits"),o=d.KeyObject.from(b);else if((0,k.default)(b))o=b;else throw TypeError((0,l.default)(b,...m.types));let p=(0,g.concat)((0,g.lengthAndInput)(g.encoder.encode(c)),(0,g.lengthAndInput)(f),(0,g.lengthAndInput)(h),(0,g.uint32be)(e)),q=(0,d.diffieHellman)({privateKey:o,publicKey:n});return(0,g.concatKdf)(q,e,p)},c.generateEpk=async function(a){let b;if((0,i.isCryptoKey)(a))b=d.KeyObject.from(a);else if((0,k.default)(a))b=a;else throw TypeError((0,l.default)(a,...m.types));switch(b.asymmetricKeyType){case"x25519":return n("x25519");case"x448":return n("x448");case"ec":return n("ec",{namedCurve:(0,f.default)(b)});default:throw new h.JOSENotSupported("Invalid or unsupported EPK")}},c.ecdhAllowed=a=>["P-256","P-384","P-521","X25519","X448"].includes((0,f.default)(a))},87036,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(57706);c.default=function(a){if(!(a instanceof Uint8Array)||a.length<8)throw new d.JWEInvalid("PBES2 Salt Input must be 8 or more octets")}},77834,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decrypt=c.encrypt=void 0;let d=a.r(24361),e=a.r(54799),f=a.r(71742),g=a.r(77504),h=a.r(53214),i=a.r(10556),j=a.r(87036),k=a.r(76663),l=a.r(70823),m=a.r(98331),n=a.r(46061),o=a.r(60419),p=(0,d.promisify)(e.pbkdf2);function q(a,b){if((0,m.default)(a))return a.export();if(a instanceof Uint8Array)return a;if((0,k.isCryptoKey)(a))return(0,l.checkEncCryptoKey)(a,b,"deriveBits","deriveKey"),e.KeyObject.from(a).export();throw TypeError((0,n.default)(a,...o.types,"Uint8Array"))}c.encrypt=async(a,b,c,d=2048,e=(0,f.default)(new Uint8Array(16)))=>{(0,j.default)(e);let k=(0,g.p2s)(a,e),l=parseInt(a.slice(13,16),10)>>3,m=q(b,a),n=await p(m,k,d,l,`sha${a.slice(8,11)}`);return{encryptedKey:await (0,i.wrap)(a.slice(-6),n,c),p2c:d,p2s:(0,h.encode)(e)}},c.decrypt=async(a,b,c,d,e)=>{(0,j.default)(e);let f=(0,g.p2s)(a,e),h=parseInt(a.slice(13,16),10)>>3,k=q(b,a),l=await p(k,f,d,h,`sha${a.slice(8,11)}`);return(0,i.unwrap)(a.slice(-6),l,c)}},56263,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.setModulusLength=c.weakMap=void 0,c.weakMap=new WeakMap;let d=(a,b)=>{let c=a.readUInt8(1);if((128&c)==0)return 0===b?c:d(a.subarray(2+c),b-1);let e=127&c;c=0;for(let b=0;b<e;b++)c<<=8,c|=a.readUInt8(2+b);return 0===b?c:d(a.subarray(2+c),b-1)};c.setModulusLength=(a,b)=>{c.weakMap.set(a,b)},c.default=(a,b)=>{if(2048>(a=>{var b,e,f,g;let h;if(c.weakMap.has(a))return c.weakMap.get(a);let i=null!=(e=null==(b=a.asymmetricKeyDetails)?void 0:b.modulusLength)?e:(f=a.export({format:"der",type:"pkcs1"}),g=+("private"===a.type),((128&(h=f.readUInt8(1)))==0?d(f.subarray(2),g):d(f.subarray(2+(127&h)),g))-1<<3);return c.weakMap.set(a,i),i})(a))throw TypeError(`${b} requires key modulusLength to be 2048 bits or larger`)}},49091,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decrypt=c.encrypt=void 0;let d=a.r(54799),e=a.r(56263),f=a.r(76663),g=a.r(70823),h=a.r(98331),i=a.r(46061),j=a.r(60419),k=(a,b)=>{if("rsa"!==a.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");(0,e.default)(a,b)},l=a=>{switch(a){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return d.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return d.constants.RSA_PKCS1_PADDING;default:return}},m=a=>{switch(a){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function n(a,b,...c){if((0,h.default)(a))return a;if((0,f.isCryptoKey)(a))return(0,g.checkEncCryptoKey)(a,b,...c),d.KeyObject.from(a);throw TypeError((0,i.default)(a,...j.types))}c.encrypt=(a,b,c)=>{let e=l(a),f=m(a),g=n(b,a,"wrapKey","encrypt");return k(g,a),(0,d.publicEncrypt)({key:g,oaepHash:f,padding:e},c)},c.decrypt=(a,b,c)=>{let e=l(a),f=m(a),g=n(b,a,"unwrapKey","decrypt");return k(g,a),(0,d.privateDecrypt)({key:g,oaepHash:f,padding:e},c)}},47316,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.bitLength=void 0;let d=a.r(57706),e=a.r(71742);function f(a){switch(a){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new d.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}c.bitLength=f,c.default=a=>(0,e.default)(new Uint8Array(f(a)>>3))},20398,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.fromX509=c.fromSPKI=c.fromPKCS8=c.toPKCS8=c.toSPKI=void 0;let d=a.r(54799),e=a.r(874),f=a.r(76663),g=a.r(98331),h=a.r(46061),i=a.r(60419),j=(a,b,c)=>{let e;if((0,f.isCryptoKey)(c)){if(!c.extractable)throw TypeError("CryptoKey is not extractable");e=d.KeyObject.from(c)}else if((0,g.default)(c))e=c;else throw TypeError((0,h.default)(c,...i.types));if(e.type!==a)throw TypeError(`key is not a ${a} key`);return e.export({format:"pem",type:b})};c.toSPKI=a=>j("public","spki",a),c.toPKCS8=a=>j("private","pkcs8",a),c.fromPKCS8=a=>(0,d.createPrivateKey)({key:e.Buffer.from(a.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"}),c.fromSPKI=a=>(0,d.createPublicKey)({key:e.Buffer.from(a.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"}),c.fromX509=a=>(0,d.createPublicKey)({key:a,type:"spki",format:"pem"})},80836,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(874),e=a.r(57706),f=d.Buffer.from([0]),g=d.Buffer.from([2]),h=d.Buffer.from([3]),i=d.Buffer.from([48]),j=d.Buffer.from([4]),k=a=>{if(a<128)return d.Buffer.from([a]);let b=d.Buffer.alloc(5);b.writeUInt32BE(a,1);let c=1;for(;0===b[c];)c++;return b[c-1]=128|5-c,b.slice(c-1)},l=new Map([["P-256",d.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",d.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",d.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",d.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",d.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",d.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",d.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",d.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",d.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);c.default=class{constructor(){this.length=0,this.elements=[]}oidFor(a){let b=l.get(a);if(!b)throw new e.JOSENotSupported("Invalid or unsupported OID");this.elements.push(b),this.length+=b.length}zero(){this.elements.push(g,d.Buffer.from([1]),f),this.length+=3}one(){this.elements.push(g,d.Buffer.from([1]),d.Buffer.from([1])),this.length+=3}unsignedInteger(a){if(128&a[0]){let b=k(a.length+1);this.elements.push(g,b,f,a),this.length+=2+b.length+a.length}else{let b=0;for(;0===a[b]&&(128&a[b+1])==0;)b++;let c=k(a.length-b);this.elements.push(g,k(a.length-b),a.slice(b)),this.length+=1+c.length+a.length-b}}octStr(a){let b=k(a.length);this.elements.push(j,k(a.length),a),this.length+=1+b.length+a.length}bitStr(a){let b=k(a.length+1);this.elements.push(h,k(a.length+1),f,a),this.length+=1+b.length+a.length+1}add(a){this.elements.push(a),this.length+=a.length}end(a=i){let b=k(this.length);return d.Buffer.concat([a,b,...this.elements],1+b.length+this.length)}}},41793,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.jwkImport=c.jwkExport=c.rsaPssParams=c.oneShotCallback=void 0;let[d,e]=process.versions.node.split(".").map(a=>parseInt(a,10));c.oneShotCallback=d>=16||15===d&&e>=13,c.rsaPssParams=!("electron"in process.versions)&&(d>=17||16===d&&e>=9),c.jwkExport=d>=16||15===d&&e>=9,c.jwkImport=d>=16||15===d&&e>=12},12339,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(874),e=a.r(54799),f=a.r(53214),g=a.r(57706),h=a.r(31720),i=a.r(56263),j=a.r(80836),k=a.r(41793);c.default=a=>{if(k.jwkImport&&"oct"!==a.kty)return a.d?(0,e.createPrivateKey)({format:"jwk",key:a}):(0,e.createPublicKey)({format:"jwk",key:a});switch(a.kty){case"oct":return(0,e.createSecretKey)((0,f.decode)(a.k));case"RSA":{let b=new j.default,c=void 0!==a.d,f=d.Buffer.from(a.n,"base64"),g=d.Buffer.from(a.e,"base64");c?(b.zero(),b.unsignedInteger(f),b.unsignedInteger(g),b.unsignedInteger(d.Buffer.from(a.d,"base64")),b.unsignedInteger(d.Buffer.from(a.p,"base64")),b.unsignedInteger(d.Buffer.from(a.q,"base64")),b.unsignedInteger(d.Buffer.from(a.dp,"base64")),b.unsignedInteger(d.Buffer.from(a.dq,"base64")),b.unsignedInteger(d.Buffer.from(a.qi,"base64"))):(b.unsignedInteger(f),b.unsignedInteger(g));let h={key:b.end(),format:"der",type:"pkcs1"},k=c?(0,e.createPrivateKey)(h):(0,e.createPublicKey)(h);return(0,i.setModulusLength)(k,f.length<<3),k}case"EC":{let b=new j.default,c=void 0!==a.d,f=d.Buffer.concat([d.Buffer.alloc(1,4),d.Buffer.from(a.x,"base64"),d.Buffer.from(a.y,"base64")]);if(c){b.zero();let c=new j.default;c.oidFor("ecPublicKey"),c.oidFor(a.crv),b.add(c.end());let g=new j.default;g.one(),g.octStr(d.Buffer.from(a.d,"base64"));let i=new j.default;i.bitStr(f);let k=i.end(d.Buffer.from([161]));g.add(k);let l=g.end(),m=new j.default;m.add(l);let n=m.end(d.Buffer.from([4]));b.add(n);let o=b.end(),p=(0,e.createPrivateKey)({key:o,format:"der",type:"pkcs8"});return(0,h.setCurve)(p,a.crv),p}let g=new j.default;g.oidFor("ecPublicKey"),g.oidFor(a.crv),b.add(g.end()),b.bitStr(f);let i=b.end(),k=(0,e.createPublicKey)({key:i,format:"der",type:"spki"});return(0,h.setCurve)(k,a.crv),k}case"OKP":{let b=new j.default;if(void 0!==a.d){b.zero();let c=new j.default;c.oidFor(a.crv),b.add(c.end());let f=new j.default;f.octStr(d.Buffer.from(a.d,"base64"));let g=f.end(d.Buffer.from([4]));b.add(g);let h=b.end();return(0,e.createPrivateKey)({key:h,format:"der",type:"pkcs8"})}let c=new j.default;c.oidFor(a.crv),b.add(c.end()),b.bitStr(d.Buffer.from(a.x,"base64"));let f=b.end();return(0,e.createPublicKey)({key:f,format:"der",type:"spki"})}default:throw new g.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}}},25889,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.importJWK=c.importPKCS8=c.importX509=c.importSPKI=void 0;let d=a.r(53214),e=a.r(20398),f=a.r(12339),g=a.r(57706),h=a.r(75478);c.importSPKI=async function(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,e.fromSPKI)(a,b,c)},c.importX509=async function(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,e.fromX509)(a,b,c)},c.importPKCS8=async function(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,e.fromPKCS8)(a,b,c)},c.importJWK=async function(a,b,c){var e;if(!(0,h.default)(a))throw TypeError("JWK must be an object");switch(b||(b=a.alg),a.kty){case"oct":if("string"!=typeof a.k||!a.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=c||(c=!0!==a.ext),c)return(0,f.default)({...a,alg:b,ext:null!=(e=a.ext)&&e});return(0,d.decode)(a.k);case"RSA":if(void 0!==a.oth)throw new g.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return(0,f.default)({...a,alg:b});default:throw new g.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}},25568,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(46061),e=a.r(60419);c.default=(a,b,c)=>{if(a.startsWith("HS")||"dir"===a||a.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(a)){if(!(b instanceof Uint8Array)){if(!(0,e.default)(b))throw TypeError((0,d.withAlg)(a,b,...e.types,"Uint8Array"));if("secret"!==b.type)throw TypeError(`${e.types.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}}else{if(!(0,e.default)(b))throw TypeError((0,d.withAlg)(a,b,...e.types));if("secret"===b.type)throw TypeError(`${e.types.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===c&&"public"===b.type)throw TypeError(`${e.types.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===c&&"public"===b.type)throw TypeError(`${e.types.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(b.algorithm&&"verify"===c&&"private"===b.type)throw TypeError(`${e.types.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(b.algorithm&&"encrypt"===c&&"private"===b.type)throw TypeError(`${e.types.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)}}},55e3,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(57790),f=a.r(50926),g=a.r(77504),h=a.r(65879),i=a.r(76663),j=a.r(70823),k=a.r(98331),l=a.r(46061),m=a.r(57706),n=a.r(97066),o=a.r(60419);c.default=(a,b,c,p,q)=>{let r;if((0,i.isCryptoKey)(c))(0,j.checkEncCryptoKey)(c,a,"encrypt"),r=d.KeyObject.from(c);else if(c instanceof Uint8Array||(0,k.default)(c))r=c;else throw TypeError((0,l.default)(c,...o.types,"Uint8Array"));switch((0,f.default)(a,r),(0,e.default)(a,p),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(a,b,c,e,f){let i=parseInt(a.slice(1,4),10);(0,k.default)(c)&&(c=c.export());let j=c.subarray(i>>3),l=c.subarray(0,i>>3),o=`aes-${i}-cbc`;if(!(0,n.default)(o))throw new m.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let p=(0,d.createCipheriv)(o,j,e),q=(0,g.concat)(p.update(b),p.final()),r=parseInt(a.slice(-3),10),s=(0,h.default)(f,e,q,r,l,i);return{ciphertext:q,tag:s}}(a,b,r,p,q);case"A128GCM":case"A192GCM":case"A256GCM":var s=r;let t=parseInt(a.slice(1,4),10),u=`aes-${t}-gcm`;if(!(0,n.default)(u))throw new m.JOSENotSupported(`alg ${a} is not supported by your javascript runtime`);let v=(0,d.createCipheriv)(u,s,p,{authTagLength:16});q.byteLength&&v.setAAD(q,{plaintextLength:b.length});let w=v.update(b);return v.final(),{ciphertext:w,tag:v.getAuthTag()};default:throw new m.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},78994,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.unwrap=c.wrap=void 0;let d=a.r(55e3),e=a.r(14380),f=a.r(61061),g=a.r(53214);c.wrap=async function(a,b,c,e){let h=a.slice(0,7);e||(e=(0,f.default)(h));let{ciphertext:i,tag:j}=await (0,d.default)(h,c,b,e,new Uint8Array(0));return{encryptedKey:i,iv:(0,g.encode)(e),tag:(0,g.encode)(j)}},c.unwrap=async function(a,b,c,d,f){let g=a.slice(0,7);return(0,e.default)(g,b,c,d,f,new Uint8Array(0))}},96672,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(10556),e=a.r(96144),f=a.r(77834),g=a.r(49091),h=a.r(53214),i=a.r(57706),j=a.r(47316),k=a.r(25889),l=a.r(25568),m=a.r(75478),n=a.r(78994);c.default=async function(a,b,c,o,p){switch((0,l.default)(a,b,"decrypt"),a){case"dir":if(void 0!==c)throw new i.JWEInvalid("Encountered unexpected JWE Encrypted Key");return b;case"ECDH-ES":if(void 0!==c)throw new i.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let f,g;if(!(0,m.default)(o.epk))throw new i.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!e.ecdhAllowed(b))throw new i.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let l=await (0,k.importJWK)(o.epk,a);if(void 0!==o.apu){if("string"!=typeof o.apu)throw new i.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{f=(0,h.decode)(o.apu)}catch{throw new i.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==o.apv){if("string"!=typeof o.apv)throw new i.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{g=(0,h.decode)(o.apv)}catch{throw new i.JWEInvalid("Failed to base64url decode the apv")}}let n=await e.deriveKey(l,b,"ECDH-ES"===a?o.enc:a,"ECDH-ES"===a?(0,j.bitLength)(o.enc):parseInt(a.slice(-5,-2),10),f,g);if("ECDH-ES"===a)return n;if(void 0===c)throw new i.JWEInvalid("JWE Encrypted Key missing");return(0,d.unwrap)(a.slice(-6),n,c)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===c)throw new i.JWEInvalid("JWE Encrypted Key missing");return(0,g.decrypt)(a,b,c);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let d;if(void 0===c)throw new i.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof o.p2c)throw new i.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let e=(null==p?void 0:p.maxPBES2Count)||1e4;if(o.p2c>e)throw new i.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof o.p2s)throw new i.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{d=(0,h.decode)(o.p2s)}catch{throw new i.JWEInvalid("Failed to base64url decode the p2s")}return(0,f.decrypt)(a,b,c,o.p2c,d)}case"A128KW":case"A192KW":case"A256KW":if(void 0===c)throw new i.JWEInvalid("JWE Encrypted Key missing");return(0,d.unwrap)(a,b,c);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let d,e;if(void 0===c)throw new i.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof o.iv)throw new i.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof o.tag)throw new i.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{d=(0,h.decode)(o.iv)}catch{throw new i.JWEInvalid("Failed to base64url decode the iv")}try{e=(0,h.decode)(o.tag)}catch{throw new i.JWEInvalid("Failed to base64url decode the tag")}return(0,n.unwrap)(a,b,c,d,e)}default:throw new i.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}},66556,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(57706);c.default=function(a,b,c,e,f){let g;if(void 0!==f.crit&&void 0===e.crit)throw new a('"crit" (Critical) Header Parameter MUST be integrity protected');if(!e||void 0===e.crit)return new Set;if(!Array.isArray(e.crit)||0===e.crit.length||e.crit.some(a=>"string"!=typeof a||0===a.length))throw new a('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let h of(g=void 0!==c?new Map([...Object.entries(c),...b.entries()]):b,e.crit)){if(!g.has(h))throw new d.JOSENotSupported(`Extension Header Parameter "${h}" is not recognized`);if(void 0===f[h])throw new a(`Extension Header Parameter "${h}" is missing`);if(g.get(h)&&void 0===e[h])throw new a(`Extension Header Parameter "${h}" MUST be integrity protected`)}return new Set(e.crit)}},96006,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=(a,b)=>{if(void 0!==b&&(!Array.isArray(b)||b.some(a=>"string"!=typeof a)))throw TypeError(`"${a}" option must be an array of strings`);if(b)return new Set(b)}},3905,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.flattenedDecrypt=void 0;let d=a.r(53214),e=a.r(14380),f=a.r(40739),g=a.r(57706),h=a.r(62262),i=a.r(75478),j=a.r(96672),k=a.r(77504),l=a.r(47316),m=a.r(66556),n=a.r(96006);c.flattenedDecrypt=async function(a,b,c){var o;let p,q,r,s,t,u,v;if(!(0,i.default)(a))throw new g.JWEInvalid("Flattened JWE must be an object");if(void 0===a.protected&&void 0===a.header&&void 0===a.unprotected)throw new g.JWEInvalid("JOSE Header missing");if("string"!=typeof a.iv)throw new g.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof a.ciphertext)throw new g.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof a.tag)throw new g.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==a.protected&&"string"!=typeof a.protected)throw new g.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==a.encrypted_key&&"string"!=typeof a.encrypted_key)throw new g.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==a.aad&&"string"!=typeof a.aad)throw new g.JWEInvalid("JWE AAD incorrect type");if(void 0!==a.header&&!(0,i.default)(a.header))throw new g.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==a.unprotected&&!(0,i.default)(a.unprotected))throw new g.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(a.protected)try{let b=(0,d.decode)(a.protected);p=JSON.parse(k.decoder.decode(b))}catch{throw new g.JWEInvalid("JWE Protected Header is invalid")}if(!(0,h.default)(p,a.header,a.unprotected))throw new g.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let w={...p,...a.header,...a.unprotected};if((0,m.default)(g.JWEInvalid,new Map,null==c?void 0:c.crit,p,w),void 0!==w.zip){if(!p||!p.zip)throw new g.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==w.zip)throw new g.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:x,enc:y}=w;if("string"!=typeof x||!x)throw new g.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof y||!y)throw new g.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let z=c&&(0,n.default)("keyManagementAlgorithms",c.keyManagementAlgorithms),A=c&&(0,n.default)("contentEncryptionAlgorithms",c.contentEncryptionAlgorithms);if(z&&!z.has(x))throw new g.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(A&&!A.has(y))throw new g.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==a.encrypted_key)try{q=(0,d.decode)(a.encrypted_key)}catch{throw new g.JWEInvalid("Failed to base64url decode the encrypted_key")}let B=!1;"function"==typeof b&&(b=await b(p,a),B=!0);try{r=await (0,j.default)(x,b,q,w,c)}catch(a){if(a instanceof TypeError||a instanceof g.JWEInvalid||a instanceof g.JOSENotSupported)throw a;r=(0,l.default)(y)}try{s=(0,d.decode)(a.iv)}catch{throw new g.JWEInvalid("Failed to base64url decode the iv")}try{t=(0,d.decode)(a.tag)}catch{throw new g.JWEInvalid("Failed to base64url decode the tag")}let C=k.encoder.encode(null!=(o=a.protected)?o:"");u=void 0!==a.aad?(0,k.concat)(C,k.encoder.encode("."),k.encoder.encode(a.aad)):C;try{v=(0,d.decode)(a.ciphertext)}catch{throw new g.JWEInvalid("Failed to base64url decode the ciphertext")}let D=await (0,e.default)(y,r,v,s,t,u);"DEF"===w.zip&&(D=await ((null==c?void 0:c.inflateRaw)||f.inflate)(D));let E={plaintext:D};if(void 0!==a.protected&&(E.protectedHeader=p),void 0!==a.aad)try{E.additionalAuthenticatedData=(0,d.decode)(a.aad)}catch{throw new g.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==a.unprotected&&(E.sharedUnprotectedHeader=a.unprotected),void 0!==a.header&&(E.unprotectedHeader=a.header),B)?{...E,key:b}:E}},50766,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.compactDecrypt=void 0;let d=a.r(3905),e=a.r(57706),f=a.r(77504);c.compactDecrypt=async function(a,b,c){if(a instanceof Uint8Array&&(a=f.decoder.decode(a)),"string"!=typeof a)throw new e.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:g,1:h,2:i,3:j,4:k,length:l}=a.split(".");if(5!==l)throw new e.JWEInvalid("Invalid Compact JWE");let m=await (0,d.flattenedDecrypt)({ciphertext:j,iv:i||void 0,protected:g||void 0,tag:k||void 0,encrypted_key:h||void 0},b,c),n={plaintext:m.plaintext,protectedHeader:m.protectedHeader};return"function"==typeof b?{...n,key:m.key}:n}},48578,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generalDecrypt=void 0;let d=a.r(3905),e=a.r(57706),f=a.r(75478);c.generalDecrypt=async function(a,b,c){if(!(0,f.default)(a))throw new e.JWEInvalid("General JWE must be an object");if(!Array.isArray(a.recipients)||!a.recipients.every(f.default))throw new e.JWEInvalid("JWE Recipients missing or incorrect type");if(!a.recipients.length)throw new e.JWEInvalid("JWE Recipients has no members");for(let e of a.recipients)try{return await (0,d.flattenedDecrypt)({aad:a.aad,ciphertext:a.ciphertext,encrypted_key:e.encrypted_key,header:e.header,iv:a.iv,protected:a.protected,tag:a.tag,unprotected:a.unprotected},b,c)}catch{}throw new e.JWEDecryptionFailed}},34483,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=class{constructor(a){if(48!==a[0]||(this.buffer=a,this.offset=1,this.decodeLength()!==a.length-this.offset))throw TypeError()}decodeLength(){let a=this.buffer[this.offset++];if(128&a){let b=-129&a;a=0;for(let c=0;c<b;c++)a=a<<8|this.buffer[this.offset+c];this.offset+=b}return a}unsignedInteger(){if(2!==this.buffer[this.offset++])throw TypeError();let a=this.decodeLength();0===this.buffer[this.offset]&&(this.offset++,a--);let b=this.buffer.slice(this.offset,this.offset+a);return this.offset+=a,b}end(){if(this.offset!==this.buffer.length)throw TypeError()}}},59708,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(53214),f=a.r(34483),g=a.r(57706),h=a.r(31720),i=a.r(76663),j=a.r(98331),k=a.r(46061),l=a.r(60419),m=a.r(41793),n=a=>{let b;if((0,i.isCryptoKey)(a)){if(!a.extractable)throw TypeError("CryptoKey is not extractable");b=d.KeyObject.from(a)}else if((0,j.default)(a))b=a;else if(a instanceof Uint8Array)return{kty:"oct",k:(0,e.encode)(a)};else throw TypeError((0,k.default)(a,...l.types,"Uint8Array"));if(m.jwkExport){if("secret"!==b.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(b.asymmetricKeyType))throw new g.JOSENotSupported("Unsupported key asymmetricKeyType");return b.export({format:"jwk"})}switch(b.type){case"secret":return{kty:"oct",k:(0,e.encode)(b.export())};case"private":case"public":switch(b.asymmetricKeyType){case"rsa":{let a,c=b.export({format:"der",type:"pkcs1"}),d=new f.default(c);"private"===b.type&&d.unsignedInteger();let g=(0,e.encode)(d.unsignedInteger()),h=(0,e.encode)(d.unsignedInteger());return"private"===b.type&&(a={d:(0,e.encode)(d.unsignedInteger()),p:(0,e.encode)(d.unsignedInteger()),q:(0,e.encode)(d.unsignedInteger()),dp:(0,e.encode)(d.unsignedInteger()),dq:(0,e.encode)(d.unsignedInteger()),qi:(0,e.encode)(d.unsignedInteger())}),d.end(),{kty:"RSA",n:g,e:h,...a}}case"ec":{let a,c,f,i=(0,h.default)(b);switch(i){case"secp256k1":a=64,c=33,f=-1;break;case"P-256":a=64,c=36,f=-1;break;case"P-384":a=96,c=35,f=-3;break;case"P-521":a=132,c=35,f=-3;break;default:throw new g.JOSENotSupported("Unsupported curve")}if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"EC",crv:i,x:(0,e.encode)(c.subarray(-a,-a/2)),y:(0,e.encode)(c.subarray(-a/2))}}let j=b.export({type:"pkcs8",format:"der"});return j.length<100&&(c+=f),{...n((0,d.createPublicKey)(b)),d:(0,e.encode)(j.subarray(c,c+a/2))}}case"ed25519":case"x25519":{let a=(0,h.default)(b);if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"OKP",crv:a,x:(0,e.encode)(c.subarray(-32))}}let c=b.export({type:"pkcs8",format:"der"});return{...n((0,d.createPublicKey)(b)),d:(0,e.encode)(c.subarray(-32))}}case"ed448":case"x448":{let a=(0,h.default)(b);if("public"===b.type){let c=b.export({type:"spki",format:"der"});return{kty:"OKP",crv:a,x:(0,e.encode)(c.subarray("Ed448"===a?-57:-56))}}let c=b.export({type:"pkcs8",format:"der"});return{...n((0,d.createPublicKey)(b)),d:(0,e.encode)(c.subarray("Ed448"===a?-57:-56))}}default:throw new g.JOSENotSupported("Unsupported key asymmetricKeyType")}default:throw new g.JOSENotSupported("Unsupported key type")}};c.default=n},79036,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.exportJWK=c.exportPKCS8=c.exportSPKI=void 0;let d=a.r(20398),e=a.r(20398),f=a.r(59708);c.exportSPKI=async function(a){return(0,d.toSPKI)(a)},c.exportPKCS8=async function(a){return(0,e.toPKCS8)(a)},c.exportJWK=async function(a){return(0,f.default)(a)}},46677,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(10556),e=a.r(96144),f=a.r(77834),g=a.r(49091),h=a.r(53214),i=a.r(47316),j=a.r(57706),k=a.r(79036),l=a.r(25568),m=a.r(78994);c.default=async function(a,b,c,n,o={}){let p,q,r;switch((0,l.default)(a,c,"encrypt"),a){case"dir":r=c;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!e.ecdhAllowed(c))throw new j.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:f,apv:g}=o,{epk:l}=o;l||(l=(await e.generateEpk(c)).privateKey);let{x:m,y:s,crv:t,kty:u}=await (0,k.exportJWK)(l),v=await e.deriveKey(c,l,"ECDH-ES"===a?b:a,"ECDH-ES"===a?(0,i.bitLength)(b):parseInt(a.slice(-5,-2),10),f,g);if(q={epk:{x:m,crv:t,kty:u}},"EC"===u&&(q.epk.y=s),f&&(q.apu=(0,h.encode)(f)),g&&(q.apv=(0,h.encode)(g)),"ECDH-ES"===a){r=v;break}r=n||(0,i.default)(b);let w=a.slice(-6);p=await (0,d.wrap)(w,v,r);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":r=n||(0,i.default)(b),p=await (0,g.encrypt)(a,c,r);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{r=n||(0,i.default)(b);let{p2c:d,p2s:e}=o;({encryptedKey:p,...q}=await (0,f.encrypt)(a,c,r,d,e));break}case"A128KW":case"A192KW":case"A256KW":r=n||(0,i.default)(b),p=await (0,d.wrap)(a,c,r);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{r=n||(0,i.default)(b);let{iv:d}=o;({encryptedKey:p,...q}=await (0,m.wrap)(a,c,r,d));break}default:throw new j.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:r,encryptedKey:p,parameters:q}}},2961,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.FlattenedEncrypt=c.unprotected=void 0;let d=a.r(53214),e=a.r(55e3),f=a.r(40739),g=a.r(61061),h=a.r(46677),i=a.r(57706),j=a.r(62262),k=a.r(77504),l=a.r(66556);c.unprotected=Symbol(),c.FlattenedEncrypt=class{constructor(a){if(!(a instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=a}setKeyManagementParameters(a){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=a,this}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setSharedUnprotectedHeader(a){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=a,this}setUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}setAdditionalAuthenticatedData(a){return this._aad=a,this}setContentEncryptionKey(a){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=a,this}setInitializationVector(a){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=a,this}async encrypt(a,b){let m,n,o,p,q,r,s;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new i.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!(0,j.default)(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new i.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let t={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if((0,l.default)(i.JWEInvalid,new Map,null==b?void 0:b.crit,this._protectedHeader,t),void 0!==t.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new i.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==t.zip)throw new i.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:u,enc:v}=t;if("string"!=typeof u||!u)throw new i.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof v||!v)throw new i.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===u){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===u&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let d;({cek:n,encryptedKey:m,parameters:d}=await (0,h.default)(u,v,a,this._cek,this._keyManagementParameters)),d&&(b&&c.unprotected in b?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...d}:this.setUnprotectedHeader(d):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...d}:this.setProtectedHeader(d))}if(this._iv||(this._iv=(0,g.default)(v)),p=this._protectedHeader?k.encoder.encode((0,d.encode)(JSON.stringify(this._protectedHeader))):k.encoder.encode(""),this._aad?(q=(0,d.encode)(this._aad),o=(0,k.concat)(p,k.encoder.encode("."),k.encoder.encode(q))):o=p,"DEF"===t.zip){let a=await ((null==b?void 0:b.deflateRaw)||f.deflate)(this._plaintext);({ciphertext:r,tag:s}=await (0,e.default)(v,a,n,this._iv,o))}else({ciphertext:r,tag:s}=await (0,e.default)(v,this._plaintext,n,this._iv,o));let w={ciphertext:(0,d.encode)(r),iv:(0,d.encode)(this._iv),tag:(0,d.encode)(s)};return m&&(w.encrypted_key=(0,d.encode)(m)),q&&(w.aad=q),this._protectedHeader&&(w.protected=k.decoder.decode(p)),this._sharedUnprotectedHeader&&(w.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(w.header=this._unprotectedHeader),w}}},48523,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GeneralEncrypt=void 0;let d=a.r(2961),e=a.r(57706),f=a.r(47316),g=a.r(62262),h=a.r(46677),i=a.r(53214),j=a.r(66556);class k{constructor(a,b,c){this.parent=a,this.key=b,this.options=c}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addRecipient(...a){return this.parent.addRecipient(...a)}encrypt(...a){return this.parent.encrypt(...a)}done(){return this.parent}}c.GeneralEncrypt=class{constructor(a){this._recipients=[],this._plaintext=a}addRecipient(a,b){let c=new k(this,a,{crit:null==b?void 0:b.crit});return this._recipients.push(c),c}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setSharedUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}setAdditionalAuthenticatedData(a){return this._aad=a,this}async encrypt(a){var b,c,k;let l;if(!this._recipients.length)throw new e.JWEInvalid("at least one recipient must be added");if(a={deflateRaw:null==a?void 0:a.deflateRaw},1===this._recipients.length){let[b]=this._recipients,c=await new d.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(b.unprotectedHeader).encrypt(b.key,{...b.options,...a}),e={ciphertext:c.ciphertext,iv:c.iv,recipients:[{}],tag:c.tag};return c.aad&&(e.aad=c.aad),c.protected&&(e.protected=c.protected),c.unprotected&&(e.unprotected=c.unprotected),c.encrypted_key&&(e.recipients[0].encrypted_key=c.encrypted_key),c.header&&(e.recipients[0].header=c.header),e}for(let a=0;a<this._recipients.length;a++){let b=this._recipients[a];if(!(0,g.default)(this._protectedHeader,this._unprotectedHeader,b.unprotectedHeader))throw new e.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let c={...this._protectedHeader,...this._unprotectedHeader,...b.unprotectedHeader},{alg:d}=c;if("string"!=typeof d||!d)throw new e.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===d||"ECDH-ES"===d)throw new e.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof c.enc||!c.enc)throw new e.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(l){if(l!==c.enc)throw new e.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else l=c.enc;if((0,j.default)(e.JWEInvalid,new Map,b.options.crit,this._protectedHeader,c),void 0!==c.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new e.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let m=(0,f.default)(l),n={ciphertext:"",iv:"",recipients:[],tag:""};for(let e=0;e<this._recipients.length;e++){let f=this._recipients[e],g={};n.recipients.push(g);let j=({...this._protectedHeader,...this._unprotectedHeader,...f.unprotectedHeader}).alg.startsWith("PBES2")?2048+e:void 0;if(0===e){let b=await new d.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(m).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(f.unprotectedHeader).setKeyManagementParameters({p2c:j}).encrypt(f.key,{...f.options,...a,[d.unprotected]:!0});n.ciphertext=b.ciphertext,n.iv=b.iv,n.tag=b.tag,b.aad&&(n.aad=b.aad),b.protected&&(n.protected=b.protected),b.unprotected&&(n.unprotected=b.unprotected),g.encrypted_key=b.encrypted_key,b.header&&(g.header=b.header);continue}let{encryptedKey:o,parameters:p}=await (0,h.default)((null==(b=f.unprotectedHeader)?void 0:b.alg)||(null==(c=this._protectedHeader)?void 0:c.alg)||(null==(k=this._unprotectedHeader)?void 0:k.alg),l,f.key,m,{p2c:j});g.encrypted_key=(0,i.encode)(o),(f.unprotectedHeader||p)&&(g.header={...f.unprotectedHeader,...p})}return n}}},36286,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(57706);c.default=function(a){switch(a){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new d.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}},36112,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(31720),f=a.r(57706),g=a.r(56263),h=a.r(41793),i={padding:d.constants.RSA_PKCS1_PSS_PADDING,saltLength:d.constants.RSA_PSS_SALTLEN_DIGEST},j=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);c.default=function(a,b){switch(a){case"EdDSA":if(!["ed25519","ed448"].includes(b.asymmetricKeyType))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");return b;case"RS256":case"RS384":case"RS512":if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,g.default)(b,a),b;case h.rsaPssParams&&"PS256":case h.rsaPssParams&&"PS384":case h.rsaPssParams&&"PS512":if("rsa-pss"===b.asymmetricKeyType){let{hashAlgorithm:c,mgf1HashAlgorithm:d,saltLength:e}=b.asymmetricKeyDetails,f=parseInt(a.slice(-3),10);if(void 0!==c&&(c!==`sha${f}`||d!==c))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${a}`);if(void 0!==e&&e>f>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${a}`)}else if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");return(0,g.default)(b,a),{key:b,...i};case!h.rsaPssParams&&"PS256":case!h.rsaPssParams&&"PS384":case!h.rsaPssParams&&"PS512":if("rsa"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,g.default)(b,a),{key:b,...i};case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==b.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let c=(0,e.default)(b),d=j.get(a);if(c!==d)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${d}, got ${c}`);return{dsaEncoding:"ieee-p1363",key:b}}default:throw new f.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}},27789,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(57706);c.default=function(a){switch(a){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new d.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}},90078,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799),e=a.r(76663),f=a.r(70823),g=a.r(46061),h=a.r(60419);c.default=function(a,b,c){if(b instanceof Uint8Array){if(!a.startsWith("HS"))throw TypeError((0,g.default)(b,...h.types));return(0,d.createSecretKey)(b)}if(b instanceof d.KeyObject)return b;if((0,e.isCryptoKey)(b))return(0,f.checkSigCryptoKey)(b,a,c),d.KeyObject.from(b);throw TypeError((0,g.default)(b,...h.types,"Uint8Array"))}},90702,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});let e=a.r(54799),f=a.r(24361),g=a.r(36286),h=a.r(27789),i=a.r(36112),j=a.r(90078);d=e.sign.length>3?(0,f.promisify)(e.sign):e.sign,c.default=async(a,b,c)=>{let f=(0,j.default)(a,b,"sign");if(a.startsWith("HS")){let b=e.createHmac((0,h.default)(a),f);return b.update(c),b.digest()}return d((0,g.default)(a),c,(0,i.default)(a,f))}},16934,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});let e=a.r(54799),f=a.r(24361),g=a.r(36286),h=a.r(36112),i=a.r(90702),j=a.r(90078),k=a.r(41793);d=e.verify.length>4&&k.oneShotCallback?(0,f.promisify)(e.verify):e.verify,c.default=async(a,b,c,f)=>{let k=(0,j.default)(a,b,"verify");if(a.startsWith("HS")){let b=await (0,i.default)(a,k,f);try{return e.timingSafeEqual(c,b)}catch{return!1}}let l=(0,g.default)(a),m=(0,h.default)(a,k);try{return await d(l,f,m,c)}catch{return!1}}},21738,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.flattenedVerify=void 0;let d=a.r(53214),e=a.r(16934),f=a.r(57706),g=a.r(77504),h=a.r(62262),i=a.r(75478),j=a.r(25568),k=a.r(66556),l=a.r(96006);c.flattenedVerify=async function(a,b,c){var m;let n,o;if(!(0,i.default)(a))throw new f.JWSInvalid("Flattened JWS must be an object");if(void 0===a.protected&&void 0===a.header)throw new f.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==a.protected&&"string"!=typeof a.protected)throw new f.JWSInvalid("JWS Protected Header incorrect type");if(void 0===a.payload)throw new f.JWSInvalid("JWS Payload missing");if("string"!=typeof a.signature)throw new f.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==a.header&&!(0,i.default)(a.header))throw new f.JWSInvalid("JWS Unprotected Header incorrect type");let p={};if(a.protected)try{let b=(0,d.decode)(a.protected);p=JSON.parse(g.decoder.decode(b))}catch{throw new f.JWSInvalid("JWS Protected Header is invalid")}if(!(0,h.default)(p,a.header))throw new f.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let q={...p,...a.header},r=(0,k.default)(f.JWSInvalid,new Map([["b64",!0]]),null==c?void 0:c.crit,p,q),s=!0;if(r.has("b64")&&"boolean"!=typeof(s=p.b64))throw new f.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:t}=q;if("string"!=typeof t||!t)throw new f.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let u=c&&(0,l.default)("algorithms",c.algorithms);if(u&&!u.has(t))throw new f.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(s){if("string"!=typeof a.payload)throw new f.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof a.payload&&!(a.payload instanceof Uint8Array))throw new f.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let v=!1;"function"==typeof b&&(b=await b(p,a),v=!0),(0,j.default)(t,b,"verify");let w=(0,g.concat)(g.encoder.encode(null!=(m=a.protected)?m:""),g.encoder.encode("."),"string"==typeof a.payload?g.encoder.encode(a.payload):a.payload);try{n=(0,d.decode)(a.signature)}catch{throw new f.JWSInvalid("Failed to base64url decode the signature")}if(!await (0,e.default)(t,b,n,w))throw new f.JWSSignatureVerificationFailed;if(s)try{o=(0,d.decode)(a.payload)}catch{throw new f.JWSInvalid("Failed to base64url decode the payload")}else o="string"==typeof a.payload?g.encoder.encode(a.payload):a.payload;let x={payload:o};return(void 0!==a.protected&&(x.protectedHeader=p),void 0!==a.header&&(x.unprotectedHeader=a.header),v)?{...x,key:b}:x}},44990,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.compactVerify=void 0;let d=a.r(21738),e=a.r(57706),f=a.r(77504);c.compactVerify=async function(a,b,c){if(a instanceof Uint8Array&&(a=f.decoder.decode(a)),"string"!=typeof a)throw new e.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:g,1:h,2:i,length:j}=a.split(".");if(3!==j)throw new e.JWSInvalid("Invalid Compact JWS");let k=await (0,d.flattenedVerify)({payload:h,protected:g,signature:i},b,c),l={payload:k.payload,protectedHeader:k.protectedHeader};return"function"==typeof b?{...l,key:k.key}:l}},80522,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generalVerify=void 0;let d=a.r(21738),e=a.r(57706),f=a.r(75478);c.generalVerify=async function(a,b,c){if(!(0,f.default)(a))throw new e.JWSInvalid("General JWS must be an object");if(!Array.isArray(a.signatures)||!a.signatures.every(f.default))throw new e.JWSInvalid("JWS Signatures missing or incorrect type");for(let e of a.signatures)try{return await (0,d.flattenedVerify)({header:e.header,payload:a.payload,protected:e.protected,signature:e.signature},b,c)}catch{}throw new e.JWSSignatureVerificationFailed}},1252,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=a=>Math.floor(a.getTime()/1e3)},16948,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;c.default=a=>{let b=d.exec(a);if(!b)throw TypeError("Invalid time period format");let c=parseFloat(b[1]);switch(b[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(c);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*c);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*c);case"day":case"days":case"d":return Math.round(86400*c);case"week":case"weeks":case"w":return Math.round(604800*c);default:return Math.round(0x1e187e0*c)}}},77744,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(57706),e=a.r(77504),f=a.r(1252),g=a.r(16948),h=a.r(75478),i=a=>a.toLowerCase().replace(/^application\//,"");c.default=(a,b,c={})=>{var j,k;let l,m,{typ:n}=c;if(n&&("string"!=typeof a.typ||i(a.typ)!==i(n)))throw new d.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{l=JSON.parse(e.decoder.decode(b))}catch{}if(!(0,h.default)(l))throw new d.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:o=[],issuer:p,subject:q,audience:r,maxTokenAge:s}=c;for(let a of(void 0!==s&&o.push("iat"),void 0!==r&&o.push("aud"),void 0!==q&&o.push("sub"),void 0!==p&&o.push("iss"),new Set(o.reverse())))if(!(a in l))throw new d.JWTClaimValidationFailed(`missing required "${a}" claim`,a,"missing");if(p&&!(Array.isArray(p)?p:[p]).includes(l.iss))throw new d.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(q&&l.sub!==q)throw new d.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(r&&(j=l.aud,k="string"==typeof r?[r]:r,"string"==typeof j?!k.includes(j):!(Array.isArray(j)&&k.some(Set.prototype.has.bind(new Set(j))))))throw new d.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof c.clockTolerance){case"string":m=(0,g.default)(c.clockTolerance);break;case"number":m=c.clockTolerance;break;case"undefined":m=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:t}=c,u=(0,f.default)(t||new Date);if((void 0!==l.iat||s)&&"number"!=typeof l.iat)throw new d.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==l.nbf){if("number"!=typeof l.nbf)throw new d.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(l.nbf>u+m)throw new d.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==l.exp){if("number"!=typeof l.exp)throw new d.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(l.exp<=u-m)throw new d.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(s){let a=u-l.iat;if(a-m>("number"==typeof s?s:(0,g.default)(s)))throw new d.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(a<0-m)throw new d.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return l}},59374,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.jwtVerify=void 0;let d=a.r(44990),e=a.r(77744),f=a.r(57706);c.jwtVerify=async function(a,b,c){var g;let h=await (0,d.compactVerify)(a,b,c);if((null==(g=h.protectedHeader.crit)?void 0:g.includes("b64"))&&!1===h.protectedHeader.b64)throw new f.JWTInvalid("JWTs MUST NOT use unencoded payload");let i={payload:(0,e.default)(h.protectedHeader,h.payload,c),protectedHeader:h.protectedHeader};return"function"==typeof b?{...i,key:h.key}:i}},80191,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.jwtDecrypt=void 0;let d=a.r(50766),e=a.r(77744),f=a.r(57706);c.jwtDecrypt=async function(a,b,c){let g=await (0,d.compactDecrypt)(a,b,c),h=(0,e.default)(g.protectedHeader,g.plaintext,c),{protectedHeader:i}=g;if(void 0!==i.iss&&i.iss!==h.iss)throw new f.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==i.sub&&i.sub!==h.sub)throw new f.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==i.aud&&JSON.stringify(i.aud)!==JSON.stringify(h.aud))throw new f.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let j={payload:h,protectedHeader:i};return"function"==typeof b?{...j,key:g.key}:j}},44271,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CompactEncrypt=void 0;let d=a.r(2961);c.CompactEncrypt=class{constructor(a){this._flattened=new d.FlattenedEncrypt(a)}setContentEncryptionKey(a){return this._flattened.setContentEncryptionKey(a),this}setInitializationVector(a){return this._flattened.setInitializationVector(a),this}setProtectedHeader(a){return this._flattened.setProtectedHeader(a),this}setKeyManagementParameters(a){return this._flattened.setKeyManagementParameters(a),this}async encrypt(a,b){let c=await this._flattened.encrypt(a,b);return[c.protected,c.encrypted_key,c.iv,c.ciphertext,c.tag].join(".")}}},1815,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.FlattenedSign=void 0;let d=a.r(53214),e=a.r(90702),f=a.r(62262),g=a.r(57706),h=a.r(77504),i=a.r(25568),j=a.r(66556);c.FlattenedSign=class{constructor(a){if(!(a instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=a}setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setUnprotectedHeader(a){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=a,this}async sign(a,b){let c;if(!this._protectedHeader&&!this._unprotectedHeader)throw new g.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,f.default)(this._protectedHeader,this._unprotectedHeader))throw new g.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let k={...this._protectedHeader,...this._unprotectedHeader},l=(0,j.default)(g.JWSInvalid,new Map([["b64",!0]]),null==b?void 0:b.crit,this._protectedHeader,k),m=!0;if(l.has("b64")&&"boolean"!=typeof(m=this._protectedHeader.b64))throw new g.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:n}=k;if("string"!=typeof n||!n)throw new g.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,i.default)(n,a,"sign");let o=this._payload;m&&(o=h.encoder.encode((0,d.encode)(o))),c=this._protectedHeader?h.encoder.encode((0,d.encode)(JSON.stringify(this._protectedHeader))):h.encoder.encode("");let p=(0,h.concat)(c,h.encoder.encode("."),o),q=await (0,e.default)(n,a,p),r={signature:(0,d.encode)(q),payload:""};return m&&(r.payload=h.decoder.decode(o)),this._unprotectedHeader&&(r.header=this._unprotectedHeader),this._protectedHeader&&(r.protected=h.decoder.decode(c)),r}}},1707,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CompactSign=void 0;let d=a.r(1815);c.CompactSign=class{constructor(a){this._flattened=new d.FlattenedSign(a)}setProtectedHeader(a){return this._flattened.setProtectedHeader(a),this}async sign(a,b){let c=await this._flattened.sign(a,b);if(void 0===c.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${c.protected}.${c.payload}.${c.signature}`}}},19935,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GeneralSign=void 0;let d=a.r(1815),e=a.r(57706);class f{constructor(a,b,c){this.parent=a,this.key=b,this.options=c}setProtectedHeader(a){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=a,this}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addSignature(...a){return this.parent.addSignature(...a)}sign(...a){return this.parent.sign(...a)}done(){return this.parent}}c.GeneralSign=class{constructor(a){this._signatures=[],this._payload=a}addSignature(a,b){let c=new f(this,a,b);return this._signatures.push(c),c}async sign(){if(!this._signatures.length)throw new e.JWSInvalid("at least one signature must be added");let a={signatures:[],payload:""};for(let b=0;b<this._signatures.length;b++){let c=this._signatures[b],f=new d.FlattenedSign(this._payload);f.setProtectedHeader(c.protectedHeader),f.setUnprotectedHeader(c.unprotectedHeader);let{payload:g,...h}=await f.sign(c.key,c.options);if(0===b)a.payload=g;else if(a.payload!==g)throw new e.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");a.signatures.push(h)}return a}}},60210,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ProduceJWT=void 0;let d=a.r(1252),e=a.r(75478),f=a.r(16948);c.ProduceJWT=class{constructor(a){if(!(0,e.default)(a))throw TypeError("JWT Claims Set MUST be an object");this._payload=a}setIssuer(a){return this._payload={...this._payload,iss:a},this}setSubject(a){return this._payload={...this._payload,sub:a},this}setAudience(a){return this._payload={...this._payload,aud:a},this}setJti(a){return this._payload={...this._payload,jti:a},this}setNotBefore(a){return"number"==typeof a?this._payload={...this._payload,nbf:a}:this._payload={...this._payload,nbf:(0,d.default)(new Date)+(0,f.default)(a)},this}setExpirationTime(a){return"number"==typeof a?this._payload={...this._payload,exp:a}:this._payload={...this._payload,exp:(0,d.default)(new Date)+(0,f.default)(a)},this}setIssuedAt(a){return void 0===a?this._payload={...this._payload,iat:(0,d.default)(new Date)}:this._payload={...this._payload,iat:a},this}}},22999,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SignJWT=void 0;let d=a.r(1707),e=a.r(57706),f=a.r(77504),g=a.r(60210);class h extends g.ProduceJWT{setProtectedHeader(a){return this._protectedHeader=a,this}async sign(a,b){var c;let g=new d.CompactSign(f.encoder.encode(JSON.stringify(this._payload)));if(g.setProtectedHeader(this._protectedHeader),Array.isArray(null==(c=this._protectedHeader)?void 0:c.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new e.JWTInvalid("JWTs MUST NOT use unencoded payload");return g.sign(a,b)}}c.SignJWT=h},26987,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.EncryptJWT=void 0;let d=a.r(44271),e=a.r(77504),f=a.r(60210);class g extends f.ProduceJWT{setProtectedHeader(a){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=a,this}setKeyManagementParameters(a){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=a,this}setContentEncryptionKey(a){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=a,this}setInitializationVector(a){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=a,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(a,b){let c=new d.CompactEncrypt(e.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),c.setProtectedHeader(this._protectedHeader),this._iv&&c.setInitializationVector(this._iv),this._cek&&c.setContentEncryptionKey(this._cek),this._keyManagementParameters&&c.setKeyManagementParameters(this._keyManagementParameters),c.encrypt(a,b)}}c.EncryptJWT=g},83938,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.calculateJwkThumbprintUri=c.calculateJwkThumbprint=void 0;let d=a.r(36933),e=a.r(53214),f=a.r(57706),g=a.r(77504),h=a.r(75478),i=(a,b)=>{if("string"!=typeof a||!a)throw new f.JWKInvalid(`${b} missing or invalid`)};async function j(a,b){let c;if(!(0,h.default)(a))throw TypeError("JWK must be an object");if(null!=b||(b="sha256"),"sha256"!==b&&"sha384"!==b&&"sha512"!==b)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(a.kty){case"EC":i(a.crv,'"crv" (Curve) Parameter'),i(a.x,'"x" (X Coordinate) Parameter'),i(a.y,'"y" (Y Coordinate) Parameter'),c={crv:a.crv,kty:a.kty,x:a.x,y:a.y};break;case"OKP":i(a.crv,'"crv" (Subtype of Key Pair) Parameter'),i(a.x,'"x" (Public Key) Parameter'),c={crv:a.crv,kty:a.kty,x:a.x};break;case"RSA":i(a.e,'"e" (Exponent) Parameter'),i(a.n,'"n" (Modulus) Parameter'),c={e:a.e,kty:a.kty,n:a.n};break;case"oct":i(a.k,'"k" (Key Value) Parameter'),c={k:a.k,kty:a.kty};break;default:throw new f.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let j=g.encoder.encode(JSON.stringify(c));return(0,e.encode)(await (0,d.default)(b,j))}c.calculateJwkThumbprint=j,c.calculateJwkThumbprintUri=async function(a,b){null!=b||(b="sha256");let c=await j(a,b);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${b.slice(-3)}:${c}`}},87685,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.EmbeddedJWK=void 0;let d=a.r(25889),e=a.r(75478),f=a.r(57706);c.EmbeddedJWK=async function(a,b){let c={...a,...null==b?void 0:b.header};if(!(0,e.default)(c.jwk))throw new f.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let g=await (0,d.importJWK)({...c.jwk,ext:!0},c.alg,!0);if(g instanceof Uint8Array||"public"!==g.type)throw new f.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return g}},20686,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.createLocalJWKSet=c.LocalJWKSet=c.isJWKSLike=void 0;let d=a.r(25889),e=a.r(57706),f=a.r(75478);function g(a){return a&&"object"==typeof a&&Array.isArray(a.keys)&&a.keys.every(h)}function h(a){return(0,f.default)(a)}c.isJWKSLike=g;class i{constructor(a){if(this._cached=new WeakMap,!g(a))throw new e.JWKSInvalid("JSON Web Key Set malformed");this._jwks=function(a){return"function"==typeof structuredClone?structuredClone(a):JSON.parse(JSON.stringify(a))}(a)}async getKey(a,b){let{alg:c,kid:d}={...a,...null==b?void 0:b.header},f=function(a){switch("string"==typeof a&&a.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new e.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}(c),g=this._jwks.keys.filter(a=>{let b=f===a.kty;if(b&&"string"==typeof d&&(b=d===a.kid),b&&"string"==typeof a.alg&&(b=c===a.alg),b&&"string"==typeof a.use&&(b="sig"===a.use),b&&Array.isArray(a.key_ops)&&(b=a.key_ops.includes("verify")),b&&"EdDSA"===c&&(b="Ed25519"===a.crv||"Ed448"===a.crv),b)switch(c){case"ES256":b="P-256"===a.crv;break;case"ES256K":b="secp256k1"===a.crv;break;case"ES384":b="P-384"===a.crv;break;case"ES512":b="P-521"===a.crv}return b}),{0:h,length:i}=g;if(0===i)throw new e.JWKSNoMatchingKey;if(1!==i){let a=new e.JWKSMultipleMatchingKeys,{_cached:b}=this;throw a[Symbol.asyncIterator]=async function*(){for(let a of g)try{yield await j(b,a,c)}catch{continue}},a}return j(this._cached,h,c)}}async function j(a,b,c){let f=a.get(b)||a.set(b,{}).get(b);if(void 0===f[c]){let a=await (0,d.importJWK)({...b,ext:!0},c);if(a instanceof Uint8Array||"public"!==a.type)throw new e.JWKSInvalid("JSON Web Key Set members must be public keys");f[c]=a}return f[c]}c.LocalJWKSet=i,c.createLocalJWKSet=function(a){let b=new i(a);return async function(a,c){return b.getKey(a,c)}}},37687,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(21517),e=a.r(24836),f=a.r(27699),g=a.r(57706),h=a.r(77504);c.default=async(a,b,c)=>{let i;switch(a.protocol){case"https:":i=e.get;break;case"http:":i=d.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:j,headers:k}=c,l=i(a.href,{agent:j,timeout:b,headers:k}),[m]=await Promise.race([(0,f.once)(l,"response"),(0,f.once)(l,"timeout")]);if(!m)throw l.destroy(),new g.JWKSTimeout;if(200!==m.statusCode)throw new g.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let n=[];for await(let a of m)n.push(a);try{return JSON.parse(h.decoder.decode((0,h.concat)(...n)))}catch{throw new g.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}}},57752,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.createRemoteJWKSet=void 0;let d=a.r(37687),e=a.r(57706),f=a.r(20686);class g extends f.LocalJWKSet{constructor(a,b){if(super({keys:[]}),this._jwks=void 0,!(a instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(a.href),this._options={agent:null==b?void 0:b.agent,headers:null==b?void 0:b.headers},this._timeoutDuration="number"==typeof(null==b?void 0:b.timeoutDuration)?null==b?void 0:b.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==b?void 0:b.cooldownDuration)?null==b?void 0:b.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==b?void 0:b.cacheMaxAge)?null==b?void 0:b.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(a,b){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(a,b)}catch(c){if(c instanceof e.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(a,b);throw c}}async reload(){this._pendingFetch&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=(0,d.default)(this._url,this._timeoutDuration,this._options).then(a=>{if(!(0,f.isJWKSLike)(a))throw new e.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:a.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(a=>{throw this._pendingFetch=void 0,a})),await this._pendingFetch}}c.createRemoteJWKSet=function(a,b){let c=new g(a,b);return async function(a,b){return c.getKey(a,b)}}},96720,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UnsecuredJWT=void 0;let d=a.r(53214),e=a.r(77504),f=a.r(57706),g=a.r(77744),h=a.r(60210);class i extends h.ProduceJWT{encode(){let a=d.encode(JSON.stringify({alg:"none"})),b=d.encode(JSON.stringify(this._payload));return`${a}.${b}.`}static decode(a,b){let c;if("string"!=typeof a)throw new f.JWTInvalid("Unsecured JWT must be a string");let{0:h,1:i,2:j,length:k}=a.split(".");if(3!==k||""!==j)throw new f.JWTInvalid("Invalid Unsecured JWT");try{if(c=JSON.parse(e.decoder.decode(d.decode(h))),"none"!==c.alg)throw Error()}catch{throw new f.JWTInvalid("Invalid Unsecured JWT")}return{payload:(0,g.default)(c,d.decode(i),b),header:c}}}c.UnsecuredJWT=i},67029,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decode=c.encode=void 0;let d=a.r(53214);c.encode=d.encode,c.decode=d.decode},40480,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decodeProtectedHeader=void 0;let d=a.r(67029),e=a.r(77504),f=a.r(75478);c.decodeProtectedHeader=function(a){let b;if("string"==typeof a){let c=a.split(".");(3===c.length||5===c.length)&&([b]=c)}else if("object"==typeof a&&a)if("protected"in a)b=a.protected;else throw TypeError("Token does not contain a Protected Header");try{if("string"!=typeof b||!b)throw Error();let a=JSON.parse(e.decoder.decode((0,d.decode)(b)));if(!(0,f.default)(a))throw Error();return a}catch{throw TypeError("Invalid Token or Protected Header formatting")}}},78998,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.decodeJwt=void 0;let d=a.r(67029),e=a.r(77504),f=a.r(75478),g=a.r(57706);c.decodeJwt=function(a){let b,c;if("string"!=typeof a)throw new g.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:h,length:i}=a.split(".");if(5===i)throw new g.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==i)throw new g.JWTInvalid("Invalid JWT");if(!h)throw new g.JWTInvalid("JWTs must contain a payload");try{b=(0,d.decode)(h)}catch{throw new g.JWTInvalid("Failed to base64url decode the payload")}try{c=JSON.parse(e.decoder.decode(b))}catch{throw new g.JWTInvalid("Failed to parse the decoded payload as JSON")}if(!(0,f.default)(c))throw new g.JWTInvalid("Invalid JWT Claims Set");return c}},51313,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generateKeyPair=c.generateSecret=void 0;let d=a.r(54799),e=a.r(24361),f=a.r(71742),g=a.r(56263),h=a.r(57706),i=(0,e.promisify)(d.generateKeyPair);c.generateSecret=async function(a,b){let c;switch(a){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(a.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(a.slice(1,4),10);break;default:throw new h.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,d.createSecretKey)((0,f.default)(new Uint8Array(c>>3)))},c.generateKeyPair=async function(a,b){var c,d;switch(a){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let a=null!=(c=null==b?void 0:b.modulusLength)?c:2048;if("number"!=typeof a||a<2048)throw new h.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");let d=await i("rsa",{modulusLength:a,publicExponent:65537});return(0,g.setModulusLength)(d.privateKey,a),(0,g.setModulusLength)(d.publicKey,a),d}case"ES256":return i("ec",{namedCurve:"P-256"});case"ES256K":return i("ec",{namedCurve:"secp256k1"});case"ES384":return i("ec",{namedCurve:"P-384"});case"ES512":return i("ec",{namedCurve:"P-521"});case"EdDSA":switch(null==b?void 0:b.crv){case void 0:case"Ed25519":return i("ed25519");case"Ed448":return i("ed448");default:throw new h.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":let e=null!=(d=null==b?void 0:b.crv)?d:"P-256";switch(e){case void 0:case"P-256":case"P-384":case"P-521":return i("ec",{namedCurve:e});case"X25519":return i("x25519");case"X448":return i("x448");default:throw new h.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}default:throw new h.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}},11672,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generateKeyPair=void 0;let d=a.r(51313);c.generateKeyPair=async function(a,b){return(0,d.generateKeyPair)(a,b)}},13972,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generateSecret=void 0;let d=a.r(51313);c.generateSecret=async function(a,b){return(0,d.generateSecret)(a,b)}},23699,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default="node:crypto"},19463,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=a.r(23699).default},14943,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.cryptoRuntime=c.base64url=c.generateSecret=c.generateKeyPair=c.errors=c.decodeJwt=c.decodeProtectedHeader=c.importJWK=c.importX509=c.importPKCS8=c.importSPKI=c.exportJWK=c.exportSPKI=c.exportPKCS8=c.UnsecuredJWT=c.createRemoteJWKSet=c.createLocalJWKSet=c.EmbeddedJWK=c.calculateJwkThumbprintUri=c.calculateJwkThumbprint=c.EncryptJWT=c.SignJWT=c.GeneralSign=c.FlattenedSign=c.CompactSign=c.FlattenedEncrypt=c.CompactEncrypt=c.jwtDecrypt=c.jwtVerify=c.generalVerify=c.flattenedVerify=c.compactVerify=c.GeneralEncrypt=c.generalDecrypt=c.flattenedDecrypt=c.compactDecrypt=void 0;var d=a.r(50766);Object.defineProperty(c,"compactDecrypt",{enumerable:!0,get:function(){return d.compactDecrypt}});var e=a.r(3905);Object.defineProperty(c,"flattenedDecrypt",{enumerable:!0,get:function(){return e.flattenedDecrypt}});var f=a.r(48578);Object.defineProperty(c,"generalDecrypt",{enumerable:!0,get:function(){return f.generalDecrypt}});var g=a.r(48523);Object.defineProperty(c,"GeneralEncrypt",{enumerable:!0,get:function(){return g.GeneralEncrypt}});var h=a.r(44990);Object.defineProperty(c,"compactVerify",{enumerable:!0,get:function(){return h.compactVerify}});var i=a.r(21738);Object.defineProperty(c,"flattenedVerify",{enumerable:!0,get:function(){return i.flattenedVerify}});var j=a.r(80522);Object.defineProperty(c,"generalVerify",{enumerable:!0,get:function(){return j.generalVerify}});var k=a.r(59374);Object.defineProperty(c,"jwtVerify",{enumerable:!0,get:function(){return k.jwtVerify}});var l=a.r(80191);Object.defineProperty(c,"jwtDecrypt",{enumerable:!0,get:function(){return l.jwtDecrypt}});var m=a.r(44271);Object.defineProperty(c,"CompactEncrypt",{enumerable:!0,get:function(){return m.CompactEncrypt}});var n=a.r(2961);Object.defineProperty(c,"FlattenedEncrypt",{enumerable:!0,get:function(){return n.FlattenedEncrypt}});var o=a.r(1707);Object.defineProperty(c,"CompactSign",{enumerable:!0,get:function(){return o.CompactSign}});var p=a.r(1815);Object.defineProperty(c,"FlattenedSign",{enumerable:!0,get:function(){return p.FlattenedSign}});var q=a.r(19935);Object.defineProperty(c,"GeneralSign",{enumerable:!0,get:function(){return q.GeneralSign}});var r=a.r(22999);Object.defineProperty(c,"SignJWT",{enumerable:!0,get:function(){return r.SignJWT}});var s=a.r(26987);Object.defineProperty(c,"EncryptJWT",{enumerable:!0,get:function(){return s.EncryptJWT}});var t=a.r(83938);Object.defineProperty(c,"calculateJwkThumbprint",{enumerable:!0,get:function(){return t.calculateJwkThumbprint}}),Object.defineProperty(c,"calculateJwkThumbprintUri",{enumerable:!0,get:function(){return t.calculateJwkThumbprintUri}});var u=a.r(87685);Object.defineProperty(c,"EmbeddedJWK",{enumerable:!0,get:function(){return u.EmbeddedJWK}});var v=a.r(20686);Object.defineProperty(c,"createLocalJWKSet",{enumerable:!0,get:function(){return v.createLocalJWKSet}});var w=a.r(57752);Object.defineProperty(c,"createRemoteJWKSet",{enumerable:!0,get:function(){return w.createRemoteJWKSet}});var x=a.r(96720);Object.defineProperty(c,"UnsecuredJWT",{enumerable:!0,get:function(){return x.UnsecuredJWT}});var y=a.r(79036);Object.defineProperty(c,"exportPKCS8",{enumerable:!0,get:function(){return y.exportPKCS8}}),Object.defineProperty(c,"exportSPKI",{enumerable:!0,get:function(){return y.exportSPKI}}),Object.defineProperty(c,"exportJWK",{enumerable:!0,get:function(){return y.exportJWK}});var z=a.r(25889);Object.defineProperty(c,"importSPKI",{enumerable:!0,get:function(){return z.importSPKI}}),Object.defineProperty(c,"importPKCS8",{enumerable:!0,get:function(){return z.importPKCS8}}),Object.defineProperty(c,"importX509",{enumerable:!0,get:function(){return z.importX509}}),Object.defineProperty(c,"importJWK",{enumerable:!0,get:function(){return z.importJWK}});var A=a.r(40480);Object.defineProperty(c,"decodeProtectedHeader",{enumerable:!0,get:function(){return A.decodeProtectedHeader}});var B=a.r(78998);Object.defineProperty(c,"decodeJwt",{enumerable:!0,get:function(){return B.decodeJwt}}),c.errors=a.r(57706);var C=a.r(11672);Object.defineProperty(c,"generateKeyPair",{enumerable:!0,get:function(){return C.generateKeyPair}});var D=a.r(13972);Object.defineProperty(c,"generateSecret",{enumerable:!0,get:function(){return D.generateSecret}}),c.base64url=a.r(67029);var E=a.r(19463);Object.defineProperty(c,"cryptoRuntime",{enumerable:!0,get:function(){return E.default}})},14681,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});let d=a.r(54799);c.default=(a,b,c,e,f)=>{let g=parseInt(a.substr(3),10)>>3||20,h=(0,d.createHmac)(a,c.byteLength?c:new Uint8Array(g)).update(b).digest(),i=Math.ceil(f/g),j=new Uint8Array(g*i+e.byteLength+1),k=0,l=0;for(let b=1;b<=i;b++)j.set(e,l),j[l+e.byteLength]=b,j.set((0,d.createHmac)(a,h).update(j.subarray(k,l+e.byteLength+1)).digest(),l),k=l,l+=g;return j.slice(0,f)}},8468,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});let e=a.r(54799),f=a.r(14681);"function"!=typeof e.hkdf||process.versions.electron||(d=async(...a)=>new Promise((b,c)=>{e.hkdf(...a,(a,d)=>{a?c(a):b(new Uint8Array(d))})})),c.default=async(a,b,c,e,g)=>(d||f.default)(a,b,c,e,g)},92147,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=c.hkdf=void 0;let d=a.r(8468);function e(a,b){if("string"==typeof a)return new TextEncoder().encode(a);if(!(a instanceof Uint8Array))throw TypeError(`"${b}"" must be an instance of Uint8Array or a string`);return a}async function f(a,b,c,f,g){return(0,d.default)(function(a){switch(a){case"sha256":case"sha384":case"sha512":case"sha1":return a;default:throw TypeError('unsupported "digest" value')}}(a),function(a){let b=e(a,"ikm");if(!b.byteLength)throw TypeError('"ikm" must be at least one byte in length');return b}(b),e(c,"salt"),function(a){let b=e(a,"info");if(b.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return b}(f),function(a,b){if("number"!=typeof a||!Number.isInteger(a)||a<1)throw TypeError('"keylen" must be a positive integer');if(a>255*(parseInt(b.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return a}(g,a))}c.hkdf=f,c.default=f},80741,a=>{"use strict";let b,c;a.s([],2121),a.i(2121);var d=a.i(54799);let e=new Uint8Array(256),f=e.length;function g(){return f>e.length-16&&(d.default.randomFillSync(e),f=0),e.slice(f,f+=16)}let h=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,i=function(a){return"string"==typeof a&&h.test(a)},j=[];for(let a=0;a<256;++a)j.push((a+256).toString(16).substr(1));let k=function(a,b=0){let c=(j[a[b+0]]+j[a[b+1]]+j[a[b+2]]+j[a[b+3]]+"-"+j[a[b+4]]+j[a[b+5]]+"-"+j[a[b+6]]+j[a[b+7]]+"-"+j[a[b+8]]+j[a[b+9]]+"-"+j[a[b+10]]+j[a[b+11]]+j[a[b+12]]+j[a[b+13]]+j[a[b+14]]+j[a[b+15]]).toLowerCase();if(!i(c))throw TypeError("Stringified UUID is invalid");return c},l=0,m=0,n=function(a){let b;if(!i(a))throw TypeError("Invalid UUID");let c=new Uint8Array(16);return c[0]=(b=parseInt(a.slice(0,8),16))>>>24,c[1]=b>>>16&255,c[2]=b>>>8&255,c[3]=255&b,c[4]=(b=parseInt(a.slice(9,13),16))>>>8,c[5]=255&b,c[6]=(b=parseInt(a.slice(14,18),16))>>>8,c[7]=255&b,c[8]=(b=parseInt(a.slice(19,23),16))>>>8,c[9]=255&b,c[10]=(b=parseInt(a.slice(24,36),16))/0x10000000000&255,c[11]=b/0x100000000&255,c[12]=b>>>24&255,c[13]=b>>>16&255,c[14]=b>>>8&255,c[15]=255&b,c};function o(a,b,c){function d(a,d,e,f){if("string"==typeof a&&(a=function(a){a=unescape(encodeURIComponent(a));let b=[];for(let c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b}(a)),"string"==typeof d&&(d=n(d)),16!==d.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let g=new Uint8Array(16+a.length);if(g.set(d),g.set(a,d.length),(g=c(g))[6]=15&g[6]|b,g[8]=63&g[8]|128,e){f=f||0;for(let a=0;a<16;++a)e[f+a]=g[a];return e}return k(g)}try{d.name=a}catch(a){}return d.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",d.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",d}let p=o("v3",48,function(a){return Array.isArray(a)?a=Buffer.from(a):"string"==typeof a&&(a=Buffer.from(a,"utf8")),d.default.createHash("md5").update(a).digest()}),q=o("v5",80,function(a){return Array.isArray(a)?a=Buffer.from(a):"string"==typeof a&&(a=Buffer.from(a,"utf8")),d.default.createHash("sha1").update(a).digest()});a.s(["NIL",0,"00000000-0000-0000-0000-000000000000","parse",0,n,"stringify",0,k,"v1",0,function(a,d,e){let f=d&&e||0,h=d||Array(16),i=(a=a||{}).node||b,j=void 0!==a.clockseq?a.clockseq:c;if(null==i||null==j){let d=a.random||(a.rng||g)();null==i&&(i=b=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==j&&(j=c=(d[6]<<8|d[7])&16383)}let n=void 0!==a.msecs?a.msecs:Date.now(),o=void 0!==a.nsecs?a.nsecs:m+1,p=n-l+(o-m)/1e4;if(p<0&&void 0===a.clockseq&&(j=j+1&16383),(p<0||n>l)&&void 0===a.nsecs&&(o=0),o>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");l=n,m=o,c=j;let q=((0xfffffff&(n+=122192928e5))*1e4+o)%0x100000000;h[f++]=q>>>24&255,h[f++]=q>>>16&255,h[f++]=q>>>8&255,h[f++]=255&q;let r=n/0x100000000*1e4&0xfffffff;h[f++]=r>>>8&255,h[f++]=255&r,h[f++]=r>>>24&15|16,h[f++]=r>>>16&255,h[f++]=j>>>8|128,h[f++]=255&j;for(let a=0;a<6;++a)h[f+a]=i[a];return d||k(h)},"v3",0,p,"v4",0,function(a,b,c){let d=(a=a||{}).random||(a.rng||g)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,b){c=c||0;for(let a=0;a<16;++a)b[c+a]=d[a];return b}return k(d)},"v5",0,q,"validate",0,i,"version",0,function(a){if(!i(a))throw TypeError("Invalid UUID");return parseInt(a.substr(14,1),16)}],80741)},68735,(a,b,c)=>{"use strict";function d(a,b,c){e(a,b),b.set(a,c)}function e(a,b){if(b.has(a))throw TypeError("Cannot initialize the same private elements twice on an object")}function f(a,b){return a.get(h(a,b))}function g(a,b,c){return a.set(h(a,b),c),c}function h(a,b,c){if("function"==typeof a?a===b:a.has(b))return arguments.length<3?b:c;throw TypeError("Private element is not present on this object")}Object.defineProperty(c,"__esModule",{value:!0}),c.SessionStore=void 0,c.defaultCookies=function(a){let b=a?"__Secure-":"";return{sessionToken:{name:`${b}next-auth.session-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a}},callbackUrl:{name:`${b}next-auth.callback-url`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a}},csrfToken:{name:`${a?"__Host-":""}next-auth.csrf-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a}},pkceCodeVerifier:{name:`${b}next-auth.pkce.code_verifier`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a,maxAge:900}},state:{name:`${b}next-auth.state`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a,maxAge:900}},nonce:{name:`${b}next-auth.nonce`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a}}}};var i=new WeakMap,j=new WeakMap,k=new WeakMap,l=new WeakSet;function m(a){let b=Math.ceil(a.value.length/3933);if(1===b)return f(i,this)[a.name]=a.value,[a];let c=[];for(let d=0;d<b;d++){let b=`${a.name}.${d}`,e=a.value.substr(3933*d,3933);c.push({...a,name:b,value:e}),f(i,this)[b]=e}return f(k,this).debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:163,valueSize:a.value.length,chunks:c.map(a=>a.value.length+163)}),c}function n(){let a={};for(let c in f(i,this)){var b;null==(b=f(i,this))||delete b[c],a[c]={name:c,value:"",options:{...f(j,this).options,maxAge:0}}}return a}c.SessionStore=class{constructor(a,b,c){!function(a,b){e(a,b),b.add(a)}(this,l),d(this,i,{}),d(this,j,void 0),d(this,k,void 0),g(k,this,c),g(j,this,a);const{cookies:h}=b,{name:m}=a;if("function"==typeof(null==h?void 0:h.getAll))for(const{name:a,value:b}of h.getAll())a.startsWith(m)&&(f(i,this)[a]=b);else if(h instanceof Map)for(const a of h.keys())a.startsWith(m)&&(f(i,this)[a]=h.get(a));else for(const a in h)a.startsWith(m)&&(f(i,this)[a]=h[a])}get value(){return Object.keys(f(i,this)).sort((a,b)=>{var c,d;return parseInt(null!=(c=a.split(".").pop())?c:"0")-parseInt(null!=(d=b.split(".").pop())?d:"0")}).map(a=>f(i,this)[a]).join("")}chunk(a,b){let c=h(l,this,n).call(this);for(let d of h(l,this,m).call(this,{name:f(j,this).name,value:a,options:{...f(j,this).options,...b}}))c[d.name]=d;return Object.values(c)}clean(){return Object.values(h(l,this,n).call(this))}}},53754,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})},42078,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0});var e={encode:!0,decode:!0,getToken:!0};c.decode=l,c.encode=k,c.getToken=m;var f=a.r(14943),g=d(a.r(92147)),h=a.r(80741),i=a.r(68735),j=a.r(53754);async function k(a){let{token:b={},secret:c,maxAge:d=2592e3,salt:e=""}=a,g=await n(c,e);return await new f.EncryptJWT(b).setProtectedHeader({alg:"dir",enc:"A256GCM"}).setIssuedAt().setExpirationTime((Date.now()/1e3|0)+d).setJti((0,h.v4)()).encrypt(g)}async function l(a){let{token:b,secret:c,salt:d=""}=a;if(!b)return null;let e=await n(c,d),{payload:g}=await (0,f.jwtDecrypt)(b,e,{clockTolerance:15});return g}async function m(a){var b,c,d,e;let{req:f,secureCookie:g=null!=(b=null==(c=process.env.NEXTAUTH_URL)?void 0:c.startsWith("https://"))?b:!!process.env.VERCEL,cookieName:h=g?"__Secure-next-auth.session-token":"next-auth.session-token",raw:j,decode:k=l,logger:m=console,secret:n=null!=(d=process.env.NEXTAUTH_SECRET)?d:process.env.AUTH_SECRET}=a;if(!f)throw Error("Must pass `req` to JWT getToken()");let o=new i.SessionStore({name:h,options:{secure:g}},{cookies:f.cookies,headers:f.headers},m).value,p=f.headers instanceof Headers?f.headers.get("authorization"):null==(e=f.headers)?void 0:e.authorization;if(o||(null==p?void 0:p.split(" ")[0])!=="Bearer"||(o=decodeURIComponent(p.split(" ")[1])),!o)return null;if(j)return o;try{return await k({token:o,secret:n})}catch(a){return null}}async function n(a,b){return await (0,g.default)("sha256",a,b,`NextAuth.js Generated Encryption Key${b?` (${b})`:""}`,32)}Object.keys(j).forEach(function(a){"default"===a||"__esModule"===a||Object.prototype.hasOwnProperty.call(e,a)||a in c&&c[a]===j[a]||Object.defineProperty(c,a,{enumerable:!0,get:function(){return j[a]}})})},94047,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.pkce=c.nonce=c.PKCE_CODE_CHALLENGE_METHOD=void 0,c.signCookie=g,c.state=void 0;var d=a.r(22475),e=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=f(void 0);if(c&&c.has(a))return c.get(a);var d={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&({}).hasOwnProperty.call(a,g)){var h=e?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(d,g,h):d[g]=a[g]}return d.default=a,c&&c.set(a,d),d}(a.r(42078));function f(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(f=function(a){return a?c:b})(a)}async function g(a,b,c,d){let{cookies:f,logger:g}=d;g.debug(`CREATE_${a.toUpperCase()}`,{value:b,maxAge:c});let{name:h}=f[a],i=new Date;return i.setTime(i.getTime()+1e3*c),{name:h,value:await e.encode({...d.jwt,maxAge:c,token:{value:b},salt:h}),options:{...f[a].options,expires:i}}}let h=c.PKCE_CODE_CHALLENGE_METHOD="S256";c.pkce={async create(a,b,c){var e,f;if(!(null!=(e=a.provider)&&null!=(e=e.checks)&&e.includes("pkce")))return;let i=d.generators.codeVerifier();c.code_challenge=d.generators.codeChallenge(i),c.code_challenge_method=h;let j=null!=(f=a.cookies.pkceCodeVerifier.options.maxAge)?f:900;b.push(await g("pkceCodeVerifier",i,j,a))},async use(a,b,c,d){var f;if(!(null!=(f=c.provider)&&null!=(f=f.checks)&&f.includes("pkce")))return;let g=null==a?void 0:a[c.cookies.pkceCodeVerifier.name];if(!g)throw TypeError("PKCE code_verifier cookie was missing.");let{name:h}=c.cookies.pkceCodeVerifier,i=await e.decode({...c.jwt,token:g,salt:h});if(!(null!=i&&i.value))throw TypeError("PKCE code_verifier value could not be parsed.");b.push({name:h,value:"",options:{...c.cookies.pkceCodeVerifier.options,maxAge:0}}),d.code_verifier=i.value}},c.state={async create(a,b,c){var e,f;if(!(null!=(e=a.provider.checks)&&e.includes("state")))return;let h=d.generators.state();c.state=h;let i=null!=(f=a.cookies.state.options.maxAge)?f:900;b.push(await g("state",h,i,a))},async use(a,b,c,d){var f;if(!(null!=(f=c.provider.checks)&&f.includes("state")))return;let g=null==a?void 0:a[c.cookies.state.name];if(!g)throw TypeError("State cookie was missing.");let{name:h}=c.cookies.state,i=await e.decode({...c.jwt,token:g,salt:h});if(!(null!=i&&i.value))throw TypeError("State value could not be parsed.");b.push({name:h,value:"",options:{...c.cookies.state.options,maxAge:0}}),d.state=i.value}},c.nonce={async create(a,b,c){var e,f;if(!(null!=(e=a.provider.checks)&&e.includes("nonce")))return;let h=d.generators.nonce();c.nonce=h;let i=null!=(f=a.cookies.nonce.options.maxAge)?f:900;b.push(await g("nonce",h,i,a))},async use(a,b,c,d){var f;if(!(null!=(f=c.provider)&&null!=(f=f.checks)&&f.includes("nonce")))return;let g=null==a?void 0:a[c.cookies.nonce.name];if(!g)throw TypeError("Nonce cookie was missing.");let{name:h}=c.cookies.nonce,i=await e.decode({...c.jwt,token:g,salt:h});if(!(null!=i&&i.value))throw TypeError("Nonce value could not be parsed.");b.push({name:h,value:"",options:{...c.cookies.nonce.options,maxAge:0}}),d.nonce=i.value}}},95020,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=j;var d=a.r(22475),e=a.r(23242),f=a.r(52702),g=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=i(void 0);if(c&&c.has(a))return c.get(a);var d={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!==f&&({}).hasOwnProperty.call(a,f)){var g=e?Object.getOwnPropertyDescriptor(a,f):null;g&&(g.get||g.set)?Object.defineProperty(d,f,g):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}(a.r(94047)),h=a.r(18673);function i(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(i=function(a){return a?c:b})(a)}async function j(a){var b,c,i,j,l,m;let{options:n,query:o,body:p,method:q,cookies:r}=a,{logger:s,provider:t}=n,u=null!=(b=null==p?void 0:p.error)?b:null==o?void 0:o.error;if(u){let a=Error(u);throw s.error("OAUTH_CALLBACK_HANDLER_ERROR",{error:a,error_description:null==o?void 0:o.error_description,providerId:t.id}),s.debug("OAUTH_CALLBACK_HANDLER_ERROR",{body:p}),a}if(null!=(c=t.version)&&c.startsWith("1."))try{let a=await (0,f.oAuth1Client)(n),{oauth_token:b,oauth_verifier:c}=null!=o?o:{},d=await a.getOAuthAccessToken(b,f.oAuth1TokenStore.get(b),c),e=await a.get(t.profileUrl,d.oauth_token,d.oauth_token_secret);return"string"==typeof e&&(e=JSON.parse(e)),{...await k({profile:e,tokens:d,provider:t,logger:s}),cookies:[]}}catch(a){throw s.error("OAUTH_V1_GET_ACCESS_TOKEN_ERROR",a),a}null!=o&&o.oauth_token&&f.oAuth1TokenStore.delete(o.oauth_token);try{let a,b,c=await (0,e.openidClient)(n),f={},h=[];await g.state.use(r,h,n,f),await g.pkce.use(r,h,n,f),await g.nonce.use(r,h,n,f);let u={...c.callbackParams({url:`http://n?${new URLSearchParams(o)}`,body:p,method:q}),...null==(i=t.token)?void 0:i.params};if(null!=(j=t.token)&&j.request){let b=await t.token.request({provider:t,params:u,checks:f,client:c});a=new d.TokenSet(b.tokens)}else a=t.idToken?await c.callback(t.callbackUrl,u,f):await c.oauthCallback(t.callbackUrl,u,f);return Array.isArray(a.scope)&&(a.scope=a.scope.join(" ")),b=null!=(l=t.userinfo)&&l.request?await t.userinfo.request({provider:t,tokens:a,client:c}):t.idToken?a.claims():await c.userinfo(a,{params:null==(m=t.userinfo)?void 0:m.params}),{...await k({profile:b,provider:t,tokens:a,logger:s}),cookies:h}}catch(a){throw new h.OAuthCallbackError(a)}}async function k({profile:a,tokens:b,provider:c,logger:d}){try{var e;d.debug("PROFILE_DATA",{OAuthProfile:a});let f=await c.profile(a,b);if(f.email=null==(e=f.email)?void 0:e.toLowerCase(),!f.id)throw TypeError(`Profile id is missing in ${c.name} OAuth profile response`);return{profile:f,account:{provider:c.id,type:c.type,providerAccountId:f.id.toString(),...b},OAuthProfile:a}}catch(b){d.error("OAUTH_PARSE_PROFILE_ERROR",{error:b,OAuthProfile:a})}}},97055,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.createSecret=function(a){var b;let{authOptions:c,url:e}=a;return null!=(b=c.secret)?b:(0,d.createHash)("sha256").update(JSON.stringify({...e,...c})).digest("hex")},c.fromDate=function(a,b=Date.now()){return new Date(b+1e3*a)},c.hashToken=function(a,b){var c;let{provider:e,secret:f}=b;return(0,d.createHash)("sha256").update(`${a}${null!=(c=e.secret)?c:f}`).digest("hex")};var d=a.r(54799)},50700,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=f;var d=a.r(18673),e=a.r(97055);async function f(a){var b,c,f,g,h,i;let{sessionToken:j,profile:k,account:l,options:m}=a;if(!(null!=l&&l.providerAccountId)||!l.type)throw Error("Missing or invalid provider account");if(!["email","oauth"].includes(l.type))throw Error("Provider not supported");let{adapter:n,jwt:o,events:p,session:{strategy:q,generateSessionToken:r}}=m;if(!n)return{user:k,account:l};let{createUser:s,updateUser:t,getUser:u,getUserByAccount:v,getUserByEmail:w,linkAccount:x,createSession:y,getSessionAndUser:z,deleteSession:A}=n,B=null,C=null,D=!1,E="jwt"===q;if(j)if(E)try{(B=await o.decode({...o,token:j}))&&"sub"in B&&B.sub&&(C=await u(B.sub))}catch(a){}else{let a=await z(j);a&&(B=a.session,C=a.user)}if("email"===l.type){let a=await w(k.email);if(a)(null==(b=C)?void 0:b.id)!==a.id&&!E&&j&&await A(j),C=await t({id:a.id,emailVerified:new Date}),await (null==(c=p.updateUser)?void 0:c.call(p,{user:C}));else{let{id:a,...b}={...k,emailVerified:new Date};C=await s(b),await (null==(f=p.createUser)?void 0:f.call(p,{user:C})),D=!0}return{session:B=E?{}:await y({sessionToken:await r(),userId:C.id,expires:(0,e.fromDate)(m.session.maxAge)}),user:C,isNewUser:D}}if("oauth"===l.type){let a=await v({providerAccountId:l.providerAccountId,provider:l.provider});if(a){if(C){if(a.id===C.id)return{session:B,user:C,isNewUser:D};throw new d.AccountNotLinkedError("The account is already associated with another user")}return{session:B=E?{}:await y({sessionToken:await r(),userId:a.id,expires:(0,e.fromDate)(m.session.maxAge)}),user:a,isNewUser:D}}{if(C)return await x({...l,userId:C.id}),await (null==(i=p.linkAccount)?void 0:i.call(p,{user:C,account:l,profile:k})),{session:B,user:C,isNewUser:D};let a=k.email?await w(k.email):null;if(a){let b=m.provider;if(null!=b&&b.allowDangerousEmailAccountLinking)C=a;else throw new d.AccountNotLinkedError("Another account already exists with the same e-mail address")}else{let{id:a,...b}={...k,emailVerified:null};C=await s(b)}return await (null==(g=p.createUser)?void 0:g.call(p,{user:C})),await x({...l,userId:C.id}),await (null==(h=p.linkAccount)?void 0:h.call(p,{user:C,account:l,profile:k})),{session:B=E?{}:await y({sessionToken:await r(),userId:C.id,expires:(0,e.fromDate)(m.session.maxAge)}),user:C,isNewUser:!0}}}throw Error("Unsupported account type")}},1562,(a,b,c)=>{"use strict";async function d({email:a,adapter:b}){let{getUserByEmail:c}=b,d=a?await c(a):null;return d||{id:a,email:a,emailVerified:null}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=d},64333,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0}),c.default=i;var e=d(a.r(95020)),f=d(a.r(50700)),g=a.r(97055),h=d(a.r(1562));async function i(a){var b,c,d,i,j,k;let{options:l,query:m,body:n,method:o,headers:p,sessionStore:q}=a,{provider:r,adapter:s,url:t,callbackUrl:u,pages:v,jwt:w,events:x,callbacks:y,session:{strategy:z,maxAge:A},logger:B}=l,C=[],D="jwt"===z;if("oauth"===r.type)try{let{profile:d,account:g,OAuthProfile:h,cookies:i}=await (0,e.default)({query:m,body:n,method:o,options:l,cookies:a.cookies});i.length&&C.push(...i);try{if(B.debug("OAUTH_CALLBACK_RESPONSE",{profile:d,account:g,OAuthProfile:h}),!d||!g||!h)return{redirect:`${t}/signin`,cookies:C};let a=d;if(s){let{getUserByAccount:b}=s,c=await b({providerAccountId:g.providerAccountId,provider:r.id});c&&(a=c)}try{let b=await y.signIn({user:a,account:g,profile:h});if(!b)return{redirect:`${t}/error?error=AccessDenied`,cookies:C};if("string"==typeof b)return{redirect:b,cookies:C}}catch(a){return{redirect:`${t}/error?error=${encodeURIComponent(a.message)}`,cookies:C}}let{user:e,session:i,isNewUser:j}=await (0,f.default)({sessionToken:q.value,profile:d,account:g,options:l});if(D){let a={name:e.name,email:e.email,picture:e.image,sub:null==(c=e.id)?void 0:c.toString()},b=await y.jwt({token:a,user:e,account:g,profile:h,isNewUser:j,trigger:j?"signUp":"signIn"}),d=await w.encode({...w,token:b}),f=new Date;f.setTime(f.getTime()+1e3*A);let i=q.chunk(d,{expires:f});C.push(...i)}else C.push({name:l.cookies.sessionToken.name,value:i.sessionToken,options:{...l.cookies.sessionToken.options,expires:i.expires}});if(await (null==(b=x.signIn)?void 0:b.call(x,{user:e,account:g,profile:d,isNewUser:j})),j&&v.newUser)return{redirect:`${v.newUser}${v.newUser.includes("?")?"&":"?"}callbackUrl=${encodeURIComponent(u)}`,cookies:C};return{redirect:u,cookies:C}}catch(a){if("AccountNotLinkedError"===a.name)return{redirect:`${t}/error?error=OAuthAccountNotLinked`,cookies:C};if("CreateUserError"===a.name)return{redirect:`${t}/error?error=OAuthCreateAccount`,cookies:C};return B.error("OAUTH_CALLBACK_HANDLER_ERROR",a),{redirect:`${t}/error?error=Callback`,cookies:C}}}catch(a){if("OAuthCallbackError"===a.name)return B.error("OAUTH_CALLBACK_ERROR",{error:a,providerId:r.id}),{redirect:`${t}/error?error=OAuthCallback`,cookies:C};return B.error("OAUTH_CALLBACK_ERROR",a),{redirect:`${t}/error?error=Callback`,cookies:C}}if("email"===r.type)try{let a=null==m?void 0:m.token,b=null==m?void 0:m.email;if(!a)return{redirect:`${t}/error?error=configuration`,cookies:C};let c=await s.useVerificationToken({identifier:b,token:(0,g.hashToken)(a,l)});if(!c||c.expires.valueOf()<Date.now()||b&&c.identifier!==b)return{redirect:`${t}/error?error=Verification`,cookies:C};let e=await (0,h.default)({email:c.identifier,adapter:s}),j={providerAccountId:e.email,type:"email",provider:r.id};try{let a=await y.signIn({user:e,account:j});if(!a)return{redirect:`${t}/error?error=AccessDenied`,cookies:C};if("string"==typeof a)return{redirect:a,cookies:C}}catch(a){return{redirect:`${t}/error?error=${encodeURIComponent(a.message)}`,cookies:C}}let{user:k,session:n,isNewUser:o}=await (0,f.default)({sessionToken:q.value,profile:e,account:j,options:l});if(D){let a={name:k.name,email:k.email,picture:k.image,sub:null==(i=k.id)?void 0:i.toString()},b=await y.jwt({token:a,user:k,account:j,isNewUser:o,trigger:o?"signUp":"signIn"}),c=await w.encode({...w,token:b}),d=new Date;d.setTime(d.getTime()+1e3*A);let e=q.chunk(c,{expires:d});C.push(...e)}else C.push({name:l.cookies.sessionToken.name,value:n.sessionToken,options:{...l.cookies.sessionToken.options,expires:n.expires}});if(await (null==(d=x.signIn)?void 0:d.call(x,{user:k,account:j,isNewUser:o})),o&&v.newUser)return{redirect:`${v.newUser}${v.newUser.includes("?")?"&":"?"}callbackUrl=${encodeURIComponent(u)}`,cookies:C};return{redirect:u,cookies:C}}catch(a){if("CreateUserError"===a.name)return{redirect:`${t}/error?error=EmailCreateAccount`,cookies:C};return B.error("CALLBACK_EMAIL_ERROR",a),{redirect:`${t}/error?error=Callback`,cookies:C}}if("credentials"===r.type&&"POST"===o){let a;try{if(!(a=await r.authorize(n,{query:m,body:n,headers:p,method:o})))return{status:401,redirect:`${t}/error?${new URLSearchParams({error:"CredentialsSignin",provider:r.id})}`,cookies:C}}catch(a){return{status:401,redirect:`${t}/error?error=${encodeURIComponent(a.message)}`,cookies:C}}let b={providerAccountId:a.id,type:"credentials",provider:r.id};try{let c=await y.signIn({user:a,account:b,credentials:n});if(!c)return{status:403,redirect:`${t}/error?error=AccessDenied`,cookies:C};if("string"==typeof c)return{redirect:c,cookies:C}}catch(a){return{redirect:`${t}/error?error=${encodeURIComponent(a.message)}`,cookies:C}}let c={name:a.name,email:a.email,picture:a.image,sub:null==(j=a.id)?void 0:j.toString()},d=await y.jwt({token:c,user:a,account:b,isNewUser:!1,trigger:"signIn"}),e=await w.encode({...w,token:d}),f=new Date;f.setTime(f.getTime()+1e3*A);let g=q.chunk(e,{expires:f});return C.push(...g),await (null==(k=x.signIn)?void 0:k.call(x,{user:a,account:b})),{redirect:u,cookies:C}}return{status:500,body:`Error: Callback for provider type ${r.type} not supported`,cookies:C}}},54928,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=h;var d=a.r(23242),e=a.r(52702),f=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=g(void 0);if(c&&c.has(a))return c.get(a);var d={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!==f&&({}).hasOwnProperty.call(a,f)){var h=e?Object.getOwnPropertyDescriptor(a,f):null;h&&(h.get||h.set)?Object.defineProperty(d,f,h):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}(a.r(94047));function g(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(g=function(a){return a?c:b})(a)}async function h({options:a,query:b}){var c,g,h;let{logger:i,provider:j}=a,k={};if("string"==typeof j.authorization){let a=Object.fromEntries(new URL(j.authorization).searchParams);k={...k,...a}}else k={...k,...null==(g=j.authorization)?void 0:g.params};if(k={...k,...b},null!=(c=j.version)&&c.startsWith("1.")){let b=(0,e.oAuth1Client)(a),c=await b.getOAuthRequestToken(k),d=`${null==(h=j.authorization)?void 0:h.url}?${new URLSearchParams({oauth_token:c.oauth_token,oauth_token_secret:c.oauth_token_secret,...c.params})}`;return e.oAuth1TokenStore.set(c.oauth_token,c.oauth_token_secret),i.debug("GET_AUTHORIZATION_URL",{url:d,provider:j}),{redirect:d}}let l=await (0,d.openidClient)(a),m=k,n=[];await f.state.create(a,n,m),await f.pkce.create(a,n,m),await f.nonce.create(a,n,m);let o=l.authorizationUrl(m);return i.debug("GET_AUTHORIZATION_URL",{url:o,cookies:n,provider:j}),{redirect:o,cookies:n}}},87683,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=f;var d=a.r(54799),e=a.r(97055);async function f(a,b){var c,f,g,h;let{url:i,adapter:j,provider:k,callbackUrl:l,theme:m}=b,n=null!=(c=await (null==(f=k.generateVerificationToken)?void 0:f.call(k)))?c:(0,d.randomBytes)(32).toString("hex"),o=new Date(Date.now()+(null!=(g=k.maxAge)?g:86400)*1e3),p=new URLSearchParams({callbackUrl:l,token:n,email:a}),q=`${i}/callback/${k.id}?${p}`;return await Promise.all([k.sendVerificationRequest({identifier:a,token:n,expires:o,url:q,provider:k,theme:m}),null==(h=j.createVerificationToken)?void 0:h.call(j,{identifier:a,token:(0,e.hashToken)(n,b),expires:o})]),`${i}/verify-request?${new URLSearchParams({provider:k.id,type:k.type})}`}},53311,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0}),c.default=h;var e=d(a.r(54928)),f=d(a.r(87683)),g=d(a.r(1562));async function h(a){let{options:b,query:c,body:d}=a,{url:h,callbacks:i,logger:j,provider:k}=b;if(!k.type)return{status:500,text:`Error: Type not specified for ${k.name}`};if("oauth"===k.type)try{return await (0,e.default)({options:b,query:c})}catch(a){return j.error("SIGNIN_OAUTH_ERROR",{error:a,providerId:k.id}),{redirect:`${h}/error?error=OAuthSignin`}}if("email"===k.type){var l;let a=null==d?void 0:d.email;if(!a)return{redirect:`${h}/error?error=EmailSignin`};let c=null!=(l=k.normalizeIdentifier)?l:a=>{var b;let c=a.trim();if(1!==(null!=(b=c.match(/@/g))?b:[]).length||c.includes('"'))throw Error("Invalid email address format.");let[d,e]=c.toLowerCase().split("@");if(!d||!e||!(e=e.split(",")[0]).includes("."))throw Error("Invalid email address format.");return`${d}@${e}`};try{a=c(null==d?void 0:d.email)}catch(a){return j.error("SIGNIN_EMAIL_ERROR",{error:a,providerId:k.id}),{redirect:`${h}/error?error=EmailSignin`}}let e=await (0,g.default)({email:a,adapter:b.adapter}),m={providerAccountId:a,userId:a,type:"email",provider:k.id};try{let a=await i.signIn({user:e,account:m,email:{verificationRequest:!0}});if(!a)return{redirect:`${h}/error?error=AccessDenied`};if("string"==typeof a)return{redirect:a}}catch(a){return{redirect:`${h}/error?${new URLSearchParams({error:a})}`}}try{return{redirect:await (0,f.default)(a,b)}}catch(a){return j.error("SIGNIN_EMAIL_ERROR",{error:a,providerId:k.id}),{redirect:`${h}/error?error=EmailSignin`}}}return{redirect:`${h}/signin`}}},76453,(a,b,c)=>{"use strict";async function d(a){var b,c;let{options:d,sessionStore:e}=a,{adapter:f,events:g,jwt:h,callbackUrl:i,logger:j,session:k}=d,l=null==e?void 0:e.value;if(!l)return{redirect:i};if("jwt"===k.strategy)try{let a=await h.decode({...h,token:l});await (null==(b=g.signOut)?void 0:b.call(g,{token:a}))}catch(a){j.error("SIGNOUT_ERROR",a)}else try{let a=await f.deleteSession(l);await (null==(c=g.signOut)?void 0:c.call(g,{session:a}))}catch(a){j.error("SIGNOUT_ERROR",a)}return{redirect:i,cookies:e.clean()}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=d},66994,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=e;var d=a.r(97055);async function e(a){var b,c,e,f,g,h;let{options:i,sessionStore:j,newSession:k,isUpdate:l}=a,{adapter:m,jwt:n,events:o,callbacks:p,logger:q,session:{strategy:r,maxAge:s}}=i,t={body:{},headers:[{key:"Content-Type",value:"application/json"},...l?[]:[{key:"Cache-Control",value:"private, no-cache, no-store"},{key:"Pragma",value:"no-cache"},{key:"Expires",value:"0"}]].filter(Boolean),cookies:[]},u=j.value;if(!u)return t;if("jwt"===r)try{let a=await n.decode({...n,token:u});if(!a)throw Error("JWT invalid");let e=await p.jwt({token:a,...l&&{trigger:"update"},session:k}),f=(0,d.fromDate)(s),g=await p.session({session:{user:{name:null==a?void 0:a.name,email:null==a?void 0:a.email,image:null==a?void 0:a.picture},expires:f.toISOString()},token:e});t.body=g;let h=await n.encode({...n,token:e,maxAge:i.session.maxAge}),m=j.chunk(h,{expires:f});null==(b=t.cookies)||b.push(...m),await (null==(c=o.session)?void 0:c.call(o,{session:g,token:e}))}catch(a){q.error("JWT_SESSION_ERROR",a),null==(e=t.cookies)||e.push(...j.clean())}else try{let{getSessionAndUser:a,deleteSession:b,updateSession:c}=m,e=await a(u);if(e&&e.session.expires.valueOf()<Date.now()&&(await b(u),e=null),e){let{user:a,session:b}=e,h=i.session.updateAge,j=b.expires.valueOf()-1e3*s+1e3*h,m=(0,d.fromDate)(s);j<=Date.now()&&await c({sessionToken:u,expires:m});let n=await p.session({session:{user:{name:a.name,email:a.email,image:a.image},expires:b.expires.toISOString()},user:a,newSession:k,...l?{trigger:"update"}:{}});t.body=n,null==(f=t.cookies)||f.push({name:i.cookies.sessionToken.name,value:u,options:{...i.cookies.sessionToken.options,expires:m}}),await (null==(g=o.session)?void 0:g.call(o,{session:n}))}else u&&(null==(h=t.cookies)||h.push(...j.clean()))}catch(a){q.error("SESSION_ERROR",a)}return t}},54454,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){return{headers:[{key:"Content-Type",value:"application/json"}],body:a.reduce((a,{id:b,name:c,type:d,signinUrl:e,callbackUrl:f})=>(a[b]={id:b,name:c,type:d,signinUrl:e,callbackUrl:f},a),{})}}},76992,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"callback",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(c,"providers",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"session",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(c,"signin",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(c,"signout",{enumerable:!0,get:function(){return g.default}});var e=d(a.r(64333)),f=d(a.r(53311)),g=d(a.r(76453)),h=d(a.r(66994)),i=d(a.r(54454))},89887,(a,b,c)=>{var d,e,f,g,h,i,j={},k=[],l=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function m(a,b){for(var c in b)a[c]=b[c];return a}function n(a){var b=a.parentNode;b&&b.removeChild(a)}function o(a,b,c){var e,f,g,h={};for(g in b)"key"==g?e=b[g]:"ref"==g?f=b[g]:h[g]=b[g];if(arguments.length>2&&(h.children=arguments.length>3?d.call(arguments,2):c),"function"==typeof a&&null!=a.defaultProps)for(g in a.defaultProps)void 0===h[g]&&(h[g]=a.defaultProps[g]);return p(a,h,e,f,null)}function p(a,b,c,d,g){var h={type:a,props:b,key:c,ref:d,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==g?++f:g};return null==g&&null!=e.vnode&&e.vnode(h),h}function q(a){return a.children}function r(a,b){this.props=a,this.context=b}function s(a,b){if(null==b)return a.__?s(a.__,a.__.__k.indexOf(a)+1):null;for(var c;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e)return c.__e;return"function"==typeof a.type?s(a):null}function t(a){(!a.__d&&(a.__d=!0)&&g.push(a)&&!u.__r++||h!==e.debounceRendering)&&((h=e.debounceRendering)||setTimeout)(u)}function u(){for(var a;u.__r=g.length;)a=g.sort(function(a,b){return a.__v.__b-b.__v.__b}),g=[],a.some(function(a){var b,c,d,e,f;a.__d&&(e=(d=a.__v).__e,(f=a.__P)&&(b=[],(c=m({},d)).__v=d.__v+1,B(f,d,c,a.__n,void 0!==f.ownerSVGElement,null!=d.__h?[e]:null,b,null==e?s(d):e,d.__h),C(b,d),d.__e!=e&&function a(b){var c,d;if(null!=(b=b.__)&&null!=b.__c){for(b.__e=b.__c.base=null,c=0;c<b.__k.length;c++)if(null!=(d=b.__k[c])&&null!=d.__e){b.__e=b.__c.base=d.__e;break}return a(b)}}(d)))})}function v(a,b,c,d,f,g,h,i,l,m){var o,r,t,u,v,x,y,z=d&&d.__k||k,A=z.length;for(c.__k=[],o=0;o<b.length;o++)if(null!=(u=c.__k[o]=null==(u=b[o])||"boolean"==typeof u?null:"string"==typeof u||"number"==typeof u||"bigint"==typeof u?p(null,u,null,null,u):Array.isArray(u)?p(q,{children:u},null,null,null):u.__b>0?p(u.type,u.props,u.key,u.ref?u.ref:null,u.__v):u)){if(u.__=c,u.__b=c.__b+1,null===(t=z[o])||t&&u.key==t.key&&u.type===t.type)z[o]=void 0;else for(r=0;r<A;r++){if((t=z[r])&&u.key==t.key&&u.type===t.type){z[r]=void 0;break}t=null}B(a,u,t=t||j,f,g,h,i,l,m),v=u.__e,(r=u.ref)&&t.ref!=r&&(y||(y=[]),t.ref&&y.push(t.ref,null,u),y.push(r,u.__c||v,u)),null!=v?(null==x&&(x=v),"function"==typeof u.type&&u.__k===t.__k?u.__d=l=function a(b,c,d){for(var e,f=b.__k,g=0;f&&g<f.length;g++)(e=f[g])&&(e.__=b,c="function"==typeof e.type?a(e,c,d):w(d,e,e,f,e.__e,c));return c}(u,l,a):l=w(a,u,t,z,v,l),"function"==typeof c.type&&(c.__d=l)):l&&t.__e==l&&l.parentNode!=a&&(l=s(t))}for(c.__e=x,o=A;o--;)null!=z[o]&&function a(b,c,d){var f,g;if(e.unmount&&e.unmount(b),(f=b.ref)&&(f.current&&f.current!==b.__e||D(f,null,c)),null!=(f=b.__c)){if(f.componentWillUnmount)try{f.componentWillUnmount()}catch(a){e.__e(a,c)}f.base=f.__P=null,b.__c=void 0}if(f=b.__k)for(g=0;g<f.length;g++)f[g]&&a(f[g],c,d||"function"!=typeof b.type);d||null==b.__e||n(b.__e),b.__=b.__e=b.__d=void 0}(z[o],z[o]);if(y)for(o=0;o<y.length;o++)D(y[o],y[++o],y[++o])}function w(a,b,c,d,e,f){var g,h,i;if(void 0!==b.__d)g=b.__d,b.__d=void 0;else if(null==c||e!=f||null==e.parentNode)a:if(null==f||f.parentNode!==a)a.appendChild(e),g=null;else{for(h=f,i=0;(h=h.nextSibling)&&i<d.length;i+=1)if(h==e)break a;a.insertBefore(e,f),g=f}return void 0!==g?g:e.nextSibling}function x(a,b,c){"-"===b[0]?a.setProperty(b,c):a[b]=null==c?"":"number"!=typeof c||l.test(b)?c:c+"px"}function y(a,b,c,d,e){var f;a:if("style"===b)if("string"==typeof c)a.style.cssText=c;else{if("string"==typeof d&&(a.style.cssText=d=""),d)for(b in d)c&&b in c||x(a.style,b,"");if(c)for(b in c)d&&c[b]===d[b]||x(a.style,b,c[b])}else if("o"===b[0]&&"n"===b[1])f=b!==(b=b.replace(/Capture$/,"")),b=b.toLowerCase()in a?b.toLowerCase().slice(2):b.slice(2),a.l||(a.l={}),a.l[b+f]=c,c?d||a.addEventListener(b,f?A:z,f):a.removeEventListener(b,f?A:z,f);else if("dangerouslySetInnerHTML"!==b){if(e)b=b.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==b&&"list"!==b&&"form"!==b&&"tabIndex"!==b&&"download"!==b&&b in a)try{a[b]=null==c?"":c;break a}catch(a){}"function"==typeof c||(null==c||!1===c&&-1==b.indexOf("-")?a.removeAttribute(b):a.setAttribute(b,c))}}function z(a){this.l[a.type+!1](e.event?e.event(a):a)}function A(a){this.l[a.type+!0](e.event?e.event(a):a)}function B(a,b,c,f,g,h,i,k,l){var o,p,t,u,w,x,z,A,B,C,D,F,G,H,I,J=b.type;if(void 0!==b.constructor)return null;null!=c.__h&&(l=c.__h,k=b.__e=c.__e,b.__h=null,h=[k]),(o=e.__b)&&o(b);try{a:if("function"==typeof J){if(A=b.props,B=(o=J.contextType)&&f[o.__c],C=o?B?B.props.value:o.__:f,c.__c?z=(p=b.__c=c.__c).__=p.__E:("prototype"in J&&J.prototype.render?b.__c=p=new J(A,C):(b.__c=p=new r(A,C),p.constructor=J,p.render=E),B&&B.sub(p),p.props=A,p.state||(p.state={}),p.context=C,p.__n=f,t=p.__d=!0,p.__h=[],p._sb=[]),null==p.__s&&(p.__s=p.state),null!=J.getDerivedStateFromProps&&(p.__s==p.state&&(p.__s=m({},p.__s)),m(p.__s,J.getDerivedStateFromProps(A,p.__s))),u=p.props,w=p.state,t)null==J.getDerivedStateFromProps&&null!=p.componentWillMount&&p.componentWillMount(),null!=p.componentDidMount&&p.__h.push(p.componentDidMount);else{if(null==J.getDerivedStateFromProps&&A!==u&&null!=p.componentWillReceiveProps&&p.componentWillReceiveProps(A,C),!p.__e&&null!=p.shouldComponentUpdate&&!1===p.shouldComponentUpdate(A,p.__s,C)||b.__v===c.__v){for(p.props=A,p.state=p.__s,b.__v!==c.__v&&(p.__d=!1),p.__v=b,b.__e=c.__e,b.__k=c.__k,b.__k.forEach(function(a){a&&(a.__=b)}),D=0;D<p._sb.length;D++)p.__h.push(p._sb[D]);p._sb=[],p.__h.length&&i.push(p);break a}null!=p.componentWillUpdate&&p.componentWillUpdate(A,p.__s,C),null!=p.componentDidUpdate&&p.__h.push(function(){p.componentDidUpdate(u,w,x)})}if(p.context=C,p.props=A,p.__v=b,p.__P=a,F=e.__r,G=0,"prototype"in J&&J.prototype.render){for(p.state=p.__s,p.__d=!1,F&&F(b),o=p.render(p.props,p.state,p.context),H=0;H<p._sb.length;H++)p.__h.push(p._sb[H]);p._sb=[]}else do p.__d=!1,F&&F(b),o=p.render(p.props,p.state,p.context),p.state=p.__s;while(p.__d&&++G<25)p.state=p.__s,null!=p.getChildContext&&(f=m(m({},f),p.getChildContext())),t||null==p.getSnapshotBeforeUpdate||(x=p.getSnapshotBeforeUpdate(u,w)),I=null!=o&&o.type===q&&null==o.key?o.props.children:o,v(a,Array.isArray(I)?I:[I],b,c,f,g,h,i,k,l),p.base=b.__e,b.__h=null,p.__h.length&&i.push(p),z&&(p.__E=p.__=null),p.__e=!1}else null==h&&b.__v===c.__v?(b.__k=c.__k,b.__e=c.__e):b.__e=function(a,b,c,e,f,g,h,i){var k,l,m,o=c.props,p=b.props,q=b.type,r=0;if("svg"===q&&(f=!0),null!=g){for(;r<g.length;r++)if((k=g[r])&&"setAttribute"in k==!!q&&(q?k.localName===q:3===k.nodeType)){a=k,g[r]=null;break}}if(null==a){if(null===q)return document.createTextNode(p);a=f?document.createElementNS("http://www.w3.org/2000/svg",q):document.createElement(q,p.is&&p),g=null,i=!1}if(null===q)o===p||i&&a.data===p||(a.data=p);else{if(g=g&&d.call(a.childNodes),l=(o=c.props||j).dangerouslySetInnerHTML,m=p.dangerouslySetInnerHTML,!i){if(null!=g)for(o={},r=0;r<a.attributes.length;r++)o[a.attributes[r].name]=a.attributes[r].value;(m||l)&&(m&&(l&&m.__html==l.__html||m.__html===a.innerHTML)||(a.innerHTML=m&&m.__html||""))}if(function(a,b,c,d,e){var f;for(f in c)"children"===f||"key"===f||f in b||y(a,f,null,c[f],d);for(f in b)e&&"function"!=typeof b[f]||"children"===f||"key"===f||"value"===f||"checked"===f||c[f]===b[f]||y(a,f,b[f],c[f],d)}(a,p,o,f,i),m)b.__k=[];else if(v(a,Array.isArray(r=b.props.children)?r:[r],b,c,e,f&&"foreignObject"!==q,g,h,g?g[0]:c.__k&&s(c,0),i),null!=g)for(r=g.length;r--;)null!=g[r]&&n(g[r]);i||("value"in p&&void 0!==(r=p.value)&&(r!==a.value||"progress"===q&&!r||"option"===q&&r!==o.value)&&y(a,"value",r,o.value,!1),"checked"in p&&void 0!==(r=p.checked)&&r!==a.checked&&y(a,"checked",r,o.checked,!1))}return a}(c.__e,b,c,f,g,h,i,l);(o=e.diffed)&&o(b)}catch(a){b.__v=null,(l||null!=h)&&(b.__e=k,b.__h=!!l,h[h.indexOf(k)]=null),e.__e(a,b,c)}}function C(a,b){e.__c&&e.__c(b,a),a.some(function(b){try{a=b.__h,b.__h=[],a.some(function(a){a.call(b)})}catch(a){e.__e(a,b.__v)}})}function D(a,b,c){try{"function"==typeof a?a(b):a.current=b}catch(a){e.__e(a,c)}}function E(a,b,c){return this.constructor(a,c)}function F(a,b,c){var f,g,h;e.__&&e.__(a,b),g=(f="function"==typeof c)?null:c&&c.__k||b.__k,h=[],B(b,a=(!f&&c||b).__k=o(q,null,[a]),g||j,j,void 0!==b.ownerSVGElement,!f&&c?[c]:g?null:b.firstChild?d.call(b.childNodes):null,h,!f&&c?c:g?g.__e:b.firstChild,f),C(h,a)}d=k.slice,e={__e:function(a,b,c,d){for(var e,f,g;b=b.__;)if((e=b.__c)&&!e.__)try{if((f=e.constructor)&&null!=f.getDerivedStateFromError&&(e.setState(f.getDerivedStateFromError(a)),g=e.__d),null!=e.componentDidCatch&&(e.componentDidCatch(a,d||{}),g=e.__d),g)return e.__E=e}catch(b){a=b}throw a}},f=0,r.prototype.setState=function(a,b){var c;c=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=m({},this.state),"function"==typeof a&&(a=a(m({},c),this.props)),a&&m(c,a),null!=a&&this.__v&&(b&&this._sb.push(b),t(this))},r.prototype.forceUpdate=function(a){this.__v&&(this.__e=!0,a&&this.__h.push(a),t(this))},r.prototype.render=q,g=[],u.__r=0,i=0,c.Component=r,c.Fragment=q,c.cloneElement=function(a,b,c){var e,f,g,h=m({},a.props);for(g in b)"key"==g?e=b[g]:"ref"==g?f=b[g]:h[g]=b[g];return arguments.length>2&&(h.children=arguments.length>3?d.call(arguments,2):c),p(a.type,h,e||a.key,f||a.ref,null)},c.createContext=function(a,b){var c={__c:b="__cC"+i++,__:a,Consumer:function(a,b){return a.children(b)},Provider:function(a){var c,d;return this.getChildContext||(c=[],(d={})[b]=this,this.getChildContext=function(){return d},this.shouldComponentUpdate=function(a){this.props.value!==a.value&&c.some(t)},this.sub=function(a){c.push(a);var b=a.componentWillUnmount;a.componentWillUnmount=function(){c.splice(c.indexOf(a),1),b&&b.call(a)}}),a.children}};return c.Provider.__=c.Consumer.contextType=c},c.createElement=o,c.createRef=function(){return{current:null}},c.h=o,c.hydrate=function a(b,c){F(b,c,a)},c.isValidElement=function(a){return null!=a&&void 0===a.constructor},c.options=e,c.render=F,c.toChildArray=function a(b,c){return c=c||[],null==b||"boolean"==typeof b||(Array.isArray(b)?b.some(function(b){a(b,c)}):c.push(b)),c}},41648,(a,b,c)=>{a.e,function(a,b){var c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,d=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,e=/[\s\n\\/='"\0<>]/,f=/^xlink:?./,g=/["&<]/;function h(a){if(!1===g.test(a+=""))return a;for(var b=0,c=0,d="",e="";c<a.length;c++){switch(a.charCodeAt(c)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 60:e="&lt;";break;default:continue}c!==b&&(d+=a.slice(b,c)),d+=e,b=c+1}return c!==b&&(d+=a.slice(b,c)),d}var i=function(a,b){return String(a).replace(/(\n+)/g,"$1"+(b||"	"))},j=function(a,b,c){return String(a).length>(b||40)||!c&&-1!==String(a).indexOf("\n")||-1!==String(a).indexOf("<")},k={},l=/([A-Z])/g;function m(a){var b="";for(var d in a){var e=a[d];null!=e&&""!==e&&(b&&(b+=" "),b+="-"==d[0]?d:k[d]||(k[d]=d.replace(l,"-$1").toLowerCase()),b="number"==typeof e&&!1===c.test(d)?b+": "+e+"px;":b+": "+e+";")}return b||void 0}function n(a,b){return Array.isArray(b)?b.reduce(n,a):null!=b&&!1!==b&&a.push(b),a}function o(){this.__d=!0}function p(a,b){return{__v:a,context:b,props:a.props,setState:o,forceUpdate:o,__d:!0,__h:[]}}function q(a,b){var c=a.contextType,d=c&&b[c.__c];return null!=c?d?d.props.value:c.__:b}var r=[],s={shallow:!0};v.render=v;var t=function(a,b){return v(a,b,s)},u=[];function v(a,c,g){c=c||{};var k,l=b.options.__s;return b.options.__s=!0,k=g&&(g.pretty||g.voidElements||g.sortAttributes||g.shallow||g.allAttributes||g.xml||g.attributeHook)?function a(c,g,k,l,o,s){if(null==c||"boolean"==typeof c)return"";if("object"!=typeof c)return h(c);var t=k.pretty,u=t&&"string"==typeof t?t:"	";if(Array.isArray(c)){for(var v="",w=0;w<c.length;w++)t&&w>0&&(v+="\n"),v+=a(c[w],g,k,l,o,s);return v}var x,y=c.type,z=c.props,A=!1;if("function"==typeof y){if(A=!0,!k.shallow||!l&&!1!==k.renderRootComponent){if(y===b.Fragment){var B=[];return n(B,c.props.children),a(B,g,k,!1!==k.shallowHighOrder,o,s)}var C,D=c.__c=p(c,g);b.options.__b&&b.options.__b(c);var E=b.options.__r;if(y.prototype&&"function"==typeof y.prototype.render){var F=q(y,g);(D=c.__c=new y(z,F)).__v=c,D._dirty=D.__d=!0,D.props=z,null==D.state&&(D.state={}),null==D._nextState&&null==D.__s&&(D._nextState=D.__s=D.state),D.context=F,y.getDerivedStateFromProps?D.state=Object.assign({},D.state,y.getDerivedStateFromProps(D.props,D.state)):D.componentWillMount&&(D.componentWillMount(),D.state=D._nextState!==D.state?D._nextState:D.__s!==D.state?D.__s:D.state),E&&E(c),C=D.render(D.props,D.state,D.context)}else for(var G=q(y,g),H=0;D.__d&&H++<25;)D.__d=!1,E&&E(c),C=y.call(c.__c,z,G);return D.getChildContext&&(g=Object.assign({},g,D.getChildContext())),b.options.diffed&&b.options.diffed(c),a(C,g,k,!1!==k.shallowHighOrder,o,s)}y=(x=y).displayName||x!==Function&&x.name||function(a){var b=(Function.prototype.toString.call(a).match(/^\s*function\s+([^( ]+)/)||"")[1];if(!b){for(var c=-1,d=r.length;d--;)if(r[d]===a){c=d;break}c<0&&(c=r.push(a)-1),b="UnnamedComponent"+c}return b}(x)}var I,J,K="<"+y;if(z){var L=Object.keys(z);k&&!0===k.sortAttributes&&L.sort();for(var M=0;M<L.length;M++){var N=L[M],O=z[N];if("children"!==N){if(!e.test(N)&&(k&&k.allAttributes||"key"!==N&&"ref"!==N&&"__self"!==N&&"__source"!==N)){if("defaultValue"===N)N="value";else if("defaultChecked"===N)N="checked";else if("defaultSelected"===N)N="selected";else if("className"===N){if(void 0!==z.class)continue;N="class"}else o&&f.test(N)&&(N=N.toLowerCase().replace(/^xlink:?/,"xlink:"));if("htmlFor"===N){if(z.for)continue;N="for"}"style"===N&&O&&"object"==typeof O&&(O=m(O)),"a"===N[0]&&"r"===N[1]&&"boolean"==typeof O&&(O=String(O));var P=k.attributeHook&&k.attributeHook(N,O,g,k,A);if(P||""===P)K+=P;else if("dangerouslySetInnerHTML"===N)J=O&&O.__html;else if("textarea"===y&&"value"===N)I=O;else if((O||0===O||""===O)&&"function"!=typeof O){if(!(!0!==O&&""!==O||(O=N,k&&k.xml))){K=K+" "+N;continue}if("value"===N){if("select"===y){s=O;continue}"option"===y&&s==O&&void 0===z.selected&&(K+=" selected")}K=K+" "+N+'="'+h(O)+'"'}}}else I=O}}if(t){var Q=K.replace(/\n\s*/," ");Q===K||~Q.indexOf("\n")?t&&~K.indexOf("\n")&&(K+="\n"):K=Q}if(K+=">",e.test(y))throw Error(y+" is not a valid HTML tag name in "+K);var R,S=d.test(y)||k.voidElements&&k.voidElements.test(y),T=[];if(J)t&&j(J)&&(J="\n"+u+i(J,u)),K+=J;else if(null!=I&&n(R=[],I).length){for(var U=t&&~K.indexOf("\n"),V=!1,W=0;W<R.length;W++){var X=R[W];if(null!=X&&!1!==X){var Y=a(X,g,k,!0,"svg"===y||"foreignObject"!==y&&o,s);if(t&&!U&&j(Y)&&(U=!0),Y)if(t){var Z=Y.length>0&&"<"!=Y[0];V&&Z?T[T.length-1]+=Y:T.push(Y),V=Z}else T.push(Y)}}if(t&&U)for(var $=T.length;$--;)T[$]="\n"+u+i(T[$],u)}if(T.length||J)K+=T.join("");else if(k&&k.xml)return K.substring(0,K.length-1)+" />";return!S||R||J?(t&&~K.indexOf("\n")&&(K+="\n"),K=K+"</"+y+">"):K=K.replace(/>$/," />"),K}(a,c,g):function a(c,g,i,j){if(null==c||!0===c||!1===c||""===c)return"";if("object"!=typeof c)return h(c);if(w(c)){for(var k="",l=0;l<c.length;l++)k+=a(c[l],g,i,j);return k}b.options.__b&&b.options.__b(c);var n=c.type,o=c.props;if("function"==typeof n){if(n===b.Fragment)return a(c.props.children,g,i,j);var r,s,t,u,v,y=n.prototype&&"function"==typeof n.prototype.render?(r=g,t=q(s=c.type,r),u=new s(c.props,t),c.__c=u,u.__v=c,u.__d=!0,u.props=c.props,null==u.state&&(u.state={}),null==u.__s&&(u.__s=u.state),u.context=t,s.getDerivedStateFromProps?u.state=x({},u.state,s.getDerivedStateFromProps(u.props,u.state)):u.componentWillMount&&(u.componentWillMount(),u.state=u.__s!==u.state?u.__s:u.state),(v=b.options.__r)&&v(c),u.render(u.props,u.state,u.context)):function(a,c){var d,e=p(a,c),f=q(a.type,c);a.__c=e;for(var g=b.options.__r,h=0;e.__d&&h++<25;)e.__d=!1,g&&g(a),d=a.type.call(e,a.props,f);return d}(c,g),z=c.__c;z.getChildContext&&(g=x({},g,z.getChildContext()));var A=a(y,g,i,j);return b.options.diffed&&b.options.diffed(c),A}var B,C,D="<";if(D+=n,o)for(var E in B=o.children,o){var F,G,H,I=o[E];if(!("key"===E||"ref"===E||"__self"===E||"__source"===E||"children"===E||"className"===E&&"class"in o||"htmlFor"===E&&"for"in o||e.test(E))){if(G=E="className"===(F=E)?"class":"htmlFor"===F?"for":"defaultValue"===F?"value":"defaultChecked"===F?"checked":"defaultSelected"===F?"selected":i&&f.test(F)?F.toLowerCase().replace(/^xlink:?/,"xlink:"):F,H=I,I="style"===G&&null!=H&&"object"==typeof H?m(H):"a"===G[0]&&"r"===G[1]&&"boolean"==typeof H?String(H):H,"dangerouslySetInnerHTML"===E)C=I&&I.__html;else if("textarea"===n&&"value"===E)B=I;else if((I||0===I||""===I)&&"function"!=typeof I){if(!0===I||""===I){I=E,D=D+" "+E;continue}if("value"===E){if("select"===n){j=I;continue}"option"!==n||j!=I||"selected"in o||(D+=" selected")}D=D+" "+E+'="'+h(I)+'"'}}}var J=D;if(D+=">",e.test(n))throw Error(n+" is not a valid HTML tag name in "+D);var K="",L=!1;if(C)K+=C,L=!0;else if("string"==typeof B)K+=h(B),L=!0;else if(w(B))for(var M=0;M<B.length;M++){var N=B[M];if(null!=N&&!1!==N){var O=a(N,g,"svg"===n||"foreignObject"!==n&&i,j);O&&(K+=O,L=!0)}}else if(null!=B&&!1!==B&&!0!==B){var P=a(B,g,"svg"===n||"foreignObject"!==n&&i,j);P&&(K+=P,L=!0)}if(b.options.diffed&&b.options.diffed(c),L)D+=K;else if(d.test(n))return J+" />";return D+"</"+n+">"}(a,c,!1,void 0),b.options.__c&&b.options.__c(a,u),b.options.__s=l,u.length=0,k}var w=Array.isArray,x=Object.assign;v.shallowRender=t,a.default=v,a.render=v,a.renderToStaticMarkup=v,a.renderToString=v,a.shallowRender=t}(c,a.r(89887))},10803,(a,b,c)=>{b.exports=a.r(41648).default},27569,(a,b,c)=>{function d(){return b.exports=d=Object.assign.bind(),b.exports.__esModule=!0,b.exports.default=b.exports,d.apply(null,arguments)}b.exports=d,b.exports.__esModule=!0,b.exports.default=b.exports},21925,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){var b;let{csrfToken:c,providers:d,callbackUrl:h,theme:i,email:j,error:k}=a,l=d.filter(a=>"oauth"===a.type||"email"===a.type||"credentials"===a.type&&!!a.credentials);"undefined"!=typeof document&&i.buttonText&&document.documentElement.style.setProperty("--button-text-color",i.buttonText),"undefined"!=typeof document&&i.brandColor&&document.documentElement.style.setProperty("--brand-color",i.brandColor);let m={Signin:"Try signing in with a different account.",OAuthSignin:"Try signing in with a different account.",OAuthCallback:"Try signing in with a different account.",OAuthCreateAccount:"Try signing in with a different account.",EmailCreateAccount:"Try signing in with a different account.",Callback:"Try signing in with a different account.",OAuthAccountNotLinked:"To confirm your identity, sign in with the same account you used originally.",EmailSignin:"The e-mail could not be sent.",CredentialsSignin:"Sign in failed. Check the details you provided are correct.",SessionRequired:"Please sign in to access this page.",default:"Unable to sign in."},n=k&&(null!=(b=m[k])?b:m.default),o="https://authjs.dev/img/providers";return(0,e.h)("div",{className:"signin"},i.brandColor&&(0,e.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${i.brandColor}
        }
      `}}),i.buttonText&&(0,e.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${i.buttonText}
        }
      `}}),(0,e.h)("div",{className:"card"},i.logo&&(0,e.h)("img",{src:i.logo,alt:"Logo",className:"logo"}),n&&(0,e.h)("div",{className:"error"},(0,e.h)("p",null,n)),l.map((a,b)=>{let d,i,k,m,n,p;if("oauth"===a.type){var q;({bg:d="",text:i="",logo:k="",bgDark:n=d,textDark:p=i,logoDark:m=""}=null!=(q=a.style)?q:{}),k=k.startsWith("/")?`${o}${k}`:k,(m=m.startsWith("/")?`${o}${m}`:m||k)||(m=k)}return(0,e.h)("div",{key:a.id,className:"provider"},"oauth"===a.type&&(0,e.h)("form",{action:a.signinUrl,method:"POST"},(0,e.h)("input",{type:"hidden",name:"csrfToken",value:c}),h&&(0,e.h)("input",{type:"hidden",name:"callbackUrl",value:h}),(0,e.h)("button",{type:"submit",className:"button",style:{"--provider-bg":d,"--provider-dark-bg":n,"--provider-color":i,"--provider-dark-color":p,"--provider-bg-hover":g(d,.8),"--provider-dark-bg-hover":g(n,.8)}},k&&(0,e.h)("img",{loading:"lazy",height:24,width:24,id:"provider-logo",src:`${k.startsWith("/")?o:""}${k}`}),m&&(0,e.h)("img",{loading:"lazy",height:24,width:24,id:"provider-logo-dark",src:`${k.startsWith("/")?o:""}${m}`}),(0,e.h)("span",null,"Sign in with ",a.name))),("email"===a.type||"credentials"===a.type)&&b>0&&"email"!==l[b-1].type&&"credentials"!==l[b-1].type&&(0,e.h)("hr",null),"email"===a.type&&(0,e.h)("form",{action:a.signinUrl,method:"POST"},(0,e.h)("input",{type:"hidden",name:"csrfToken",value:c}),(0,e.h)("label",{className:"section-header",htmlFor:`input-email-for-${a.id}-provider`},"Email"),(0,e.h)("input",{id:`input-email-for-${a.id}-provider`,autoFocus:!0,type:"email",name:"email",value:j,placeholder:"email@example.com",required:!0}),(0,e.h)("button",{id:"submitButton",type:"submit"},"Sign in with ",a.name)),"credentials"===a.type&&(0,e.h)("form",{action:a.callbackUrl,method:"POST"},(0,e.h)("input",{type:"hidden",name:"csrfToken",value:c}),Object.keys(a.credentials).map(b=>{var c,d,g;return(0,e.h)("div",{key:`input-group-${a.id}`},(0,e.h)("label",{className:"section-header",htmlFor:`input-${b}-for-${a.id}-provider`},null!=(c=a.credentials[b].label)?c:b),(0,e.h)("input",(0,f.default)({name:b,id:`input-${b}-for-${a.id}-provider`,type:null!=(d=a.credentials[b].type)?d:"text",placeholder:null!=(g=a.credentials[b].placeholder)?g:""},a.credentials[b])))}),(0,e.h)("button",{type:"submit"},"Sign in with ",a.name)),("email"===a.type||"credentials"===a.type)&&b+1<l.length&&(0,e.h)("hr",null))})))};var e=a.r(89887),f=d(a.r(27569));function g(a,b=1){if(!a)return;3===(a=a.replace(/^#/,"")).length&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);let c=parseInt(a,16);return b=Math.min(Math.max(b,0),1),`rgba(${c>>16&255}, ${c>>8&255}, ${255&c}, ${b})`}},45999,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){let{url:b,csrfToken:c,theme:e}=a;return(0,d.h)("div",{className:"signout"},e.brandColor&&(0,d.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${e.brandColor}
        }
      `}}),e.buttonText&&(0,d.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${e.buttonText}
        }
      `}}),(0,d.h)("div",{className:"card"},e.logo&&(0,d.h)("img",{src:e.logo,alt:"Logo",className:"logo"}),(0,d.h)("h1",null,"Signout"),(0,d.h)("p",null,"Are you sure you want to sign out?"),(0,d.h)("form",{action:`${b}/signout`,method:"POST"},(0,d.h)("input",{type:"hidden",name:"csrfToken",value:c}),(0,d.h)("button",{id:"submitButton",type:"submit"},"Sign out"))))};var d=a.r(89887)},55568,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){let{url:b,theme:c}=a;return(0,d.h)("div",{className:"verify-request"},c.brandColor&&(0,d.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${c.brandColor}
        }
      `}}),(0,d.h)("div",{className:"card"},c.logo&&(0,d.h)("img",{src:c.logo,alt:"Logo",className:"logo"}),(0,d.h)("h1",null,"Check your email"),(0,d.h)("p",null,"A sign in link has been sent to your email address."),(0,d.h)("p",null,(0,d.h)("a",{className:"site",href:b.origin},b.host))))};var d=a.r(89887)},87269,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){var b;let{url:c,error:e="default",theme:f}=a,g=`${c}/signin`,h={default:{status:200,heading:"Error",message:(0,d.h)("p",null,(0,d.h)("a",{className:"site",href:null==c?void 0:c.origin},null==c?void 0:c.host))},configuration:{status:500,heading:"Server error",message:(0,d.h)("div",null,(0,d.h)("p",null,"There is a problem with the server configuration."),(0,d.h)("p",null,"Check the server logs for more information."))},accessdenied:{status:403,heading:"Access Denied",message:(0,d.h)("div",null,(0,d.h)("p",null,"You do not have permission to sign in."),(0,d.h)("p",null,(0,d.h)("a",{className:"button",href:g},"Sign in")))},verification:{status:403,heading:"Unable to sign in",message:(0,d.h)("div",null,(0,d.h)("p",null,"The sign in link is no longer valid."),(0,d.h)("p",null,"It may have been used already or it may have expired.")),signin:(0,d.h)("a",{className:"button",href:g},"Sign in")}},{status:i,heading:j,message:k,signin:l}=null!=(b=h[e.toLowerCase()])?b:h.default;return{status:i,html:(0,d.h)("div",{className:"error"},(null==f?void 0:f.brandColor)&&(0,d.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${null==f?void 0:f.brandColor}
        }
      `}}),(0,d.h)("div",{className:"card"},(null==f?void 0:f.logo)&&(0,d.h)("img",{src:f.logo,alt:"Logo",className:"logo"}),(0,d.h)("h1",null,j),(0,d.h)("div",{className:"message"},k),l))}};var d=a.r(89887)},76294,(a,b,c)=>{b.exports=function(){return':root{--border-width:1px;--border-radius:0.5rem;--color-error:#c94b4b;--color-info:#157efb;--color-info-hover:#0f6ddb;--color-info-text:#fff}.__next-auth-theme-auto,.__next-auth-theme-light{--color-background:#ececec;--color-background-hover:hsla(0,0%,93%,.8);--color-background-card:#fff;--color-text:#000;--color-primary:#444;--color-control-border:#bbb;--color-button-active-background:#f9f9f9;--color-button-active-border:#aaa;--color-separator:#ccc}.__next-auth-theme-dark{--color-background:#161b22;--color-background-hover:rgba(22,27,34,.8);--color-background-card:#0d1117;--color-text:#fff;--color-primary:#ccc;--color-control-border:#555;--color-button-active-background:#060606;--color-button-active-border:#666;--color-separator:#444}@media (prefers-color-scheme:dark){.__next-auth-theme-auto{--color-background:#161b22;--color-background-hover:rgba(22,27,34,.8);--color-background-card:#0d1117;--color-text:#fff;--color-primary:#ccc;--color-control-border:#555;--color-button-active-background:#060606;--color-button-active-border:#666;--color-separator:#444}a.button,button{background-color:var(--provider-dark-bg,var(--color-background));color:var(--provider-dark-color,var(--color-primary))}a.button:hover,button:hover{background-color:var(--provider-dark-bg-hover,var(--color-background-hover))!important}#provider-logo{display:none!important}#provider-logo-dark{display:block!important;width:25px}}html{box-sizing:border-box}*,:after,:before{box-sizing:inherit;margin:0;padding:0}body{background-color:var(--color-background);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;margin:0;padding:0}h1{font-weight:400}h1,p{color:var(--color-text);margin-bottom:1.5rem;padding:0 1rem}form{margin:0;padding:0}label{font-weight:500;margin-bottom:.25rem;text-align:left}input[type],label{color:var(--color-text);display:block}input[type]{background:var(--color-background-card);border:var(--border-width) solid var(--color-control-border);border-radius:var(--border-radius);box-sizing:border-box;font-size:1rem;padding:.5rem 1rem;width:100%}input[type]:focus{box-shadow:none}p{font-size:1.1rem;line-height:2rem}a.button{line-height:1rem;text-decoration:none}a.button:link,a.button:visited{background-color:var(--color-background);color:var(--color-primary)}button span{flex-grow:1}a.button,button{align-items:center;background-color:var(--provider-bg);border-color:rgba(0,0,0,.1);border-radius:var(--border-radius);color:var(--provider-color,var(--color-primary));display:flex;font-size:1.1rem;font-weight:500;justify-content:center;min-height:62px;padding:.75rem 1rem;position:relative;transition:all .1s ease-in-out}a.button:hover,button:hover{background-color:var(--provider-bg-hover,var(--color-background-hover));cursor:pointer}a.button:active,button:active{cursor:pointer}a.button #provider-logo,button #provider-logo{display:block;width:25px}a.button #provider-logo-dark,button #provider-logo-dark{display:none}#submitButton{background-color:var(--brand-color,var(--color-info));color:var(--button-text-color,var(--color-info-text));width:100%}#submitButton:hover{background-color:var(--button-hover-bg,var(--color-info-hover))!important}a.site{color:var(--color-primary);font-size:1rem;line-height:2rem;text-decoration:none}a.site:hover{text-decoration:underline}.page{box-sizing:border-box;display:grid;height:100%;margin:0;padding:0;place-items:center;position:absolute;width:100%}.page>div{text-align:center}.error a.button{margin-top:.5rem;padding-left:2rem;padding-right:2rem}.error .message{margin-bottom:1.5rem}.signin input[type=text]{display:block;margin-left:auto;margin-right:auto}.signin hr{border:0;border-top:1px solid var(--color-separator);display:block;margin:2rem auto 1rem;overflow:visible}.signin hr:before{background:var(--color-background-card);color:#888;content:"or";padding:0 .4rem;position:relative;top:-.7rem}.signin .error{background:#f5f5f5;background:var(--color-error);border-radius:.3rem;font-weight:500}.signin .error p{color:var(--color-info-text);font-size:.9rem;line-height:1.2rem;padding:.5rem 1rem;text-align:left}.signin form,.signin>div{display:block}.signin form input[type],.signin>div input[type]{margin-bottom:.5rem}.signin form button,.signin>div button{width:100%}.signin .provider+.provider{margin-top:1rem}.logo{display:inline-block;margin:1.25rem 0;max-height:70px;max-width:150px}.card{background-color:var(--color-background-card);border-radius:2rem;padding:1.25rem 2rem}.card .header{color:var(--color-primary)}.section-header{color:var(--color-text)}@media screen and (min-width:450px){.card{margin:2rem 0;width:368px}}@media screen and (max-width:450px){.card{margin:1rem 0;width:343px}}'}},89669,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){let{url:b,theme:c,query:d,cookies:k}=a;function l({html:a,title:b,status:d}){var f;return{cookies:k,status:d,headers:[{key:"Content-Type",value:"text/html"}],body:`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>${(0,j.default)()}</style><title>${b}</title></head><body class="__next-auth-theme-${null!=(f=null==c?void 0:c.colorScheme)?f:"auto"}"><div class="page">${(0,e.default)(a)}</div></body></html>`}}return{signin:b=>l({html:(0,f.default)({csrfToken:a.csrfToken,providers:a.providers,callbackUrl:a.callbackUrl,theme:c,...d,...b}),title:"Sign In"}),signout:d=>l({html:(0,g.default)({csrfToken:a.csrfToken,url:b,theme:c,...d}),title:"Sign Out"}),verifyRequest:a=>l({html:(0,h.default)({url:b,theme:c,...a}),title:"Verify Request"}),error:a=>l({...(0,i.default)({url:b,theme:c,...a}),title:"Error"})}};var e=d(a.r(10803)),f=d(a.r(21925)),g=d(a.r(45999)),h=d(a.r(55568)),i=d(a.r(87269)),j=d(a.r(76294))},11903,(a,b,c)=>{"use strict";function d(a){return a&&"object"==typeof a&&!Array.isArray(a)}Object.defineProperty(c,"__esModule",{value:!0}),c.merge=function a(b,...c){if(!c.length)return b;let e=c.shift();if(d(b)&&d(e))for(let c in e)d(e[c])?(b[c]||Object.assign(b,{[c]:{}}),a(b[c],e[c])):Object.assign(b,{[c]:e[c]});return a(b,...c)}},25750,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){let{url:b,providerId:c}=a,f=a.providers.map(({options:a,...c})=>{var f,g;if("oauth"===c.type){let f=e(c),h=e(a,!0),i=null!=(g=null==h?void 0:h.id)?g:c.id;return(0,d.merge)(f,{...h,signinUrl:`${b}/signin/${i}`,callbackUrl:`${b}/callback/${i}`})}let h=null!=(f=null==a?void 0:a.id)?f:c.id;return(0,d.merge)(c,{...a,signinUrl:`${b}/signin/${h}`,callbackUrl:`${b}/callback/${h}`})});return{providers:f,provider:f.find(({id:a})=>a===c)}};var d=a.r(11903);function e(a,b=!1){var c,d,f,g,h;if(!a)return;let i=Object.entries(a).reduce((a,[b,c])=>{if(["authorization","token","userinfo"].includes(b)&&"string"==typeof c){var d;let e=new URL(c);a[b]={url:`${e.origin}${e.pathname}`,params:Object.fromEntries(null!=(d=e.searchParams)?d:[])}}else a[b]=c;return a},{});return b||null!=(c=i.version)&&c.startsWith("1.")||(i.idToken=!!(null!=(d=null!=(f=i.idToken)?f:null==(g=i.wellKnown)?void 0:g.includes("openid-configuration"))?d:null==(h=i.authorization)||null==(h=h.params)||null==(h=h.scope)?void 0:h.includes("openid")),i.checks||(i.checks=["state"])),i}},91965,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.defaultCallbacks=void 0,c.defaultCallbacks={signIn:()=>!0,redirect:({url:a,baseUrl:b})=>a.startsWith("/")?`${b}${a}`:new URL(a).origin===b?a:b,session:({session:a})=>a,jwt:({token:a})=>a}},8594,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.createCSRFToken=function({options:a,cookieValue:b,isPost:c,bodyValue:e}){if(b){let[f,g]=b.split("|");if(g===(0,d.createHash)("sha256").update(`${f}${a.secret}`).digest("hex"))return{csrfTokenVerified:c&&f===e,csrfToken:f}}let f=(0,d.randomBytes)(32).toString("hex"),g=(0,d.createHash)("sha256").update(`${f}${a.secret}`).digest("hex");return{cookie:`${f}|${g}`,csrfToken:f}};var d=a.r(54799)},88486,(a,b,c)=>{"use strict";async function d({options:a,paramValue:b,cookieValue:c}){let{url:d,callbacks:e}=a,f=d.origin;return b?f=await e.redirect({url:b,baseUrl:d.origin}):c&&(f=await e.redirect({url:c,baseUrl:d.origin})),{callbackUrl:f,callbackUrlCookie:f!==c?f:void 0}}Object.defineProperty(c,"__esModule",{value:!0}),c.createCallbackUrl=d},72581,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){var b;let c=new URL("http://localhost:3000/api/auth");a&&!a.startsWith("http")&&(a=`https://${a}`);let d=new URL(null!=(b=a)?b:c),e=("/"===d.pathname?c.pathname:d.pathname).replace(/\/$/,""),f=`${d.origin}${e}`;return{origin:d.origin,host:d.host,path:e,base:f,toString:()=>f}}},93818,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0}),c.init=r;var e=a.r(54799),f=d(a.r(96946)),g=a.r(18673),h=d(a.r(25750)),i=a.r(97055),j=q(a.r(68735)),k=q(a.r(42078)),l=a.r(91965),m=a.r(8594),n=a.r(88486),o=d(a.r(72581));function p(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(p=function(a){return a?c:b})(a)}function q(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=p(b);if(c&&c.has(a))return c.get(a);var d={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!==f&&({}).hasOwnProperty.call(a,f)){var g=e?Object.getOwnPropertyDescriptor(a,f):null;g&&(g.get||g.set)?Object.defineProperty(d,f,g):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}async function r({authOptions:a,providerId:b,action:c,origin:d,cookies:p,callbackUrl:q,csrfToken:r,isPost:s}){var t,u;let v=(0,o.default)(d),w=(0,i.createSecret)({authOptions:a,url:v}),{providers:x,provider:y}=(0,h.default)({providers:a.providers,url:v,providerId:b}),z={debug:!1,pages:{},theme:{colorScheme:"auto",logo:"",brandColor:"",buttonText:""},...a,url:v,action:c,provider:y,cookies:{...j.defaultCookies(null!=(t=a.useSecureCookies)?t:v.base.startsWith("https://")),...a.cookies},secret:w,providers:x,session:{strategy:a.adapter?"database":"jwt",maxAge:2592e3,updateAge:86400,generateSessionToken:()=>{var a;return null!=(a=null===e.randomUUID||void 0===e.randomUUID?void 0:(0,e.randomUUID)())?a:(0,e.randomBytes)(32).toString("hex")},...a.session},jwt:{secret:w,maxAge:2592e3,encode:k.encode,decode:k.decode,...a.jwt},events:(0,g.eventsErrorHandler)(null!=(u=a.events)?u:{},f.default),adapter:(0,g.adapterErrorHandler)(a.adapter,f.default),callbacks:{...l.defaultCallbacks,...a.callbacks},logger:f.default,callbackUrl:v.origin},A=[],{csrfToken:B,cookie:C,csrfTokenVerified:D}=(0,m.createCSRFToken)({options:z,cookieValue:null==p?void 0:p[z.cookies.csrfToken.name],isPost:s,bodyValue:r});z.csrfToken=B,z.csrfTokenVerified=D,C&&A.push({name:z.cookies.csrfToken.name,value:C,options:z.cookies.csrfToken.options});let{callbackUrl:E,callbackUrlCookie:F}=await (0,n.createCallbackUrl)({options:z,cookieValue:null==p?void 0:p[z.cookies.callbackUrl.name],paramValue:q});return z.callbackUrl=E,F&&A.push({name:z.cookies.callbackUrl.name,value:F,options:z.cookies.callbackUrl.options}),{options:z,cookies:A}}},94904,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0}),c.assertConfig=function(a){var b,c,d,j,k,l,m;let n,o,p,{options:q,req:r}=a,s=[];if(!h&&(r.origin||s.push("NEXTAUTH_URL"),q.debug&&s.push("DEBUG_ENABLED")),!q.secret)return new e.MissingSecret("Please define a `secret` in production.");if(!(null!=(b=r.query)&&b.nextauth)&&!r.action)return new e.MissingAPIRoute("Cannot find [...nextauth].{js,ts} in `/pages/api/auth`. Make sure the filename is written correctly.");let t=null==(c=r.query)?void 0:c.callbackUrl,u=(0,f.default)(r.origin);if(t&&!i(t,u.base))return new e.InvalidCallbackUrl(`Invalid callback URL. Received: ${t}`);let{callbackUrl:v}=(0,g.defaultCookies)(null!=(d=q.useSecureCookies)?d:u.base.startsWith("https://")),w=null==(j=r.cookies)?void 0:j[null!=(k=null==(l=q.cookies)||null==(l=l.callbackUrl)?void 0:l.name)?k:v.name];if(w&&!i(w,u.base))return new e.InvalidCallbackUrl(`Invalid callback URL. Received: ${w}`);for(let a of q.providers)"credentials"===a.type?n=!0:"email"===a.type?o=!0:"twitter"===a.id&&"2.0"===a.version&&(p=!0);if(n){let a=(null==(m=q.session)?void 0:m.strategy)==="database",b=!q.providers.some(a=>"credentials"!==a.type);if(a&&b)return new e.UnsupportedStrategy("Signin in with credentials only supported if JWT strategy is enabled");if(q.providers.some(a=>"credentials"===a.type&&!a.authorize))return new e.MissingAuthorize("Must define an authorize() handler to use credentials authentication provider")}if(o){let{adapter:a}=q;if(!a)return new e.MissingAdapter("E-mail login requires an adapter.");let b=["createVerificationToken","useVerificationToken","getUserByEmail"].filter(b=>!a[b]);if(b.length)return new e.MissingAdapterMethods(`Required adapter methods were missing: ${b.join(", ")}`)}return h||(p&&s.push("TWITTER_OAUTH_2_BETA"),h=!0),s};var e=a.r(18673),f=d(a.r(72581)),g=a.r(68735);let h=!1;function i(a,b){try{return/^https?:/.test(new URL(a,a.startsWith("/")?b:void 0).protocol)}catch(a){return!1}}},12807,(a,b,c)=>{"use strict";c.parse=function(a,b){if("string"!=typeof a)throw TypeError("argument str must be a string");var c={},d=a.length;if(d<2)return c;var f=b&&b.decode||l,g=0,h=0,i=0;do{if(-1===(h=a.indexOf("=",g)))break;if(-1===(i=a.indexOf(";",g)))i=d;else if(h>i){g=a.lastIndexOf(";",h-1)+1;continue}var m=j(a,g,h),n=k(a,h,m),o=a.slice(m,n);if(!e.call(c,o)){var p=j(a,h+1,i),q=k(a,i,p);34===a.charCodeAt(p)&&34===a.charCodeAt(q-1)&&(p++,q--);var r=a.slice(p,q);c[o]=function(a,b){try{return b(a)}catch(b){return a}}(r,f)}g=i+1}while(g<d)return c},c.serialize=function(a,b,c){var e=c&&c.encode||encodeURIComponent;if("function"!=typeof e)throw TypeError("option encode is invalid");if(!f.test(a))throw TypeError("argument name is invalid");var j=e(b);if(!g.test(j))throw TypeError("argument val is invalid");var k=a+"="+j;if(!c)return k;if(null!=c.maxAge){var l=Math.floor(c.maxAge);if(!isFinite(l))throw TypeError("option maxAge is invalid");k+="; Max-Age="+l}if(c.domain){if(!h.test(c.domain))throw TypeError("option domain is invalid");k+="; Domain="+c.domain}if(c.path){if(!i.test(c.path))throw TypeError("option path is invalid");k+="; Path="+c.path}if(c.expires){var m,n=c.expires;if(m=n,"[object Date]"!==d.call(m)||isNaN(n.valueOf()))throw TypeError("option expires is invalid");k+="; Expires="+n.toUTCString()}if(c.httpOnly&&(k+="; HttpOnly"),c.secure&&(k+="; Secure"),c.partitioned&&(k+="; Partitioned"),c.priority)switch("string"==typeof c.priority?c.priority.toLowerCase():c.priority){case"low":k+="; Priority=Low";break;case"medium":k+="; Priority=Medium";break;case"high":k+="; Priority=High";break;default:throw TypeError("option priority is invalid")}if(c.sameSite)switch("string"==typeof c.sameSite?c.sameSite.toLowerCase():c.sameSite){case!0:case"strict":k+="; SameSite=Strict";break;case"lax":k+="; SameSite=Lax";break;case"none":k+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return k};var d=Object.prototype.toString,e=Object.prototype.hasOwnProperty,f=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,g=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,h=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/;function j(a,b,c){do{var d=a.charCodeAt(b);if(32!==d&&9!==d)return b}while(++b<c)return c}function k(a,b,c){for(;b>c;){var d=a.charCodeAt(--b);if(32!==d&&9!==d)return b+1}return c}function l(a){return -1!==a.indexOf("%")?decodeURIComponent(a):a}},77370,(a,b,c)=>{"use strict";var d=a.r(21318);Object.defineProperty(c,"__esModule",{value:!0}),c.AuthHandler=q;var e=n(a.r(96946)),f=a.r(93368),g=n(a.r(76992)),h=d(a.r(89669)),i=a.r(93818),j=a.r(94904),k=a.r(68735),l=a.r(12807);function m(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(m=function(a){return a?c:b})(a)}function n(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=m(b);if(c&&c.has(a))return c.get(a);var d={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!==f&&({}).hasOwnProperty.call(a,f)){var g=e?Object.getOwnPropertyDescriptor(a,f):null;g&&(g.get||g.set)?Object.defineProperty(d,f,g):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}async function o(a){try{return await a.json()}catch(a){}}async function p(a){var b,c,d,e;if(a instanceof Request){let b=new URL(a.url),g=b.pathname.split("/").slice(3),h=Object.fromEntries(a.headers),i=Object.fromEntries(b.searchParams);return i.nextauth=g,{action:g[0],method:a.method,headers:h,body:await o(a),cookies:(0,l.parse)(null!=(c=a.headers.get("cookie"))?c:""),providerId:g[1],error:null!=(d=b.searchParams.get("error"))?d:g[1],origin:(0,f.detectOrigin)(null!=(e=h["x-forwarded-host"])?e:h.host,h["x-forwarded-proto"]),query:i}}let{headers:g}=a,h=null!=(b=null==g?void 0:g["x-forwarded-host"])?b:null==g?void 0:g.host;return a.origin=(0,f.detectOrigin)(h,null==g?void 0:g["x-forwarded-proto"]),a}async function q(a){var b,c,d,f,l,m,n;let{options:o,req:q}=a,r=await p(q);(0,e.setLogger)(o.logger,o.debug);let s=(0,j.assertConfig)({options:o,req:r});if(Array.isArray(s))s.forEach(e.default.warn);else if(s instanceof Error){if(e.default.error(s.code,s),!["signin","signout","error","verify-request"].includes(r.action)||"GET"!==r.method)return{status:500,headers:[{key:"Content-Type",value:"application/json"}],body:{message:"There is a problem with the server configuration. Check the server logs for more information."}};let{pages:a,theme:b}=o,c=(null==a?void 0:a.error)&&(null==(l=r.query)||null==(l=l.callbackUrl)?void 0:l.startsWith(a.error));return!(null!=a&&a.error)||c?(c&&e.default.error("AUTH_ON_ERROR_PAGE_ERROR",Error(`The error page ${null==a?void 0:a.error} should not require authentication`)),(0,h.default)({theme:b}).error({error:"configuration"})):{redirect:`${a.error}?error=Configuration`}}let{action:t,providerId:u,error:v,method:w="GET"}=r,{options:x,cookies:y}=await (0,i.init)({authOptions:o,action:t,providerId:u,origin:r.origin,callbackUrl:null!=(b=null==(c=r.body)?void 0:c.callbackUrl)?b:null==(d=r.query)?void 0:d.callbackUrl,csrfToken:null==(f=r.body)?void 0:f.csrfToken,cookies:r.cookies,isPost:"POST"===w}),z=new k.SessionStore(x.cookies.sessionToken,r,x.logger);if("GET"===w){let a=(0,h.default)({...x,query:r.query,cookies:y}),{pages:b}=x;switch(t){case"providers":return await g.providers(x.providers);case"session":{let a=await g.session({options:x,sessionStore:z});return a.cookies&&y.push(...a.cookies),{...a,cookies:y}}case"csrf":return{headers:[{key:"Content-Type",value:"application/json"},{key:"Cache-Control",value:"private, no-cache, no-store"},{key:"Pragma",value:"no-cache"},{key:"Expires",value:"0"}],body:{csrfToken:x.csrfToken},cookies:y};case"signin":if(b.signIn){let a=`${b.signIn}${b.signIn.includes("?")?"&":"?"}callbackUrl=${encodeURIComponent(x.callbackUrl)}`;return v&&(a=`${a}&error=${encodeURIComponent(v)}`),{redirect:a,cookies:y}}return a.signin();case"signout":if(b.signOut)return{redirect:b.signOut,cookies:y};return a.signout();case"callback":if(x.provider){let a=await g.callback({body:r.body,query:r.query,headers:r.headers,cookies:r.cookies,method:w,options:x,sessionStore:z});return a.cookies&&y.push(...a.cookies),{...a,cookies:y}}break;case"verify-request":if(b.verifyRequest)return{redirect:b.verifyRequest,cookies:y};return a.verifyRequest();case"error":if(["Signin","OAuthSignin","OAuthCallback","OAuthCreateAccount","EmailCreateAccount","Callback","OAuthAccountNotLinked","EmailSignin","CredentialsSignin","SessionRequired"].includes(v))return{redirect:`${x.url}/signin?error=${v}`,cookies:y};if(b.error)return{redirect:`${b.error}${b.error.includes("?")?"&":"?"}error=${v}`,cookies:y};return a.error({error:v})}}else if("POST"===w)switch(t){case"signin":if(x.csrfTokenVerified&&x.provider){let a=await g.signin({query:r.query,body:r.body,options:x});return a.cookies&&y.push(...a.cookies),{...a,cookies:y}}return{redirect:`${x.url}/signin?csrf=true`,cookies:y};case"signout":if(x.csrfTokenVerified){let a=await g.signout({options:x,sessionStore:z});return a.cookies&&y.push(...a.cookies),{...a,cookies:y}}return{redirect:`${x.url}/signout?csrf=true`,cookies:y};case"callback":if(x.provider){if("credentials"===x.provider.type&&!x.csrfTokenVerified)return{redirect:`${x.url}/signin?csrf=true`,cookies:y};let a=await g.callback({body:r.body,query:r.query,headers:r.headers,cookies:r.cookies,method:w,options:x,sessionStore:z});return a.cookies&&y.push(...a.cookies),{...a,cookies:y}}break;case"_log":if(o.logger)try{let{code:a,level:b,...c}=null!=(m=r.body)?m:{};e.default[b](a,c)}catch(a){e.default.error("LOGGER_ERROR",a)}return{};case"session":if(x.csrfTokenVerified){let a=await g.session({options:x,sessionStore:z,newSession:null==(n=r.body)?void 0:n.data,isUpdate:!0});return a.cookies&&y.push(...a.cookies),{...a,cookies:y}}return{status:400,body:{},cookies:y}}return{status:400,body:`Error: This action with HTTP ${w} is not supported by NextAuth.js`}}},48093,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.getBody=e,c.setCookie=function(a,b){var c;let e=null!=(c=a.getHeader("Set-Cookie"))?c:[];Array.isArray(e)||(e=[e]);let{name:f,value:g,options:h}=b,i=(0,d.serialize)(f,g,h);e.push(i),a.setHeader("Set-Cookie",e)},c.toResponse=function(a){var b,c,e;let f=new Headers(null==(b=a.headers)?void 0:b.reduce((a,{key:b,value:c})=>(a[b]=c,a),{}));null==(c=a.cookies)||c.forEach(a=>{let{name:b,value:c,options:e}=a,g=(0,d.serialize)(b,c,e);f.has("Set-Cookie")?f.append("Set-Cookie",g):f.set("Set-Cookie",g)});let g=a.body;"application/json"===f.get("content-type")?g=JSON.stringify(a.body):"application/x-www-form-urlencoded"===f.get("content-type")&&(g=new URLSearchParams(a.body).toString());let h=new Response(g,{headers:f,status:a.redirect?302:null!=(e=a.status)?e:200});return a.redirect&&h.headers.set("Location",a.redirect),h};var d=a.r(12807);async function e(a){if(!("body"in a)||!a.body||"POST"!==a.method)return;let b=a.headers.get("content-type");return null!=b&&b.includes("application/json")?await a.json():null!=b&&b.includes("application/x-www-form-urlencoded")?Object.fromEntries(new URLSearchParams(await a.text())):void 0}},63681,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={RequestCookies:function(){return f.RequestCookies},ResponseCookies:function(){return f.ResponseCookies},stringifyCookie:function(){return f.stringifyCookie}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(36226)},51409,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ReflectAdapter",{enumerable:!0,get:function(){return d}});class d{static get(a,b,c){let d=Reflect.get(a,b,c);return"function"==typeof d?d.bind(a):d}static set(a,b,c,d){return Reflect.set(a,b,c,d)}static has(a,b){return Reflect.has(a,b)}static deleteProperty(a,b){return Reflect.deleteProperty(a,b)}}},14896,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={MutableRequestCookiesAdapter:function(){return n},ReadonlyRequestCookiesError:function(){return i},RequestCookiesAdapter:function(){return j},appendMutableCookies:function(){return m},areCookiesMutableInCurrentPhase:function(){return p},createCookiesWithMutableAccessCheck:function(){return o},getModifiedCookieValues:function(){return l},responseCookiesToRequestCookies:function(){return r}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(63681),g=a.r(51409),h=a.r(56704);class i extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#options")}static callable(){throw new i}}class j{static seal(a){return new Proxy(a,{get(a,b,c){switch(b){case"clear":case"delete":case"set":return i.callable;default:return g.ReflectAdapter.get(a,b,c)}}})}}let k=Symbol.for("next.mutated.cookies");function l(a){let b=a[k];return b&&Array.isArray(b)&&0!==b.length?b:[]}function m(a,b){let c=l(b);if(0===c.length)return!1;let d=new f.ResponseCookies(a),e=d.getAll();for(let a of c)d.set(a);for(let a of e)d.set(a);return!0}class n{static wrap(a,b){let c=new f.ResponseCookies(new Headers);for(let b of a.getAll())c.set(b);let d=[],e=new Set,i=()=>{let a=h.workAsyncStorage.getStore();if(a&&(a.pathWasRevalidated=!0),d=c.getAll().filter(a=>e.has(a.name)),b){let a=[];for(let b of d){let c=new f.ResponseCookies(new Headers);c.set(b),a.push(c.toString())}b(a)}},j=new Proxy(c,{get(a,b,c){switch(b){case k:return d;case"delete":return function(...b){e.add("string"==typeof b[0]?b[0]:b[0].name);try{return a.delete(...b),j}finally{i()}};case"set":return function(...b){e.add("string"==typeof b[0]?b[0]:b[0].name);try{return a.set(...b),j}finally{i()}};default:return g.ReflectAdapter.get(a,b,c)}}});return j}}function o(a){let b=new Proxy(a.mutableCookies,{get(c,d,e){switch(d){case"delete":return function(...d){return q(a,"cookies().delete"),c.delete(...d),b};case"set":return function(...d){return q(a,"cookies().set"),c.set(...d),b};default:return g.ReflectAdapter.get(c,d,e)}}});return b}function p(a){return"action"===a.phase}function q(a,b){if(!p(a))throw new i}function r(a){let b=new f.RequestCookies(new Headers);for(let c of a.getAll())b.set(c);return b}},8018,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return i}});let d=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=e(void 0);if(c&&c.has(a))return c.get(a);var d={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(d,g,h):d[g]=a[g]}return d.default=a,c&&c.set(a,d),d}(a.r(717));function e(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(e=function(a){return a?c:b})(a)}let f={current:null},g="function"==typeof d.cache?d.cache:a=>a,h=console.warn;function i(a){return function(...b){h(a(...b))}}g(a=>{try{h(f.current)}finally{f.current=null}})},86309,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={isRequestAPICallableInsideAfter:function(){return j},throwForSearchParamsAccessInUseCache:function(){return i},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(60312),g=a.r(24725);function h(a,b){throw Object.defineProperty(new f.StaticGenBailoutError(`Route ${a} with \`dynamic = "error"\` couldn't be rendered statically because it used ${b}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function i(a,b){let c=Object.defineProperty(Error(`Route ${a.route} used \`searchParams\` inside "use cache". Accessing dynamic request data inside a cache scope is not supported. If you need some search params inside a cached function await \`searchParams\` outside of the cached function and pass only the required search params as arguments to the cached function. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E842",enumerable:!1,configurable:!0});throw Error.captureStackTrace(c,b),a.invalidDynamicUsageError??=c,c}function j(){let a=g.afterTaskAsyncStorage.getStore();return(null==a?void 0:a.rootTaskSpawnPhase)==="action"}},81740,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"cookies",{enumerable:!0,get:function(){return n}});let d=a.r(14896),e=a.r(63681),f=a.r(56704),g=a.r(32319),h=a.r(60384),i=a.r(60312),j=a.r(13091),k=a.r(8018),l=a.r(86309),m=a.r(50640);function n(){let a="cookies",b=f.workAsyncStorage.getStore(),c=g.workUnitAsyncStorage.getStore();if(b){if(c&&"after"===c.phase&&!(0,l.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${b.route} used \`cookies()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`cookies()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E843",enumerable:!1,configurable:!0});if(b.forceStatic)return p(d.RequestCookiesAdapter.seal(new e.RequestCookies(new Headers({}))));if(b.dynamicShouldError)throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${b.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`cookies()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E849",enumerable:!1,configurable:!0});if(c)switch(c.type){case"cache":let f=Object.defineProperty(Error(`Route ${b.route} used \`cookies()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E831",enumerable:!1,configurable:!0});throw Error.captureStackTrace(f,n),b.invalidDynamicUsageError??=f,f;case"unstable-cache":throw Object.defineProperty(Error(`Route ${b.route} used \`cookies()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E846",enumerable:!1,configurable:!0});case"prerender":var k=b,q=c;let g=o.get(q);if(g)return g;let r=(0,j.makeHangingPromise)(q.renderSignal,k.route,"`cookies()`");return o.set(q,r),r;case"prerender-client":let s="`cookies`";throw Object.defineProperty(new m.InvariantError(`${s} must not be used within a Client Component. Next.js should be preventing ${s} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,h.postponeWithTracking)(b.route,a,c.dynamicTracking);case"prerender-legacy":return(0,h.throwToInterruptStaticGeneration)(a,b,c);case"prerender-runtime":return(0,h.delayUntilRuntimeStage)(c,p(c.cookies));case"private-cache":return p(c.cookies);case"request":return(0,h.trackDynamicDataInDynamicRender)(c),p((0,d.areCookiesMutableInCurrentPhase)(c)?c.userspaceMutableCookies:c.cookies)}}(0,g.throwForMissingRequestStore)(a)}a.r(31382);let o=new WeakMap;function p(a){let b=o.get(a);if(b)return b;let c=Promise.resolve(a);return o.set(a,c),c}(0,k.createDedupedByCallsiteServerErrorLoggerDev)(function(a,b){let c=a?`Route "${a}" `:"This route ";return Object.defineProperty(Error(`${c}used ${b}. \`cookies()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E830",enumerable:!1,configurable:!0})})},29927,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={HeadersAdapter:function(){return h},ReadonlyHeadersError:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(51409);class g extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new g}}class h extends Headers{constructor(a){super(),this.headers=new Proxy(a,{get(b,c,d){if("symbol"==typeof c)return f.ReflectAdapter.get(b,c,d);let e=c.toLowerCase(),g=Object.keys(a).find(a=>a.toLowerCase()===e);if(void 0!==g)return f.ReflectAdapter.get(b,g,d)},set(b,c,d,e){if("symbol"==typeof c)return f.ReflectAdapter.set(b,c,d,e);let g=c.toLowerCase(),h=Object.keys(a).find(a=>a.toLowerCase()===g);return f.ReflectAdapter.set(b,h??c,d,e)},has(b,c){if("symbol"==typeof c)return f.ReflectAdapter.has(b,c);let d=c.toLowerCase(),e=Object.keys(a).find(a=>a.toLowerCase()===d);return void 0!==e&&f.ReflectAdapter.has(b,e)},deleteProperty(b,c){if("symbol"==typeof c)return f.ReflectAdapter.deleteProperty(b,c);let d=c.toLowerCase(),e=Object.keys(a).find(a=>a.toLowerCase()===d);return void 0===e||f.ReflectAdapter.deleteProperty(b,e)}})}static seal(a){return new Proxy(a,{get(a,b,c){switch(b){case"append":case"delete":case"set":return g.callable;default:return f.ReflectAdapter.get(a,b,c)}}})}merge(a){return Array.isArray(a)?a.join(", "):a}static from(a){return a instanceof Headers?a:new h(a)}append(a,b){let c=this.headers[a];"string"==typeof c?this.headers[a]=[c,b]:Array.isArray(c)?c.push(b):this.headers[a]=b}delete(a){delete this.headers[a]}get(a){let b=this.headers[a];return void 0!==b?this.merge(b):null}has(a){return void 0!==this.headers[a]}set(a,b){this.headers[a]=b}forEach(a,b){for(let[c,d]of this.entries())a.call(b,d,c,this)}*entries(){for(let a of Object.keys(this.headers)){let b=a.toLowerCase(),c=this.get(b);yield[b,c]}}*keys(){for(let a of Object.keys(this.headers)){let b=a.toLowerCase();yield b}}*values(){for(let a of Object.keys(this.headers)){let b=this.get(a);yield b}}[Symbol.iterator](){return this.entries()}}},35754,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"headers",{enumerable:!0,get:function(){return m}});let d=a.r(29927),e=a.r(56704),f=a.r(32319),g=a.r(60384),h=a.r(60312),i=a.r(13091),j=a.r(8018),k=a.r(86309),l=a.r(50640);function m(){let a="headers",b=e.workAsyncStorage.getStore(),c=f.workUnitAsyncStorage.getStore();if(b){if(c&&"after"===c.phase&&!(0,k.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${b.route} used \`headers()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`headers()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E839",enumerable:!1,configurable:!0});if(b.forceStatic)return o(d.HeadersAdapter.seal(new Headers({})));if(c)switch(c.type){case"cache":{let a=Object.defineProperty(Error(`Route ${b.route} used \`headers()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E833",enumerable:!1,configurable:!0});throw Error.captureStackTrace(a,m),b.invalidDynamicUsageError??=a,a}case"unstable-cache":throw Object.defineProperty(Error(`Route ${b.route} used \`headers()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E838",enumerable:!1,configurable:!0})}if(b.dynamicShouldError)throw Object.defineProperty(new h.StaticGenBailoutError(`Route ${b.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`headers()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E828",enumerable:!1,configurable:!0});if(c)switch(c.type){case"prerender":var j=b,p=c;let e=n.get(p);if(e)return e;let f=(0,i.makeHangingPromise)(p.renderSignal,j.route,"`headers()`");return n.set(p,f),f;case"prerender-client":let q="`headers`";throw Object.defineProperty(new l.InvariantError(`${q} must not be used within a client component. Next.js should be preventing ${q} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,g.postponeWithTracking)(b.route,a,c.dynamicTracking);case"prerender-legacy":return(0,g.throwToInterruptStaticGeneration)(a,b,c);case"prerender-runtime":return(0,g.delayUntilRuntimeStage)(c,o(c.headers));case"private-cache":return o(c.headers);case"request":return(0,g.trackDynamicDataInDynamicRender)(c),o(c.headers)}}(0,f.throwForMissingRequestStore)(a)}a.r(31382);let n=new WeakMap;function o(a){let b=n.get(a);if(b)return b;let c=Promise.resolve(a);return n.set(a,c),c}(0,j.createDedupedByCallsiteServerErrorLoggerDev)(function(a,b){let c=a?`Route "${a}" `:"This route ";return Object.defineProperty(Error(`${c}used ${b}. \`headers()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E836",enumerable:!1,configurable:!0})})},51125,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"draftMode",{enumerable:!0,get:function(){return k}});let d=a.r(32319),e=a.r(56704),f=a.r(60384),g=a.r(8018),h=a.r(60312),i=a.r(96556),j=a.r(50640);function k(){let a=e.workAsyncStorage.getStore(),b=d.workUnitAsyncStorage.getStore();switch((!a||!b)&&(0,d.throwForMissingRequestStore)("draftMode"),b.type){case"prerender-runtime":return(0,f.delayUntilRuntimeStage)(b,l(b.draftMode,a));case"request":return l(b.draftMode,a);case"cache":case"private-cache":case"unstable-cache":let c=(0,d.getDraftModeProviderForCacheScope)(a,b);if(c)return l(c,a);case"prerender":case"prerender-client":case"prerender-ppr":case"prerender-legacy":return l(null,a);default:return b}}function l(a,b){let c=n.get(a??m);return c||Promise.resolve(new o(a))}a.r(51409);let m={},n=new WeakMap;class o{constructor(a){this._provider=a}get isEnabled(){return null!==this._provider&&this._provider.isEnabled}enable(){p("draftMode().enable()",this.enable),null!==this._provider&&this._provider.enable()}disable(){p("draftMode().disable()",this.disable),null!==this._provider&&this._provider.disable()}}function p(a,b){let c=e.workAsyncStorage.getStore(),g=d.workUnitAsyncStorage.getStore();if(c){if((null==g?void 0:g.phase)==="after")throw Object.defineProperty(Error(`Route ${c.route} used "${a}" inside \`after()\`. The enabled status of \`draftMode()\` can be read inside \`after()\` but you cannot enable or disable \`draftMode()\`. See more info here: https://nextjs.org/docs/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E845",enumerable:!1,configurable:!0});if(c.dynamicShouldError)throw Object.defineProperty(new h.StaticGenBailoutError(`Route ${c.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(g)switch(g.type){case"cache":case"private-cache":{let d=Object.defineProperty(Error(`Route ${c.route} used "${a}" inside "use cache". The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E829",enumerable:!1,configurable:!0});throw Error.captureStackTrace(d,b),c.invalidDynamicUsageError??=d,d}case"unstable-cache":throw Object.defineProperty(Error(`Route ${c.route} used "${a}" inside a function cached with \`unstable_cache()\`. The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E844",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":{let b=Object.defineProperty(Error(`Route ${c.route} used ${a} without first calling \`await connection()\`. See more info here: https://nextjs.org/docs/messages/next-prerender-sync-headers`),"__NEXT_ERROR_CODE",{value:"E126",enumerable:!1,configurable:!0});return(0,f.abortAndThrowOnSynchronousRequestDataAccess)(c.route,a,b,g)}case"prerender-client":let d="`draftMode`";throw Object.defineProperty(new j.InvariantError(`${d} must not be used within a Client Component. Next.js should be preventing ${d} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,f.postponeWithTracking)(c.route,a,g.dynamicTracking);case"prerender-legacy":g.revalidate=0;let e=Object.defineProperty(new i.DynamicServerError(`Route ${c.route} couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw c.dynamicUsageDescription=a,c.dynamicUsageStack=e.stack,e;case"request":(0,f.trackDynamicDataInDynamicRender)(g)}}}(0,g.createDedupedByCallsiteServerErrorLoggerDev)(function(a,b){let c=a?`Route "${a}" `:"This route ";return Object.defineProperty(Error(`${c}used ${b}. \`draftMode()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E835",enumerable:!1,configurable:!0})})},5246,(a,b,c)=>{b.exports.cookies=a.r(81740).cookies,b.exports.headers=a.r(35754).headers,b.exports.draftMode=a.r(51125).draftMode},94431,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0,c.getServerSession=h,c.unstable_getServerSession=i;var d=a.r(77370),e=a.r(48093);async function f(a,b,c){var f,g,h,i,j,k,l,m;let{nextauth:n,...o}=a.query;null!=c.secret||(c.secret=null!=(f=null!=(g=null==(h=c.jwt)?void 0:h.secret)?g:process.env.NEXTAUTH_SECRET)?f:process.env.AUTH_SECRET);let p=await (0,d.AuthHandler)({req:{body:a.body,query:o,cookies:a.cookies,headers:a.headers,method:a.method,action:null==n?void 0:n[0],providerId:null==n?void 0:n[1],error:null!=(i=a.query.error)?i:null==n?void 0:n[1]},options:c});if(b.status(null!=(j=p.status)?j:200),null==(k=p.cookies)||k.forEach(a=>(0,e.setCookie)(b,a)),null==(l=p.headers)||l.forEach(a=>b.setHeader(a.key,a.value)),p.redirect){if((null==(m=a.body)?void 0:m.json)!=="true"){b.status(302).setHeader("Location",p.redirect),b.end();return}return b.json({url:p.redirect})}return b.send(p.body)}async function g(b,c,f){var g,h,i;null!=f.secret||(f.secret=null!=(g=process.env.NEXTAUTH_SECRET)?g:process.env.AUTH_SECRET);let{headers:j,cookies:k}=a.r(5246),l=null==(h=await c.params)?void 0:h.nextauth,m=Object.fromEntries(b.nextUrl.searchParams),n=await (0,e.getBody)(b),o=await (0,d.AuthHandler)({req:{body:n,query:m,cookies:Object.fromEntries((await k()).getAll().map(a=>[a.name,a.value])),headers:Object.fromEntries(await j()),method:b.method,action:null==l?void 0:l[0],providerId:null==l?void 0:l[1],error:null!=(i=m.error)?i:null==l?void 0:l[1]},options:f}),p=(0,e.toResponse)(o),q=p.headers.get("Location");return(null==n?void 0:n.json)==="true"&&q?(p.headers.delete("Location"),p.headers.set("Content-Type","application/json"),new Response(JSON.stringify({url:q}),{status:o.status,headers:p.headers})):p}async function h(...b){var c,f;let g,i,j,k=0===b.length||1===b.length;if(k){j=Object.assign({},b[0],{providers:[]});let{headers:c,cookies:d}=a.r(5246);g={headers:Object.fromEntries(await c()),cookies:Object.fromEntries((await d()).getAll().map(a=>[a.name,a.value]))},i={getHeader(){},setCookie(){},setHeader(){}}}else g=b[0],i=b[1],j=Object.assign({},b[2],{providers:[]});null!=(c=j).secret||(c.secret=null!=(f=process.env.NEXTAUTH_SECRET)?f:process.env.AUTH_SECRET);let{body:l,cookies:m,status:n=200}=await (0,d.AuthHandler)({options:j,req:{action:"session",method:"GET",cookies:g.cookies,headers:g.headers}});if(null==m||m.forEach(a=>(0,e.setCookie)(i,a)),l&&"string"!=typeof l&&Object.keys(l).length){if(200===n)return k&&delete l.expires,l;throw Error(l.message)}return null}async function i(...a){return await h(...a)}c.default=function(...a){var b;return 1===a.length?async(b,c)=>null!=c&&c.params?await g(b,c,a[0]):await f(b,c,a[0]):null!=(b=a[1])&&b.params?g(...a):f(...a)}},20971,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={};Object.defineProperty(c,"default",{enumerable:!0,get:function(){return f.default}});var e=a.r(98841);Object.keys(e).forEach(function(a){"default"===a||"__esModule"===a||Object.prototype.hasOwnProperty.call(d,a)||a in c&&c[a]===e[a]||Object.defineProperty(c,a,{enumerable:!0,get:function(){return e[a]}})});var f=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=g(void 0);if(c&&c.has(a))return c.get(a);var d={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!==f&&({}).hasOwnProperty.call(a,f)){var h=e?Object.getOwnPropertyDescriptor(a,f):null;h&&(h.get||h.set)?Object.defineProperty(d,f,h):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}(a.r(94431));function g(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(g=function(a){return a?c:b})(a)}Object.keys(f).forEach(function(a){"default"===a||"__esModule"===a||Object.prototype.hasOwnProperty.call(d,a)||a in c&&c[a]===f[a]||Object.defineProperty(c,a,{enumerable:!0,get:function(){return f[a]}})})},94415,63227,a=>{"use strict";let b=Symbol.for("drizzle:entityKind");function c(a,c){if(!a||"object"!=typeof a)return!1;if(a instanceof c)return!0;if(!Object.prototype.hasOwnProperty.call(c,b))throw Error(`Class "${c.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let d=Object.getPrototypeOf(a).constructor;if(d)for(;d;){if(b in d&&d[b]===c[b])return!0;d=Object.getPrototypeOf(d)}return!1}Symbol.for("drizzle:hasOwnEntityKind"),a.s(["entityKind",()=>b,"is",()=>c],63227);class d{constructor(a,b){this.table=a,this.config=b,this.name=b.name,this.keyAsName=b.keyAsName,this.notNull=b.notNull,this.default=b.default,this.defaultFn=b.defaultFn,this.onUpdateFn=b.onUpdateFn,this.hasDefault=b.hasDefault,this.primary=b.primaryKey,this.isUnique=b.isUnique,this.uniqueName=b.uniqueName,this.uniqueType=b.uniqueType,this.dataType=b.dataType,this.columnType=b.columnType,this.generated=b.generated,this.generatedIdentity=b.generatedIdentity}static [b]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(a){return a}mapToDriverValue(a){return a}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}a.s(["Column",()=>d],94415)},77396,a=>{"use strict";var b=a.i(63227);class c{static [b.entityKind]="ColumnBuilder";config;constructor(a,b,c){this.config={name:a,keyAsName:""===a,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:b,columnType:c,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(a){return this.config.default=a,this.config.hasDefault=!0,this}$defaultFn(a){return this.config.defaultFn=a,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(a){return this.config.onUpdateFn=a,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(a){""===this.config.name&&(this.config.name=a)}}a.s(["ColumnBuilder",()=>c])},37003,a=>{"use strict";let b=Symbol.for("drizzle:Name");a.s(["TableName",()=>b])},96178,7231,51146,5302,4501,84113,55280,a=>{"use strict";let b,c;var d=a.i(63227),e=a.i(77396),f=a.i(94415),g=a.i(37003);class h{static [d.entityKind]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(a,b){this.reference=()=>{let{name:b,columns:c,foreignColumns:d}=a();return{name:b,columns:c,foreignTable:d[0].table,foreignColumns:d}},b&&(this._onUpdate=b.onUpdate,this._onDelete=b.onDelete)}onUpdate(a){return this._onUpdate=void 0===a?"no action":a,this}onDelete(a){return this._onDelete=void 0===a?"no action":a,this}build(a){return new i(a,this)}}class i{constructor(a,b){this.table=a,this.reference=b.reference,this.onUpdate=b._onUpdate,this.onDelete=b._onDelete}static [d.entityKind]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:a,columns:b,foreignColumns:c}=this.reference(),d=b.map(a=>a.name),e=c.map(a=>a.name),f=[this.table[g.TableName],...d,c[0].table[g.TableName],...e];return a??`${f.join("_")}_fk`}}function j(a,...b){return a(...b)}function k(a,b){return`${a[g.TableName]}_${b.join("_")}_unique`}a.s(["ForeignKeyBuilder",()=>h],7231);class l{constructor(a,b){this.name=b,this.columns=a}static [d.entityKind]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(a){return new n(a,this.columns,this.nullsNotDistinctConfig,this.name)}}class m{static [d.entityKind]="PgUniqueOnConstraintBuilder";name;constructor(a){this.name=a}on(...a){return new l(a,this.name)}}class n{constructor(a,b,c,d){this.table=a,this.columns=b,this.name=d??k(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=c}static [d.entityKind]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}function o(a,b,c){for(let d=b;d<a.length;d++){let e=a[d];if("\\"===e){d++;continue}if('"'===e)return[a.slice(b,d).replace(/\\/g,""),d+1];if(!c&&(","===e||"}"===e))return[a.slice(b,d).replace(/\\/g,""),d]}return[a.slice(b).replace(/\\/g,""),a.length]}a.s(["UniqueConstraintBuilder",()=>l,"uniqueKeyName",()=>k],51146);class p extends e.ColumnBuilder{foreignKeyConfigs=[];static [d.entityKind]="PgColumnBuilder";array(a){return new t(this.config.name,this,a)}references(a,b={}){return this.foreignKeyConfigs.push({ref:a,actions:b}),this}unique(a,b){return this.config.isUnique=!0,this.config.uniqueName=a,this.config.uniqueType=b?.nulls,this}generatedAlwaysAs(a){return this.config.generated={as:a,type:"always",mode:"stored"},this}buildForeignKeys(a,b){return this.foreignKeyConfigs.map(({ref:c,actions:d})=>j((c,d)=>{let e=new h(()=>({columns:[a],foreignColumns:[c()]}));return d.onUpdate&&e.onUpdate(d.onUpdate),d.onDelete&&e.onDelete(d.onDelete),e.build(b)},c,d))}buildExtraConfigColumn(a){return new r(a,this.config)}}class q extends f.Column{constructor(a,b){b.uniqueName||(b.uniqueName=k(a,[b.name])),super(a,b),this.table=a}static [d.entityKind]="PgColumn"}class r extends q{static [d.entityKind]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(a){return this.indexConfig.opClass=a,this}}class s{static [d.entityKind]="IndexedColumn";constructor(a,b,c,d){this.name=a,this.keyAsName=b,this.type=c,this.indexConfig=d}name;keyAsName;type;indexConfig}class t extends p{static [d.entityKind]="PgArrayBuilder";constructor(a,b,c){super(a,"array","PgArray"),this.config.baseBuilder=b,this.config.size=c}build(a){let b=this.config.baseBuilder.build(a);return new u(a,this.config,b)}}class u extends q{constructor(a,b,c,d){super(a,b),this.baseColumn=c,this.range=d,this.size=b.size}size;static [d.entityKind]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(a){return"string"==typeof a&&(a=function(a){let[b]=function a(b,c=0){let d=[],e=c,f=!1;for(;e<b.length;){let g=b[e];if(","===g){(f||e===c)&&d.push(""),f=!0,e++;continue}if(f=!1,"\\"===g){e+=2;continue}if('"'===g){let[a,c]=o(b,e+1,!0);d.push(a),e=c;continue}if("}"===g)return[d,e+1];if("{"===g){let[c,f]=a(b,e+1);d.push(c),e=f;continue}let[h,i]=o(b,e,!1);d.push(h),e=i}return[d,e]}(a,1);return b}(a)),a.map(a=>this.baseColumn.mapFromDriverValue(a))}mapToDriverValue(a,b=!1){let c=a.map(a=>null===a?null:(0,d.is)(this.baseColumn,u)?this.baseColumn.mapToDriverValue(a,!0):this.baseColumn.mapToDriverValue(a));return b?c:function a(b){return`{${b.map(b=>Array.isArray(b)?a(b):"string"==typeof b?`"${b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${b}`).join(",")}}`}(c)}}a.s(["IndexedColumn",()=>s,"PgColumn",()=>q,"PgColumnBuilder",()=>p],5302);class v extends p{static [d.entityKind]="PgEnumObjectColumnBuilder";constructor(a,b){super(a,"string","PgEnumObjectColumn"),this.config.enum=b}build(a){return new w(a,this.config)}}class w extends q{static [d.entityKind]="PgEnumObjectColumn";enum;enumValues=this.config.enum.enumValues;constructor(a,b){super(a,b),this.enum=b.enum}getSQLType(){return this.enum.enumName}}let x=Symbol.for("drizzle:isPgEnum");function y(a){return!!a&&"function"==typeof a&&x in a&&!0===a[x]}class z extends p{static [d.entityKind]="PgEnumColumnBuilder";constructor(a,b){super(a,"string","PgEnumColumn"),this.config.enum=b}build(a){return new A(a,this.config)}}class A extends q{static [d.entityKind]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(a,b){super(a,b),this.enum=b.enum}getSQLType(){return this.enum.enumName}}function B(a,b){var c;let d,e;return Array.isArray(b)?d=Object.assign(a=>new z(a??"",d),{enumName:a,enumValues:[...b],schema:void 0,[x]:!0}):(c=void 0,e=Object.assign(a=>new v(a??"",e),{enumName:a,enumValues:Object.values(b),schema:c,[x]:!0}))}a.s(["isPgEnum",()=>y,"pgEnum",()=>B],96178);class C{static [d.entityKind]="Subquery";constructor(a,b,c,d=!1,e=[]){this._={brand:"Subquery",sql:a,selectedFields:b,alias:c,isWith:d,usedTables:e}}}class D extends C{static [d.entityKind]="WithSubquery"}a.s(["Subquery",()=>C,"WithSubquery",()=>D],4501);let E={startActiveSpan:(a,d)=>b?(c||(c=b.trace.getTracer("drizzle-orm","0.44.7")),j((b,c)=>c.startActiveSpan(a,a=>{try{return d(a)}catch(c){throw a.setStatus({code:b.SpanStatusCode.ERROR,message:c instanceof Error?c.message:"Unknown error"}),c}finally{a.end()}}),b,c)):d()};a.s(["tracer",()=>E],84113);let F=Symbol.for("drizzle:ViewBaseConfig");a.s(["ViewBaseConfig",()=>F],55280)},20713,a=>{"use strict";var b=a.i(63227),c=a.i(37003);let d=Symbol.for("drizzle:Schema"),e=Symbol.for("drizzle:Columns"),f=Symbol.for("drizzle:ExtraConfigColumns"),g=Symbol.for("drizzle:OriginalName"),h=Symbol.for("drizzle:BaseName"),i=Symbol.for("drizzle:IsAlias"),j=Symbol.for("drizzle:ExtraConfigBuilder"),k=Symbol.for("drizzle:IsDrizzleTable");class l{static [b.entityKind]="Table";static Symbol={Name:c.TableName,Schema:d,OriginalName:g,Columns:e,ExtraConfigColumns:f,BaseName:h,IsAlias:i,ExtraConfigBuilder:j};[c.TableName];[g];[d];[e];[f];[h];[i]=!1;[k]=!0;[j]=void 0;constructor(a,b,e){this[c.TableName]=this[g]=a,this[d]=b,this[h]=e}}function m(a){return a[c.TableName]}function n(a){return`${a[d]??"public"}.${a[c.TableName]}`}a.s(["Columns",()=>e,"IsAlias",()=>i,"Schema",()=>d,"Table",()=>l,"getTableName",()=>m,"getTableUniqueName",()=>n])},30928,77001,a=>{"use strict";var b=a.i(94415),c=a.i(63227),d=a.i(51674),e=a.i(20713),f=a.i(55280);class g{constructor(a){this.table=a}static [c.entityKind]="ColumnAliasProxyHandler";get(a,b){return"table"===b?this.table:a[b]}}class h{constructor(a,b){this.alias=a,this.replaceOriginalName=b}static [c.entityKind]="TableAliasProxyHandler";get(a,d){if(d===e.Table.Symbol.IsAlias)return!0;if(d===e.Table.Symbol.Name||this.replaceOriginalName&&d===e.Table.Symbol.OriginalName)return this.alias;if(d===f.ViewBaseConfig)return{...a[f.ViewBaseConfig],name:this.alias,isAlias:!0};if(d===e.Table.Symbol.Columns){let b=a[e.Table.Symbol.Columns];if(!b)return b;let c={};return Object.keys(b).map(d=>{c[d]=new Proxy(b[d],new g(new Proxy(a,this)))}),c}let h=a[d];return(0,c.is)(h,b.Column)?new Proxy(h,new g(new Proxy(a,this))):h}}class i{constructor(a){this.alias=a}static [c.entityKind]="RelationTableAliasProxyHandler";get(a,b){return"sourceTable"===b?j(a.sourceTable,this.alias):a[b]}}function j(a,b){return new Proxy(a,new h(b,!1))}function k(a,b){return new Proxy(a,new g(new Proxy(a.table,new h(b,!1))))}function l(a,b){return new d.SQL.Aliased(m(a.sql,b),a.fieldAlias)}function m(a,e){return d.sql.join(a.queryChunks.map(a=>(0,c.is)(a,b.Column)?k(a,e):(0,c.is)(a,d.SQL)?m(a,e):(0,c.is)(a,d.SQL.Aliased)?l(a,e):a))}a.s(["ColumnAliasProxyHandler",()=>g,"TableAliasProxyHandler",()=>h,"aliasedTable",()=>j,"aliasedTableColumn",()=>k,"mapColumnsInAliasedSQLToAlias",()=>l,"mapColumnsInSQLToAlias",()=>m],77001);var n=a.i(4501);class o{static [c.entityKind]="SelectionProxyHandler";config;constructor(a){this.config={...a}}get(a,e){if("_"===e)return{...a._,selectedFields:new Proxy(a._.selectedFields,this)};if(e===f.ViewBaseConfig)return{...a[f.ViewBaseConfig],selectedFields:new Proxy(a[f.ViewBaseConfig].selectedFields,this)};if("symbol"==typeof e)return a[e];let i=((0,c.is)(a,n.Subquery)?a._.selectedFields:(0,c.is)(a,d.View)?a[f.ViewBaseConfig].selectedFields:a)[e];if((0,c.is)(i,d.SQL.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!i.isSelectionField)return i.sql;let a=i.clone();return a.isSelectionField=!0,a}if((0,c.is)(i,d.SQL)){if("sql"===this.config.sqlBehavior)return i;throw Error(`You tried to reference "${e}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return(0,c.is)(i,b.Column)?this.config.alias?new Proxy(i,new g(new Proxy(i.table,new h(this.config.alias,this.config.replaceOriginalName??!1)))):i:"object"!=typeof i||null===i?i:new Proxy(i,new o(this.config))}}a.s(["SelectionProxyHandler",()=>o],30928)},7484,a=>{"use strict";var b=a.i(63227);class c{static [b.entityKind]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}then(a,b){return this.execute().then(a,b)}}a.s(["QueryPromise",()=>c])},41657,11832,a=>{"use strict";var b=a.i(63227),c=a.i(20713);function d(a){return(a.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(a=>a.toLowerCase()).join("_")}function e(a){return(a.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((a,b,c)=>a+(0===c?b.toLowerCase():`${b[0].toUpperCase()}${b.slice(1)}`),"")}function f(a){return a}class g{static [b.entityKind]="CasingCache";cache={};cachedTables={};convert;constructor(a){this.convert="snake_case"===a?d:"camelCase"===a?e:f}getColumnCasing(a){if(!a.keyAsName)return a.name;let b=a.table[c.Table.Symbol.Schema]??"public",d=a.table[c.Table.Symbol.OriginalName],e=`${b}.${d}.${a.name}`;return this.cache[e]||this.cacheTable(a.table),this.cache[e]}cacheTable(a){let b=a[c.Table.Symbol.Schema]??"public",d=a[c.Table.Symbol.OriginalName],e=`${b}.${d}`;if(!this.cachedTables[e]){for(let b of Object.values(a[c.Table.Symbol.Columns])){let a=`${e}.${b.name}`;this.cache[a]=this.convert(b.name)}this.cachedTables[e]=!0}}clearCache(){this.cache={},this.cachedTables={}}}a.s(["CasingCache",()=>g],41657);class h extends Error{static [b.entityKind]="DrizzleError";constructor({message:a,cause:b}){super(a),this.name="DrizzleError",this.cause=b}}class i extends Error{constructor(a,b,c){super(`Failed query: ${a}
params: ${b}`),this.query=a,this.params=b,this.cause=c,Error.captureStackTrace(this,i),c&&(this.cause=c)}}class j extends h{static [b.entityKind]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}a.s(["DrizzleError",()=>h,"DrizzleQueryError",()=>i,"TransactionRollbackError",()=>j],11832)},44551,13552,97122,86096,56564,83217,90714,65105,952,99450,31793,18830,57833,a=>{"use strict";var b=a.i(94415),c=a.i(63227),d=a.i(51674),e=a.i(4501),f=a.i(20713),g=a.i(55280);function h(a,e,g){let h={},i=a.reduce((a,{path:i,field:j},k)=>{let l;l=(0,c.is)(j,b.Column)?j:(0,c.is)(j,d.SQL)?j.decoder:j.sql.decoder;let m=a;for(let[a,d]of i.entries())if(a<i.length-1)d in m||(m[d]={}),m=m[d];else{let a=e[k],n=m[d]=null===a?null:l.mapFromDriverValue(a);if(g&&(0,c.is)(j,b.Column)&&2===i.length){let a=i[0];a in h?"string"==typeof h[a]&&h[a]!==(0,f.getTableName)(j.table)&&(h[a]=!1):h[a]=null===n&&(0,f.getTableName)(j.table)}}return a},{});if(g&&Object.keys(h).length>0)for(let[a,b]of Object.entries(h))"string"!=typeof b||g[b]||(i[a]=null);return i}function i(a,b){let c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(let[a,b]of c.entries())if(b!==d[a])return!1;return!0}function j(a,e){let g=Object.entries(e).filter(([,a])=>void 0!==a).map(([e,g])=>(0,c.is)(g,d.SQL)||(0,c.is)(g,b.Column)?[e,g]:[e,new d.Param(g,a[f.Table.Symbol.Columns][e])]);if(0===g.length)throw Error("No values to set");return Object.fromEntries(g)}function k(a,b){for(let c of b)for(let b of Object.getOwnPropertyNames(c.prototype))"constructor"!==b&&Object.defineProperty(a.prototype,b,Object.getOwnPropertyDescriptor(c.prototype,b)||Object.create(null))}function l(a){return a[f.Table.Symbol.Columns]}function m(a){return(0,c.is)(a,e.Subquery)?a._.alias:(0,c.is)(a,d.View)?a[g.ViewBaseConfig].name:(0,c.is)(a,d.SQL)?void 0:a[f.Table.Symbol.IsAlias]?a[f.Table.Symbol.Name]:a[f.Table.Symbol.BaseName]}function n(a,b){return{name:"string"==typeof a&&a.length>0?a:"",config:"object"==typeof a?a:b}}function o(a){if("object"!=typeof a||null===a||"Object"!==a.constructor.name)return!1;if("logger"in a){let b=typeof a.logger;return"boolean"===b||"object"===b&&"function"==typeof a.logger.logQuery||"undefined"===b}if("schema"in a){let b=typeof a.schema;return"object"===b||"undefined"===b}if("casing"in a){let b=typeof a.casing;return"string"===b||"undefined"===b}if("mode"in a)return"default"===a.mode&&"planetscale"===a.mode&&void 0===a.mode;if("connection"in a){let b=typeof a.connection;return"string"===b||"object"===b||"undefined"===b}if("client"in a){let b=typeof a.client;return"object"===b||"function"===b||"undefined"===b}return 0===Object.keys(a).length}let p="undefined"==typeof TextDecoder?null:new TextDecoder;a.s(["applyMixins",()=>k,"getColumnNameAndConfig",()=>n,"getTableColumns",()=>l,"getTableLikeName",()=>m,"haveSameKeys",()=>i,"isConfig",()=>o,"mapResultRow",()=>h,"mapUpdateSet",()=>j,"orderSelectedFields",()=>function a(e,g){return Object.entries(e).reduce((e,[h,i])=>{if("string"!=typeof h)return e;let j=g?[...g,h]:[h];return(0,c.is)(i,b.Column)||(0,c.is)(i,d.SQL)||(0,c.is)(i,d.SQL.Aliased)?e.push({path:j,field:i}):(0,c.is)(i,f.Table)?e.push(...a(i[f.Table.Symbol.Columns],j)):e.push(...a(i,j)),e},[])},"textDecoder",()=>p],44551);var q=f,r=a.i(5302),s=r;class t extends s.PgColumnBuilder{static [c.entityKind]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(a){if(a){let{name:b,...c}=a;this.config.generatedIdentity={type:"always",sequenceName:b,sequenceOptions:c}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(a){if(a){let{name:b,...c}=a;this.config.generatedIdentity={type:"byDefault",sequenceName:b,sequenceOptions:c}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class u extends t{static [c.entityKind]="PgBigInt53Builder";constructor(a){super(a,"number","PgBigInt53")}build(a){return new v(a,this.config)}}class v extends r.PgColumn{static [c.entityKind]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class w extends t{static [c.entityKind]="PgBigInt64Builder";constructor(a){super(a,"bigint","PgBigInt64")}build(a){return new x(a,this.config)}}class x extends r.PgColumn{static [c.entityKind]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(a){return BigInt(a)}}function y(a,b){let{name:c,config:d}=n(a,b);return"number"===d.mode?new u(c):new w(c)}var z=r;class A extends z.PgColumnBuilder{static [c.entityKind]="PgBigSerial53Builder";constructor(a){super(a,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new B(a,this.config)}}class B extends z.PgColumn{static [c.entityKind]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class C extends z.PgColumnBuilder{static [c.entityKind]="PgBigSerial64Builder";constructor(a){super(a,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(a){return new D(a,this.config)}}class D extends z.PgColumn{static [c.entityKind]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(a){return BigInt(a)}}function E(a,b){let{name:c,config:d}=n(a,b);return"number"===d.mode?new A(c):new C(c)}var F=r;class G extends F.PgColumnBuilder{static [c.entityKind]="PgBooleanBuilder";constructor(a){super(a,"boolean","PgBoolean")}build(a){return new H(a,this.config)}}class H extends F.PgColumn{static [c.entityKind]="PgBoolean";getSQLType(){return"boolean"}}function I(a){return new G(a??"")}a.s(["boolean",()=>I],13552);var J=r;class K extends J.PgColumnBuilder{static [c.entityKind]="PgCharBuilder";constructor(a,b){super(a,"string","PgChar"),this.config.length=b.length,this.config.enumValues=b.enum}build(a){return new L(a,this.config)}}class L extends J.PgColumn{static [c.entityKind]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function M(a,b={}){let{name:c,config:d}=n(a,b);return new K(c,d)}var N=r;class O extends N.PgColumnBuilder{static [c.entityKind]="PgCidrBuilder";constructor(a){super(a,"string","PgCidr")}build(a){return new P(a,this.config)}}class P extends N.PgColumn{static [c.entityKind]="PgCidr";getSQLType(){return"cidr"}}function Q(a){return new O(a??"")}var R=r;class S extends R.PgColumnBuilder{static [c.entityKind]="PgCustomColumnBuilder";constructor(a,b,c){super(a,"custom","PgCustomColumn"),this.config.fieldConfig=b,this.config.customTypeParams=c}build(a){return new T(a,this.config)}}class T extends R.PgColumn{static [c.entityKind]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(a,b){super(a,b),this.sqlName=b.customTypeParams.dataType(b.fieldConfig),this.mapTo=b.customTypeParams.toDriver,this.mapFrom=b.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(a){return"function"==typeof this.mapFrom?this.mapFrom(a):a}mapToDriverValue(a){return"function"==typeof this.mapTo?this.mapTo(a):a}}function U(a){return(b,c)=>{let{name:d,config:e}=n(b,c);return new S(d,e,a)}}var V=r,W=r;class X extends W.PgColumnBuilder{static [c.entityKind]="PgDateColumnBaseBuilder";defaultNow(){return this.default(d.sql`now()`)}}class Y extends X{static [c.entityKind]="PgDateBuilder";constructor(a){super(a,"date","PgDate")}build(a){return new Z(a,this.config)}}class Z extends V.PgColumn{static [c.entityKind]="PgDate";getSQLType(){return"date"}mapFromDriverValue(a){return new Date(a)}mapToDriverValue(a){return a.toISOString()}}class $ extends X{static [c.entityKind]="PgDateStringBuilder";constructor(a){super(a,"string","PgDateString")}build(a){return new _(a,this.config)}}class _ extends V.PgColumn{static [c.entityKind]="PgDateString";getSQLType(){return"date"}}function aa(a,b){let{name:c,config:d}=n(a,b);return d?.mode==="date"?new Y(c):new $(c)}a.s(["PgDate",()=>Z,"PgDateString",()=>_,"date",()=>aa],97122);var ab=r;class ac extends ab.PgColumnBuilder{static [c.entityKind]="PgDoublePrecisionBuilder";constructor(a){super(a,"number","PgDoublePrecision")}build(a){return new ad(a,this.config)}}class ad extends ab.PgColumn{static [c.entityKind]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(a){return"string"==typeof a?Number.parseFloat(a):a}}function ae(a){return new ac(a??"")}var af=r;class ag extends af.PgColumnBuilder{static [c.entityKind]="PgInetBuilder";constructor(a){super(a,"string","PgInet")}build(a){return new ah(a,this.config)}}class ah extends af.PgColumn{static [c.entityKind]="PgInet";getSQLType(){return"inet"}}function ai(a){return new ag(a??"")}var aj=r;class ak extends t{static [c.entityKind]="PgIntegerBuilder";constructor(a){super(a,"number","PgInteger")}build(a){return new al(a,this.config)}}class al extends aj.PgColumn{static [c.entityKind]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(a){return"string"==typeof a?Number.parseInt(a):a}}function am(a){return new ak(a??"")}a.s(["integer",()=>am],86096);var an=r;class ao extends an.PgColumnBuilder{static [c.entityKind]="PgIntervalBuilder";constructor(a,b){super(a,"string","PgInterval"),this.config.intervalConfig=b}build(a){return new ap(a,this.config)}}class ap extends an.PgColumn{static [c.entityKind]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let a=this.fields?` ${this.fields}`:"",b=this.precision?`(${this.precision})`:"";return`interval${a}${b}`}}function aq(a,b={}){let{name:c,config:d}=n(a,b);return new ao(c,d)}var ar=r;class as extends ar.PgColumnBuilder{static [c.entityKind]="PgJsonBuilder";constructor(a){super(a,"json","PgJson")}build(a){return new at(a,this.config)}}class at extends ar.PgColumn{static [c.entityKind]="PgJson";constructor(a,b){super(a,b)}getSQLType(){return"json"}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}}function au(a){return new as(a??"")}a.s(["PgJson",()=>at,"json",()=>au],56564);var av=r;class aw extends av.PgColumnBuilder{static [c.entityKind]="PgJsonbBuilder";constructor(a){super(a,"json","PgJsonb")}build(a){return new ax(a,this.config)}}class ax extends av.PgColumn{static [c.entityKind]="PgJsonb";constructor(a,b){super(a,b)}getSQLType(){return"jsonb"}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}}function ay(a){return new aw(a??"")}a.s(["PgJsonb",()=>ax,"jsonb",()=>ay],83217);var az=r;class aA extends az.PgColumnBuilder{static [c.entityKind]="PgLineBuilder";constructor(a){super(a,"array","PgLine")}build(a){return new aB(a,this.config)}}class aB extends az.PgColumn{static [c.entityKind]="PgLine";getSQLType(){return"line"}mapFromDriverValue(a){let[b,c,d]=a.slice(1,-1).split(",");return[Number.parseFloat(b),Number.parseFloat(c),Number.parseFloat(d)]}mapToDriverValue(a){return`{${a[0]},${a[1]},${a[2]}}`}}class aC extends az.PgColumnBuilder{static [c.entityKind]="PgLineABCBuilder";constructor(a){super(a,"json","PgLineABC")}build(a){return new aD(a,this.config)}}class aD extends az.PgColumn{static [c.entityKind]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(a){let[b,c,d]=a.slice(1,-1).split(",");return{a:Number.parseFloat(b),b:Number.parseFloat(c),c:Number.parseFloat(d)}}mapToDriverValue(a){return`{${a.a},${a.b},${a.c}}`}}function aE(a,b){let{name:c,config:d}=n(a,b);return d?.mode&&"tuple"!==d.mode?new aC(c):new aA(c)}var aF=r;class aG extends aF.PgColumnBuilder{static [c.entityKind]="PgMacaddrBuilder";constructor(a){super(a,"string","PgMacaddr")}build(a){return new aH(a,this.config)}}class aH extends aF.PgColumn{static [c.entityKind]="PgMacaddr";getSQLType(){return"macaddr"}}function aI(a){return new aG(a??"")}var aJ=r;class aK extends aJ.PgColumnBuilder{static [c.entityKind]="PgMacaddr8Builder";constructor(a){super(a,"string","PgMacaddr8")}build(a){return new aL(a,this.config)}}class aL extends aJ.PgColumn{static [c.entityKind]="PgMacaddr8";getSQLType(){return"macaddr8"}}function aM(a){return new aK(a??"")}var aN=r;class aO extends aN.PgColumnBuilder{static [c.entityKind]="PgNumericBuilder";constructor(a,b,c){super(a,"string","PgNumeric"),this.config.precision=b,this.config.scale=c}build(a){return new aP(a,this.config)}}class aP extends aN.PgColumn{static [c.entityKind]="PgNumeric";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}mapFromDriverValue(a){return"string"==typeof a?a:String(a)}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class aQ extends aN.PgColumnBuilder{static [c.entityKind]="PgNumericNumberBuilder";constructor(a,b,c){super(a,"number","PgNumericNumber"),this.config.precision=b,this.config.scale=c}build(a){return new aR(a,this.config)}}class aR extends aN.PgColumn{static [c.entityKind]="PgNumericNumber";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class aS extends aN.PgColumnBuilder{static [c.entityKind]="PgNumericBigIntBuilder";constructor(a,b,c){super(a,"bigint","PgNumericBigInt"),this.config.precision=b,this.config.scale=c}build(a){return new aT(a,this.config)}}class aT extends aN.PgColumn{static [c.entityKind]="PgNumericBigInt";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}function aU(a,b){let{name:c,config:d}=n(a,b),e=d?.mode;return"number"===e?new aQ(c,d?.precision,d?.scale):"bigint"===e?new aS(c,d?.precision,d?.scale):new aO(c,d?.precision,d?.scale)}a.s(["PgNumeric",()=>aP,"numeric",()=>aU],90714);var aV=r;class aW extends aV.PgColumnBuilder{static [c.entityKind]="PgPointTupleBuilder";constructor(a){super(a,"array","PgPointTuple")}build(a){return new aX(a,this.config)}}class aX extends aV.PgColumn{static [c.entityKind]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(a){if("string"==typeof a){let[b,c]=a.slice(1,-1).split(",");return[Number.parseFloat(b),Number.parseFloat(c)]}return[a.x,a.y]}mapToDriverValue(a){return`(${a[0]},${a[1]})`}}class aY extends aV.PgColumnBuilder{static [c.entityKind]="PgPointObjectBuilder";constructor(a){super(a,"json","PgPointObject")}build(a){return new aZ(a,this.config)}}class aZ extends aV.PgColumn{static [c.entityKind]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(a){if("string"==typeof a){let[b,c]=a.slice(1,-1).split(",");return{x:Number.parseFloat(b),y:Number.parseFloat(c)}}return a}mapToDriverValue(a){return`(${a.x},${a.y})`}}function a$(a,b){let{name:c,config:d}=n(a,b);return d?.mode&&"tuple"!==d.mode?new aY(c):new aW(c)}var a_=r;function a0(a,b){let c=new DataView(new ArrayBuffer(8));for(let d=0;d<8;d++)c.setUint8(d,a[b+d]);return c.getFloat64(0,!0)}function a1(a){let b=function(a){let b=[];for(let c=0;c<a.length;c+=2)b.push(Number.parseInt(a.slice(c,c+2),16));return new Uint8Array(b)}(a),c=0,d=b[0];c+=1;let e=new DataView(b.buffer),f=e.getUint32(c,1===d);if(c+=4,0x20000000&f&&(e.getUint32(c,1===d),c+=4),(65535&f)==1){let a=a0(b,c),d=a0(b,c+=8);return c+=8,[a,d]}throw Error("Unsupported geometry type")}class a2 extends a_.PgColumnBuilder{static [c.entityKind]="PgGeometryBuilder";constructor(a){super(a,"array","PgGeometry")}build(a){return new a3(a,this.config)}}class a3 extends a_.PgColumn{static [c.entityKind]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(a){return a1(a)}mapToDriverValue(a){return`point(${a[0]} ${a[1]})`}}class a4 extends a_.PgColumnBuilder{static [c.entityKind]="PgGeometryObjectBuilder";constructor(a){super(a,"json","PgGeometryObject")}build(a){return new a5(a,this.config)}}class a5 extends a_.PgColumn{static [c.entityKind]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(a){let b=a1(a);return{x:b[0],y:b[1]}}mapToDriverValue(a){return`point(${a.x} ${a.y})`}}function a6(a,b){let{name:c,config:d}=n(a,b);return d?.mode&&"tuple"!==d.mode?new a4(c):new a2(c)}var a7=r;class a8 extends a7.PgColumnBuilder{static [c.entityKind]="PgRealBuilder";constructor(a,b){super(a,"number","PgReal"),this.config.length=b}build(a){return new a9(a,this.config)}}class a9 extends a7.PgColumn{static [c.entityKind]="PgReal";constructor(a,b){super(a,b)}getSQLType(){return"real"}mapFromDriverValue=a=>"string"==typeof a?Number.parseFloat(a):a}function ba(a){return new a8(a??"")}var bb=r;class bc extends bb.PgColumnBuilder{static [c.entityKind]="PgSerialBuilder";constructor(a){super(a,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new bd(a,this.config)}}class bd extends bb.PgColumn{static [c.entityKind]="PgSerial";getSQLType(){return"serial"}}function be(a){return new bc(a??"")}var bf=r;class bg extends t{static [c.entityKind]="PgSmallIntBuilder";constructor(a){super(a,"number","PgSmallInt")}build(a){return new bh(a,this.config)}}class bh extends bf.PgColumn{static [c.entityKind]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=a=>"string"==typeof a?Number(a):a}function bi(a){return new bg(a??"")}var bj=r;class bk extends bj.PgColumnBuilder{static [c.entityKind]="PgSmallSerialBuilder";constructor(a){super(a,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new bl(a,this.config)}}class bl extends bj.PgColumn{static [c.entityKind]="PgSmallSerial";getSQLType(){return"smallserial"}}function bm(a){return new bk(a??"")}var bn=r;class bo extends bn.PgColumnBuilder{static [c.entityKind]="PgTextBuilder";constructor(a,b){super(a,"string","PgText"),this.config.enumValues=b.enum}build(a){return new bp(a,this.config)}}class bp extends bn.PgColumn{static [c.entityKind]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function bq(a,b={}){let{name:c,config:d}=n(a,b);return new bo(c,d)}a.s(["text",()=>bq],65105);var br=r;class bs extends X{constructor(a,b,c){super(a,"string","PgTime"),this.withTimezone=b,this.precision=c,this.config.withTimezone=b,this.config.precision=c}static [c.entityKind]="PgTimeBuilder";build(a){return new bt(a,this.config)}}class bt extends br.PgColumn{static [c.entityKind]="PgTime";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":`(${this.precision})`;return`time${a}${this.withTimezone?" with time zone":""}`}}function bu(a,b={}){let{name:c,config:d}=n(a,b);return new bs(c,d.withTimezone??!1,d.precision)}a.s(["PgTime",()=>bt,"time",()=>bu],952);var bv=r;class bw extends X{static [c.entityKind]="PgTimestampBuilder";constructor(a,b,c){super(a,"date","PgTimestamp"),this.config.withTimezone=b,this.config.precision=c}build(a){return new bx(a,this.config)}}class bx extends bv.PgColumn{static [c.entityKind]="PgTimestamp";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":` (${this.precision})`;return`timestamp${a}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=a=>new Date(this.withTimezone?a:a+"+0000");mapToDriverValue=a=>a.toISOString()}class by extends X{static [c.entityKind]="PgTimestampStringBuilder";constructor(a,b,c){super(a,"string","PgTimestampString"),this.config.withTimezone=b,this.config.precision=c}build(a){return new bz(a,this.config)}}class bz extends bv.PgColumn{static [c.entityKind]="PgTimestampString";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":`(${this.precision})`;return`timestamp${a}${this.withTimezone?" with time zone":""}`}}function bA(a,b={}){let{name:c,config:d}=n(a,b);return d?.mode==="string"?new by(c,d.withTimezone??!1,d.precision):new bw(c,d?.withTimezone??!1,d?.precision)}a.s(["PgTimestamp",()=>bx,"PgTimestampString",()=>bz,"timestamp",()=>bA],99450);var bB=r;class bC extends bB.PgColumnBuilder{static [c.entityKind]="PgUUIDBuilder";constructor(a){super(a,"string","PgUUID")}defaultRandom(){return this.default(d.sql`gen_random_uuid()`)}build(a){return new bD(a,this.config)}}class bD extends bB.PgColumn{static [c.entityKind]="PgUUID";getSQLType(){return"uuid"}}function bE(a){return new bC(a??"")}a.s(["PgUUID",()=>bD,"uuid",()=>bE],31793);var bF=r;class bG extends bF.PgColumnBuilder{static [c.entityKind]="PgVarcharBuilder";constructor(a,b){super(a,"string","PgVarchar"),this.config.length=b.length,this.config.enumValues=b.enum}build(a){return new bH(a,this.config)}}class bH extends bF.PgColumn{static [c.entityKind]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function bI(a,b={}){let{name:c,config:d}=n(a,b);return new bG(c,d)}a.s(["varchar",()=>bI],18830);var bJ=r;class bK extends bJ.PgColumnBuilder{static [c.entityKind]="PgBinaryVectorBuilder";constructor(a,b){super(a,"string","PgBinaryVector"),this.config.dimensions=b.dimensions}build(a){return new bL(a,this.config)}}class bL extends bJ.PgColumn{static [c.entityKind]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function bM(a,b){let{name:c,config:d}=n(a,b);return new bK(c,d)}var bN=r;class bO extends bN.PgColumnBuilder{static [c.entityKind]="PgHalfVectorBuilder";constructor(a,b){super(a,"array","PgHalfVector"),this.config.dimensions=b.dimensions}build(a){return new bP(a,this.config)}}class bP extends bN.PgColumn{static [c.entityKind]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){return a.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function bQ(a,b){let{name:c,config:d}=n(a,b);return new bO(c,d)}var bR=r;class bS extends bR.PgColumnBuilder{static [c.entityKind]="PgSparseVectorBuilder";constructor(a,b){super(a,"string","PgSparseVector"),this.config.dimensions=b.dimensions}build(a){return new bT(a,this.config)}}class bT extends bR.PgColumn{static [c.entityKind]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function bU(a,b){let{name:c,config:d}=n(a,b);return new bS(c,d)}var bV=r;class bW extends bV.PgColumnBuilder{static [c.entityKind]="PgVectorBuilder";constructor(a,b){super(a,"array","PgVector"),this.config.dimensions=b.dimensions}build(a){return new bX(a,this.config)}}class bX extends bV.PgColumn{static [c.entityKind]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){return a.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function bY(a,b){let{name:c,config:d}=n(a,b);return new bW(c,d)}let bZ=Symbol.for("drizzle:PgInlineForeignKeys"),b$=Symbol.for("drizzle:EnableRLS");class b_ extends q.Table{static [c.entityKind]="PgTable";static Symbol=Object.assign({},q.Table.Symbol,{InlineForeignKeys:bZ,EnableRLS:b$});[bZ]=[];[b$]=!1;[q.Table.Symbol.ExtraConfigBuilder]=void 0;[q.Table.Symbol.ExtraConfigColumns]={}}let b0=(a,b,c)=>(function(a,b,c,d,e=a){let f=new b_(a,d,e),g="function"==typeof b?b({bigint:y,bigserial:E,boolean:I,char:M,cidr:Q,customType:U,date:aa,doublePrecision:ae,inet:ai,integer:am,interval:aq,json:au,jsonb:ay,line:aE,macaddr:aI,macaddr8:aM,numeric:aU,point:a$,geometry:a6,real:ba,serial:be,smallint:bi,smallserial:bm,text:bq,time:bu,timestamp:bA,uuid:bE,varchar:bI,bit:bM,halfvec:bQ,sparsevec:bU,vector:bY}):b,h=Object.fromEntries(Object.entries(g).map(([a,b])=>{b.setName(a);let c=b.build(f);return f[bZ].push(...b.buildForeignKeys(c,f)),[a,c]})),i=Object.fromEntries(Object.entries(g).map(([a,b])=>(b.setName(a),[a,b.buildExtraConfigColumn(f)]))),j=Object.assign(f,h);return j[q.Table.Symbol.Columns]=h,j[q.Table.Symbol.ExtraConfigColumns]=i,c&&(j[b_.Symbol.ExtraConfigBuilder]=c),Object.assign(j,{enableRLS:()=>(j[b_.Symbol.EnableRLS]=!0,j)})})(a,b,c,void 0);a.s(["PgTable",()=>b_,"pgTable",()=>b0],57833)},74619,a=>{"use strict";var b=a.i(63227),c=a.i(57833);function d(...a){return a[0].columns?new e(a[0].columns,a[0].name):new e(a)}class e{static [b.entityKind]="PgPrimaryKeyBuilder";columns;name;constructor(a,b){this.columns=a,this.name=b}build(a){return new f(a,this.columns,this.name)}}class f{constructor(a,b,c){this.table=a,this.columns=b,this.name=c}static [b.entityKind]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[c.PgTable.Symbol.Name]}_${this.columns.map(a=>a.name).join("_")}_pk`}}a.s(["PrimaryKeyBuilder",()=>e,"primaryKey",()=>d])},93321,51674,a=>{"use strict";var b,c=a.i(94415),d=a.i(63227),e=a.i(20713),f=a.i(96178),g=a.i(4501),h=a.i(84113),i=a.i(55280);class j{static [d.entityKind]="FakePrimitiveParam"}function k(a){return null!=a&&"function"==typeof a.getSQL}class l{static [d.entityKind]="StringChunk";value;constructor(a){this.value=Array.isArray(a)?a:[a]}getSQL(){return new m([this])}}class m{constructor(a){for(const b of(this.queryChunks=a,a))if((0,d.is)(b,e.Table)){const a=b[e.Table.Symbol.Schema];this.usedTables.push(void 0===a?b[e.Table.Symbol.Name]:a+"."+b[e.Table.Symbol.Name])}}static [d.entityKind]="SQL";decoder=p;shouldInlineParams=!1;usedTables=[];append(a){return this.queryChunks.push(...a.queryChunks),this}toQuery(a){return h.tracer.startActiveSpan("drizzle.buildSQL",b=>{let c=this.buildQueryFromSourceParams(this.queryChunks,a);return b?.setAttributes({"drizzle.query.text":c.sql,"drizzle.query.params":JSON.stringify(c.params)}),c})}buildQueryFromSourceParams(a,b){let h=Object.assign({},b,{inlineParams:b.inlineParams||this.shouldInlineParams,paramStartIndex:b.paramStartIndex||{value:0}}),{casing:j,escapeName:o,escapeParam:p,prepareTyping:q,inlineParams:s,paramStartIndex:t}=h;var u=a.map(a=>{if((0,d.is)(a,l))return{sql:a.value.join(""),params:[]};if((0,d.is)(a,n))return{sql:o(a.value),params:[]};if(void 0===a)return{sql:"",params:[]};if(Array.isArray(a)){let b=[new l("(")];for(let[c,d]of a.entries())b.push(d),c<a.length-1&&b.push(new l(", "));return b.push(new l(")")),this.buildQueryFromSourceParams(b,h)}if((0,d.is)(a,m))return this.buildQueryFromSourceParams(a.queryChunks,{...h,inlineParams:s||a.shouldInlineParams});if((0,d.is)(a,e.Table)){let b=a[e.Table.Symbol.Schema],c=a[e.Table.Symbol.Name];return{sql:void 0===b||a[e.IsAlias]?o(c):o(b)+"."+o(c),params:[]}}if((0,d.is)(a,c.Column)){let c=j.getColumnCasing(a);if("indexes"===b.invokeSource)return{sql:o(c),params:[]};let d=a.table[e.Table.Symbol.Schema];return{sql:a.table[e.IsAlias]||void 0===d?o(a.table[e.Table.Symbol.Name])+"."+o(c):o(d)+"."+o(a.table[e.Table.Symbol.Name])+"."+o(c),params:[]}}if((0,d.is)(a,y)){let b=a[i.ViewBaseConfig].schema,c=a[i.ViewBaseConfig].name;return{sql:void 0===b||a[i.ViewBaseConfig].isAlias?o(c):o(b)+"."+o(c),params:[]}}if((0,d.is)(a,r)){if((0,d.is)(a.value,v))return{sql:p(t.value++,a),params:[a],typings:["none"]};let b=null===a.value?null:a.encoder.mapToDriverValue(a.value);if((0,d.is)(b,m))return this.buildQueryFromSourceParams([b],h);if(s)return{sql:this.mapInlineParam(b,h),params:[]};let c=["none"];return q&&(c=[q(a.encoder)]),{sql:p(t.value++,b),params:[b],typings:c}}return(0,d.is)(a,v)?{sql:p(t.value++,a),params:[a],typings:["none"]}:(0,d.is)(a,m.Aliased)&&void 0!==a.fieldAlias?{sql:o(a.fieldAlias),params:[]}:(0,d.is)(a,g.Subquery)?a._.isWith?{sql:o(a._.alias),params:[]}:this.buildQueryFromSourceParams([new l("("),a._.sql,new l(") "),new n(a._.alias)],h):(0,f.isPgEnum)(a)?a.schema?{sql:o(a.schema)+"."+o(a.enumName),params:[]}:{sql:o(a.enumName),params:[]}:k(a)?a.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([a.getSQL()],h):this.buildQueryFromSourceParams([new l("("),a.getSQL(),new l(")")],h):s?{sql:this.mapInlineParam(a,h),params:[]}:{sql:p(t.value++,a),params:[a],typings:["none"]}});let w={sql:"",params:[]};for(let a of u)w.sql+=a.sql,w.params.push(...a.params),a.typings?.length&&(w.typings||(w.typings=[]),w.typings.push(...a.typings));return w}mapInlineParam(a,{escapeString:b}){if(null===a)return"null";if("number"==typeof a||"boolean"==typeof a)return a.toString();if("string"==typeof a)return b(a);if("object"==typeof a){let c=a.toString();return"[object Object]"===c?b(JSON.stringify(a)):b(c)}throw Error("Unexpected param value: "+a)}getSQL(){return this}as(a){return void 0===a?this:new m.Aliased(this,a)}mapWith(a){return this.decoder="function"==typeof a?{mapFromDriverValue:a}:a,this}inlineParams(){return this.shouldInlineParams=!0,this}if(a){return a?this:void 0}}class n{constructor(a){this.value=a}static [d.entityKind]="Name";brand;getSQL(){return new m([this])}}function o(a){return"object"==typeof a&&null!==a&&"mapToDriverValue"in a&&"function"==typeof a.mapToDriverValue}let p={mapFromDriverValue:a=>a},q={mapToDriverValue:a=>a};({...p,...q});class r{constructor(a,b=q){this.value=a,this.encoder=b}static [d.entityKind]="Param";brand;getSQL(){return new m([this])}}function s(a,...b){let c=[];for(let[d,e]of((b.length>0||a.length>0&&""!==a[0])&&c.push(new l(a[0])),b.entries()))c.push(e,new l(a[d+1]));return new m(c)}(b=s||(s={})).empty=function(){return new m([])},b.fromList=function(a){return new m(a)},b.raw=function(a){return new m([new l(a)])},b.join=function(a,b){let c=[];for(let[d,e]of a.entries())d>0&&void 0!==b&&c.push(b),c.push(e);return new m(c)},b.identifier=function(a){return new n(a)},b.placeholder=function(a){return new v(a)},b.param=function(a,b){return new r(a,b)};var t=m||(m={});class u{constructor(a,b){this.sql=a,this.fieldAlias=b}static [d.entityKind]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new u(this.sql,this.fieldAlias)}}t.Aliased=u;class v{constructor(a){this.name=a}static [d.entityKind]="Placeholder";getSQL(){return new m([this])}}function w(a,b){return a.map(a=>{if((0,d.is)(a,v)){if(!(a.name in b))throw Error(`No value for placeholder "${a.name}" was provided`);return b[a.name]}if((0,d.is)(a,r)&&(0,d.is)(a.value,v)){if(!(a.value.name in b))throw Error(`No value for placeholder "${a.value.name}" was provided`);return a.encoder.mapToDriverValue(b[a.value.name])}return a})}let x=Symbol.for("drizzle:IsDrizzleView");class y{static [d.entityKind]="View";[i.ViewBaseConfig];[x]=!0;constructor({name:a,schema:b,selectedFields:c,query:d}){this[i.ViewBaseConfig]={name:a,originalName:a,schema:b,selectedFields:c,query:d,isExisting:!d,isAlias:!1}}getSQL(){return new m([this])}}function z(a,b){return!o(b)||k(a)||(0,d.is)(a,r)||(0,d.is)(a,v)||(0,d.is)(a,c.Column)||(0,d.is)(a,e.Table)||(0,d.is)(a,y)?a:new r(a,b)}c.Column.prototype.getSQL=function(){return new m([this])},e.Table.prototype.getSQL=function(){return new m([this])},g.Subquery.prototype.getSQL=function(){return new m([this])},a.s(["Param",()=>r,"Placeholder",()=>v,"SQL",()=>m,"StringChunk",()=>l,"View",()=>y,"fillPlaceholders",()=>w,"isDriverValueEncoder",()=>o,"isSQLWrapper",()=>k,"sql",()=>s],51674);let A=(a,b)=>s`${a} = ${z(b,a)}`,B=(a,b)=>s`${a} <> ${z(b,a)}`;function C(...a){let b=a.filter(a=>void 0!==a);if(0!==b.length)return new m(1===b.length?b:[new l("("),s.join(b,new l(" and ")),new l(")")])}function D(...a){let b=a.filter(a=>void 0!==a);if(0!==b.length)return new m(1===b.length?b:[new l("("),s.join(b,new l(" or ")),new l(")")])}function E(a){return s`not ${a}`}let F=(a,b)=>s`${a} > ${z(b,a)}`,G=(a,b)=>s`${a} >= ${z(b,a)}`,H=(a,b)=>s`${a} < ${z(b,a)}`,I=(a,b)=>s`${a} <= ${z(b,a)}`;function J(a,b){return Array.isArray(b)?0===b.length?s`false`:s`${a} in ${b.map(b=>z(b,a))}`:s`${a} in ${z(b,a)}`}function K(a,b){return Array.isArray(b)?0===b.length?s`true`:s`${a} not in ${b.map(b=>z(b,a))}`:s`${a} not in ${z(b,a)}`}function L(a){return s`${a} is null`}function M(a){return s`${a} is not null`}function N(a){return s`exists ${a}`}function O(a){return s`not exists ${a}`}function P(a,b,c){return s`${a} between ${z(b,a)} and ${z(c,a)}`}function Q(a,b,c){return s`${a} not between ${z(b,a)} and ${z(c,a)}`}function R(a,b){return s`${a} like ${b}`}function S(a,b){return s`${a} not like ${b}`}function T(a,b){return s`${a} ilike ${b}`}function U(a,b){return s`${a} not ilike ${b}`}a.s(["and",()=>C,"between",()=>P,"eq",()=>A,"exists",()=>N,"gt",()=>F,"gte",()=>G,"ilike",()=>T,"inArray",()=>J,"isNotNull",()=>M,"isNull",()=>L,"like",()=>R,"lt",()=>H,"lte",()=>I,"ne",()=>B,"not",()=>E,"notBetween",()=>Q,"notExists",()=>O,"notIlike",()=>U,"notInArray",()=>K,"notLike",()=>S,"or",()=>D],93321)},30385,a=>{"use strict";var b=a.i(51674);function c(a){return b.sql`${a} asc`}function d(a){return b.sql`${a} desc`}a.s(["asc",()=>c,"desc",()=>d])},68540,a=>{"use strict";var b=a.i(20713),c=a.i(94415),d=a.i(63227),e=a.i(74619),f=a.i(93321),g=a.i(30385),h=a.i(51674);class i{constructor(a,c,d){this.sourceTable=a,this.referencedTable=c,this.relationName=d,this.referencedTableName=c[b.Table.Symbol.Name]}static [d.entityKind]="Relation";referencedTableName;fieldName}class j{constructor(a,b){this.table=a,this.config=b}static [d.entityKind]="Relations"}class k extends i{constructor(a,b,c,d){super(a,b,c?.relationName),this.config=c,this.isNullable=d}static [d.entityKind]="One";withFieldName(a){let b=new k(this.sourceTable,this.referencedTable,this.config,this.isNullable);return b.fieldName=a,b}}class l extends i{constructor(a,b,c){super(a,b,c?.relationName),this.config=c}static [d.entityKind]="Many";withFieldName(a){let b=new l(this.sourceTable,this.referencedTable,this.config);return b.fieldName=a,b}}function m(){return{and:f.and,between:f.between,eq:f.eq,exists:f.exists,gt:f.gt,gte:f.gte,ilike:f.ilike,inArray:f.inArray,isNull:f.isNull,isNotNull:f.isNotNull,like:f.like,lt:f.lt,lte:f.lte,ne:f.ne,not:f.not,notBetween:f.notBetween,notExists:f.notExists,notLike:f.notLike,notIlike:f.notIlike,notInArray:f.notInArray,or:f.or,sql:h.sql}}function n(){return{sql:h.sql,asc:g.asc,desc:g.desc}}function o(a,c){1===Object.keys(a).length&&"default"in a&&!(0,d.is)(a.default,b.Table)&&(a=a.default);let f={},g={},h={};for(let[i,k]of Object.entries(a))if((0,d.is)(k,b.Table)){let a=(0,b.getTableUniqueName)(k),c=g[a];for(let d of(f[a]=i,h[i]={tsName:i,dbName:k[b.Table.Symbol.Name],schema:k[b.Table.Symbol.Schema],columns:k[b.Table.Symbol.Columns],relations:c?.relations??{},primaryKey:c?.primaryKey??[]},Object.values(k[b.Table.Symbol.Columns])))d.primary&&h[i].primaryKey.push(d);let j=k[b.Table.Symbol.ExtraConfigBuilder]?.(k[b.Table.Symbol.ExtraConfigColumns]);if(j)for(let a of Object.values(j))(0,d.is)(a,e.PrimaryKeyBuilder)&&h[i].primaryKey.push(...a.columns)}else if((0,d.is)(k,j)){let a,d=(0,b.getTableUniqueName)(k.table),e=f[d];for(let[b,f]of Object.entries(k.config(c(k.table))))if(e){let c=h[e];c.relations[b]=f,a&&c.primaryKey.push(...a)}else d in g||(g[d]={relations:{},primaryKey:a}),g[d].relations[b]=f}return{tables:h,tableNamesMap:f}}function p(a,b){return new j(a,a=>Object.fromEntries(Object.entries(b(a)).map(([a,b])=>[a,b.withFieldName(a)])))}function q(a,c,e){if((0,d.is)(e,k)&&e.config)return{fields:e.config.fields,references:e.config.references};let f=c[(0,b.getTableUniqueName)(e.referencedTable)];if(!f)throw Error(`Table "${e.referencedTable[b.Table.Symbol.Name]}" not found in schema`);let g=a[f];if(!g)throw Error(`Table "${f}" not found in schema`);let h=e.sourceTable,i=c[(0,b.getTableUniqueName)(h)];if(!i)throw Error(`Table "${h[b.Table.Symbol.Name]}" not found in schema`);let j=[];for(let a of Object.values(g.relations))(e.relationName&&e!==a&&a.relationName===e.relationName||!e.relationName&&a.referencedTable===e.sourceTable)&&j.push(a);if(j.length>1)throw e.relationName?Error(`There are multiple relations with name "${e.relationName}" in table "${f}"`):Error(`There are multiple relations between "${f}" and "${e.sourceTable[b.Table.Symbol.Name]}". Please specify relation name`);if(j[0]&&(0,d.is)(j[0],k)&&j[0].config)return{fields:j[0].config.references,references:j[0].config.fields};throw Error(`There is not enough information to infer relation "${i}.${e.fieldName}"`)}function r(a){return{one:function(b,c){return new k(a,b,c,c?.fields.reduce((a,b)=>a&&b.notNull,!0)??!1)},many:function(b,c){return new l(a,b,c)}}}a.s(["Many",()=>l,"One",()=>k,"createTableRelationsHelpers",()=>r,"extractTablesRelationalConfig",()=>o,"getOperators",()=>m,"getOrderByOperators",()=>n,"mapRelationalRow",()=>function a(b,e,f,g,i=a=>a){let j={};for(let[l,m]of g.entries())if(m.isJson){let c=e.relations[m.tsKey],g=f[l],h="string"==typeof g?JSON.parse(g):g;j[m.tsKey]=(0,d.is)(c,k)?h&&a(b,b[m.relationTableTsKey],h,m.selection,i):h.map(c=>a(b,b[m.relationTableTsKey],c,m.selection,i))}else{let a,b=i(f[l]),e=m.field;a=(0,d.is)(e,c.Column)?e:(0,d.is)(e,h.SQL)?e.decoder:e.sql.decoder,j[m.tsKey]=null===b?null:a.mapFromDriverValue(b)}return j},"normalizeRelation",()=>q,"relations",()=>p])},82534,a=>{"use strict";var b=a.i(63227);class c{static [b.entityKind]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}a.s(["TypedQueryBuilder",()=>c])},89221,a=>{"use strict";var b=a.i(51674),c=a.i(63227),d=a.i(5302);class e{constructor(a,b){this.unique=a,this.name=b}static [c.entityKind]="PgIndexBuilderOn";on(...a){return new f(a.map(a=>{if((0,c.is)(a,b.SQL))return a;let e=new d.IndexedColumn(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=JSON.parse(JSON.stringify(a.defaultConfig)),e}),this.unique,!1,this.name)}onOnly(...a){return new f(a.map(a=>{if((0,c.is)(a,b.SQL))return a;let e=new d.IndexedColumn(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=a.defaultConfig,e}),this.unique,!0,this.name)}using(a,...e){return new f(e.map(a=>{if((0,c.is)(a,b.SQL))return a;let e=new d.IndexedColumn(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=JSON.parse(JSON.stringify(a.defaultConfig)),e}),this.unique,!0,this.name,a)}}class f{static [c.entityKind]="PgIndexBuilder";config;constructor(a,b,c,d,e="btree"){this.config={name:d,columns:a,unique:b,only:c,method:e}}concurrently(){return this.config.concurrently=!0,this}with(a){return this.config.with=a,this}where(a){return this.config.where=a,this}build(a){return new g(this.config,a)}}class g{static [c.entityKind]="PgIndex";config;constructor(a,b){this.config={...a,table:b}}}function h(a){return new e(!1,a)}function i(a){return new e(!0,a)}a.s(["IndexBuilder",()=>f,"index",()=>h,"uniqueIndex",()=>i])},908,94831,14782,a=>{"use strict";var b=a.i(63227);class c{constructor(a,b){this.name=a,this.value=b}static [b.entityKind]="PgCheckBuilder";brand;build(a){return new d(a,this)}}class d{constructor(a,b){this.table=a,this.name=b.name,this.value=b.value}static [b.entityKind]="PgCheck";name;value}a.s(["CheckBuilder",()=>c],908);class e{constructor(a,b){this.name=a,b&&(this.as=b.as,this.for=b.for,this.to=b.to,this.using=b.using,this.withCheck=b.withCheck)}static [b.entityKind]="PgPolicy";as;for;to;using;withCheck;_linkedTable;link(a){return this._linkedTable=a,this}}a.s(["PgPolicy",()=>e],94831);let f=Symbol.for("drizzle:PgViewConfig");a.s(["PgViewConfig",()=>f],14782)},81562,55339,a=>{"use strict";var b=a.i(77001),c=a.i(41657),d=a.i(94415),e=a.i(63227),f=a.i(11832),g=a.i(5302),h=a.i(97122),i=a.i(56564),j=a.i(83217),k=a.i(90714),l=a.i(952),m=a.i(99450),n=a.i(31793),o=a.i(57833),p=a.i(68540),q=a.i(93321),r=a.i(51674),s=a.i(4501),t=a.i(20713),u=a.i(44551),v=a.i(55280),w=r;class x extends w.View{static [e.entityKind]="PgViewBase"}a.s(["PgViewBase",()=>x],55339);class y{static [e.entityKind]="PgDialect";casing;constructor(a){this.casing=new c.CasingCache(a?.casing)}async migrate(a,b,c){let d="string"==typeof c?"__drizzle_migrations":c.migrationsTable??"__drizzle_migrations",e="string"==typeof c?"drizzle":c.migrationsSchema??"drizzle",f=r.sql`
			CREATE TABLE IF NOT EXISTS ${r.sql.identifier(e)}.${r.sql.identifier(d)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await b.execute(r.sql`CREATE SCHEMA IF NOT EXISTS ${r.sql.identifier(e)}`),await b.execute(f);let g=(await b.all(r.sql`select id, hash, created_at from ${r.sql.identifier(e)}.${r.sql.identifier(d)} order by created_at desc limit 1`))[0];await b.transaction(async b=>{for await(let c of a)if(!g||Number(g.created_at)<c.folderMillis){for(let a of c.sql)await b.execute(r.sql.raw(a));await b.execute(r.sql`insert into ${r.sql.identifier(e)}.${r.sql.identifier(d)} ("hash", "created_at") values(${c.hash}, ${c.folderMillis})`)}})}escapeName(a){return`"${a}"`}escapeParam(a){return`$${a+1}`}escapeString(a){return`'${a.replace(/'/g,"''")}'`}buildWithCTE(a){if(!a?.length)return;let b=[r.sql`with `];for(let[c,d]of a.entries())b.push(r.sql`${r.sql.identifier(d._.alias)} as (${d._.sql})`),c<a.length-1&&b.push(r.sql`, `);return b.push(r.sql` `),r.sql.join(b)}buildDeleteQuery({table:a,where:b,returning:c,withList:d}){let e=this.buildWithCTE(d),f=c?r.sql` returning ${this.buildSelection(c,{isSingleTable:!0})}`:void 0,g=b?r.sql` where ${b}`:void 0;return r.sql`${e}delete from ${a}${g}${f}`}buildUpdateSet(a,b){let c=a[t.Table.Symbol.Columns],d=Object.keys(c).filter(a=>void 0!==b[a]||c[a]?.onUpdateFn!==void 0),e=d.length;return r.sql.join(d.flatMap((a,d)=>{let f=c[a],g=b[a]??r.sql.param(f.onUpdateFn(),f),h=r.sql`${r.sql.identifier(this.casing.getColumnCasing(f))} = ${g}`;return d<e-1?[h,r.sql.raw(", ")]:[h]}))}buildUpdateQuery({table:a,set:b,where:c,returning:d,withList:e,from:f,joins:g}){let h=this.buildWithCTE(e),i=a[o.PgTable.Symbol.Name],j=a[o.PgTable.Symbol.Schema],k=a[o.PgTable.Symbol.OriginalName],l=i===k?void 0:i,m=r.sql`${j?r.sql`${r.sql.identifier(j)}.`:void 0}${r.sql.identifier(k)}${l&&r.sql` ${r.sql.identifier(l)}`}`,n=this.buildUpdateSet(a,b),p=f&&r.sql.join([r.sql.raw(" from "),this.buildFromTable(f)]),q=this.buildJoins(g),s=d?r.sql` returning ${this.buildSelection(d,{isSingleTable:!f})}`:void 0,t=c?r.sql` where ${c}`:void 0;return r.sql`${h}update ${m} set ${n}${p}${q}${t}${s}`}buildSelection(a,{isSingleTable:b=!1}={}){let c=a.length,f=a.flatMap(({field:a},f)=>{let h=[];if((0,e.is)(a,r.SQL.Aliased)&&a.isSelectionField)h.push(r.sql.identifier(a.fieldAlias));else if((0,e.is)(a,r.SQL.Aliased)||(0,e.is)(a,r.SQL)){let c=(0,e.is)(a,r.SQL.Aliased)?a.sql:a;b?h.push(new r.SQL(c.queryChunks.map(a=>(0,e.is)(a,g.PgColumn)?r.sql.identifier(this.casing.getColumnCasing(a)):a))):h.push(c),(0,e.is)(a,r.SQL.Aliased)&&h.push(r.sql` as ${r.sql.identifier(a.fieldAlias)}`)}else(0,e.is)(a,d.Column)&&(b?h.push(r.sql.identifier(this.casing.getColumnCasing(a))):h.push(a));return f<c-1&&h.push(r.sql`, `),h});return r.sql.join(f)}buildJoins(a){if(!a||0===a.length)return;let b=[];for(let[c,d]of a.entries()){0===c&&b.push(r.sql` `);let f=d.table,g=d.lateral?r.sql` lateral`:void 0,h=d.on?r.sql` on ${d.on}`:void 0;if((0,e.is)(f,o.PgTable)){let a=f[o.PgTable.Symbol.Name],c=f[o.PgTable.Symbol.Schema],e=f[o.PgTable.Symbol.OriginalName],i=a===e?void 0:d.alias;b.push(r.sql`${r.sql.raw(d.joinType)} join${g} ${c?r.sql`${r.sql.identifier(c)}.`:void 0}${r.sql.identifier(e)}${i&&r.sql` ${r.sql.identifier(i)}`}${h}`)}else if((0,e.is)(f,r.View)){let a=f[v.ViewBaseConfig].name,c=f[v.ViewBaseConfig].schema,e=f[v.ViewBaseConfig].originalName,i=a===e?void 0:d.alias;b.push(r.sql`${r.sql.raw(d.joinType)} join${g} ${c?r.sql`${r.sql.identifier(c)}.`:void 0}${r.sql.identifier(e)}${i&&r.sql` ${r.sql.identifier(i)}`}${h}`)}else b.push(r.sql`${r.sql.raw(d.joinType)} join${g} ${f}${h}`);c<a.length-1&&b.push(r.sql` `)}return r.sql.join(b)}buildFromTable(a){if((0,e.is)(a,t.Table)&&a[t.Table.Symbol.IsAlias]){let b=r.sql`${r.sql.identifier(a[t.Table.Symbol.OriginalName])}`;return a[t.Table.Symbol.Schema]&&(b=r.sql`${r.sql.identifier(a[t.Table.Symbol.Schema])}.${b}`),r.sql`${b} ${r.sql.identifier(a[t.Table.Symbol.Name])}`}return a}buildSelectQuery({withList:a,fields:b,fieldsFlat:c,where:f,having:g,table:h,joins:i,orderBy:j,groupBy:k,limit:l,offset:m,lockingClause:n,distinct:o,setOperators:p}){let q,w,y,z=c??(0,u.orderSelectedFields)(b);for(let a of z){let b;if((0,e.is)(a.field,d.Column)&&(0,t.getTableName)(a.field.table)!==((0,e.is)(h,s.Subquery)?h._.alias:(0,e.is)(h,x)?h[v.ViewBaseConfig].name:(0,e.is)(h,r.SQL)?void 0:(0,t.getTableName)(h))&&(b=a.field.table,!i?.some(({alias:a})=>a===(b[t.Table.Symbol.IsAlias]?(0,t.getTableName)(b):b[t.Table.Symbol.BaseName])))){let b=(0,t.getTableName)(a.field.table);throw Error(`Your "${a.path.join("->")}" field references a column "${b}"."${a.field.name}", but the table "${b}" is not part of the query! Did you forget to join it?`)}}let A=!i||0===i.length,B=this.buildWithCTE(a);o&&(q=!0===o?r.sql` distinct`:r.sql` distinct on (${r.sql.join(o.on,r.sql`, `)})`);let C=this.buildSelection(z,{isSingleTable:A}),D=this.buildFromTable(h),E=this.buildJoins(i),F=f?r.sql` where ${f}`:void 0,G=g?r.sql` having ${g}`:void 0;j&&j.length>0&&(w=r.sql` order by ${r.sql.join(j,r.sql`, `)}`),k&&k.length>0&&(y=r.sql` group by ${r.sql.join(k,r.sql`, `)}`);let H="object"==typeof l||"number"==typeof l&&l>=0?r.sql` limit ${l}`:void 0,I=m?r.sql` offset ${m}`:void 0,J=r.sql.empty();if(n){let a=r.sql` for ${r.sql.raw(n.strength)}`;n.config.of&&a.append(r.sql` of ${r.sql.join(Array.isArray(n.config.of)?n.config.of:[n.config.of],r.sql`, `)}`),n.config.noWait?a.append(r.sql` nowait`):n.config.skipLocked&&a.append(r.sql` skip locked`),J.append(a)}let K=r.sql`${B}select${q} ${C} from ${D}${E}${F}${y}${G}${w}${H}${I}${J}`;return p.length>0?this.buildSetOperations(K,p):K}buildSetOperations(a,b){let[c,...d]=b;if(!c)throw Error("Cannot pass undefined values to any set operator");return 0===d.length?this.buildSetOperationQuery({leftSelect:a,setOperator:c}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:a,setOperator:c}),d)}buildSetOperationQuery({leftSelect:a,setOperator:{type:b,isAll:c,rightSelect:d,limit:f,orderBy:h,offset:i}}){let j,k=r.sql`(${a.getSQL()}) `,l=r.sql`(${d.getSQL()})`;if(h&&h.length>0){let a=[];for(let b of h)if((0,e.is)(b,g.PgColumn))a.push(r.sql.identifier(b.name));else if((0,e.is)(b,r.SQL)){for(let a=0;a<b.queryChunks.length;a++){let c=b.queryChunks[a];(0,e.is)(c,g.PgColumn)&&(b.queryChunks[a]=r.sql.identifier(c.name))}a.push(r.sql`${b}`)}else a.push(r.sql`${b}`);j=r.sql` order by ${r.sql.join(a,r.sql`, `)} `}let m="object"==typeof f||"number"==typeof f&&f>=0?r.sql` limit ${f}`:void 0,n=r.sql.raw(`${b} ${c?"all ":""}`),o=i?r.sql` offset ${i}`:void 0;return r.sql`${k}${n}${l}${j}${m}${o}`}buildInsertQuery({table:a,values:b,onConflict:c,returning:d,withList:f,select:g,overridingSystemValue_:h}){let i=[],j=Object.entries(a[t.Table.Symbol.Columns]).filter(([a,b])=>!b.shouldDisableInsert()),k=j.map(([,a])=>r.sql.identifier(this.casing.getColumnCasing(a)));if(g)(0,e.is)(b,r.SQL)?i.push(b):i.push(b.getSQL());else for(let[a,c]of(i.push(r.sql.raw("values ")),b.entries())){let d=[];for(let[a,b]of j){let f=c[a];if(void 0===f||(0,e.is)(f,r.Param)&&void 0===f.value)if(void 0!==b.defaultFn){let a=b.defaultFn(),c=(0,e.is)(a,r.SQL)?a:r.sql.param(a,b);d.push(c)}else if(b.default||void 0===b.onUpdateFn)d.push(r.sql`default`);else{let a=b.onUpdateFn(),c=(0,e.is)(a,r.SQL)?a:r.sql.param(a,b);d.push(c)}else d.push(f)}i.push(d),a<b.length-1&&i.push(r.sql`, `)}let l=this.buildWithCTE(f),m=r.sql.join(i),n=d?r.sql` returning ${this.buildSelection(d,{isSingleTable:!0})}`:void 0,o=c?r.sql` on conflict ${c}`:void 0,p=!0===h?r.sql`overriding system value `:void 0;return r.sql`${l}insert into ${a} ${k} ${p}${m}${o}${n}`}buildRefreshMaterializedViewQuery({view:a,concurrently:b,withNoData:c}){let d=b?r.sql` concurrently`:void 0,e=c?r.sql` with no data`:void 0;return r.sql`refresh materialized view${d} ${a}${e}`}prepareTyping(a){if((0,e.is)(a,j.PgJsonb)||(0,e.is)(a,i.PgJson))return"json";if((0,e.is)(a,k.PgNumeric))return"decimal";if((0,e.is)(a,l.PgTime))return"time";if((0,e.is)(a,m.PgTimestamp)||(0,e.is)(a,m.PgTimestampString))return"timestamp";if((0,e.is)(a,h.PgDate)||(0,e.is)(a,h.PgDateString))return"date";else if((0,e.is)(a,n.PgUUID))return"uuid";else return"none"}sqlToQuery(a,b){return a.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:b})}buildRelationalQueryWithoutPK({fullSchema:a,schema:c,tableNamesMap:g,table:h,tableConfig:i,queryConfig:j,tableAlias:k,nestedQueryRelation:l,joinOn:m}){let n,u=[],v,w,x=[],y,z=[];if(!0===j)u=Object.entries(i.columns).map(([a,c])=>({dbKey:c.name,tsKey:a,field:(0,b.aliasedTableColumn)(c,k),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let f=Object.fromEntries(Object.entries(i.columns).map(([a,c])=>[a,(0,b.aliasedTableColumn)(c,k)]));if(j.where){let a="function"==typeof j.where?j.where(f,(0,p.getOperators)()):j.where;y=a&&(0,b.mapColumnsInSQLToAlias)(a,k)}let h=[],l=[];if(j.columns){let a=!1;for(let[b,c]of Object.entries(j.columns))void 0!==c&&b in i.columns&&(a||!0!==c||(a=!0),l.push(b));l.length>0&&(l=a?l.filter(a=>j.columns?.[a]===!0):Object.keys(i.columns).filter(a=>!l.includes(a)))}else l=Object.keys(i.columns);for(let a of l){let b=i.columns[a];h.push({tsKey:a,value:b})}let m=[];if(j.with&&(m=Object.entries(j.with).filter(a=>!!a[1]).map(([a,b])=>({tsKey:a,queryConfig:b,relation:i.relations[a]}))),j.extras)for(let[a,c]of Object.entries("function"==typeof j.extras?j.extras(f,{sql:r.sql}):j.extras))h.push({tsKey:a,value:(0,b.mapColumnsInAliasedSQLToAlias)(c,k)});for(let{tsKey:a,value:c}of h)u.push({dbKey:(0,e.is)(c,r.SQL.Aliased)?c.fieldAlias:i.columns[a].name,tsKey:a,field:(0,e.is)(c,d.Column)?(0,b.aliasedTableColumn)(c,k):c,relationTableTsKey:void 0,isJson:!1,selection:[]});let n="function"==typeof j.orderBy?j.orderBy(f,(0,p.getOrderByOperators)()):j.orderBy??[];for(let{tsKey:f,queryConfig:h,relation:i}of(Array.isArray(n)||(n=[n]),x=n.map(a=>(0,e.is)(a,d.Column)?(0,b.aliasedTableColumn)(a,k):(0,b.mapColumnsInSQLToAlias)(a,k)),v=j.limit,w=j.offset,m)){let d=(0,p.normalizeRelation)(c,g,i),j=g[(0,t.getTableUniqueName)(i.referencedTable)],l=`${k}_${f}`,m=(0,q.and)(...d.fields.map((a,c)=>(0,q.eq)((0,b.aliasedTableColumn)(d.references[c],l),(0,b.aliasedTableColumn)(a,k)))),n=this.buildRelationalQueryWithoutPK({fullSchema:a,schema:c,tableNamesMap:g,table:a[j],tableConfig:c[j],queryConfig:(0,e.is)(i,p.One)?!0===h?{limit:1}:{...h,limit:1}:h,tableAlias:l,joinOn:m,nestedQueryRelation:i}),o=r.sql`${r.sql.identifier(l)}.${r.sql.identifier("data")}`.as(f);z.push({on:r.sql`true`,table:new s.Subquery(n.sql,{},l),alias:l,joinType:"left",lateral:!0}),u.push({dbKey:f,tsKey:f,field:o,relationTableTsKey:j,isJson:!0,selection:n.selection})}}if(0===u.length)throw new f.DrizzleError({message:`No fields selected for table "${i.tsName}" ("${k}")`});if(y=(0,q.and)(m,y),l){let a=r.sql`json_build_array(${r.sql.join(u.map(({field:a,tsKey:b,isJson:c})=>c?r.sql`${r.sql.identifier(`${k}_${b}`)}.${r.sql.identifier("data")}`:(0,e.is)(a,r.SQL.Aliased)?a.sql:a),r.sql`, `)})`;(0,e.is)(l,p.Many)&&(a=r.sql`coalesce(json_agg(${a}${x.length>0?r.sql` order by ${r.sql.join(x,r.sql`, `)}`:void 0}), '[]'::json)`);let c=[{dbKey:"data",tsKey:"data",field:a.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:u}];void 0!==v||void 0!==w||x.length>0?(n=this.buildSelectQuery({table:(0,b.aliasedTable)(h,k),fields:{},fieldsFlat:[{path:[],field:r.sql.raw("*")}],where:y,limit:v,offset:w,orderBy:x,setOperators:[]}),y=void 0,v=void 0,w=void 0,x=[]):n=(0,b.aliasedTable)(h,k),n=this.buildSelectQuery({table:(0,e.is)(n,o.PgTable)?n:new s.Subquery(n,{},k),fields:{},fieldsFlat:c.map(({field:a})=>({path:[],field:(0,e.is)(a,d.Column)?(0,b.aliasedTableColumn)(a,k):a})),joins:z,where:y,limit:v,offset:w,orderBy:x,setOperators:[]})}else n=this.buildSelectQuery({table:(0,b.aliasedTable)(h,k),fields:{},fieldsFlat:u.map(({field:a})=>({path:[],field:(0,e.is)(a,d.Column)?(0,b.aliasedTableColumn)(a,k):a})),joins:z,where:y,limit:v,offset:w,orderBy:x,setOperators:[]});return{tableTsKey:i.tsName,sql:n,selection:u}}}a.s(["PgDialect",()=>y],81562)},63343,a=>{"use strict";var b=a.i(63227),c=a.i(7484),d=a.i(30928),e=a.i(20713),f=a.i(84113),g=a.i(44551),h=a.i(57833),i=a.i(51674),j=a.i(4501),k=a.i(55280);a.i(908),a.i(7231),a.i(89221),a.i(94831),a.i(74619),a.i(51146);var l=a.i(14782),m=a.i(81562),n=a.i(55339),o=a.i(82534);class p{static [b.entityKind]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(a){this.fields=a.fields,this.session=a.session,this.dialect=a.dialect,a.withList&&(this.withList=a.withList),this.distinct=a.distinct}authToken;setToken(a){return this.authToken=a,this}from(a){let c,d=!!this.fields;return c=this.fields?this.fields:(0,b.is)(a,j.Subquery)?Object.fromEntries(Object.keys(a._.selectedFields).map(b=>[b,a[b]])):(0,b.is)(a,n.PgViewBase)?a[k.ViewBaseConfig].selectedFields:(0,b.is)(a,i.SQL)?{}:(0,g.getTableColumns)(a),new r({table:a,fields:c,isPartialSelect:d,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class q extends o.TypedQueryBuilder{static [b.entityKind]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:a,fields:b,isPartialSelect:c,session:d,dialect:e,withList:f,distinct:h}){for(const i of(super(),this.config={withList:f,table:a,fields:{...b},distinct:h,setOperators:[]},this.isPartialSelect=c,this.session=d,this.dialect=e,this._={selectedFields:b,config:this.config},this.tableName=(0,g.getTableLikeName)(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{},L(a)))this.usedTables.add(i)}getUsedTables(){return[...this.usedTables]}createJoin(a,c){return(f,h)=>{let l=this.tableName,m=(0,g.getTableLikeName)(f);for(let a of L(f))this.usedTables.add(a);if("string"==typeof m&&this.config.joins?.some(a=>a.alias===m))throw Error(`Alias "${m}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof l&&(this.config.fields={[l]:this.config.fields}),"string"==typeof m&&!(0,b.is)(f,i.SQL))){let a=(0,b.is)(f,j.Subquery)?f._.selectedFields:(0,b.is)(f,i.View)?f[k.ViewBaseConfig].selectedFields:f[e.Table.Symbol.Columns];this.config.fields[m]=a}if("function"==typeof h&&(h=h(new Proxy(this.config.fields,new d.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:h,table:f,joinType:a,alias:m,lateral:c}),"string"==typeof m)switch(a){case"left":this.joinsNotNullableMap[m]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[m]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[m]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[m]=!1}return this}}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);fullJoin=this.createJoin("full",!1);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(a,b){return c=>{let d="function"==typeof c?c(t()):c;if(!(0,g.haveSameKeys)(this.getSelectedFields(),d.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:a,isAll:b,rightSelect:d}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(a){return this.config.setOperators.push(...a),this}where(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new d.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=a,this}having(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new d.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=a,this}groupBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new d.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(b)?b:[b]}else this.config.groupBy=a;return this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new d.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),c=Array.isArray(b)?b:[b];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=c:this.config.orderBy=c}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a;return this}limit(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=a:this.config.limit=a,this}offset(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=a:this.config.offset=a,this}for(a,b={}){return this.config.lockingClause={strength:a,config:b},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}as(a){let b=[];if(b.push(...L(this.config.table)),this.config.joins)for(let a of this.config.joins)b.push(...L(a.table));return new Proxy(new j.Subquery(this.getSQL(),this.config.fields,a,!1,[...new Set(b)]),new d.SelectionProxyHandler({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new d.SelectionProxyHandler({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(a){return this.cacheConfig=void 0===a?{config:{},enable:!0,autoInvalidate:!0}:!1===a?{enable:!1}:{enable:!0,autoInvalidate:!0,...a},this}}class r extends q{static [b.entityKind]="PgSelect";_prepare(a){let{session:b,config:c,dialect:d,joinsNotNullableMap:e,authToken:h,cacheConfig:i,usedTables:j}=this;if(!b)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");let{fields:k}=c;return f.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let c=(0,g.orderSelectedFields)(k),f=b.prepareQuery(d.sqlToQuery(this.getSQL()),c,a,!0,void 0,{type:"select",tables:[...j]},i);return f.joinsNotNullableMap=e,f.setToken(h)})}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>f.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken))}function s(a,b){return(c,d,...e)=>{let f=[d,...e].map(c=>({type:a,isAll:b,rightSelect:c}));for(let a of f)if(!(0,g.haveSameKeys)(c.getSelectedFields(),a.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return c.addSetOperators(f)}}(0,g.applyMixins)(r,[c.QueryPromise]);let t=()=>({union:u,unionAll:v,intersect:w,intersectAll:x,except:y,exceptAll:z}),u=s("union",!1),v=s("union",!0),w=s("intersect",!1),x=s("intersect",!0),y=s("except",!1),z=s("except",!0);class A{static [b.entityKind]="PgQueryBuilder";dialect;dialectConfig;constructor(a){this.dialect=(0,b.is)(a,m.PgDialect)?a:void 0,this.dialectConfig=(0,b.is)(a,m.PgDialect)?void 0:a}$with=(a,b)=>{let c=this;return{as:e=>("function"==typeof e&&(e=e(c)),new Proxy(new j.WithSubquery(e.getSQL(),b??("getSelectedFields"in e?e.getSelectedFields()??{}:{}),a,!0),new d.SelectionProxyHandler({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...a){let b=this;return{select:function(c){return new p({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a})},selectDistinct:function(a){return new p({fields:a??void 0,session:void 0,dialect:b.getDialect(),distinct:!0})},selectDistinctOn:function(a,c){return new p({fields:c??void 0,session:void 0,dialect:b.getDialect(),distinct:{on:a}})}}}select(a){return new p({fields:a??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(a){return new p({fields:a??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(a,b){return new p({fields:b??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:a}})}getDialect(){return this.dialect||(this.dialect=new m.PgDialect(this.dialectConfig)),this.dialect}}var B=n;class C{constructor(a,b){this.name=a,this.schema=b}static [b.entityKind]="PgDefaultViewBuilderCore";config={};with(a){return this.config.with=a,this}}class D extends C{static [b.entityKind]="PgViewBuilder";as(a){"function"==typeof a&&(a=a(new A));let b=new d.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),c=new Proxy(a.getSelectedFields(),b);return new Proxy(new I({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:c,query:a.getSQL().inlineParams()}}),b)}}class E extends C{static [b.entityKind]="PgManualViewBuilder";columns;constructor(a,b,c){super(a,c),this.columns=(0,g.getTableColumns)((0,h.pgTable)(a,b))}existing(){return new Proxy(new I({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new d.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(a){return new Proxy(new I({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:a.inlineParams()}}),new d.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}}class F{constructor(a,b){this.name=a,this.schema=b}static [b.entityKind]="PgMaterializedViewBuilderCore";config={};using(a){return this.config.using=a,this}with(a){return this.config.with=a,this}tablespace(a){return this.config.tablespace=a,this}withNoData(){return this.config.withNoData=!0,this}}class G extends F{static [b.entityKind]="PgMaterializedViewBuilder";as(a){"function"==typeof a&&(a=a(new A));let b=new d.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),c=new Proxy(a.getSelectedFields(),b);return new Proxy(new K({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:c,query:a.getSQL().inlineParams()}}),b)}}class H extends F{static [b.entityKind]="PgManualMaterializedViewBuilder";columns;constructor(a,b,c){super(a,c),this.columns=(0,g.getTableColumns)((0,h.pgTable)(a,b))}existing(){return new Proxy(new K({pgConfig:{tablespace:this.config.tablespace,using:this.config.using,with:this.config.with,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new d.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(a){return new Proxy(new K({pgConfig:{tablespace:this.config.tablespace,using:this.config.using,with:this.config.with,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:a.inlineParams()}}),new d.SelectionProxyHandler({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}}class I extends B.PgViewBase{static [b.entityKind]="PgView";[l.PgViewConfig];constructor({pgConfig:a,config:b}){super(b),a&&(this[l.PgViewConfig]={with:a.with})}}let J=Symbol.for("drizzle:PgMaterializedViewConfig");class K extends B.PgViewBase{static [b.entityKind]="PgMaterializedView";[J];constructor({pgConfig:a,config:b}){super(b),this[J]={with:a?.with,using:a?.using,tablespace:a?.tablespace,withNoData:a?.withNoData}}}function L(a){return(0,b.is)(a,h.PgTable)?[a[e.Schema]?`${a[e.Schema]}.${a[e.Table.Symbol.BaseName]}`:a[e.Table.Symbol.BaseName]]:(0,b.is)(a,j.Subquery)?a._.usedTables??[]:(0,b.is)(a,i.SQL)?a.usedTables??[]:[]}class M extends c.QueryPromise{constructor(a,b,c,d){super(),this.session=b,this.dialect=c,this.config={table:a,withList:d}}static [b.entityKind]="PgDelete";config;cacheConfig;where(a){return this.config.where=a,this}returning(a=this.config.table[e.Table.Symbol.Columns]){return this.config.returningFields=a,this.config.returning=(0,g.orderSelectedFields)(a),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return f.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0,void 0,{type:"delete",tables:L(this.config.table)},this.cacheConfig))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>f.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new d.SelectionProxyHandler({alias:(0,e.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var N=c;class O{constructor(a,b,c,d,e){this.table=a,this.session=b,this.dialect=c,this.withList=d,this.overridingSystemValue_=e}static [b.entityKind]="PgInsertBuilder";authToken;setToken(a){return this.authToken=a,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(a){if(0===(a=Array.isArray(a)?a:[a]).length)throw Error("values() must be called with at least one value");let c=a.map(a=>{let c={},d=this.table[e.Table.Symbol.Columns];for(let e of Object.keys(a)){let f=a[e];c[e]=(0,b.is)(f,i.SQL)?f:new i.Param(f,d[e])}return c});return new P(this.table,c,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(a){let c="function"==typeof a?a(new A):a;if(!(0,b.is)(c,i.SQL)&&!(0,g.haveSameKeys)(this.table[e.Columns],c._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new P(this.table,c,this.session,this.dialect,this.withList,!0)}}class P extends N.QueryPromise{constructor(a,b,c,d,e,f,g){super(),this.session=c,this.dialect=d,this.config={table:a,values:b,withList:e,select:f,overridingSystemValue_:g}}static [b.entityKind]="PgInsert";config;cacheConfig;returning(a=this.config.table[e.Table.Symbol.Columns]){return this.config.returningFields=a,this.config.returning=(0,g.orderSelectedFields)(a),this}onConflictDoNothing(a={}){if(void 0===a.target)this.config.onConflict=i.sql`do nothing`;else{let b="";b=Array.isArray(a.target)?a.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(a.target));let c=a.where?i.sql` where ${a.where}`:void 0;this.config.onConflict=i.sql`(${i.sql.raw(b)})${c} do nothing`}return this}onConflictDoUpdate(a){if(a.where&&(a.targetWhere||a.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let b=a.where?i.sql` where ${a.where}`:void 0,c=a.targetWhere?i.sql` where ${a.targetWhere}`:void 0,d=a.setWhere?i.sql` where ${a.setWhere}`:void 0,e=this.dialect.buildUpdateSet(this.config.table,(0,g.mapUpdateSet)(this.config.table,a.set)),f="";return f=Array.isArray(a.target)?a.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(a.target)),this.config.onConflict=i.sql`(${i.sql.raw(f)})${c} do update set ${e}${b}${d}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return f.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0,void 0,{type:"insert",tables:L(this.config.table)},this.cacheConfig))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>f.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new d.SelectionProxyHandler({alias:(0,e.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var Q=c;class R{constructor(a,b,c,d){this.table=a,this.session=b,this.dialect=c,this.withList=d}static [b.entityKind]="PgUpdateBuilder";authToken;setToken(a){return this.authToken=a,this}set(a){return new S(this.table,(0,g.mapUpdateSet)(this.table,a),this.session,this.dialect,this.withList).setToken(this.authToken)}}class S extends Q.QueryPromise{constructor(a,b,c,d,e){super(),this.session=c,this.dialect=d,this.config={set:b,table:a,withList:e,joins:[]},this.tableName=(0,g.getTableLikeName)(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}static [b.entityKind]="PgUpdate";config;tableName;joinsNotNullableMap;cacheConfig;from(a){let b=(0,g.getTableLikeName)(a);return"string"==typeof b&&(this.joinsNotNullableMap[b]=!0),this.config.from=a,this}getTableLikeFields(a){return(0,b.is)(a,h.PgTable)?a[e.Table.Symbol.Columns]:(0,b.is)(a,j.Subquery)?a._.selectedFields:a[k.ViewBaseConfig].selectedFields}createJoin(a){return(c,f)=>{let h=(0,g.getTableLikeName)(c);if("string"==typeof h&&this.config.joins.some(a=>a.alias===h))throw Error(`Alias "${h}" is already used in this query`);if("function"==typeof f){let a=this.config.from&&!(0,b.is)(this.config.from,i.SQL)?this.getTableLikeFields(this.config.from):void 0;f=f(new Proxy(this.config.table[e.Table.Symbol.Columns],new d.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new d.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:f,table:c,joinType:a,alias:h}),"string"==typeof h)switch(a){case"left":this.joinsNotNullableMap[h]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[h]=!0;break;case"inner":this.joinsNotNullableMap[h]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[h]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(a){return this.config.where=a,this}returning(a){if(!a&&(a=Object.assign({},this.config.table[e.Table.Symbol.Columns]),this.config.from)){let c=(0,g.getTableLikeName)(this.config.from);if("string"==typeof c&&this.config.from&&!(0,b.is)(this.config.from,i.SQL)){let b=this.getTableLikeFields(this.config.from);a[c]=b}for(let c of this.config.joins){let d=(0,g.getTableLikeName)(c.table);if("string"==typeof d&&!(0,b.is)(c.table,i.SQL)){let b=this.getTableLikeFields(c.table);a[d]=b}}}return this.config.returningFields=a,this.config.returning=(0,g.orderSelectedFields)(a),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){let b=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0,void 0,{type:"insert",tables:L(this.config.table)},this.cacheConfig);return b.joinsNotNullableMap=this.joinsNotNullableMap,b}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>this._prepare().execute(a,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new d.SelectionProxyHandler({alias:(0,e.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var T=i;class U extends T.SQL{constructor(a){super(U.buildEmbeddedCount(a.source,a.filters).queryChunks),this.params=a,this.mapWith(Number),this.session=a.session,this.sql=U.buildCount(a.source,a.filters)}sql;token;static [b.entityKind]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(a,b){return T.sql`(select count(*) from ${a}${T.sql.raw(" where ").if(b)}${b})`}static buildCount(a,b){return T.sql`select count(*) as count from ${a}${T.sql.raw(" where ").if(b)}${b};`}setToken(a){return this.token=a,this}then(a,b){return Promise.resolve(this.session.count(this.sql,this.token)).then(a,b)}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}}var V=c,W=a.i(68540);class X{constructor(a,b,c,d,e,f,g){this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g}static [b.entityKind]="PgRelationalQueryBuilder";findMany(a){return new Y(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a||{},"many")}findFirst(a){return new Y(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a?{...a,limit:1}:{limit:1},"first")}}class Y extends V.QueryPromise{constructor(a,b,c,d,e,f,g,h,i){super(),this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g,this.config=h,this.mode=i}static [b.entityKind]="PgRelationalQuery";_prepare(a){return f.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let{query:b,builtQuery:c}=this._toSQL();return this.session.prepareQuery(c,void 0,a,!0,(a,c)=>{let d=a.map(a=>(0,W.mapRelationalRow)(this.schema,this.tableConfig,a,b.selection,c));return"first"===this.mode?d[0]:d})})}prepare(a){return this._prepare(a)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let a=this._getQuery(),b=this.dialect.sqlToQuery(a.sql);return{query:a,builtQuery:b}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(a){return this.authToken=a,this}execute(){return f.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}}var Z=c;class $ extends Z.QueryPromise{constructor(a,b,c,d){super(),this.execute=a,this.sql=b,this.query=c,this.mapBatchResult=d}static [b.entityKind]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(a,b){return b?this.mapBatchResult(a):a}_prepare(){return this}isResponseInArrayMode(){return!1}}var _=c;class aa extends _.QueryPromise{constructor(a,b,c){super(),this.session=b,this.dialect=c,this.config={view:a}}static [b.entityKind]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return f.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,a,!0))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>f.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(a,this.authToken))}class ab{constructor(a,b,c){if(this.dialect=a,this.session=b,this._=c?{schema:c.schema,fullSchema:c.fullSchema,tableNamesMap:c.tableNamesMap,session:b}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:b},this.query={},this._.schema)for(const[d,e]of Object.entries(this._.schema))this.query[d]=new X(c.fullSchema,this._.schema,this._.tableNamesMap,c.fullSchema[d],e,a,b);this.$cache={invalidate:async a=>{}}}static [b.entityKind]="PgDatabase";query;$with=(a,b)=>{let c=this;return{as:e=>("function"==typeof e&&(e=e(new A(c.dialect))),new Proxy(new j.WithSubquery(e.getSQL(),b??("getSelectedFields"in e?e.getSelectedFields()??{}:{}),a,!0),new d.SelectionProxyHandler({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(a,b){return new U({source:a,filters:b,session:this.session})}$cache;with(...a){let b=this;return{select:function(c){return new p({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a})},selectDistinct:function(c){return new p({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:!0})},selectDistinctOn:function(c,d){return new p({fields:d??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:{on:c}})},update:function(c){return new R(c,b.session,b.dialect,a)},insert:function(c){return new O(c,b.session,b.dialect,a)},delete:function(c){return new M(c,b.session,b.dialect,a)}}}select(a){return new p({fields:a??void 0,session:this.session,dialect:this.dialect})}selectDistinct(a){return new p({fields:a??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(a,b){return new p({fields:b??void 0,session:this.session,dialect:this.dialect,distinct:{on:a}})}update(a){return new R(a,this.session,this.dialect)}insert(a){return new O(a,this.session,this.dialect)}delete(a){return new M(a,this.session,this.dialect)}refreshMaterializedView(a){return new aa(a,this.session,this.dialect)}authToken;execute(a){let b="string"==typeof a?i.sql.raw(a):a.getSQL(),c=this.dialect.sqlToQuery(b),d=this.session.prepareQuery(c,void 0,void 0,!1);return new $(()=>d.execute(void 0,this.authToken),b,c,a=>d.mapResult(a,!0))}transaction(a,b){return this.session.transaction(a,b)}}a.s(["PgDatabase",()=>ab],63343)},33957,a=>{"use strict";var b=a.i(63227),c=a.i(30928),d=a.i(51674),e=a.i(4501),f=d;class g extends f.SQL{constructor(a){super(g.buildEmbeddedCount(a.source,a.filters).queryChunks),this.params=a,this.mapWith(Number),this.session=a.session,this.sql=g.buildCount(a.source,a.filters)}sql;static [b.entityKind]="MySqlCountBuilder";[Symbol.toStringTag]="MySqlCountBuilder";session;static buildEmbeddedCount(a,b){return f.sql`(select count(*) from ${a}${f.sql.raw(" where ").if(b)}${b})`}static buildCount(a,b){return f.sql`select count(*) as count from ${a}${f.sql.raw(" where ").if(b)}${b}`}then(a,b){return Promise.resolve(this.session.count(this.sql)).then(a,b)}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}}var h=a.i(7484),i=a.i(20713),j=a.i(55280);class k{constructor(a,b){this.name=a,this.value=b}static [b.entityKind]="MySqlCheckBuilder";brand;build(a){return new l(a,this)}}class l{constructor(a,b){this.table=a,this.name=b.name,this.value=b.value}static [b.entityKind]="MySqlCheck";name;value}var m=a.i(37003);class n{static [b.entityKind]="MySqlForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(a,b){this.reference=()=>{let{name:b,columns:c,foreignColumns:d}=a();return{name:b,columns:c,foreignTable:d[0].table,foreignColumns:d}},b&&(this._onUpdate=b.onUpdate,this._onDelete=b.onDelete)}onUpdate(a){return this._onUpdate=a,this}onDelete(a){return this._onDelete=a,this}build(a){return new o(a,this)}}class o{constructor(a,b){this.table=a,this.reference=b.reference,this.onUpdate=b._onUpdate,this.onDelete=b._onDelete}static [b.entityKind]="MySqlForeignKey";reference;onUpdate;onDelete;getName(){let{name:a,columns:b,foreignColumns:c}=this.reference(),d=b.map(a=>a.name),e=c.map(a=>a.name),f=[this.table[m.TableName],...d,c[0].table[m.TableName],...e];return a??`${f.join("_")}_fk`}}class p{constructor(a,b){this.name=a,this.unique=b}static [b.entityKind]="MySqlIndexBuilderOn";on(...a){return new q(this.name,a,this.unique)}}class q{static [b.entityKind]="MySqlIndexBuilder";config;constructor(a,b,c){this.config={name:a,columns:b,unique:c}}using(a){return this.config.using=a,this}algorythm(a){return this.config.algorythm=a,this}lock(a){return this.config.lock=a,this}build(a){return new r(this.config,a)}}class r{static [b.entityKind]="MySqlIndex";config;constructor(a,b){this.config={...a,table:b}}}var s=i,t=a.i(44551),u=a.i(77396),v=a.i(94415);function w(a,b){return`${a[m.TableName]}_${b.join("_")}_unique`}class x{constructor(a,b){this.name=b,this.columns=a}static [b.entityKind]="MySqlUniqueConstraintBuilder";columns;build(a){return new z(a,this.columns,this.name)}}class y{static [b.entityKind]="MySqlUniqueOnConstraintBuilder";name;constructor(a){this.name=a}on(...a){return new x(a,this.name)}}class z{constructor(a,b,c){this.table=a,this.columns=b,this.name=c??w(this.table,this.columns.map(a=>a.name))}static [b.entityKind]="MySqlUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}class A extends u.ColumnBuilder{static [b.entityKind]="MySqlColumnBuilder";foreignKeyConfigs=[];references(a,b={}){return this.foreignKeyConfigs.push({ref:a,actions:b}),this}unique(a){return this.config.isUnique=!0,this.config.uniqueName=a,this}generatedAlwaysAs(a,b){return this.config.generated={as:a,type:"always",mode:b?.mode??"virtual"},this}buildForeignKeys(a,b){return this.foreignKeyConfigs.map(({ref:c,actions:d})=>{let e;return e=new n(()=>({columns:[a],foreignColumns:[c()]})),d.onUpdate&&e.onUpdate(d.onUpdate),d.onDelete&&e.onDelete(d.onDelete),e.build(b)})}}class B extends v.Column{constructor(a,b){b.uniqueName||(b.uniqueName=w(a,[b.name])),super(a,b),this.table=a}static [b.entityKind]="MySqlColumn"}class C extends A{static [b.entityKind]="MySqlColumnBuilderWithAutoIncrement";constructor(a,b,c){super(a,b,c),this.config.autoIncrement=!1}autoincrement(){return this.config.autoIncrement=!0,this.config.hasDefault=!0,this}}class D extends B{static [b.entityKind]="MySqlColumnWithAutoIncrement";autoIncrement=this.config.autoIncrement}class E extends C{static [b.entityKind]="MySqlBigInt53Builder";constructor(a,b=!1){super(a,"number","MySqlBigInt53"),this.config.unsigned=b}build(a){return new F(a,this.config)}}class F extends D{static [b.entityKind]="MySqlBigInt53";getSQLType(){return`bigint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class G extends C{static [b.entityKind]="MySqlBigInt64Builder";constructor(a,b=!1){super(a,"bigint","MySqlBigInt64"),this.config.unsigned=b}build(a){return new H(a,this.config)}}class H extends D{static [b.entityKind]="MySqlBigInt64";getSQLType(){return`bigint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return BigInt(a)}}function I(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return"number"===d.mode?new E(c,d.unsigned):new G(c,d.unsigned)}class J extends A{static [b.entityKind]="MySqlBinaryBuilder";constructor(a,b){super(a,"string","MySqlBinary"),this.config.length=b}build(a){return new K(a,this.config)}}class K extends B{static [b.entityKind]="MySqlBinary";length=this.config.length;mapFromDriverValue(a){if("string"==typeof a)return a;if(Buffer.isBuffer(a))return a.toString();let b=[];for(let c of a)b.push(49===c?"1":"0");return b.join("")}getSQLType(){return void 0===this.length?"binary":`binary(${this.length})`}}function L(a,b={}){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new J(c,d.length)}class M extends A{static [b.entityKind]="MySqlBooleanBuilder";constructor(a){super(a,"boolean","MySqlBoolean")}build(a){return new N(a,this.config)}}class N extends B{static [b.entityKind]="MySqlBoolean";getSQLType(){return"boolean"}mapFromDriverValue(a){return"boolean"==typeof a?a:1===a}}function O(a){return new M(a??"")}class P extends A{static [b.entityKind]="MySqlCharBuilder";constructor(a,b){super(a,"string","MySqlChar"),this.config.length=b.length,this.config.enum=b.enum}build(a){return new Q(a,this.config)}}class Q extends B{static [b.entityKind]="MySqlChar";length=this.config.length;enumValues=this.config.enum;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function R(a,b={}){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new P(c,d)}class S extends A{static [b.entityKind]="MySqlCustomColumnBuilder";constructor(a,b,c){super(a,"custom","MySqlCustomColumn"),this.config.fieldConfig=b,this.config.customTypeParams=c}build(a){return new T(a,this.config)}}class T extends B{static [b.entityKind]="MySqlCustomColumn";sqlName;mapTo;mapFrom;constructor(a,b){super(a,b),this.sqlName=b.customTypeParams.dataType(b.fieldConfig),this.mapTo=b.customTypeParams.toDriver,this.mapFrom=b.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(a){return"function"==typeof this.mapFrom?this.mapFrom(a):a}mapToDriverValue(a){return"function"==typeof this.mapTo?this.mapTo(a):a}}function U(a){return(b,c)=>{let{name:d,config:e}=(0,t.getColumnNameAndConfig)(b,c);return new S(d,e,a)}}class V extends A{static [b.entityKind]="MySqlDateBuilder";constructor(a){super(a,"date","MySqlDate")}build(a){return new W(a,this.config)}}class W extends B{static [b.entityKind]="MySqlDate";constructor(a,b){super(a,b)}getSQLType(){return"date"}mapFromDriverValue(a){return new Date(a)}}class X extends A{static [b.entityKind]="MySqlDateStringBuilder";constructor(a){super(a,"string","MySqlDateString")}build(a){return new Y(a,this.config)}}class Y extends B{static [b.entityKind]="MySqlDateString";constructor(a,b){super(a,b)}getSQLType(){return"date"}}function Z(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return d?.mode==="string"?new X(c):new V(c)}class $ extends A{static [b.entityKind]="MySqlDateTimeBuilder";constructor(a,b){super(a,"date","MySqlDateTime"),this.config.fsp=b?.fsp}build(a){return new _(a,this.config)}}class _ extends B{static [b.entityKind]="MySqlDateTime";fsp;constructor(a,b){super(a,b),this.fsp=b.fsp}getSQLType(){let a=void 0===this.fsp?"":`(${this.fsp})`;return`datetime${a}`}mapToDriverValue(a){return a.toISOString().replace("T"," ").replace("Z","")}mapFromDriverValue(a){return new Date(a.replace(" ","T")+"Z")}}class aa extends A{static [b.entityKind]="MySqlDateTimeStringBuilder";constructor(a,b){super(a,"string","MySqlDateTimeString"),this.config.fsp=b?.fsp}build(a){return new ab(a,this.config)}}class ab extends B{static [b.entityKind]="MySqlDateTimeString";fsp;constructor(a,b){super(a,b),this.fsp=b.fsp}getSQLType(){let a=void 0===this.fsp?"":`(${this.fsp})`;return`datetime${a}`}}function ac(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return d?.mode==="string"?new aa(c,d):new $(c,d)}class ad extends C{static [b.entityKind]="MySqlDecimalBuilder";constructor(a,b){super(a,"string","MySqlDecimal"),this.config.precision=b?.precision,this.config.scale=b?.scale,this.config.unsigned=b?.unsigned}build(a){return new ae(a,this.config)}}class ae extends D{static [b.entityKind]="MySqlDecimal";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue(a){return"string"==typeof a?a:String(a)}getSQLType(){let a="";return void 0!==this.precision&&void 0!==this.scale?a+=`decimal(${this.precision},${this.scale})`:void 0===this.precision?a+="decimal":a+=`decimal(${this.precision})`,a="decimal(10,0)"===a||"decimal(10)"===a?"decimal":a,this.unsigned?`${a} unsigned`:a}}class af extends C{static [b.entityKind]="MySqlDecimalNumberBuilder";constructor(a,b){super(a,"number","MySqlDecimalNumber"),this.config.precision=b?.precision,this.config.scale=b?.scale,this.config.unsigned=b?.unsigned}build(a){return new ag(a,this.config)}}class ag extends D{static [b.entityKind]="MySqlDecimalNumber";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}mapToDriverValue=String;getSQLType(){let a="";return void 0!==this.precision&&void 0!==this.scale?a+=`decimal(${this.precision},${this.scale})`:void 0===this.precision?a+="decimal":a+=`decimal(${this.precision})`,a="decimal(10,0)"===a||"decimal(10)"===a?"decimal":a,this.unsigned?`${a} unsigned`:a}}class ah extends C{static [b.entityKind]="MySqlDecimalBigIntBuilder";constructor(a,b){super(a,"bigint","MySqlDecimalBigInt"),this.config.precision=b?.precision,this.config.scale=b?.scale,this.config.unsigned=b?.unsigned}build(a){return new ai(a,this.config)}}class ai extends D{static [b.entityKind]="MySqlDecimalBigInt";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){let a="";return void 0!==this.precision&&void 0!==this.scale?a+=`decimal(${this.precision},${this.scale})`:void 0===this.precision?a+="decimal":a+=`decimal(${this.precision})`,a="decimal(10,0)"===a||"decimal(10)"===a?"decimal":a,this.unsigned?`${a} unsigned`:a}}function aj(a,b={}){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b),e=d?.mode;return"number"===e?new af(c,d):"bigint"===e?new ah(c,d):new ad(c,d)}class ak extends C{static [b.entityKind]="MySqlDoubleBuilder";constructor(a,b){super(a,"number","MySqlDouble"),this.config.precision=b?.precision,this.config.scale=b?.scale,this.config.unsigned=b?.unsigned}build(a){return new al(a,this.config)}}class al extends D{static [b.entityKind]="MySqlDouble";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;getSQLType(){let a="";return void 0!==this.precision&&void 0!==this.scale?a+=`double(${this.precision},${this.scale})`:void 0===this.precision?a+="double":a+=`double(${this.precision})`,this.unsigned?`${a} unsigned`:a}}function am(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new ak(c,d)}class an extends A{static [b.entityKind]="MySqlEnumColumnBuilder";constructor(a,b){super(a,"string","MySqlEnumColumn"),this.config.enumValues=b}build(a){return new ao(a,this.config)}}class ao extends B{static [b.entityKind]="MySqlEnumColumn";enumValues=this.config.enumValues;getSQLType(){return`enum(${this.enumValues.map(a=>`'${a}'`).join(",")})`}}class ap extends A{static [b.entityKind]="MySqlEnumObjectColumnBuilder";constructor(a,b){super(a,"string","MySqlEnumObjectColumn"),this.config.enumValues=b}build(a){return new aq(a,this.config)}}class aq extends B{static [b.entityKind]="MySqlEnumObjectColumn";enumValues=this.config.enumValues;getSQLType(){return`enum(${this.enumValues.map(a=>`'${a}'`).join(",")})`}}function ar(a,b){if("string"==typeof a&&Array.isArray(b)||Array.isArray(a)){let c="string"==typeof a&&a.length>0?a:"",d=("string"==typeof a?b:a)??[];if(0===d.length)throw Error(`You have an empty array for "${c}" enum values`);return new an(c,d)}if("string"==typeof a&&"object"==typeof b||"object"==typeof a){let c="object"==typeof a?"":a,d="object"==typeof a?Object.values(a):"object"==typeof b?Object.values(b):[];if(0===d.length)throw Error(`You have an empty array for "${c}" enum values`);return new ap(c,d)}}class as extends C{static [b.entityKind]="MySqlFloatBuilder";constructor(a,b){super(a,"number","MySqlFloat"),this.config.precision=b?.precision,this.config.scale=b?.scale,this.config.unsigned=b?.unsigned}build(a){return new at(a,this.config)}}class at extends D{static [b.entityKind]="MySqlFloat";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;getSQLType(){let a="";return void 0!==this.precision&&void 0!==this.scale?a+=`float(${this.precision},${this.scale})`:void 0===this.precision?a+="float":a+=`float(${this.precision})`,this.unsigned?`${a} unsigned`:a}}function au(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new as(c,d)}class av extends C{static [b.entityKind]="MySqlIntBuilder";constructor(a,b){super(a,"number","MySqlInt"),this.config.unsigned=!!b&&b.unsigned}build(a){return new aw(a,this.config)}}class aw extends D{static [b.entityKind]="MySqlInt";getSQLType(){return`int${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return"string"==typeof a?Number(a):a}}function ax(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new av(c,d)}class ay extends A{static [b.entityKind]="MySqlJsonBuilder";constructor(a){super(a,"json","MySqlJson")}build(a){return new az(a,this.config)}}class az extends B{static [b.entityKind]="MySqlJson";getSQLType(){return"json"}mapToDriverValue(a){return JSON.stringify(a)}}function aA(a){return new ay(a??"")}class aB extends C{static [b.entityKind]="MySqlMediumIntBuilder";constructor(a,b){super(a,"number","MySqlMediumInt"),this.config.unsigned=!!b&&b.unsigned}build(a){return new aC(a,this.config)}}class aC extends D{static [b.entityKind]="MySqlMediumInt";getSQLType(){return`mediumint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return"string"==typeof a?Number(a):a}}function aD(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new aB(c,d)}class aE extends C{static [b.entityKind]="MySqlRealBuilder";constructor(a,b){super(a,"number","MySqlReal"),this.config.precision=b?.precision,this.config.scale=b?.scale}build(a){return new aF(a,this.config)}}class aF extends D{static [b.entityKind]="MySqlReal";precision=this.config.precision;scale=this.config.scale;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`real(${this.precision}, ${this.scale})`:void 0===this.precision?"real":`real(${this.precision})`}}function aG(a,b={}){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new aE(c,d)}class aH extends C{static [b.entityKind]="MySqlSerialBuilder";constructor(a){super(a,"number","MySqlSerial"),this.config.hasDefault=!0,this.config.autoIncrement=!0}build(a){return new aI(a,this.config)}}class aI extends D{static [b.entityKind]="MySqlSerial";getSQLType(){return"serial"}mapFromDriverValue(a){return"string"==typeof a?Number(a):a}}function aJ(a){return new aH(a??"")}class aK extends C{static [b.entityKind]="MySqlSmallIntBuilder";constructor(a,b){super(a,"number","MySqlSmallInt"),this.config.unsigned=!!b&&b.unsigned}build(a){return new aL(a,this.config)}}class aL extends D{static [b.entityKind]="MySqlSmallInt";getSQLType(){return`smallint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return"string"==typeof a?Number(a):a}}function aM(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new aK(c,d)}class aN extends A{static [b.entityKind]="MySqlTextBuilder";constructor(a,b,c){super(a,"string","MySqlText"),this.config.textType=b,this.config.enumValues=c.enum}build(a){return new aO(a,this.config)}}class aO extends B{static [b.entityKind]="MySqlText";textType=this.config.textType;enumValues=this.config.enumValues;getSQLType(){return this.textType}}function aP(a,b={}){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new aN(c,"text",d)}function aQ(a,b={}){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new aN(c,"tinytext",d)}function aR(a,b={}){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new aN(c,"mediumtext",d)}function aS(a,b={}){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new aN(c,"longtext",d)}class aT extends A{static [b.entityKind]="MySqlTimeBuilder";constructor(a,b){super(a,"string","MySqlTime"),this.config.fsp=b?.fsp}build(a){return new aU(a,this.config)}}class aU extends B{static [b.entityKind]="MySqlTime";fsp=this.config.fsp;getSQLType(){let a=void 0===this.fsp?"":`(${this.fsp})`;return`time${a}`}}function aV(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new aT(c,d)}class aW extends A{static [b.entityKind]="MySqlDateColumnBuilder";defaultNow(){return this.default(d.sql`(now())`)}onUpdateNow(){return this.config.hasOnUpdateNow=!0,this.config.hasDefault=!0,this}}class aX extends B{static [b.entityKind]="MySqlDateColumn";hasOnUpdateNow=this.config.hasOnUpdateNow}class aY extends aW{static [b.entityKind]="MySqlTimestampBuilder";constructor(a,b){super(a,"date","MySqlTimestamp"),this.config.fsp=b?.fsp}build(a){return new aZ(a,this.config)}}class aZ extends aX{static [b.entityKind]="MySqlTimestamp";fsp=this.config.fsp;getSQLType(){let a=void 0===this.fsp?"":`(${this.fsp})`;return`timestamp${a}`}mapFromDriverValue(a){return new Date(a+"+0000")}mapToDriverValue(a){return a.toISOString().slice(0,-1).replace("T"," ")}}class a$ extends aW{static [b.entityKind]="MySqlTimestampStringBuilder";constructor(a,b){super(a,"string","MySqlTimestampString"),this.config.fsp=b?.fsp}build(a){return new a_(a,this.config)}}class a_ extends aX{static [b.entityKind]="MySqlTimestampString";fsp=this.config.fsp;getSQLType(){let a=void 0===this.fsp?"":`(${this.fsp})`;return`timestamp${a}`}}function a0(a,b={}){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return d?.mode==="string"?new a$(c,d):new aY(c,d)}class a1 extends C{static [b.entityKind]="MySqlTinyIntBuilder";constructor(a,b){super(a,"number","MySqlTinyInt"),this.config.unsigned=!!b&&b.unsigned}build(a){return new a2(a,this.config)}}class a2 extends D{static [b.entityKind]="MySqlTinyInt";getSQLType(){return`tinyint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return"string"==typeof a?Number(a):a}}function a3(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new a1(c,d)}class a4 extends A{static [b.entityKind]="MySqlVarBinaryBuilder";constructor(a,b){super(a,"string","MySqlVarBinary"),this.config.length=b?.length}build(a){return new a5(a,this.config)}}class a5 extends B{static [b.entityKind]="MySqlVarBinary";length=this.config.length;mapFromDriverValue(a){if("string"==typeof a)return a;if(Buffer.isBuffer(a))return a.toString();let b=[];for(let c of a)b.push(49===c?"1":"0");return b.join("")}getSQLType(){return void 0===this.length?"varbinary":`varbinary(${this.length})`}}function a6(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new a4(c,d)}class a7 extends A{static [b.entityKind]="MySqlVarCharBuilder";constructor(a,b){super(a,"string","MySqlVarChar"),this.config.length=b.length,this.config.enum=b.enum}build(a){return new a8(a,this.config)}}class a8 extends B{static [b.entityKind]="MySqlVarChar";length=this.config.length;enumValues=this.config.enum;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function a9(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return new a7(c,d)}class ba extends A{static [b.entityKind]="MySqlYearBuilder";constructor(a){super(a,"number","MySqlYear")}build(a){return new bb(a,this.config)}}class bb extends B{static [b.entityKind]="MySqlYear";getSQLType(){return"year"}}function bc(a){return new ba(a??"")}let bd=Symbol.for("drizzle:MySqlInlineForeignKeys");class be extends s.Table{static [b.entityKind]="MySqlTable";static Symbol=Object.assign({},s.Table.Symbol,{InlineForeignKeys:bd});[s.Table.Symbol.Columns];[bd]=[];[s.Table.Symbol.ExtraConfigBuilder]=void 0}let bf=(a,b,c)=>(function(a,b,c,d,e=a){let f=new be(a,d,e),g=Object.fromEntries(Object.entries("function"==typeof b?b({bigint:I,binary:L,boolean:O,char:R,customType:U,date:Z,datetime:ac,decimal:aj,double:am,mysqlEnum:ar,float:au,int:ax,json:aA,mediumint:aD,real:aG,serial:aJ,smallint:aM,text:aP,time:aV,timestamp:a0,tinyint:a3,varbinary:a6,varchar:a9,year:bc,longtext:aS,mediumtext:aR,tinytext:aQ}):b).map(([a,b])=>{b.setName(a);let c=b.build(f);return f[bd].push(...b.buildForeignKeys(c,f)),[a,c]})),h=Object.assign(f,g);return h[s.Table.Symbol.Columns]=g,h[s.Table.Symbol.ExtraConfigColumns]=g,c&&(h[be.Symbol.ExtraConfigBuilder]=c),h})(a,b,c,void 0,a);function bg(...a){return a[0].columns?new bh(a[0].columns,a[0].name):new bh(a)}class bh{static [b.entityKind]="MySqlPrimaryKeyBuilder";columns;name;constructor(a,b){this.columns=a,this.name=b}build(a){return new bi(a,this.columns,this.name)}}class bi{constructor(a,b,c){this.table=a,this.columns=b,this.name=c}static [b.entityKind]="MySqlPrimaryKey";columns;name;getName(){return this.name??`${this.table[be.Symbol.Name]}_${this.columns.map(a=>a.name).join("_")}_pk`}}function bj(a){return(0,b.is)(a,be)?[`${a[i.Table.Symbol.BaseName]}`]:(0,b.is)(a,e.Subquery)?a._.usedTables??[]:(0,b.is)(a,d.SQL)?a.usedTables??[]:[]}function bk(a){return a.map(a=>"object"==typeof a?a.config.name:a)}function bl(a){return Array.isArray(a)?a:[a]}Symbol.for("drizzle:MySqlViewConfig");class bm extends h.QueryPromise{constructor(a,b,c,d){super(),this.table=a,this.session=b,this.dialect=c,this.config={table:a,withList:d}}static [b.entityKind]="MySqlDelete";config;where(a){return this.config.where=a,this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.table[i.Table.Symbol.Columns],new c.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),d=Array.isArray(b)?b:[b];this.config.orderBy=d}else this.config.orderBy=a;return this}limit(a){return this.config.limit=a,this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}prepare(){return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,void 0,void 0,void 0,{type:"delete",tables:bj(this.config.table)})}execute=a=>this.prepare().execute(a);createIterator=()=>{let a=this;return async function*(b){yield*a.prepare().iterator(b)}};iterator=this.createIterator();$dynamic(){return this}}var bn=h,bo=a.i(77001),bp=a.i(41657),bq=a.i(11832),br=a.i(68540),bs=a.i(93321),bt=d;class bu extends bt.View{static [b.entityKind]="MySqlViewBase"}class bv{static [b.entityKind]="MySqlDialect";casing;constructor(a){this.casing=new bp.CasingCache(a?.casing)}async migrate(a,b,c){let e=c.migrationsTable??"__drizzle_migrations",f=d.sql`
			create table if not exists ${d.sql.identifier(e)} (
				id serial primary key,
				hash text not null,
				created_at bigint
			)
		`;await b.execute(f);let g=(await b.all(d.sql`select id, hash, created_at from ${d.sql.identifier(e)} order by created_at desc limit 1`))[0];await b.transaction(async b=>{for(let c of a)if(!g||Number(g.created_at)<c.folderMillis){for(let a of c.sql)await b.execute(d.sql.raw(a));await b.execute(d.sql`insert into ${d.sql.identifier(e)} (\`hash\`, \`created_at\`) values(${c.hash}, ${c.folderMillis})`)}})}escapeName(a){return`\`${a}\``}escapeParam(a){return"?"}escapeString(a){return`'${a.replace(/'/g,"''")}'`}buildWithCTE(a){if(!a?.length)return;let b=[d.sql`with `];for(let[c,e]of a.entries())b.push(d.sql`${d.sql.identifier(e._.alias)} as (${e._.sql})`),c<a.length-1&&b.push(d.sql`, `);return b.push(d.sql` `),d.sql.join(b)}buildDeleteQuery({table:a,where:b,returning:c,withList:e,limit:f,orderBy:g}){let h=this.buildWithCTE(e),i=c?d.sql` returning ${this.buildSelection(c,{isSingleTable:!0})}`:void 0,j=b?d.sql` where ${b}`:void 0,k=this.buildOrderBy(g),l=this.buildLimit(f);return d.sql`${h}delete from ${a}${j}${k}${l}${i}`}buildUpdateSet(a,b){let c=a[i.Table.Symbol.Columns],e=Object.keys(c).filter(a=>void 0!==b[a]||c[a]?.onUpdateFn!==void 0),f=e.length;return d.sql.join(e.flatMap((a,e)=>{let g=c[a],h=b[a]??d.sql.param(g.onUpdateFn(),g),i=d.sql`${d.sql.identifier(this.casing.getColumnCasing(g))} = ${h}`;return e<f-1?[i,d.sql.raw(", ")]:[i]}))}buildUpdateQuery({table:a,set:b,where:c,returning:e,withList:f,limit:g,orderBy:h}){let i=this.buildWithCTE(f),j=this.buildUpdateSet(a,b),k=e?d.sql` returning ${this.buildSelection(e,{isSingleTable:!0})}`:void 0,l=c?d.sql` where ${c}`:void 0,m=this.buildOrderBy(h),n=this.buildLimit(g);return d.sql`${i}update ${a} set ${j}${l}${m}${n}${k}`}buildSelection(a,{isSingleTable:c=!1}={}){let e=a.length,f=a.flatMap(({field:a},f)=>{let g=[];if((0,b.is)(a,d.SQL.Aliased)&&a.isSelectionField)g.push(d.sql.identifier(a.fieldAlias));else if((0,b.is)(a,d.SQL.Aliased)||(0,b.is)(a,d.SQL)){let e=(0,b.is)(a,d.SQL.Aliased)?a.sql:a;c?g.push(new d.SQL(e.queryChunks.map(a=>(0,b.is)(a,B)?d.sql.identifier(this.casing.getColumnCasing(a)):a))):g.push(e),(0,b.is)(a,d.SQL.Aliased)&&g.push(d.sql` as ${d.sql.identifier(a.fieldAlias)}`)}else(0,b.is)(a,v.Column)&&(c?g.push(d.sql.identifier(this.casing.getColumnCasing(a))):g.push(a));return f<e-1&&g.push(d.sql`, `),g});return d.sql.join(f)}buildLimit(a){return"object"==typeof a||"number"==typeof a&&a>=0?d.sql` limit ${a}`:void 0}buildOrderBy(a){return a&&a.length>0?d.sql` order by ${d.sql.join(a,d.sql`, `)}`:void 0}buildIndex({indexes:a,indexFor:b}){return a&&a.length>0?d.sql` ${d.sql.raw(b)} INDEX (${d.sql.raw(a.join(", "))})`:void 0}buildSelectQuery({withList:a,fields:c,fieldsFlat:f,where:g,having:h,table:k,joins:l,orderBy:m,groupBy:n,limit:o,offset:p,lockingClause:q,distinct:r,setOperators:s,useIndex:u,forceIndex:w,ignoreIndex:x}){let y,z=f??(0,t.orderSelectedFields)(c);for(let a of z){let c;if((0,b.is)(a.field,v.Column)&&(0,i.getTableName)(a.field.table)!==((0,b.is)(k,e.Subquery)?k._.alias:(0,b.is)(k,bu)?k[j.ViewBaseConfig].name:(0,b.is)(k,d.SQL)?void 0:(0,i.getTableName)(k))&&(c=a.field.table,!l?.some(({alias:a})=>a===(c[i.Table.Symbol.IsAlias]?(0,i.getTableName)(c):c[i.Table.Symbol.BaseName])))){let b=(0,i.getTableName)(a.field.table);throw Error(`Your "${a.path.join("->")}" field references a column "${b}"."${a.field.name}", but the table "${b}" is not part of the query! Did you forget to join it?`)}}let A=!l||0===l.length,B=this.buildWithCTE(a),C=r?d.sql` distinct`:void 0,D=this.buildSelection(z,{isSingleTable:A}),E=(0,b.is)(k,i.Table)&&k[i.Table.Symbol.IsAlias]?d.sql`${d.sql`${d.sql.identifier(k[i.Table.Symbol.Schema]??"")}.`.if(k[i.Table.Symbol.Schema])}${d.sql.identifier(k[i.Table.Symbol.OriginalName])} ${d.sql.identifier(k[i.Table.Symbol.Name])}`:k,F=[];if(l)for(let[a,c]of l.entries()){0===a&&F.push(d.sql` `);let e=c.table,f=c.lateral?d.sql` lateral`:void 0,g=c.on?d.sql` on ${c.on}`:void 0;if((0,b.is)(e,be)){let a=e[be.Symbol.Name],b=e[be.Symbol.Schema],h=e[be.Symbol.OriginalName],i=a===h?void 0:c.alias,j=this.buildIndex({indexes:c.useIndex,indexFor:"USE"}),k=this.buildIndex({indexes:c.forceIndex,indexFor:"FORCE"}),l=this.buildIndex({indexes:c.ignoreIndex,indexFor:"IGNORE"});F.push(d.sql`${d.sql.raw(c.joinType)} join${f} ${b?d.sql`${d.sql.identifier(b)}.`:void 0}${d.sql.identifier(h)}${j}${k}${l}${i&&d.sql` ${d.sql.identifier(i)}`}${g}`)}else if((0,b.is)(e,d.View)){let a=e[j.ViewBaseConfig].name,b=e[j.ViewBaseConfig].schema,h=e[j.ViewBaseConfig].originalName,i=a===h?void 0:c.alias;F.push(d.sql`${d.sql.raw(c.joinType)} join${f} ${b?d.sql`${d.sql.identifier(b)}.`:void 0}${d.sql.identifier(h)}${i&&d.sql` ${d.sql.identifier(i)}`}${g}`)}else F.push(d.sql`${d.sql.raw(c.joinType)} join${f} ${e}${g}`);a<l.length-1&&F.push(d.sql` `)}let G=d.sql.join(F),H=g?d.sql` where ${g}`:void 0,I=h?d.sql` having ${h}`:void 0,J=this.buildOrderBy(m),K=n&&n.length>0?d.sql` group by ${d.sql.join(n,d.sql`, `)}`:void 0,L=this.buildLimit(o),M=p?d.sql` offset ${p}`:void 0,N=this.buildIndex({indexes:u,indexFor:"USE"}),O=this.buildIndex({indexes:w,indexFor:"FORCE"}),P=this.buildIndex({indexes:x,indexFor:"IGNORE"});if(q){let{config:a,strength:b}=q;y=d.sql` for ${d.sql.raw(b)}`,a.noWait?y.append(d.sql` nowait`):a.skipLocked&&y.append(d.sql` skip locked`)}let Q=d.sql`${B}select${C} ${D} from ${E}${N}${O}${P}${G}${H}${K}${I}${J}${L}${M}${y}`;return s.length>0?this.buildSetOperations(Q,s):Q}buildSetOperations(a,b){let[c,...d]=b;if(!c)throw Error("Cannot pass undefined values to any set operator");return 0===d.length?this.buildSetOperationQuery({leftSelect:a,setOperator:c}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:a,setOperator:c}),d)}buildSetOperationQuery({leftSelect:a,setOperator:{type:c,isAll:e,rightSelect:f,limit:g,orderBy:h,offset:i}}){let j,k=d.sql`(${a.getSQL()}) `,l=d.sql`(${f.getSQL()})`;if(h&&h.length>0){let a=[];for(let c of h)if((0,b.is)(c,B))a.push(d.sql.identifier(this.casing.getColumnCasing(c)));else if((0,b.is)(c,d.SQL)){for(let a=0;a<c.queryChunks.length;a++){let e=c.queryChunks[a];(0,b.is)(e,B)&&(c.queryChunks[a]=d.sql.identifier(this.casing.getColumnCasing(e)))}a.push(d.sql`${c}`)}else a.push(d.sql`${c}`);j=d.sql` order by ${d.sql.join(a,d.sql`, `)} `}let m="object"==typeof g||"number"==typeof g&&g>=0?d.sql` limit ${g}`:void 0,n=d.sql.raw(`${c} ${e?"all ":""}`),o=i?d.sql` offset ${i}`:void 0;return d.sql`${k}${n}${l}${j}${m}${o}`}buildInsertQuery({table:a,values:c,ignore:e,onConflict:f,select:g}){let h=[],j=Object.entries(a[i.Table.Symbol.Columns]).filter(([a,b])=>!b.shouldDisableInsert()),k=j.map(([,a])=>d.sql.identifier(this.casing.getColumnCasing(a))),l=[];if(g)(0,b.is)(c,d.SQL)?h.push(c):h.push(c.getSQL());else for(let[a,e]of(h.push(d.sql.raw("values ")),c.entries())){let f={},g=[];for(let[a,c]of j){let h=e[a];if(void 0===h||(0,b.is)(h,d.Param)&&void 0===h.value)if(void 0!==c.defaultFn){let e=c.defaultFn();f[a]=e;let h=(0,b.is)(e,d.SQL)?e:d.sql.param(e,c);g.push(h)}else if(c.default||void 0===c.onUpdateFn)g.push(d.sql`default`);else{let a=c.onUpdateFn(),e=(0,b.is)(a,d.SQL)?a:d.sql.param(a,c);g.push(e)}else c.defaultFn&&(0,b.is)(h,d.Param)&&(f[a]=h.value),g.push(h)}l.push(f),h.push(g),a<c.length-1&&h.push(d.sql`, `)}let m=d.sql.join(h),n=e?d.sql` ignore`:void 0,o=f?d.sql` on duplicate key ${f}`:void 0;return{sql:d.sql`insert${n} into ${a} ${k} ${m}${o}`,generatedIds:l}}sqlToQuery(a,b){return a.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,invokeSource:b})}buildRelationalQuery({fullSchema:a,schema:c,tableNamesMap:f,table:g,tableConfig:h,queryConfig:j,tableAlias:k,nestedQueryRelation:l,joinOn:m}){let n,o,p,q,r,s=[],t=[];if(!0===j)s=Object.entries(h.columns).map(([a,b])=>({dbKey:b.name,tsKey:a,field:(0,bo.aliasedTableColumn)(b,k),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let g=Object.fromEntries(Object.entries(h.columns).map(([a,b])=>[a,(0,bo.aliasedTableColumn)(b,k)]));if(j.where){let a="function"==typeof j.where?j.where(g,(0,br.getOperators)()):j.where;q=a&&(0,bo.mapColumnsInSQLToAlias)(a,k)}let l=[],m=[];if(j.columns){let a=!1;for(let[b,c]of Object.entries(j.columns))void 0!==c&&b in h.columns&&(a||!0!==c||(a=!0),m.push(b));m.length>0&&(m=a?m.filter(a=>j.columns?.[a]===!0):Object.keys(h.columns).filter(a=>!m.includes(a)))}else m=Object.keys(h.columns);for(let a of m){let b=h.columns[a];l.push({tsKey:a,value:b})}let r=[];if(j.with&&(r=Object.entries(j.with).filter(a=>!!a[1]).map(([a,b])=>({tsKey:a,queryConfig:b,relation:h.relations[a]}))),j.extras)for(let[a,b]of Object.entries("function"==typeof j.extras?j.extras(g,{sql:d.sql}):j.extras))l.push({tsKey:a,value:(0,bo.mapColumnsInAliasedSQLToAlias)(b,k)});for(let{tsKey:a,value:c}of l)s.push({dbKey:(0,b.is)(c,d.SQL.Aliased)?c.fieldAlias:h.columns[a].name,tsKey:a,field:(0,b.is)(c,v.Column)?(0,bo.aliasedTableColumn)(c,k):c,relationTableTsKey:void 0,isJson:!1,selection:[]});let u="function"==typeof j.orderBy?j.orderBy(g,(0,br.getOrderByOperators)()):j.orderBy??[];for(let{tsKey:g,queryConfig:h,relation:l}of(Array.isArray(u)||(u=[u]),p=u.map(a=>(0,b.is)(a,v.Column)?(0,bo.aliasedTableColumn)(a,k):(0,bo.mapColumnsInSQLToAlias)(a,k)),n=j.limit,o=j.offset,r)){let j=(0,br.normalizeRelation)(c,f,l),m=f[(0,i.getTableUniqueName)(l.referencedTable)],n=`${k}_${g}`,o=(0,bs.and)(...j.fields.map((a,b)=>(0,bs.eq)((0,bo.aliasedTableColumn)(j.references[b],n),(0,bo.aliasedTableColumn)(a,k)))),p=this.buildRelationalQuery({fullSchema:a,schema:c,tableNamesMap:f,table:a[m],tableConfig:c[m],queryConfig:(0,b.is)(l,br.One)?!0===h?{limit:1}:{...h,limit:1}:h,tableAlias:n,joinOn:o,nestedQueryRelation:l}),q=d.sql`${d.sql.identifier(n)}.${d.sql.identifier("data")}`.as(g);t.push({on:d.sql`true`,table:new e.Subquery(p.sql,{},n),alias:n,joinType:"left",lateral:!0}),s.push({dbKey:g,tsKey:g,field:q,relationTableTsKey:m,isJson:!0,selection:p.selection})}}if(0===s.length)throw new bq.DrizzleError({message:`No fields selected for table "${h.tsName}" ("${k}")`});if(q=(0,bs.and)(m,q),l){let a=d.sql`json_array(${d.sql.join(s.map(({field:a,tsKey:c,isJson:e})=>e?d.sql`${d.sql.identifier(`${k}_${c}`)}.${d.sql.identifier("data")}`:(0,b.is)(a,d.SQL.Aliased)?a.sql:a),d.sql`, `)})`;(0,b.is)(l,br.Many)&&(a=d.sql`coalesce(json_arrayagg(${a}), json_array())`);let c=[{dbKey:"data",tsKey:"data",field:a.as("data"),isJson:!0,relationTableTsKey:h.tsName,selection:s}];void 0!==n||void 0!==o||(p?.length??0)>0?(r=this.buildSelectQuery({table:(0,bo.aliasedTable)(g,k),fields:{},fieldsFlat:[{path:[],field:d.sql.raw("*")},...(p?.length??0)>0?[{path:[],field:d.sql`row_number() over (order by ${d.sql.join(p,d.sql`, `)})`}]:[]],where:q,limit:n,offset:o,setOperators:[]}),q=void 0,n=void 0,o=void 0,p=void 0):r=(0,bo.aliasedTable)(g,k),r=this.buildSelectQuery({table:(0,b.is)(r,be)?r:new e.Subquery(r,{},k),fields:{},fieldsFlat:c.map(({field:a})=>({path:[],field:(0,b.is)(a,v.Column)?(0,bo.aliasedTableColumn)(a,k):a})),joins:t,where:q,limit:n,offset:o,orderBy:p,setOperators:[]})}else r=this.buildSelectQuery({table:(0,bo.aliasedTable)(g,k),fields:{},fieldsFlat:s.map(({field:a})=>({path:[],field:(0,b.is)(a,v.Column)?(0,bo.aliasedTableColumn)(a,k):a})),joins:t,where:q,limit:n,offset:o,orderBy:p,setOperators:[]});return{tableTsKey:h.tsName,sql:r,selection:s}}buildRelationalQueryWithoutLateralSubqueries({fullSchema:a,schema:c,tableNamesMap:f,table:g,tableConfig:h,queryConfig:j,tableAlias:k,nestedQueryRelation:l,joinOn:m}){let n,o=[],p,q,r=[],s;if(!0===j)o=Object.entries(h.columns).map(([a,b])=>({dbKey:b.name,tsKey:a,field:(0,bo.aliasedTableColumn)(b,k),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let e=Object.fromEntries(Object.entries(h.columns).map(([a,b])=>[a,(0,bo.aliasedTableColumn)(b,k)]));if(j.where){let a="function"==typeof j.where?j.where(e,(0,br.getOperators)()):j.where;s=a&&(0,bo.mapColumnsInSQLToAlias)(a,k)}let g=[],l=[];if(j.columns){let a=!1;for(let[b,c]of Object.entries(j.columns))void 0!==c&&b in h.columns&&(a||!0!==c||(a=!0),l.push(b));l.length>0&&(l=a?l.filter(a=>j.columns?.[a]===!0):Object.keys(h.columns).filter(a=>!l.includes(a)))}else l=Object.keys(h.columns);for(let a of l){let b=h.columns[a];g.push({tsKey:a,value:b})}let m=[];if(j.with&&(m=Object.entries(j.with).filter(a=>!!a[1]).map(([a,b])=>({tsKey:a,queryConfig:b,relation:h.relations[a]}))),j.extras)for(let[a,b]of Object.entries("function"==typeof j.extras?j.extras(e,{sql:d.sql}):j.extras))g.push({tsKey:a,value:(0,bo.mapColumnsInAliasedSQLToAlias)(b,k)});for(let{tsKey:a,value:c}of g)o.push({dbKey:(0,b.is)(c,d.SQL.Aliased)?c.fieldAlias:h.columns[a].name,tsKey:a,field:(0,b.is)(c,v.Column)?(0,bo.aliasedTableColumn)(c,k):c,relationTableTsKey:void 0,isJson:!1,selection:[]});let n="function"==typeof j.orderBy?j.orderBy(e,(0,br.getOrderByOperators)()):j.orderBy??[];for(let{tsKey:e,queryConfig:g,relation:h}of(Array.isArray(n)||(n=[n]),r=n.map(a=>(0,b.is)(a,v.Column)?(0,bo.aliasedTableColumn)(a,k):(0,bo.mapColumnsInSQLToAlias)(a,k)),p=j.limit,q=j.offset,m)){let j=(0,br.normalizeRelation)(c,f,h),l=f[(0,i.getTableUniqueName)(h.referencedTable)],m=`${k}_${e}`,n=(0,bs.and)(...j.fields.map((a,b)=>(0,bs.eq)((0,bo.aliasedTableColumn)(j.references[b],m),(0,bo.aliasedTableColumn)(a,k)))),p=this.buildRelationalQueryWithoutLateralSubqueries({fullSchema:a,schema:c,tableNamesMap:f,table:a[l],tableConfig:c[l],queryConfig:(0,b.is)(h,br.One)?!0===g?{limit:1}:{...g,limit:1}:g,tableAlias:m,joinOn:n,nestedQueryRelation:h}),q=d.sql`(${p.sql})`;(0,b.is)(h,br.Many)&&(q=d.sql`coalesce(${q}, json_array())`);let r=q.as(e);o.push({dbKey:e,tsKey:e,field:r,relationTableTsKey:l,isJson:!0,selection:p.selection})}}if(0===o.length)throw new bq.DrizzleError({message:`No fields selected for table "${h.tsName}" ("${k}"). You need to have at least one item in "columns", "with" or "extras". If you need to select all columns, omit the "columns" key or set it to undefined.`});if(s=(0,bs.and)(m,s),l){let a=d.sql`json_array(${d.sql.join(o.map(({field:a})=>(0,b.is)(a,B)?d.sql.identifier(this.casing.getColumnCasing(a)):(0,b.is)(a,d.SQL.Aliased)?a.sql:a),d.sql`, `)})`;(0,b.is)(l,br.Many)&&(a=d.sql`json_arrayagg(${a})`);let c=[{dbKey:"data",tsKey:"data",field:a,isJson:!0,relationTableTsKey:h.tsName,selection:o}];void 0!==p||void 0!==q||r.length>0?(n=this.buildSelectQuery({table:(0,bo.aliasedTable)(g,k),fields:{},fieldsFlat:[{path:[],field:d.sql.raw("*")},...r.length>0?[{path:[],field:d.sql`row_number() over (order by ${d.sql.join(r,d.sql`, `)})`}]:[]],where:s,limit:p,offset:q,setOperators:[]}),s=void 0,p=void 0,q=void 0,r=void 0):n=(0,bo.aliasedTable)(g,k),n=this.buildSelectQuery({table:(0,b.is)(n,be)?n:new e.Subquery(n,{},k),fields:{},fieldsFlat:c.map(({field:a})=>({path:[],field:(0,b.is)(a,v.Column)?(0,bo.aliasedTableColumn)(a,k):a})),where:s,limit:p,offset:q,orderBy:r,setOperators:[]})}else n=this.buildSelectQuery({table:(0,bo.aliasedTable)(g,k),fields:{},fieldsFlat:o.map(({field:a})=>({path:[],field:(0,b.is)(a,v.Column)?(0,bo.aliasedTableColumn)(a,k):a})),where:s,limit:p,offset:q,orderBy:r,setOperators:[]});return{tableTsKey:h.tsName,sql:n,selection:o}}}var bw=a.i(82534);class bx{static [b.entityKind]="MySqlSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(a){this.fields=a.fields,this.session=a.session,this.dialect=a.dialect,a.withList&&(this.withList=a.withList),this.distinct=a.distinct}from(a,c){let f,g=!!this.fields;f=this.fields?this.fields:(0,b.is)(a,e.Subquery)?Object.fromEntries(Object.keys(a._.selectedFields).map(b=>[b,a[b]])):(0,b.is)(a,bu)?a[j.ViewBaseConfig].selectedFields:(0,b.is)(a,d.SQL)?{}:(0,t.getTableColumns)(a);let h=[],i=[],k=[];return(0,b.is)(a,be)&&c&&"string"!=typeof c&&(c.useIndex&&(h=bk(bl(c.useIndex))),c.forceIndex&&(i=bk(bl(c.forceIndex))),c.ignoreIndex&&(k=bk(bl(c.ignoreIndex)))),new bz({table:a,fields:f,isPartialSelect:g,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct,useIndex:h,forceIndex:i,ignoreIndex:k})}}class by extends bw.TypedQueryBuilder{static [b.entityKind]="MySqlSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:a,fields:b,isPartialSelect:c,session:d,dialect:e,withList:f,distinct:g,useIndex:h,forceIndex:i,ignoreIndex:j}){for(const k of(super(),this.config={withList:f,table:a,fields:{...b},distinct:g,setOperators:[],useIndex:h,forceIndex:i,ignoreIndex:j},this.isPartialSelect=c,this.session=d,this.dialect=e,this._={selectedFields:b,config:this.config},this.tableName=(0,t.getTableLikeName)(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{},bj(a)))this.usedTables.add(k)}getUsedTables(){return[...this.usedTables]}createJoin(a,f){return(g,h,k)=>{let l="cross"===a,m=l?void 0:h,n=l?h:k,o=this.tableName,p=(0,t.getTableLikeName)(g);for(let a of bj(g))this.usedTables.add(a);if("string"==typeof p&&this.config.joins?.some(a=>a.alias===p))throw Error(`Alias "${p}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof o&&(this.config.fields={[o]:this.config.fields}),"string"==typeof p&&!(0,b.is)(g,d.SQL))){let a=(0,b.is)(g,e.Subquery)?g._.selectedFields:(0,b.is)(g,d.View)?g[j.ViewBaseConfig].selectedFields:g[i.Table.Symbol.Columns];this.config.fields[p]=a}"function"==typeof m&&(m=m(new Proxy(this.config.fields,new c.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]);let q=[],r=[],s=[];if((0,b.is)(g,be)&&n&&"string"!=typeof n&&(n.useIndex&&(q=bk(bl(n.useIndex))),n.forceIndex&&(r=bk(bl(n.forceIndex))),n.ignoreIndex&&(s=bk(bl(n.ignoreIndex)))),this.config.joins.push({on:m,table:g,joinType:a,alias:p,useIndex:q,forceIndex:r,ignoreIndex:s,lateral:f}),"string"==typeof p)switch(a){case"left":this.joinsNotNullableMap[p]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[p]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[p]=!0}return this}}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(a,b){return c=>{let d="function"==typeof c?c(bB()):c;if(!(0,t.haveSameKeys)(this.getSelectedFields(),d.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:a,isAll:b,rightSelect:d}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(a){return this.config.setOperators.push(...a),this}where(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new c.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=a,this}having(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new c.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=a,this}groupBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new c.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(b)?b:[b]}else this.config.groupBy=a;return this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new c.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),d=Array.isArray(b)?b:[b];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=d:this.config.orderBy=d}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a;return this}limit(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=a:this.config.limit=a,this}offset(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=a:this.config.offset=a,this}for(a,b={}){return this.config.lockingClause={strength:a,config:b},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}as(a){let b=[];if(b.push(...bj(this.config.table)),this.config.joins)for(let a of this.config.joins)b.push(...bj(a.table));return new Proxy(new e.Subquery(this.getSQL(),this.config.fields,a,!1,[...new Set(b)]),new c.SelectionProxyHandler({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new c.SelectionProxyHandler({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(a){return this.cacheConfig=void 0===a?{config:{},enable:!0,autoInvalidate:!0}:!1===a?{enable:!1}:{enable:!0,autoInvalidate:!0,...a},this}}class bz extends by{static [b.entityKind]="MySqlSelect";prepare(){if(!this.session)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");let a=(0,t.orderSelectedFields)(this.config.fields),b=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),a,void 0,void 0,void 0,{type:"select",tables:[...this.usedTables]},this.cacheConfig);return b.joinsNotNullableMap=this.joinsNotNullableMap,b}execute=a=>this.prepare().execute(a);createIterator=()=>{let a=this;return async function*(b){yield*a.prepare().iterator(b)}};iterator=this.createIterator()}function bA(a,b){return(c,d,...e)=>{let f=[d,...e].map(c=>({type:a,isAll:b,rightSelect:c}));for(let a of f)if(!(0,t.haveSameKeys)(c.getSelectedFields(),a.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return c.addSetOperators(f)}}(0,t.applyMixins)(bz,[h.QueryPromise]);let bB=()=>({union:bC,unionAll:bD,intersect:bE,intersectAll:bF,except:bG,exceptAll:bH}),bC=bA("union",!1),bD=bA("union",!0),bE=bA("intersect",!1),bF=bA("intersect",!0),bG=bA("except",!1),bH=bA("except",!0);class bI{static [b.entityKind]="MySqlQueryBuilder";dialect;dialectConfig;constructor(a){this.dialect=(0,b.is)(a,bv)?a:void 0,this.dialectConfig=(0,b.is)(a,bv)?void 0:a}$with=(a,b)=>{let d=this;return{as:f=>("function"==typeof f&&(f=f(d)),new Proxy(new e.WithSubquery(f.getSQL(),b??("getSelectedFields"in f?f.getSelectedFields()??{}:{}),a,!0),new c.SelectionProxyHandler({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...a){let b=this;return{select:function(c){return new bx({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a})},selectDistinct:function(c){return new bx({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a,distinct:!0})}}}select(a){return new bx({fields:a??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(a){return new bx({fields:a??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}getDialect(){return this.dialect||(this.dialect=new bv(this.dialectConfig)),this.dialect}}class bJ{constructor(a,b,c){this.table=a,this.session=b,this.dialect=c}static [b.entityKind]="MySqlInsertBuilder";shouldIgnore=!1;ignore(){return this.shouldIgnore=!0,this}values(a){if(0===(a=Array.isArray(a)?a:[a]).length)throw Error("values() must be called with at least one value");let c=a.map(a=>{let c={},e=this.table[i.Table.Symbol.Columns];for(let f of Object.keys(a)){let g=a[f];c[f]=(0,b.is)(g,d.SQL)?g:new d.Param(g,e[f])}return c});return new bK(this.table,c,this.shouldIgnore,this.session,this.dialect)}select(a){let c="function"==typeof a?a(new bI):a;if(!(0,b.is)(c,d.SQL)&&!(0,t.haveSameKeys)(this.table[i.Columns],c._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new bK(this.table,c,this.shouldIgnore,this.session,this.dialect,!0)}}class bK extends bn.QueryPromise{constructor(a,b,c,d,e,f){super(),this.session=d,this.dialect=e,this.config={table:a,values:b,select:f,ignore:c}}static [b.entityKind]="MySqlInsert";config;cacheConfig;onDuplicateKeyUpdate(a){let b=this.dialect.buildUpdateSet(this.config.table,(0,t.mapUpdateSet)(this.config.table,a.set));return this.config.onConflict=d.sql`update ${b}`,this}$returningId(){let a=[];for(let[b,c]of Object.entries(this.config.table[i.Table.Symbol.Columns]))c.primary&&a.push({field:c,path:[b]});return this.config.returning=a,this}getSQL(){return this.dialect.buildInsertQuery(this.config).sql}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}prepare(){let{sql:a,generatedIds:b}=this.dialect.buildInsertQuery(this.config);return this.session.prepareQuery(this.dialect.sqlToQuery(a),void 0,void 0,b,this.config.returning,{type:"insert",tables:bj(this.config.table)},this.cacheConfig)}execute=a=>this.prepare().execute(a);createIterator=()=>{let a=this;return async function*(b){yield*a.prepare().iterator(b)}};iterator=this.createIterator();$dynamic(){return this}}var bL=h;class bM{constructor(a,b,c,d){this.table=a,this.session=b,this.dialect=c,this.withList=d}static [b.entityKind]="MySqlUpdateBuilder";set(a){return new bN(this.table,(0,t.mapUpdateSet)(this.table,a),this.session,this.dialect,this.withList)}}class bN extends bL.QueryPromise{constructor(a,b,c,d,e){super(),this.session=c,this.dialect=d,this.config={set:b,table:a,withList:e}}static [b.entityKind]="MySqlUpdate";config;cacheConfig;where(a){return this.config.where=a,this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.table[i.Table.Symbol.Columns],new c.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),d=Array.isArray(b)?b:[b];this.config.orderBy=d}else this.config.orderBy=a;return this}limit(a){return this.config.limit=a,this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}prepare(){return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,void 0,void 0,this.config.returning,{type:"insert",tables:bj(this.config.table)},this.cacheConfig)}execute=a=>this.prepare().execute(a);createIterator=()=>{let a=this;return async function*(b){yield*a.prepare().iterator(b)}};iterator=this.createIterator();$dynamic(){return this}}var bO=h;class bP{constructor(a,b,c,d,e,f,g,h){this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g,this.mode=h}static [b.entityKind]="MySqlRelationalQueryBuilder";findMany(a){return new bQ(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a||{},"many",this.mode)}findFirst(a){return new bQ(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a?{...a,limit:1}:{limit:1},"first",this.mode)}}class bQ extends bO.QueryPromise{constructor(a,b,c,d,e,f,g,h,i,j){super(),this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g,this.config=h,this.queryMode=i,this.mode=j}static [b.entityKind]="MySqlRelationalQuery";prepare(){let{query:a,builtQuery:b}=this._toSQL();return this.session.prepareQuery(b,void 0,b=>{let c=b.map(b=>(0,br.mapRelationalRow)(this.schema,this.tableConfig,b,a.selection));return"first"===this.queryMode?c[0]:c})}_getQuery(){return"planetscale"===this.mode?this.dialect.buildRelationalQueryWithoutLateralSubqueries({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}):this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}_toSQL(){let a=this._getQuery();return{builtQuery:this.dialect.sqlToQuery(a.sql),query:a}}getSQL(){return this._getQuery().sql}toSQL(){return this._toSQL().builtQuery}execute(){return this.prepare().execute()}}class bR{constructor(a,b,c,d){if(this.dialect=a,this.session=b,this.mode=d,this._=c?{schema:c.schema,fullSchema:c.fullSchema,tableNamesMap:c.tableNamesMap}:{schema:void 0,fullSchema:{},tableNamesMap:{}},this.query={},this._.schema)for(const[d,e]of Object.entries(this._.schema))this.query[d]=new bP(c.fullSchema,this._.schema,this._.tableNamesMap,c.fullSchema[d],e,a,b,this.mode);this.$cache={invalidate:async a=>{}}}static [b.entityKind]="MySqlDatabase";query;$with=(a,b)=>{let d=this;return{as:f=>("function"==typeof f&&(f=f(new bI(d.dialect))),new Proxy(new e.WithSubquery(f.getSQL(),b??("getSelectedFields"in f?f.getSelectedFields()??{}:{}),a,!0),new c.SelectionProxyHandler({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(a,b){return new g({source:a,filters:b,session:this.session})}$cache;with(...a){let b=this;return{select:function(c){return new bx({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a})},selectDistinct:function(c){return new bx({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:!0})},update:function(c){return new bM(c,b.session,b.dialect,a)},delete:function(c){return new bm(c,b.session,b.dialect,a)}}}select(a){return new bx({fields:a??void 0,session:this.session,dialect:this.dialect})}selectDistinct(a){return new bx({fields:a??void 0,session:this.session,dialect:this.dialect,distinct:!0})}update(a){return new bM(a,this.session,this.dialect)}insert(a){return new bJ(a,this.session,this.dialect)}delete(a){return new bm(a,this.session,this.dialect)}execute(a){return this.session.execute("string"==typeof a?d.sql.raw(a):a.getSQL())}transaction(a,b){return this.session.transaction(a,b)}}var bS=a.i(63343),bT=u,bU=v;class bV{static [b.entityKind]="SQLiteForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(a,b){this.reference=()=>{let{name:b,columns:c,foreignColumns:d}=a();return{name:b,columns:c,foreignTable:d[0].table,foreignColumns:d}},b&&(this._onUpdate=b.onUpdate,this._onDelete=b.onDelete)}onUpdate(a){return this._onUpdate=a,this}onDelete(a){return this._onDelete=a,this}build(a){return new bW(a,this)}}class bW{constructor(a,b){this.table=a,this.reference=b.reference,this.onUpdate=b._onUpdate,this.onDelete=b._onDelete}static [b.entityKind]="SQLiteForeignKey";reference;onUpdate;onDelete;getName(){let{name:a,columns:b,foreignColumns:c}=this.reference(),d=b.map(a=>a.name),e=c.map(a=>a.name),f=[this.table[m.TableName],...d,c[0].table[m.TableName],...e];return a??`${f.join("_")}_fk`}}function bX(a,b){return`${a[m.TableName]}_${b.join("_")}_unique`}class bY{constructor(a,b){this.name=b,this.columns=a}static [b.entityKind]="SQLiteUniqueConstraintBuilder";columns;build(a){return new b$(a,this.columns,this.name)}}class bZ{static [b.entityKind]="SQLiteUniqueOnConstraintBuilder";name;constructor(a){this.name=a}on(...a){return new bY(a,this.name)}}class b${constructor(a,b,c){this.table=a,this.columns=b,this.name=c??bX(this.table,this.columns.map(a=>a.name))}static [b.entityKind]="SQLiteUniqueConstraint";columns;name;getName(){return this.name}}class b_ extends bT.ColumnBuilder{static [b.entityKind]="SQLiteColumnBuilder";foreignKeyConfigs=[];references(a,b={}){return this.foreignKeyConfigs.push({ref:a,actions:b}),this}unique(a){return this.config.isUnique=!0,this.config.uniqueName=a,this}generatedAlwaysAs(a,b){return this.config.generated={as:a,type:"always",mode:b?.mode??"virtual"},this}buildForeignKeys(a,b){return this.foreignKeyConfigs.map(({ref:c,actions:d})=>{let e;return e=new bV(()=>({columns:[a],foreignColumns:[c()]})),d.onUpdate&&e.onUpdate(d.onUpdate),d.onDelete&&e.onDelete(d.onDelete),e.build(b)})}}class b0 extends bU.Column{constructor(a,b){b.uniqueName||(b.uniqueName=bX(a,[b.name])),super(a,b),this.table=a}static [b.entityKind]="SQLiteColumn"}var b1=i;class b2 extends b_{static [b.entityKind]="SQLiteBigIntBuilder";constructor(a){super(a,"bigint","SQLiteBigInt")}build(a){return new b3(a,this.config)}}class b3 extends b0{static [b.entityKind]="SQLiteBigInt";getSQLType(){return"blob"}mapFromDriverValue(a){return"undefined"!=typeof Buffer&&Buffer.from?BigInt((Buffer.isBuffer(a)?a:a instanceof ArrayBuffer?Buffer.from(a):a.buffer?Buffer.from(a.buffer,a.byteOffset,a.byteLength):Buffer.from(a)).toString("utf8")):BigInt(t.textDecoder.decode(a))}mapToDriverValue(a){return Buffer.from(a.toString())}}class b4 extends b_{static [b.entityKind]="SQLiteBlobJsonBuilder";constructor(a){super(a,"json","SQLiteBlobJson")}build(a){return new b5(a,this.config)}}class b5 extends b0{static [b.entityKind]="SQLiteBlobJson";getSQLType(){return"blob"}mapFromDriverValue(a){return"undefined"!=typeof Buffer&&Buffer.from?JSON.parse((Buffer.isBuffer(a)?a:a instanceof ArrayBuffer?Buffer.from(a):a.buffer?Buffer.from(a.buffer,a.byteOffset,a.byteLength):Buffer.from(a)).toString("utf8")):JSON.parse(t.textDecoder.decode(a))}mapToDriverValue(a){return Buffer.from(JSON.stringify(a))}}class b6 extends b_{static [b.entityKind]="SQLiteBlobBufferBuilder";constructor(a){super(a,"buffer","SQLiteBlobBuffer")}build(a){return new b7(a,this.config)}}class b7 extends b0{static [b.entityKind]="SQLiteBlobBuffer";mapFromDriverValue(a){return Buffer.isBuffer(a)?a:Buffer.from(a)}getSQLType(){return"blob"}}function b8(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return d?.mode==="json"?new b4(c):d?.mode==="bigint"?new b2(c):new b6(c)}class b9 extends b_{static [b.entityKind]="SQLiteCustomColumnBuilder";constructor(a,b,c){super(a,"custom","SQLiteCustomColumn"),this.config.fieldConfig=b,this.config.customTypeParams=c}build(a){return new ca(a,this.config)}}class ca extends b0{static [b.entityKind]="SQLiteCustomColumn";sqlName;mapTo;mapFrom;constructor(a,b){super(a,b),this.sqlName=b.customTypeParams.dataType(b.fieldConfig),this.mapTo=b.customTypeParams.toDriver,this.mapFrom=b.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(a){return"function"==typeof this.mapFrom?this.mapFrom(a):a}mapToDriverValue(a){return"function"==typeof this.mapTo?this.mapTo(a):a}}function cb(a){return(b,c)=>{let{name:d,config:e}=(0,t.getColumnNameAndConfig)(b,c);return new b9(d,e,a)}}class cc extends b_{static [b.entityKind]="SQLiteBaseIntegerBuilder";constructor(a,b,c){super(a,b,c),this.config.autoIncrement=!1}primaryKey(a){return a?.autoIncrement&&(this.config.autoIncrement=!0),this.config.hasDefault=!0,super.primaryKey()}}class cd extends b0{static [b.entityKind]="SQLiteBaseInteger";autoIncrement=this.config.autoIncrement;getSQLType(){return"integer"}}class ce extends cc{static [b.entityKind]="SQLiteIntegerBuilder";constructor(a){super(a,"number","SQLiteInteger")}build(a){return new cf(a,this.config)}}class cf extends cd{static [b.entityKind]="SQLiteInteger"}class cg extends cc{static [b.entityKind]="SQLiteTimestampBuilder";constructor(a,b){super(a,"date","SQLiteTimestamp"),this.config.mode=b}defaultNow(){return this.default(d.sql`(cast((julianday('now') - 2440587.5)*86400000 as integer))`)}build(a){return new ch(a,this.config)}}class ch extends cd{static [b.entityKind]="SQLiteTimestamp";mode=this.config.mode;mapFromDriverValue(a){return new Date("timestamp"===this.config.mode?1e3*a:a)}mapToDriverValue(a){let b=a.getTime();return"timestamp"===this.config.mode?Math.floor(b/1e3):b}}class ci extends cc{static [b.entityKind]="SQLiteBooleanBuilder";constructor(a,b){super(a,"boolean","SQLiteBoolean"),this.config.mode=b}build(a){return new cj(a,this.config)}}class cj extends cd{static [b.entityKind]="SQLiteBoolean";mode=this.config.mode;mapFromDriverValue(a){return 1===Number(a)}mapToDriverValue(a){return+!!a}}function ck(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return d?.mode==="timestamp"||d?.mode==="timestamp_ms"?new cg(c,d.mode):d?.mode==="boolean"?new ci(c,d.mode):new ce(c)}class cl extends b_{static [b.entityKind]="SQLiteNumericBuilder";constructor(a){super(a,"string","SQLiteNumeric")}build(a){return new cm(a,this.config)}}class cm extends b0{static [b.entityKind]="SQLiteNumeric";mapFromDriverValue(a){return"string"==typeof a?a:String(a)}getSQLType(){return"numeric"}}class cn extends b_{static [b.entityKind]="SQLiteNumericNumberBuilder";constructor(a){super(a,"number","SQLiteNumericNumber")}build(a){return new co(a,this.config)}}class co extends b0{static [b.entityKind]="SQLiteNumericNumber";mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}mapToDriverValue=String;getSQLType(){return"numeric"}}class cp extends b_{static [b.entityKind]="SQLiteNumericBigIntBuilder";constructor(a){super(a,"bigint","SQLiteNumericBigInt")}build(a){return new cq(a,this.config)}}class cq extends b0{static [b.entityKind]="SQLiteNumericBigInt";mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return"numeric"}}function cr(a,b){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b),e=d?.mode;return"number"===e?new cn(c):"bigint"===e?new cp(c):new cl(c)}class cs extends b_{static [b.entityKind]="SQLiteRealBuilder";constructor(a){super(a,"number","SQLiteReal")}build(a){return new ct(a,this.config)}}class ct extends b0{static [b.entityKind]="SQLiteReal";getSQLType(){return"real"}}function cu(a){return new cs(a??"")}class cv extends b_{static [b.entityKind]="SQLiteTextBuilder";constructor(a,b){super(a,"string","SQLiteText"),this.config.enumValues=b.enum,this.config.length=b.length}build(a){return new cw(a,this.config)}}class cw extends b0{static [b.entityKind]="SQLiteText";enumValues=this.config.enumValues;length=this.config.length;constructor(a,b){super(a,b)}getSQLType(){return`text${this.config.length?`(${this.config.length})`:""}`}}class cx extends b_{static [b.entityKind]="SQLiteTextJsonBuilder";constructor(a){super(a,"json","SQLiteTextJson")}build(a){return new cy(a,this.config)}}class cy extends b0{static [b.entityKind]="SQLiteTextJson";getSQLType(){return"text"}mapFromDriverValue(a){return JSON.parse(a)}mapToDriverValue(a){return JSON.stringify(a)}}function cz(a,b={}){let{name:c,config:d}=(0,t.getColumnNameAndConfig)(a,b);return"json"===d.mode?new cx(c):new cv(c,d)}let cA=Symbol.for("drizzle:SQLiteInlineForeignKeys");class cB extends b1.Table{static [b.entityKind]="SQLiteTable";static Symbol=Object.assign({},b1.Table.Symbol,{InlineForeignKeys:cA});[b1.Table.Symbol.Columns];[cA]=[];[b1.Table.Symbol.ExtraConfigBuilder]=void 0}let cC=(a,b,c)=>(function(a,b,c,d,e=a){let f=new cB(a,void 0,e),g=Object.fromEntries(Object.entries("function"==typeof b?b({blob:b8,customType:cb,integer:ck,numeric:cr,real:cu,text:cz}):b).map(([a,b])=>{b.setName(a);let c=b.build(f);return f[cA].push(...b.buildForeignKeys(c,f)),[a,c]})),h=Object.assign(f,g);return h[b1.Table.Symbol.Columns]=g,h[b1.Table.Symbol.ExtraConfigColumns]=g,c&&(h[cB.Symbol.ExtraConfigBuilder]=c),h})(a,b,c);var cD=d;class cE extends cD.View{static [b.entityKind]="SQLiteViewBase"}class cF{static [b.entityKind]="SQLiteDialect";casing;constructor(a){this.casing=new bp.CasingCache(a?.casing)}escapeName(a){return`"${a}"`}escapeParam(a){return"?"}escapeString(a){return`'${a.replace(/'/g,"''")}'`}buildWithCTE(a){if(!a?.length)return;let b=[d.sql`with `];for(let[c,e]of a.entries())b.push(d.sql`${d.sql.identifier(e._.alias)} as (${e._.sql})`),c<a.length-1&&b.push(d.sql`, `);return b.push(d.sql` `),d.sql.join(b)}buildDeleteQuery({table:a,where:b,returning:c,withList:e,limit:f,orderBy:g}){let h=this.buildWithCTE(e),i=c?d.sql` returning ${this.buildSelection(c,{isSingleTable:!0})}`:void 0,j=b?d.sql` where ${b}`:void 0,k=this.buildOrderBy(g),l=this.buildLimit(f);return d.sql`${h}delete from ${a}${j}${i}${k}${l}`}buildUpdateSet(a,b){let c=a[i.Table.Symbol.Columns],e=Object.keys(c).filter(a=>void 0!==b[a]||c[a]?.onUpdateFn!==void 0),f=e.length;return d.sql.join(e.flatMap((a,e)=>{let g=c[a],h=b[a]??d.sql.param(g.onUpdateFn(),g),i=d.sql`${d.sql.identifier(this.casing.getColumnCasing(g))} = ${h}`;return e<f-1?[i,d.sql.raw(", ")]:[i]}))}buildUpdateQuery({table:a,set:b,where:c,returning:e,withList:f,joins:g,from:h,limit:i,orderBy:j}){let k=this.buildWithCTE(f),l=this.buildUpdateSet(a,b),m=h&&d.sql.join([d.sql.raw(" from "),this.buildFromTable(h)]),n=this.buildJoins(g),o=e?d.sql` returning ${this.buildSelection(e,{isSingleTable:!0})}`:void 0,p=c?d.sql` where ${c}`:void 0,q=this.buildOrderBy(j),r=this.buildLimit(i);return d.sql`${k}update ${a} set ${l}${m}${n}${p}${o}${q}${r}`}buildSelection(a,{isSingleTable:c=!1}={}){let e=a.length,f=a.flatMap(({field:a},f)=>{let g=[];if((0,b.is)(a,d.SQL.Aliased)&&a.isSelectionField)g.push(d.sql.identifier(a.fieldAlias));else if((0,b.is)(a,d.SQL.Aliased)||(0,b.is)(a,d.SQL)){let e=(0,b.is)(a,d.SQL.Aliased)?a.sql:a;c?g.push(new d.SQL(e.queryChunks.map(a=>(0,b.is)(a,v.Column)?d.sql.identifier(this.casing.getColumnCasing(a)):a))):g.push(e),(0,b.is)(a,d.SQL.Aliased)&&g.push(d.sql` as ${d.sql.identifier(a.fieldAlias)}`)}else if((0,b.is)(a,v.Column)){let b=a.table[i.Table.Symbol.Name];"SQLiteNumericBigInt"===a.columnType?c?g.push(d.sql`cast(${d.sql.identifier(this.casing.getColumnCasing(a))} as text)`):g.push(d.sql`cast(${d.sql.identifier(b)}.${d.sql.identifier(this.casing.getColumnCasing(a))} as text)`):c?g.push(d.sql.identifier(this.casing.getColumnCasing(a))):g.push(d.sql`${d.sql.identifier(b)}.${d.sql.identifier(this.casing.getColumnCasing(a))}`)}return f<e-1&&g.push(d.sql`, `),g});return d.sql.join(f)}buildJoins(a){if(!a||0===a.length)return;let c=[];if(a)for(let[e,f]of a.entries()){0===e&&c.push(d.sql` `);let g=f.table,h=f.on?d.sql` on ${f.on}`:void 0;if((0,b.is)(g,cB)){let a=g[cB.Symbol.Name],b=g[cB.Symbol.Schema],e=g[cB.Symbol.OriginalName],i=a===e?void 0:f.alias;c.push(d.sql`${d.sql.raw(f.joinType)} join ${b?d.sql`${d.sql.identifier(b)}.`:void 0}${d.sql.identifier(e)}${i&&d.sql` ${d.sql.identifier(i)}`}${h}`)}else c.push(d.sql`${d.sql.raw(f.joinType)} join ${g}${h}`);e<a.length-1&&c.push(d.sql` `)}return d.sql.join(c)}buildLimit(a){return"object"==typeof a||"number"==typeof a&&a>=0?d.sql` limit ${a}`:void 0}buildOrderBy(a){let b=[];if(a)for(let[c,e]of a.entries())b.push(e),c<a.length-1&&b.push(d.sql`, `);return b.length>0?d.sql` order by ${d.sql.join(b)}`:void 0}buildFromTable(a){return(0,b.is)(a,i.Table)&&a[i.Table.Symbol.IsAlias]?d.sql`${d.sql`${d.sql.identifier(a[i.Table.Symbol.Schema]??"")}.`.if(a[i.Table.Symbol.Schema])}${d.sql.identifier(a[i.Table.Symbol.OriginalName])} ${d.sql.identifier(a[i.Table.Symbol.Name])}`:a}buildSelectQuery({withList:a,fields:c,fieldsFlat:f,where:g,having:h,table:k,joins:l,orderBy:m,groupBy:n,limit:o,offset:p,distinct:q,setOperators:r}){let s=f??(0,t.orderSelectedFields)(c);for(let a of s){let c;if((0,b.is)(a.field,v.Column)&&(0,i.getTableName)(a.field.table)!==((0,b.is)(k,e.Subquery)?k._.alias:(0,b.is)(k,cE)?k[j.ViewBaseConfig].name:(0,b.is)(k,d.SQL)?void 0:(0,i.getTableName)(k))&&(c=a.field.table,!l?.some(({alias:a})=>a===(c[i.Table.Symbol.IsAlias]?(0,i.getTableName)(c):c[i.Table.Symbol.BaseName])))){let b=(0,i.getTableName)(a.field.table);throw Error(`Your "${a.path.join("->")}" field references a column "${b}"."${a.field.name}", but the table "${b}" is not part of the query! Did you forget to join it?`)}}let u=!l||0===l.length,w=this.buildWithCTE(a),x=q?d.sql` distinct`:void 0,y=this.buildSelection(s,{isSingleTable:u}),z=this.buildFromTable(k),A=this.buildJoins(l),B=g?d.sql` where ${g}`:void 0,C=h?d.sql` having ${h}`:void 0,D=[];if(n)for(let[a,b]of n.entries())D.push(b),a<n.length-1&&D.push(d.sql`, `);let E=D.length>0?d.sql` group by ${d.sql.join(D)}`:void 0,F=this.buildOrderBy(m),G=this.buildLimit(o),H=p?d.sql` offset ${p}`:void 0,I=d.sql`${w}select${x} ${y} from ${z}${A}${B}${E}${C}${F}${G}${H}`;return r.length>0?this.buildSetOperations(I,r):I}buildSetOperations(a,b){let[c,...d]=b;if(!c)throw Error("Cannot pass undefined values to any set operator");return 0===d.length?this.buildSetOperationQuery({leftSelect:a,setOperator:c}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:a,setOperator:c}),d)}buildSetOperationQuery({leftSelect:a,setOperator:{type:c,isAll:e,rightSelect:f,limit:g,orderBy:h,offset:i}}){let j,k=d.sql`${a.getSQL()} `,l=d.sql`${f.getSQL()}`;if(h&&h.length>0){let a=[];for(let c of h)if((0,b.is)(c,b0))a.push(d.sql.identifier(c.name));else if((0,b.is)(c,d.SQL)){for(let a=0;a<c.queryChunks.length;a++){let e=c.queryChunks[a];(0,b.is)(e,b0)&&(c.queryChunks[a]=d.sql.identifier(this.casing.getColumnCasing(e)))}a.push(d.sql`${c}`)}else a.push(d.sql`${c}`);j=d.sql` order by ${d.sql.join(a,d.sql`, `)}`}let m="object"==typeof g||"number"==typeof g&&g>=0?d.sql` limit ${g}`:void 0,n=d.sql.raw(`${c} ${e?"all ":""}`),o=i?d.sql` offset ${i}`:void 0;return d.sql`${k}${n}${l}${j}${m}${o}`}buildInsertQuery({table:a,values:c,onConflict:e,returning:f,withList:g,select:h}){let j=[],k=Object.entries(a[i.Table.Symbol.Columns]).filter(([a,b])=>!b.shouldDisableInsert()),l=k.map(([,a])=>d.sql.identifier(this.casing.getColumnCasing(a)));if(h)(0,b.is)(c,d.SQL)?j.push(c):j.push(c.getSQL());else for(let[a,e]of(j.push(d.sql.raw("values ")),c.entries())){let f=[];for(let[a,c]of k){let g=e[a];if(void 0===g||(0,b.is)(g,d.Param)&&void 0===g.value){let a;if(null!==c.default&&void 0!==c.default)a=(0,b.is)(c.default,d.SQL)?c.default:d.sql.param(c.default,c);else if(void 0!==c.defaultFn){let e=c.defaultFn();a=(0,b.is)(e,d.SQL)?e:d.sql.param(e,c)}else if(c.default||void 0===c.onUpdateFn)a=d.sql`null`;else{let e=c.onUpdateFn();a=(0,b.is)(e,d.SQL)?e:d.sql.param(e,c)}f.push(a)}else f.push(g)}j.push(f),a<c.length-1&&j.push(d.sql`, `)}let m=this.buildWithCTE(g),n=d.sql.join(j),o=f?d.sql` returning ${this.buildSelection(f,{isSingleTable:!0})}`:void 0,p=e?.length?d.sql.join(e):void 0;return d.sql`${m}insert into ${a} ${l} ${n}${p}${o}`}sqlToQuery(a,b){return a.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,invokeSource:b})}buildRelationalQuery({fullSchema:a,schema:c,tableNamesMap:f,table:g,tableConfig:h,queryConfig:j,tableAlias:k,nestedQueryRelation:l,joinOn:m}){let n,o=[],p,q,r=[],s,t=[];if(!0===j)o=Object.entries(h.columns).map(([a,b])=>({dbKey:b.name,tsKey:a,field:(0,bo.aliasedTableColumn)(b,k),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let e=Object.fromEntries(Object.entries(h.columns).map(([a,b])=>[a,(0,bo.aliasedTableColumn)(b,k)]));if(j.where){let a="function"==typeof j.where?j.where(e,(0,br.getOperators)()):j.where;s=a&&(0,bo.mapColumnsInSQLToAlias)(a,k)}let g=[],l=[];if(j.columns){let a=!1;for(let[b,c]of Object.entries(j.columns))void 0!==c&&b in h.columns&&(a||!0!==c||(a=!0),l.push(b));l.length>0&&(l=a?l.filter(a=>j.columns?.[a]===!0):Object.keys(h.columns).filter(a=>!l.includes(a)))}else l=Object.keys(h.columns);for(let a of l){let b=h.columns[a];g.push({tsKey:a,value:b})}let m=[];if(j.with&&(m=Object.entries(j.with).filter(a=>!!a[1]).map(([a,b])=>({tsKey:a,queryConfig:b,relation:h.relations[a]}))),j.extras)for(let[a,b]of Object.entries("function"==typeof j.extras?j.extras(e,{sql:d.sql}):j.extras))g.push({tsKey:a,value:(0,bo.mapColumnsInAliasedSQLToAlias)(b,k)});for(let{tsKey:a,value:c}of g)o.push({dbKey:(0,b.is)(c,d.SQL.Aliased)?c.fieldAlias:h.columns[a].name,tsKey:a,field:(0,b.is)(c,v.Column)?(0,bo.aliasedTableColumn)(c,k):c,relationTableTsKey:void 0,isJson:!1,selection:[]});let n="function"==typeof j.orderBy?j.orderBy(e,(0,br.getOrderByOperators)()):j.orderBy??[];for(let{tsKey:e,queryConfig:g,relation:h}of(Array.isArray(n)||(n=[n]),r=n.map(a=>(0,b.is)(a,v.Column)?(0,bo.aliasedTableColumn)(a,k):(0,bo.mapColumnsInSQLToAlias)(a,k)),p=j.limit,q=j.offset,m)){let j=(0,br.normalizeRelation)(c,f,h),l=f[(0,i.getTableUniqueName)(h.referencedTable)],m=`${k}_${e}`,n=(0,bs.and)(...j.fields.map((a,b)=>(0,bs.eq)((0,bo.aliasedTableColumn)(j.references[b],m),(0,bo.aliasedTableColumn)(a,k)))),p=this.buildRelationalQuery({fullSchema:a,schema:c,tableNamesMap:f,table:a[l],tableConfig:c[l],queryConfig:(0,b.is)(h,br.One)?!0===g?{limit:1}:{...g,limit:1}:g,tableAlias:m,joinOn:n,nestedQueryRelation:h}),q=d.sql`(${p.sql})`.as(e);o.push({dbKey:e,tsKey:e,field:q,relationTableTsKey:l,isJson:!0,selection:p.selection})}}if(0===o.length)throw new bq.DrizzleError({message:`No fields selected for table "${h.tsName}" ("${k}"). You need to have at least one item in "columns", "with" or "extras". If you need to select all columns, omit the "columns" key or set it to undefined.`});if(s=(0,bs.and)(m,s),l){let a=d.sql`json_array(${d.sql.join(o.map(({field:a})=>(0,b.is)(a,b0)?d.sql.identifier(this.casing.getColumnCasing(a)):(0,b.is)(a,d.SQL.Aliased)?a.sql:a),d.sql`, `)})`;(0,b.is)(l,br.Many)&&(a=d.sql`coalesce(json_group_array(${a}), json_array())`);let c=[{dbKey:"data",tsKey:"data",field:a.as("data"),isJson:!0,relationTableTsKey:h.tsName,selection:o}];void 0!==p||void 0!==q||r.length>0?(n=this.buildSelectQuery({table:(0,bo.aliasedTable)(g,k),fields:{},fieldsFlat:[{path:[],field:d.sql.raw("*")}],where:s,limit:p,offset:q,orderBy:r,setOperators:[]}),s=void 0,p=void 0,q=void 0,r=void 0):n=(0,bo.aliasedTable)(g,k),n=this.buildSelectQuery({table:(0,b.is)(n,cB)?n:new e.Subquery(n,{},k),fields:{},fieldsFlat:c.map(({field:a})=>({path:[],field:(0,b.is)(a,v.Column)?(0,bo.aliasedTableColumn)(a,k):a})),joins:t,where:s,limit:p,offset:q,orderBy:r,setOperators:[]})}else n=this.buildSelectQuery({table:(0,bo.aliasedTable)(g,k),fields:{},fieldsFlat:o.map(({field:a})=>({path:[],field:(0,b.is)(a,v.Column)?(0,bo.aliasedTableColumn)(a,k):a})),joins:t,where:s,limit:p,offset:q,orderBy:r,setOperators:[]});return{tableTsKey:h.tsName,sql:n,selection:o}}}class cG extends cF{static [b.entityKind]="SQLiteSyncDialect";migrate(a,b,c){let e=void 0===c||"string"==typeof c?"__drizzle_migrations":c.migrationsTable??"__drizzle_migrations",f=d.sql`
			CREATE TABLE IF NOT EXISTS ${d.sql.identifier(e)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;b.run(f);let g=b.values(d.sql`SELECT id, hash, created_at FROM ${d.sql.identifier(e)} ORDER BY created_at DESC LIMIT 1`)[0]??void 0;b.run(d.sql`BEGIN`);try{for(let c of a)if(!g||Number(g[2])<c.folderMillis){for(let a of c.sql)b.run(d.sql.raw(a));b.run(d.sql`INSERT INTO ${d.sql.identifier(e)} ("hash", "created_at") VALUES(${c.hash}, ${c.folderMillis})`)}b.run(d.sql`COMMIT`)}catch(a){throw b.run(d.sql`ROLLBACK`),a}}}class cH extends cF{static [b.entityKind]="SQLiteAsyncDialect";async migrate(a,b,c){let e=void 0===c||"string"==typeof c?"__drizzle_migrations":c.migrationsTable??"__drizzle_migrations",f=d.sql`
			CREATE TABLE IF NOT EXISTS ${d.sql.identifier(e)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;await b.run(f);let g=(await b.values(d.sql`SELECT id, hash, created_at FROM ${d.sql.identifier(e)} ORDER BY created_at DESC LIMIT 1`))[0]??void 0;await b.transaction(async b=>{for(let c of a)if(!g||Number(g[2])<c.folderMillis){for(let a of c.sql)await b.run(d.sql.raw(a));await b.run(d.sql`INSERT INTO ${d.sql.identifier(e)} ("hash", "created_at") VALUES(${c.hash}, ${c.folderMillis})`)}})}}var cI=bw;class cJ{constructor(a,b){this.name=a,this.value=b}static [b.entityKind]="SQLiteCheckBuilder";brand;build(a){return new cK(a,this)}}class cK{constructor(a,b){this.table=a,this.name=b.name,this.value=b.value}static [b.entityKind]="SQLiteCheck";name;value}class cL{constructor(a,b){this.name=a,this.unique=b}static [b.entityKind]="SQLiteIndexBuilderOn";on(...a){return new cM(this.name,a,this.unique)}}class cM{static [b.entityKind]="SQLiteIndexBuilder";config;constructor(a,b,c){this.config={name:a,columns:b,unique:c,where:void 0}}where(a){return this.config.where=a,this}build(a){return new cN(this.config,a)}}class cN{static [b.entityKind]="SQLiteIndex";config;constructor(a,b){this.config={...a,table:b}}}function cO(...a){return a[0].columns?new cP(a[0].columns,a[0].name):new cP(a)}class cP{static [b.entityKind]="SQLitePrimaryKeyBuilder";columns;name;constructor(a,b){this.columns=a,this.name=b}build(a){return new cQ(a,this.columns,this.name)}}class cQ{constructor(a,b,c){this.table=a,this.columns=b,this.name=c}static [b.entityKind]="SQLitePrimaryKey";columns;name;getName(){return this.name??`${this.table[cB.Symbol.Name]}_${this.columns.map(a=>a.name).join("_")}_pk`}}function cR(a){return(0,b.is)(a,cB)?[`${a[i.Table.Symbol.BaseName]}`]:(0,b.is)(a,e.Subquery)?a._.usedTables??[]:(0,b.is)(a,d.SQL)?a.usedTables??[]:[]}class cS{static [b.entityKind]="SQLiteSelectBuilder";fields;session;dialect;withList;distinct;constructor(a){this.fields=a.fields,this.session=a.session,this.dialect=a.dialect,this.withList=a.withList,this.distinct=a.distinct}from(a){let c,f=!!this.fields;return c=this.fields?this.fields:(0,b.is)(a,e.Subquery)?Object.fromEntries(Object.keys(a._.selectedFields).map(b=>[b,a[b]])):(0,b.is)(a,cE)?a[j.ViewBaseConfig].selectedFields:(0,b.is)(a,d.SQL)?{}:(0,t.getTableColumns)(a),new cU({table:a,fields:c,isPartialSelect:f,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}class cT extends cI.TypedQueryBuilder{static [b.entityKind]="SQLiteSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:a,fields:b,isPartialSelect:c,session:d,dialect:e,withList:f,distinct:g}){for(const h of(super(),this.config={withList:f,table:a,fields:{...b},distinct:g,setOperators:[]},this.isPartialSelect=c,this.session=d,this.dialect=e,this._={selectedFields:b,config:this.config},this.tableName=(0,t.getTableLikeName)(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{},cR(a)))this.usedTables.add(h)}getUsedTables(){return[...this.usedTables]}createJoin(a){return(f,g)=>{let h=this.tableName,k=(0,t.getTableLikeName)(f);for(let a of cR(f))this.usedTables.add(a);if("string"==typeof k&&this.config.joins?.some(a=>a.alias===k))throw Error(`Alias "${k}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof h&&(this.config.fields={[h]:this.config.fields}),"string"==typeof k&&!(0,b.is)(f,d.SQL))){let a=(0,b.is)(f,e.Subquery)?f._.selectedFields:(0,b.is)(f,d.View)?f[j.ViewBaseConfig].selectedFields:f[i.Table.Symbol.Columns];this.config.fields[k]=a}if("function"==typeof g&&(g=g(new Proxy(this.config.fields,new c.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:g,table:f,joinType:a,alias:k}),"string"==typeof k)switch(a){case"left":this.joinsNotNullableMap[k]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[k]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[k]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[k]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");crossJoin=this.createJoin("cross");createSetOperator(a,b){return c=>{let d="function"==typeof c?c(cW()):c;if(!(0,t.haveSameKeys)(this.getSelectedFields(),d.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:a,isAll:b,rightSelect:d}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);except=this.createSetOperator("except",!1);addSetOperators(a){return this.config.setOperators.push(...a),this}where(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new c.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=a,this}having(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new c.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=a,this}groupBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new c.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(b)?b:[b]}else this.config.groupBy=a;return this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new c.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),d=Array.isArray(b)?b:[b];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=d:this.config.orderBy=d}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a;return this}limit(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=a:this.config.limit=a,this}offset(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=a:this.config.offset=a,this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}as(a){let b=[];if(b.push(...cR(this.config.table)),this.config.joins)for(let a of this.config.joins)b.push(...cR(a.table));return new Proxy(new e.Subquery(this.getSQL(),this.config.fields,a,!1,[...new Set(b)]),new c.SelectionProxyHandler({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new c.SelectionProxyHandler({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class cU extends cT{static [b.entityKind]="SQLiteSelect";_prepare(a=!0){if(!this.session)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");let b=(0,t.orderSelectedFields)(this.config.fields),c=this.session[a?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),b,"all",!0,void 0,{type:"select",tables:[...this.usedTables]},this.cacheConfig);return c.joinsNotNullableMap=this.joinsNotNullableMap,c}$withCache(a){return this.cacheConfig=void 0===a?{config:{},enable:!0,autoInvalidate:!0}:!1===a?{enable:!1}:{enable:!0,autoInvalidate:!0,...a},this}prepare(){return this._prepare(!1)}run=a=>this._prepare().run(a);all=a=>this._prepare().all(a);get=a=>this._prepare().get(a);values=a=>this._prepare().values(a);async execute(){return this.all()}}function cV(a,b){return(c,d,...e)=>{let f=[d,...e].map(c=>({type:a,isAll:b,rightSelect:c}));for(let a of f)if(!(0,t.haveSameKeys)(c.getSelectedFields(),a.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return c.addSetOperators(f)}}(0,t.applyMixins)(cU,[h.QueryPromise]);let cW=()=>({union:cX,unionAll:cY,intersect:cZ,except:c$}),cX=cV("union",!1),cY=cV("union",!0),cZ=cV("intersect",!1),c$=cV("except",!1);class c_{static [b.entityKind]="SQLiteQueryBuilder";dialect;dialectConfig;constructor(a){this.dialect=(0,b.is)(a,cF)?a:void 0,this.dialectConfig=(0,b.is)(a,cF)?void 0:a}$with=(a,b)=>{let d=this;return{as:f=>("function"==typeof f&&(f=f(d)),new Proxy(new e.WithSubquery(f.getSQL(),b??("getSelectedFields"in f?f.getSelectedFields()??{}:{}),a,!0),new c.SelectionProxyHandler({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...a){let b=this;return{select:function(c){return new cS({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a})},selectDistinct:function(c){return new cS({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a,distinct:!0})}}}select(a){return new cS({fields:a??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(a){return new cS({fields:a??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}getDialect(){return this.dialect||(this.dialect=new cG(this.dialectConfig)),this.dialect}}var c0=h;class c1 extends c0.QueryPromise{constructor(a,b,c,d){super(),this.table=a,this.session=b,this.dialect=c,this.config={table:a,withList:d}}static [b.entityKind]="SQLiteDelete";config;where(a){return this.config.where=a,this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.table[i.Table.Symbol.Columns],new c.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),d=Array.isArray(b)?b:[b];this.config.orderBy=d}else this.config.orderBy=a;return this}limit(a){return this.config.limit=a,this}returning(a=this.table[cB.Symbol.Columns]){return this.config.returning=(0,t.orderSelectedFields)(a),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a=!0){return this.session[a?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"delete",tables:cR(this.config.table)})}prepare(){return this._prepare(!1)}run=a=>this._prepare().run(a);all=a=>this._prepare().all(a);get=a=>this._prepare().get(a);values=a=>this._prepare().values(a);async execute(a){return this._prepare().execute(a)}$dynamic(){return this}}var c2=h;class c3{constructor(a,b,c,d){this.table=a,this.session=b,this.dialect=c,this.withList=d}static [b.entityKind]="SQLiteInsertBuilder";values(a){if(0===(a=Array.isArray(a)?a:[a]).length)throw Error("values() must be called with at least one value");let c=a.map(a=>{let c={},e=this.table[i.Table.Symbol.Columns];for(let f of Object.keys(a)){let g=a[f];c[f]=(0,b.is)(g,d.SQL)?g:new d.Param(g,e[f])}return c});return new c4(this.table,c,this.session,this.dialect,this.withList)}select(a){let c="function"==typeof a?a(new c_):a;if(!(0,b.is)(c,d.SQL)&&!(0,t.haveSameKeys)(this.table[i.Columns],c._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new c4(this.table,c,this.session,this.dialect,this.withList,!0)}}class c4 extends c2.QueryPromise{constructor(a,b,c,d,e,f){super(),this.session=c,this.dialect=d,this.config={table:a,values:b,withList:e,select:f}}static [b.entityKind]="SQLiteInsert";config;returning(a=this.config.table[cB.Symbol.Columns]){return this.config.returning=(0,t.orderSelectedFields)(a),this}onConflictDoNothing(a={}){if(this.config.onConflict||(this.config.onConflict=[]),void 0===a.target)this.config.onConflict.push(d.sql` on conflict do nothing`);else{let b=Array.isArray(a.target)?d.sql`${a.target}`:d.sql`${[a.target]}`,c=a.where?d.sql` where ${a.where}`:d.sql``;this.config.onConflict.push(d.sql` on conflict ${b} do nothing${c}`)}return this}onConflictDoUpdate(a){if(a.where&&(a.targetWhere||a.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');this.config.onConflict||(this.config.onConflict=[]);let b=a.where?d.sql` where ${a.where}`:void 0,c=a.targetWhere?d.sql` where ${a.targetWhere}`:void 0,e=a.setWhere?d.sql` where ${a.setWhere}`:void 0,f=Array.isArray(a.target)?d.sql`${a.target}`:d.sql`${[a.target]}`,g=this.dialect.buildUpdateSet(this.config.table,(0,t.mapUpdateSet)(this.config.table,a.set));return this.config.onConflict.push(d.sql` on conflict ${f}${c} do update set ${g}${b}${e}`),this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a=!0){return this.session[a?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"insert",tables:cR(this.config.table)})}prepare(){return this._prepare(!1)}run=a=>this._prepare().run(a);all=a=>this._prepare().all(a);get=a=>this._prepare().get(a);values=a=>this._prepare().values(a);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}var c5=h;class c6{constructor(a,b,c,d){this.table=a,this.session=b,this.dialect=c,this.withList=d}static [b.entityKind]="SQLiteUpdateBuilder";set(a){return new c7(this.table,(0,t.mapUpdateSet)(this.table,a),this.session,this.dialect,this.withList)}}class c7 extends c5.QueryPromise{constructor(a,b,c,d,e){super(),this.session=c,this.dialect=d,this.config={set:b,table:a,withList:e,joins:[]}}static [b.entityKind]="SQLiteUpdate";config;from(a){return this.config.from=a,this}createJoin(a){return(d,f)=>{let g=(0,t.getTableLikeName)(d);if("string"==typeof g&&this.config.joins.some(a=>a.alias===g))throw Error(`Alias "${g}" is already used in this query`);if("function"==typeof f){let a=this.config.from?(0,b.is)(d,cB)?d[i.Table.Symbol.Columns]:(0,b.is)(d,e.Subquery)?d._.selectedFields:(0,b.is)(d,cE)?d[j.ViewBaseConfig].selectedFields:void 0:void 0;f=f(new Proxy(this.config.table[i.Table.Symbol.Columns],new c.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new c.SelectionProxyHandler({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}return this.config.joins.push({on:f,table:d,joinType:a,alias:g}),this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(a){return this.config.where=a,this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.table[i.Table.Symbol.Columns],new c.SelectionProxyHandler({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),d=Array.isArray(b)?b:[b];this.config.orderBy=d}else this.config.orderBy=a;return this}limit(a){return this.config.limit=a,this}returning(a=this.config.table[cB.Symbol.Columns]){return this.config.returning=(0,t.orderSelectedFields)(a),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a=!0){return this.session[a?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"insert",tables:cR(this.config.table)})}prepare(){return this._prepare(!1)}run=a=>this._prepare().run(a);all=a=>this._prepare().all(a);get=a=>this._prepare().get(a);values=a=>this._prepare().values(a);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}var c8=d;class c9 extends c8.SQL{constructor(a){super(c9.buildEmbeddedCount(a.source,a.filters).queryChunks),this.params=a,this.session=a.session,this.sql=c9.buildCount(a.source,a.filters)}sql;static [b.entityKind]="SQLiteCountBuilderAsync";[Symbol.toStringTag]="SQLiteCountBuilderAsync";session;static buildEmbeddedCount(a,b){return c8.sql`(select count(*) from ${a}${c8.sql.raw(" where ").if(b)}${b})`}static buildCount(a,b){return c8.sql`select count(*) from ${a}${c8.sql.raw(" where ").if(b)}${b}`}then(a,b){return Promise.resolve(this.session.count(this.sql)).then(a,b)}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}}var da=h;class db{constructor(a,b,c,d,e,f,g,h){this.mode=a,this.fullSchema=b,this.schema=c,this.tableNamesMap=d,this.table=e,this.tableConfig=f,this.dialect=g,this.session=h}static [b.entityKind]="SQLiteAsyncRelationalQueryBuilder";findMany(a){return"sync"===this.mode?new dd(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a||{},"many"):new dc(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a||{},"many")}findFirst(a){return"sync"===this.mode?new dd(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a?{...a,limit:1}:{limit:1},"first"):new dc(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a?{...a,limit:1}:{limit:1},"first")}}class dc extends da.QueryPromise{constructor(a,b,c,d,e,f,g,h,i){super(),this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g,this.config=h,this.mode=i}static [b.entityKind]="SQLiteAsyncRelationalQuery";mode;getSQL(){return this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}).sql}_prepare(a=!1){let{query:b,builtQuery:c}=this._toSQL();return this.session[a?"prepareOneTimeQuery":"prepareQuery"](c,void 0,"first"===this.mode?"get":"all",!0,(a,c)=>{let d=a.map(a=>(0,br.mapRelationalRow)(this.schema,this.tableConfig,a,b.selection,c));return"first"===this.mode?d[0]:d})}prepare(){return this._prepare(!1)}_toSQL(){let a=this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}),b=this.dialect.sqlToQuery(a.sql);return{query:a,builtQuery:b}}toSQL(){return this._toSQL().builtQuery}executeRaw(){return"first"===this.mode?this._prepare(!1).get():this._prepare(!1).all()}async execute(){return this.executeRaw()}}class dd extends dc{static [b.entityKind]="SQLiteSyncRelationalQuery";sync(){return this.executeRaw()}}var de=h;class df extends de.QueryPromise{constructor(a,b,c,d,e){super(),this.execute=a,this.getSQL=b,this.dialect=d,this.mapBatchResult=e,this.config={action:c}}static [b.entityKind]="SQLiteRaw";config;getQuery(){return{...this.dialect.sqlToQuery(this.getSQL()),method:this.config.action}}mapResult(a,b){return b?this.mapBatchResult(a):a}_prepare(){return this}isResponseInArrayMode(){return!1}}class dg{constructor(a,b,c,d){this.resultKind=a,this.dialect=b,this.session=c,this._=d?{schema:d.schema,fullSchema:d.fullSchema,tableNamesMap:d.tableNamesMap}:{schema:void 0,fullSchema:{},tableNamesMap:{}},this.query={};const e=this.query;if(this._.schema)for(const[f,g]of Object.entries(this._.schema))e[f]=new db(a,d.fullSchema,this._.schema,this._.tableNamesMap,d.fullSchema[f],g,b,c);this.$cache={invalidate:async a=>{}}}static [b.entityKind]="BaseSQLiteDatabase";query;$with=(a,b)=>{let d=this;return{as:f=>("function"==typeof f&&(f=f(new c_(d.dialect))),new Proxy(new e.WithSubquery(f.getSQL(),b??("getSelectedFields"in f?f.getSelectedFields()??{}:{}),a,!0),new c.SelectionProxyHandler({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(a,b){return new c9({source:a,filters:b,session:this.session})}with(...a){let b=this;return{select:function(c){return new cS({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a})},selectDistinct:function(c){return new cS({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:!0})},update:function(c){return new c6(c,b.session,b.dialect,a)},insert:function(c){return new c3(c,b.session,b.dialect,a)},delete:function(c){return new c1(c,b.session,b.dialect,a)}}}select(a){return new cS({fields:a??void 0,session:this.session,dialect:this.dialect})}selectDistinct(a){return new cS({fields:a??void 0,session:this.session,dialect:this.dialect,distinct:!0})}update(a){return new c6(a,this.session,this.dialect)}$cache;insert(a){return new c3(a,this.session,this.dialect)}delete(a){return new c1(a,this.session,this.dialect)}run(a){let b="string"==typeof a?d.sql.raw(a):a.getSQL();return"async"===this.resultKind?new df(async()=>this.session.run(b),()=>b,"run",this.dialect,this.session.extractRawRunValueFromBatchResult.bind(this.session)):this.session.run(b)}all(a){let b="string"==typeof a?d.sql.raw(a):a.getSQL();return"async"===this.resultKind?new df(async()=>this.session.all(b),()=>b,"all",this.dialect,this.session.extractRawAllValueFromBatchResult.bind(this.session)):this.session.all(b)}get(a){let b="string"==typeof a?d.sql.raw(a):a.getSQL();return"async"===this.resultKind?new df(async()=>this.session.get(b),()=>b,"get",this.dialect,this.session.extractRawGetValueFromBatchResult.bind(this.session)):this.session.get(b)}values(a){let b="string"==typeof a?d.sql.raw(a):a.getSQL();return"async"===this.resultKind?new df(async()=>this.session.values(b),()=>b,"values",this.dialect,this.session.extractRawValuesValueFromBatchResult.bind(this.session)):this.session.values(b)}transaction(a,b){return this.session.transaction(a,b)}}var dh=a.i(13552),di=a.i(86096),dj=a.i(57833),dk=a.i(74619),dl=a.i(65105),dm=a.i(99450);function dn(a,c){if((0,b.is)(a,bR))return function(a,b){let{usersTable:c,accountsTable:d,sessionsTable:e,verificationTokensTable:f,authenticatorsTable:g}=function(a={}){let b=a.usersTable??bf("user",{id:a9("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),name:a9("name",{length:255}),email:a9("email",{length:255}).unique(),emailVerified:a0("emailVerified",{mode:"date",fsp:3}),image:a9("image",{length:255})}),c=a.accountsTable??bf("account",{userId:a9("userId",{length:255}).notNull().references(()=>b.id,{onDelete:"cascade"}),type:a9("type",{length:255}).$type().notNull(),provider:a9("provider",{length:255}).notNull(),providerAccountId:a9("providerAccountId",{length:255}).notNull(),refresh_token:a9("refresh_token",{length:255}),access_token:a9("access_token",{length:255}),expires_at:ax("expires_at"),token_type:a9("token_type",{length:255}),scope:a9("scope",{length:255}),id_token:a9("id_token",{length:2048}),session_state:a9("session_state",{length:255})},a=>({compositePk:bg({columns:[a.provider,a.providerAccountId]})})),d=a.sessionsTable??bf("session",{sessionToken:a9("sessionToken",{length:255}).primaryKey(),userId:a9("userId",{length:255}).notNull().references(()=>b.id,{onDelete:"cascade"}),expires:a0("expires",{mode:"date"}).notNull()}),e=a.verificationTokensTable??bf("verificationToken",{identifier:a9("identifier",{length:255}).notNull(),token:a9("token",{length:255}).notNull(),expires:a0("expires",{mode:"date"}).notNull()},a=>({compositePk:bg({columns:[a.identifier,a.token]})})),f=a.authenticatorsTable??bf("authenticator",{credentialID:a9("credentialID",{length:255}).notNull().unique(),userId:a9("userId",{length:255}).notNull().references(()=>b.id,{onDelete:"cascade"}),providerAccountId:a9("providerAccountId",{length:255}).notNull(),credentialPublicKey:a9("credentialPublicKey",{length:255}).notNull(),counter:ax("counter").notNull(),credentialDeviceType:a9("credentialDeviceType",{length:255}).notNull(),credentialBackedUp:O("credentialBackedUp").notNull(),transports:a9("transports",{length:255})},a=>({compositePk:bg({columns:[a.userId,a.credentialID]})}));return{usersTable:b,accountsTable:c,sessionsTable:d,verificationTokensTable:e,authenticatorsTable:f}}(b);return{async createUser(b){let{id:d,...e}=b,f=(0,t.getTableColumns)(c).id.defaultFn,[g]=await a.insert(c).values(f?e:{...e,id:d}).$returningId();return a.select().from(c).where((0,bs.eq)(c.id,g?g.id:d)).then(a=>a[0])},getUser:async b=>a.select().from(c).where((0,bs.eq)(c.id,b)).then(a=>a.length>0?a[0]:null),getUserByEmail:async b=>a.select().from(c).where((0,bs.eq)(c.email,b)).then(a=>a.length>0?a[0]:null),createSession:async b=>(await a.insert(e).values(b),a.select().from(e).where((0,bs.eq)(e.sessionToken,b.sessionToken)).then(a=>a[0])),getSessionAndUser:async b=>a.select({session:e,user:c}).from(e).where((0,bs.eq)(e.sessionToken,b)).innerJoin(c,(0,bs.eq)(c.id,e.userId)).then(a=>a.length>0?a[0]:null),async updateUser(b){if(!b.id)throw Error("No user id.");await a.update(c).set(b).where((0,bs.eq)(c.id,b.id));let[d]=await a.select().from(c).where((0,bs.eq)(c.id,b.id));if(!d)throw Error("No user found.");return d},updateSession:async b=>(await a.update(e).set(b).where((0,bs.eq)(e.sessionToken,b.sessionToken)),a.select().from(e).where((0,bs.eq)(e.sessionToken,b.sessionToken)).then(a=>a[0])),async linkAccount(b){await a.insert(d).values(b)},async getUserByAccount(b){let e=await a.select({account:d,user:c}).from(d).innerJoin(c,(0,bs.eq)(d.userId,c.id)).where((0,bs.and)((0,bs.eq)(d.provider,b.provider),(0,bs.eq)(d.providerAccountId,b.providerAccountId))).then(a=>a[0]);return e?.user??null},async deleteSession(b){await a.delete(e).where((0,bs.eq)(e.sessionToken,b))},createVerificationToken:async b=>(await a.insert(f).values(b),a.select().from(f).where((0,bs.eq)(f.identifier,b.identifier)).then(a=>a[0])),async useVerificationToken(b){let c=await a.select().from(f).where((0,bs.and)((0,bs.eq)(f.identifier,b.identifier),(0,bs.eq)(f.token,b.token))).then(a=>a.length>0?a[0]:null);return c&&await a.delete(f).where((0,bs.and)((0,bs.eq)(f.identifier,b.identifier),(0,bs.eq)(f.token,b.token))),c},async deleteUser(b){await a.delete(c).where((0,bs.eq)(c.id,b))},async unlinkAccount(b){await a.delete(d).where((0,bs.and)((0,bs.eq)(d.provider,b.provider),(0,bs.eq)(d.providerAccountId,b.providerAccountId)))},getAccount:async(b,c)=>a.select().from(d).where((0,bs.and)((0,bs.eq)(d.provider,c),(0,bs.eq)(d.providerAccountId,b))).then(a=>a[0]??null),createAuthenticator:async b=>(await a.insert(g).values(b),await a.select().from(g).where((0,bs.eq)(g.credentialID,b.credentialID)).then(a=>a[0]??null)),getAuthenticator:async b=>await a.select().from(g).where((0,bs.eq)(g.credentialID,b)).then(a=>a[0]??null),listAuthenticatorsByUserId:async b=>await a.select().from(g).where((0,bs.eq)(g.userId,b)).then(a=>a),async updateAuthenticatorCounter(b,c){await a.update(g).set({counter:c}).where((0,bs.eq)(g.credentialID,b));let d=await a.select().from(g).where((0,bs.eq)(g.credentialID,b)).then(a=>a[0]);if(!d)throw Error("Authenticator not found.");return d}}}(a,c);if((0,b.is)(a,bS.PgDatabase))return function(a,b){let{usersTable:c,accountsTable:d,sessionsTable:e,verificationTokensTable:f,authenticatorsTable:g}=function(a={}){let b=a.usersTable??(0,dj.pgTable)("user",{id:(0,dl.text)("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),name:(0,dl.text)("name"),email:(0,dl.text)("email").unique(),emailVerified:(0,dm.timestamp)("emailVerified",{mode:"date"}),image:(0,dl.text)("image")}),c=a.accountsTable??(0,dj.pgTable)("account",{userId:(0,dl.text)("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),type:(0,dl.text)("type").$type().notNull(),provider:(0,dl.text)("provider").notNull(),providerAccountId:(0,dl.text)("providerAccountId").notNull(),refresh_token:(0,dl.text)("refresh_token"),access_token:(0,dl.text)("access_token"),expires_at:(0,di.integer)("expires_at"),token_type:(0,dl.text)("token_type"),scope:(0,dl.text)("scope"),id_token:(0,dl.text)("id_token"),session_state:(0,dl.text)("session_state")},a=>({compositePk:(0,dk.primaryKey)({columns:[a.provider,a.providerAccountId]})})),d=a.sessionsTable??(0,dj.pgTable)("session",{sessionToken:(0,dl.text)("sessionToken").primaryKey(),userId:(0,dl.text)("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),expires:(0,dm.timestamp)("expires",{mode:"date"}).notNull()}),e=a.verificationTokensTable??(0,dj.pgTable)("verificationToken",{identifier:(0,dl.text)("identifier").notNull(),token:(0,dl.text)("token").notNull(),expires:(0,dm.timestamp)("expires",{mode:"date"}).notNull()},a=>({compositePk:(0,dk.primaryKey)({columns:[a.identifier,a.token]})})),f=a.authenticatorsTable??(0,dj.pgTable)("authenticator",{credentialID:(0,dl.text)("credentialID").notNull().unique(),userId:(0,dl.text)("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),providerAccountId:(0,dl.text)("providerAccountId").notNull(),credentialPublicKey:(0,dl.text)("credentialPublicKey").notNull(),counter:(0,di.integer)("counter").notNull(),credentialDeviceType:(0,dl.text)("credentialDeviceType").notNull(),credentialBackedUp:(0,dh.boolean)("credentialBackedUp").notNull(),transports:(0,dl.text)("transports")},a=>({compositePK:(0,dk.primaryKey)({columns:[a.userId,a.credentialID]})}));return{usersTable:b,accountsTable:c,sessionsTable:d,verificationTokensTable:e,authenticatorsTable:f}}(b);return{async createUser(b){let{id:d,...e}=b,f=(0,t.getTableColumns)(c).id.hasDefault;return a.insert(c).values(f?e:{...e,id:d}).returning().then(a=>a[0])},getUser:async b=>a.select().from(c).where((0,bs.eq)(c.id,b)).then(a=>a.length>0?a[0]:null),getUserByEmail:async b=>a.select().from(c).where((0,bs.eq)(c.email,b)).then(a=>a.length>0?a[0]:null),createSession:async b=>a.insert(e).values(b).returning().then(a=>a[0]),getSessionAndUser:async b=>a.select({session:e,user:c}).from(e).where((0,bs.eq)(e.sessionToken,b)).innerJoin(c,(0,bs.eq)(c.id,e.userId)).then(a=>a.length>0?a[0]:null),async updateUser(b){if(!b.id)throw Error("No user id.");let[d]=await a.update(c).set(b).where((0,bs.eq)(c.id,b.id)).returning();if(!d)throw Error("No user found.");return d},updateSession:async b=>a.update(e).set(b).where((0,bs.eq)(e.sessionToken,b.sessionToken)).returning().then(a=>a[0]),async linkAccount(b){await a.insert(d).values(b)},async getUserByAccount(b){let e=await a.select({account:d,user:c}).from(d).innerJoin(c,(0,bs.eq)(d.userId,c.id)).where((0,bs.and)((0,bs.eq)(d.provider,b.provider),(0,bs.eq)(d.providerAccountId,b.providerAccountId))).then(a=>a[0]);return e?.user??null},async deleteSession(b){await a.delete(e).where((0,bs.eq)(e.sessionToken,b))},createVerificationToken:async b=>a.insert(f).values(b).returning().then(a=>a[0]),useVerificationToken:async b=>a.delete(f).where((0,bs.and)((0,bs.eq)(f.identifier,b.identifier),(0,bs.eq)(f.token,b.token))).returning().then(a=>a.length>0?a[0]:null),async deleteUser(b){await a.delete(c).where((0,bs.eq)(c.id,b))},async unlinkAccount(b){await a.delete(d).where((0,bs.and)((0,bs.eq)(d.provider,b.provider),(0,bs.eq)(d.providerAccountId,b.providerAccountId)))},getAccount:async(b,c)=>a.select().from(d).where((0,bs.and)((0,bs.eq)(d.provider,c),(0,bs.eq)(d.providerAccountId,b))).then(a=>a[0]??null),createAuthenticator:async b=>a.insert(g).values(b).returning().then(a=>a[0]??null),getAuthenticator:async b=>a.select().from(g).where((0,bs.eq)(g.credentialID,b)).then(a=>a[0]??null),listAuthenticatorsByUserId:async b=>a.select().from(g).where((0,bs.eq)(g.userId,b)).then(a=>a),async updateAuthenticatorCounter(b,c){let d=await a.update(g).set({counter:c}).where((0,bs.eq)(g.credentialID,b)).returning().then(a=>a[0]);if(!d)throw Error("Authenticator not found.");return d}}}(a,c);if((0,b.is)(a,dg))return function(a,b){let{usersTable:c,accountsTable:d,sessionsTable:e,verificationTokensTable:f,authenticatorsTable:g}=function(a={}){let b=a.usersTable??cC("user",{id:cz("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),name:cz("name"),email:cz("email").unique(),emailVerified:ck("emailVerified",{mode:"timestamp_ms"}),image:cz("image")}),c=a.accountsTable??cC("account",{userId:cz("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),type:cz("type").$type().notNull(),provider:cz("provider").notNull(),providerAccountId:cz("providerAccountId").notNull(),refresh_token:cz("refresh_token"),access_token:cz("access_token"),expires_at:ck("expires_at"),token_type:cz("token_type"),scope:cz("scope"),id_token:cz("id_token"),session_state:cz("session_state")},a=>({compositePk:cO({columns:[a.provider,a.providerAccountId]})})),d=a.sessionsTable??cC("session",{sessionToken:cz("sessionToken").primaryKey(),userId:cz("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),expires:ck("expires",{mode:"timestamp_ms"}).notNull()}),e=a.verificationTokensTable??cC("verificationToken",{identifier:cz("identifier").notNull(),token:cz("token").notNull(),expires:ck("expires",{mode:"timestamp_ms"}).notNull()},a=>({compositePk:cO({columns:[a.identifier,a.token]})})),f=a.authenticatorsTable??cC("authenticator",{credentialID:cz("credentialID").notNull().unique(),userId:cz("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),providerAccountId:cz("providerAccountId").notNull(),credentialPublicKey:cz("credentialPublicKey").notNull(),counter:ck("counter").notNull(),credentialDeviceType:cz("credentialDeviceType").notNull(),credentialBackedUp:ck("credentialBackedUp",{mode:"boolean"}).notNull(),transports:cz("transports")},a=>({compositePK:cO({columns:[a.userId,a.credentialID]})}));return{usersTable:b,accountsTable:c,sessionsTable:d,verificationTokensTable:e,authenticatorsTable:f}}(b);return{async createUser(b){let{id:d,...e}=b,f=(0,t.getTableColumns)(c).id.hasDefault;return a.insert(c).values(f?e:{...e,id:d}).returning().get()},getUser:async b=>await a.select().from(c).where((0,bs.eq)(c.id,b)).get()??null,getUserByEmail:async b=>await a.select().from(c).where((0,bs.eq)(c.email,b)).get()??null,createSession:async b=>a.insert(e).values(b).returning().get(),getSessionAndUser:async b=>await a.select({session:e,user:c}).from(e).where((0,bs.eq)(e.sessionToken,b)).innerJoin(c,(0,bs.eq)(c.id,e.userId)).get()??null,async updateUser(b){if(!b.id)throw Error("No user id.");let d=await a.update(c).set(b).where((0,bs.eq)(c.id,b.id)).returning().get();if(!d)throw Error("User not found.");return d},updateSession:async b=>await a.update(e).set(b).where((0,bs.eq)(e.sessionToken,b.sessionToken)).returning().get()??null,async linkAccount(b){await a.insert(d).values(b).run()},async getUserByAccount(b){let e=await a.select({account:d,user:c}).from(d).innerJoin(c,(0,bs.eq)(d.userId,c.id)).where((0,bs.and)((0,bs.eq)(d.provider,b.provider),(0,bs.eq)(d.providerAccountId,b.providerAccountId))).get();return e?.user??null},async deleteSession(b){await a.delete(e).where((0,bs.eq)(e.sessionToken,b)).run()},createVerificationToken:async b=>a.insert(f).values(b).returning().get(),useVerificationToken:async b=>await a.delete(f).where((0,bs.and)((0,bs.eq)(f.identifier,b.identifier),(0,bs.eq)(f.token,b.token))).returning().get()??null,async deleteUser(b){await a.delete(c).where((0,bs.eq)(c.id,b)).run()},async unlinkAccount(b){await a.delete(d).where((0,bs.and)((0,bs.eq)(d.provider,b.provider),(0,bs.eq)(d.providerAccountId,b.providerAccountId))).run()},getAccount:async(b,c)=>a.select().from(d).where((0,bs.and)((0,bs.eq)(d.provider,c),(0,bs.eq)(d.providerAccountId,b))).then(a=>a[0]??null),createAuthenticator:async b=>a.insert(g).values(b).returning().then(a=>a[0]??null),getAuthenticator:async b=>a.select().from(g).where((0,bs.eq)(g.credentialID,b)).then(a=>a[0]??null),listAuthenticatorsByUserId:async b=>a.select().from(g).where((0,bs.eq)(g.userId,b)).then(a=>a),async updateAuthenticatorCounter(b,c){let d=await a.update(g).set({counter:c}).where((0,bs.eq)(g.credentialID,b)).returning().then(a=>a[0]);if(!d)throw Error("Authenticator not found.");return d}}}(a,c);throw Error(`Unsupported database type (${typeof a}) in Auth.js Drizzle adapter.`)}a.s(["DrizzleAdapter",()=>dn],33957)},78255,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(a){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:a}}},13148,a=>{"use strict";var b=a.i(13552),c=a.i(89221),d=a.i(86096),e=a.i(83217),f=a.i(96178),g=a.i(57833),h=a.i(74619),i=a.i(65105),j=a.i(99450),k=a.i(31793),l=a.i(18830),m=a.i(68540);let n=(0,f.pgEnum)("project_type",["project","relationship","area"]),o=(0,f.pgEnum)("project_status",["active","on_hold","completed","archived"]),p=(0,f.pgEnum)("entry_kind",["meeting","update","decision","note","prep","reflection","self_note"]),q=(0,f.pgEnum)("commitment_direction",["i_owe","waiting_for"]),r=(0,f.pgEnum)("commitment_status",["open","done","blocked","dropped"]),s=(0,f.pgEnum)("reflection_period_type",["week","month","quarter"]),t=(0,g.pgTable)("users",{id:(0,k.uuid)("id").primaryKey().defaultRandom(),name:(0,l.varchar)("name",{length:120}),email:(0,l.varchar)("email",{length:255}).notNull().unique(),emailVerified:(0,j.timestamp)("email_verified",{withTimezone:!0}),image:(0,i.text)("image"),hashedPassword:(0,i.text)("hashed_password"),timezone:(0,l.varchar)("timezone",{length:60}).default("UTC"),locale:(0,l.varchar)("locale",{length:10}).default("en-US"),role:(0,l.varchar)("role",{length:20}).default("member"),createdAt:(0,j.timestamp)("created_at",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,j.timestamp)("updated_at",{withTimezone:!0}).notNull().defaultNow()}),u=(0,g.pgTable)("accounts",{id:(0,k.uuid)("id").primaryKey().defaultRandom(),userId:(0,k.uuid)("user_id").references(()=>t.id,{onDelete:"cascade"}).notNull(),provider:(0,l.varchar)("provider",{length:255}).notNull(),providerAccountId:(0,l.varchar)("provider_account_id",{length:255}).notNull(),type:(0,l.varchar)("type",{length:255}).notNull(),refreshToken:(0,i.text)("refresh_token"),accessToken:(0,i.text)("access_token"),expiresAt:(0,d.integer)("expires_at"),tokenType:(0,l.varchar)("token_type",{length:50}),scope:(0,i.text)("scope"),idToken:(0,i.text)("id_token"),sessionState:(0,i.text)("session_state")},a=>({providerIdx:(0,c.uniqueIndex)("accounts_provider_idx").on(a.provider,a.providerAccountId)})),v=(0,g.pgTable)("sessions",{id:(0,k.uuid)("id").primaryKey().defaultRandom(),userId:(0,k.uuid)("user_id").references(()=>t.id,{onDelete:"cascade"}).notNull(),sessionToken:(0,i.text)("session_token").notNull(),expires:(0,j.timestamp)("expires",{withTimezone:!0}).notNull()},a=>({sessionTokenIdx:(0,c.uniqueIndex)("sessions_token_idx").on(a.sessionToken)})),w=(0,g.pgTable)("verification_tokens",{identifier:(0,l.varchar)("identifier",{length:255}).notNull(),token:(0,l.varchar)("token",{length:255}).notNull(),expires:(0,j.timestamp)("expires",{withTimezone:!0}).notNull()},a=>({compositePk:(0,h.primaryKey)({columns:[a.identifier,a.token]})})),x=(0,g.pgTable)("projects",{id:(0,k.uuid)("id").primaryKey().defaultRandom(),userId:(0,k.uuid)("user_id").references(()=>t.id,{onDelete:"cascade"}).notNull(),name:(0,l.varchar)("name",{length:180}).notNull(),description:(0,i.text)("description"),type:n("type").default("project").notNull(),status:o("status").default("active").notNull(),priority:(0,d.integer)("priority").default(3).notNull(),ownerNotes:(0,i.text)("owner_notes"),lastActiveAt:(0,j.timestamp)("last_active_at",{withTimezone:!0}).defaultNow(),createdAt:(0,j.timestamp)("created_at",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,j.timestamp)("updated_at",{withTimezone:!0}).notNull().defaultNow()},a=>({projectUserIdx:(0,c.index)("projects_user_idx").on(a.userId,a.lastActiveAt),projectStatusIdx:(0,c.index)("projects_status_idx").on(a.status)})),y=(0,g.pgTable)("project_entries",{id:(0,k.uuid)("id").primaryKey().defaultRandom(),userId:(0,k.uuid)("user_id").references(()=>t.id,{onDelete:"cascade"}).notNull(),projectId:(0,k.uuid)("project_id").references(()=>x.id,{onDelete:"cascade"}).notNull(),kind:p("kind").default("meeting").notNull(),title:(0,l.varchar)("title",{length:200}).notNull(),occurredAt:(0,j.timestamp)("occurred_at",{withTimezone:!0}).notNull().defaultNow(),rawContent:(0,i.text)("raw_content"),aiSummary:(0,i.text)("ai_summary"),decisions:(0,i.text)("decisions"),aiSuggestedActions:(0,e.jsonb)("ai_suggested_actions").$type(),isDecision:(0,b.boolean)("is_decision").default(!1).notNull(),createdAt:(0,j.timestamp)("created_at",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,j.timestamp)("updated_at",{withTimezone:!0}).notNull().defaultNow()},a=>({entriesProjectIdx:(0,c.index)("entries_project_idx").on(a.projectId,a.occurredAt),entriesUserIdx:(0,c.index)("entries_user_idx").on(a.userId,a.kind)})),z=(0,g.pgTable)("commitments",{id:(0,k.uuid)("id").primaryKey().defaultRandom(),userId:(0,k.uuid)("user_id").references(()=>t.id,{onDelete:"cascade"}).notNull(),projectId:(0,k.uuid)("project_id").references(()=>x.id,{onDelete:"cascade"}).notNull(),entryId:(0,k.uuid)("entry_id").references(()=>y.id,{onDelete:"set null"}),title:(0,l.varchar)("title",{length:200}).notNull(),direction:q("direction").default("i_owe").notNull(),status:r("status").default("open").notNull(),counterparty:(0,l.varchar)("counterparty",{length:180}),dueDate:(0,j.timestamp)("due_date",{withTimezone:!0}),importance:(0,d.integer)("importance").default(3).notNull(),urgency:(0,d.integer)("urgency").default(3).notNull(),notes:(0,i.text)("notes"),aiGenerated:(0,b.boolean)("ai_generated").default(!1).notNull(),completedAt:(0,j.timestamp)("completed_at",{withTimezone:!0}),createdAt:(0,j.timestamp)("created_at",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,j.timestamp)("updated_at",{withTimezone:!0}).notNull().defaultNow()},a=>({commitmentsDirectionIdx:(0,c.index)("commitments_direction_idx").on(a.userId,a.direction,a.status),commitmentsDueDateIdx:(0,c.index)("commitments_due_idx").on(a.userId,a.dueDate)})),A=(0,g.pgTable)("reflections",{id:(0,k.uuid)("id").primaryKey().defaultRandom(),userId:(0,k.uuid)("user_id").references(()=>t.id,{onDelete:"cascade"}).notNull(),periodType:s("period_type").notNull(),periodStart:(0,j.timestamp)("period_start",{withTimezone:!0}).notNull(),periodEnd:(0,j.timestamp)("period_end",{withTimezone:!0}).notNull(),stats:(0,e.jsonb)("stats").$type().notNull(),questionsAndAnswers:(0,e.jsonb)("questions_answers").$type().notNull(),aiQuestions:(0,e.jsonb)("ai_questions").$type().notNull(),createdAt:(0,j.timestamp)("created_at",{withTimezone:!0}).notNull().defaultNow()},a=>({reflectionsPeriodIdx:(0,c.index)("reflections_period_idx").on(a.userId,a.periodType,a.periodStart)})),B=(0,m.relations)(t,({many:a})=>({projects:a(x),entries:a(y),commitments:a(z),reflections:a(A)})),C=(0,m.relations)(x,({many:a})=>({entries:a(y),commitments:a(z)})),D=(0,m.relations)(y,({one:a,many:b})=>({project:a(x,{fields:[y.projectId],references:[x.id]}),commitments:b(z)})),E=(0,m.relations)(z,({one:a})=>({project:a(x,{fields:[z.projectId],references:[x.id]}),entry:a(y,{fields:[z.entryId],references:[y.id]})})),F=(0,m.relations)(A,({one:a})=>({user:a(t,{fields:[A.userId],references:[t.id]})}));a.s(["accounts",0,u,"commitmentDirectionEnum",0,q,"commitmentRelations",0,E,"commitmentStatusEnum",0,r,"commitments",0,z,"entryKindEnum",0,p,"entryRelations",0,D,"projectEntries",0,y,"projectRelations",0,C,"projectStatusEnum",0,o,"projectTypeEnum",0,n,"projects",0,x,"reflectionPeriodEnum",0,s,"reflectionRelations",0,F,"reflections",0,A,"sessions",0,v,"userRelations",0,B,"users",0,t,"verificationTokens",0,w])},42116,a=>{"use strict";var b,c,d,e,f,g,h=Object.create,i=Object.defineProperty,j=Object.getOwnPropertyDescriptor,k=Object.getOwnPropertyNames,l=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty,n=(a,b)=>i(a,"name",{value:b,configurable:!0}),o=(a,b)=>()=>(a&&(b=a(a=0)),b),p=(a,b)=>()=>(b||a((b={exports:{}}).exports,b),b.exports),q=(a,b)=>{for(var c in b)i(a,c,{get:b[c],enumerable:!0})},r=(a,b,c,d)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let e of k(b))m.call(a,e)||e===c||i(a,e,{get:()=>b[e],enumerable:!(d=j(b,e))||d.enumerable});return a},s=(a,b,c)=>(c=null!=a?h(l(a)):{},r(!b&&a&&a.__esModule?c:i(c,"default",{value:a,enumerable:!0}),a)),t=a=>r(i({},"__esModule",{value:!0}),a),u=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?i(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c},v=p(a=>{y(),a.byteLength=i,a.toByteArray=k,a.fromByteArray=o;var b,c,d=[],e=[],f="u">typeof Uint8Array?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(b=0,c=g.length;b<c;++b)d[b]=g[b],e[g.charCodeAt(b)]=b;function h(a){var b=a.length;if(b%4>0)throw Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");-1===c&&(c=b);var d=c===b?0:4-c%4;return[c,d]}function i(a){var b=h(a),c=b[0],d=b[1];return(c+d)*3/4-d}function j(a,b,c){return(b+c)*3/4-c}function k(a){var b,c,d=h(a),g=d[0],i=d[1],k=new f(j(a,g,i)),l=0,m=i>0?g-4:g;for(c=0;c<m;c+=4)b=e[a.charCodeAt(c)]<<18|e[a.charCodeAt(c+1)]<<12|e[a.charCodeAt(c+2)]<<6|e[a.charCodeAt(c+3)],k[l++]=b>>16&255,k[l++]=b>>8&255,k[l++]=255&b;return 2===i&&(b=e[a.charCodeAt(c)]<<2|e[a.charCodeAt(c+1)]>>4,k[l++]=255&b),1===i&&(b=e[a.charCodeAt(c)]<<10|e[a.charCodeAt(c+1)]<<4|e[a.charCodeAt(c+2)]>>2,k[l++]=b>>8&255,k[l++]=255&b),k}function l(a){return d[a>>18&63]+d[a>>12&63]+d[a>>6&63]+d[63&a]}function m(a,b,c){for(var d=[],e=b;e<c;e+=3)d.push(l((a[e]<<16&0xff0000)+(a[e+1]<<8&65280)+(255&a[e+2])));return d.join("")}function o(a){for(var b,c=a.length,e=c%3,f=[],g=0,h=c-e;g<h;g+=16383)f.push(m(a,g,g+16383>h?h:g+16383));return 1===e?f.push(d[(b=a[c-1])>>2]+d[b<<4&63]+"=="):2===e&&f.push(d[(b=(a[c-2]<<8)+a[c-1])>>10]+d[b>>4&63]+d[b<<2&63]+"="),f.join("")}e[45]=62,e[95]=63,n(h,"getLens"),n(i,"byteLength"),n(j,"_byteLength"),n(k,"toByteArray"),n(l,"tripletToBase64"),n(m,"encodeChunk"),n(o,"fromByteArray")}),w=p(a=>{y(),a.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},a.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=5960464477539062e-23*(23===e),n=d?0:f-1,o=d?1:-1,p=+(b<0||0===b&&1/b<0);for(isNaN(b=Math.abs(b))||b===1/0?(h=+!!isNaN(b),g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),g+l>=1?b+=m/i:b+=m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}}),x=p(a=>{y();var b=v(),c=w(),d="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function e(){try{let a=new Uint8Array(1),b={foo:n(function(){return 42},"foo")};return Object.setPrototypeOf(b,Uint8Array.prototype),Object.setPrototypeOf(a,b),42===a.foo()}catch{return!1}}function f(a){if(a>0x7fffffff)throw RangeError('The value "'+a+'" is invalid for option "size"');let b=new Uint8Array(a);return Object.setPrototypeOf(b,g.prototype),b}function g(a,b,c){if("number"==typeof a){if("string"==typeof b)throw TypeError('The "string" argument must be of type string. Received type number');return k(a)}return h(a,b,c)}function h(a,b,c){if("string"==typeof a)return l(a,b);if(ArrayBuffer.isView(a))return o(a);if(null==a)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(ag(a,ArrayBuffer)||a&&ag(a.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(ag(a,SharedArrayBuffer)||a&&ag(a.buffer,SharedArrayBuffer)))return p(a,b,c);if("number"==typeof a)throw TypeError('The "value" argument must not be of type number. Received type number');let d=a.valueOf&&a.valueOf();if(null!=d&&d!==a)return g.from(d,b,c);let e=q(a);if(e)return e;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return g.from(a[Symbol.toPrimitive]("string"),b,c);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function i(a){if("number"!=typeof a)throw TypeError('"size" argument must be of type number');if(a<0)throw RangeError('The value "'+a+'" is invalid for option "size"')}function j(a,b,c){return i(a),a<=0?f(a):void 0!==b?"string"==typeof c?f(a).fill(b,c):f(a).fill(b):f(a)}function k(a){return i(a),f(a<0?0:0|r(a))}function l(a,b){if(("string"!=typeof b||""===b)&&(b="utf8"),!g.isEncoding(b))throw TypeError("Unknown encoding: "+b);let c=0|t(a,b),d=f(c),e=d.write(a,b);return e!==c&&(d=d.slice(0,e)),d}function m(a){let b=a.length<0?0:0|r(a.length),c=f(b);for(let d=0;d<b;d+=1)c[d]=255&a[d];return c}function o(a){if(ag(a,Uint8Array)){let b=new Uint8Array(a);return p(b.buffer,b.byteOffset,b.byteLength)}return m(a)}function p(a,b,c){let d;if(b<0||a.byteLength<b)throw RangeError('"offset" is outside of buffer bounds');if(a.byteLength<b+(c||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(d=void 0===b&&void 0===c?new Uint8Array(a):void 0===c?new Uint8Array(a,b):new Uint8Array(a,b,c),g.prototype),d}function q(a){if(g.isBuffer(a)){let b=0|r(a.length),c=f(b);return 0===c.length||a.copy(c,0,0,b),c}return void 0!==a.length?"number"!=typeof a.length||ah(a.length)?f(0):m(a):"Buffer"===a.type&&Array.isArray(a.data)?m(a.data):void 0}function r(a){if(a>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|a}function s(a){return+a!=a&&(a=0),g.alloc(+a)}function t(a,b){if(g.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||ag(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);let c=a.length,d=arguments.length>2&&!0===arguments[2];if(!d&&0===c)return 0;let e=!1;for(;;)switch(b){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return ab(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return ae(a).length;default:if(e)return d?-1:ab(a).length;b=(""+b).toLowerCase(),e=!0}}function u(a,b,c){let d=!1;if((void 0===b||b<0)&&(b=0),b>this.length||((void 0===c||c>this.length)&&(c=this.length),c<=0)||(c>>>=0)<=(b>>>=0))return"";for(a||(a="utf8");;)switch(a){case"hex":return L(this,b,c);case"utf8":case"utf-8":return H(this,b,c);case"ascii":return J(this,b,c);case"latin1":case"binary":return K(this,b,c);case"base64":return G(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,b,c);default:if(d)throw TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function x(a,b,c){let d=a[b];a[b]=a[c],a[c]=d}function z(a,b,c,d,e){if(0===a.length)return -1;if("string"==typeof c?(d=c,c=0):c>0x7fffffff?c=0x7fffffff:c<-0x80000000&&(c=-0x80000000),ah(c*=1)&&(c=e?0:a.length-1),c<0&&(c=a.length+c),c>=a.length){if(e)return -1;c=a.length-1}else if(c<0)if(!e)return -1;else c=0;if("string"==typeof b&&(b=g.from(b,d)),g.isBuffer(b))return 0===b.length?-1:A(a,b,c,d,e);if("number"==typeof b)return b&=255,"function"==typeof Uint8Array.prototype.indexOf?e?Uint8Array.prototype.indexOf.call(a,b,c):Uint8Array.prototype.lastIndexOf.call(a,b,c):A(a,[b],c,d,e);throw TypeError("val must be string, number or Buffer")}function A(a,b,c,d,e){let f,g=1,h=a.length,i=b.length;if(void 0!==d&&("ucs2"===(d=String(d).toLowerCase())||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return -1;g=2,h/=2,i/=2,c/=2}function j(a,b){return 1===g?a[b]:a.readUInt16BE(b*g)}if(n(j,"read"),e){let d=-1;for(f=c;f<h;f++)if(j(a,f)===j(b,-1===d?0:f-d)){if(-1===d&&(d=f),f-d+1===i)return d*g}else -1!==d&&(f-=f-d),d=-1}else for(c+i>h&&(c=h-i),f=c;f>=0;f--){let c=!0;for(let d=0;d<i;d++)if(j(a,f+d)!==j(b,d)){c=!1;break}if(c)return f}return -1}function B(a,b,c,d){let e;c=Number(c)||0;let f=a.length-c;d?(d=Number(d))>f&&(d=f):d=f;let g=b.length;for(d>g/2&&(d=g/2),e=0;e<d;++e){let d=parseInt(b.substr(2*e,2),16);if(ah(d))break;a[c+e]=d}return e}function C(a,b,c,d){return af(ab(b,a.length-c),a,c,d)}function D(a,b,c,d){return af(ac(b),a,c,d)}function E(a,b,c,d){return af(ae(b),a,c,d)}function F(a,b,c,d){return af(ad(b,a.length-c),a,c,d)}function G(a,c,d){return 0===c&&d===a.length?b.fromByteArray(a):b.fromByteArray(a.slice(c,d))}function H(a,b,c){c=Math.min(a.length,c);let d=[],e=b;for(;e<c;){let b=a[e],f=null,g=b>239?4:b>223?3:b>191?2:1;if(e+g<=c){let c,d,h,i;switch(g){case 1:b<128&&(f=b);break;case 2:(192&(c=a[e+1]))==128&&(i=(31&b)<<6|63&c)>127&&(f=i);break;case 3:c=a[e+1],d=a[e+2],(192&c)==128&&(192&d)==128&&(i=(15&b)<<12|(63&c)<<6|63&d)>2047&&(i<55296||i>57343)&&(f=i);break;case 4:c=a[e+1],d=a[e+2],h=a[e+3],(192&c)==128&&(192&d)==128&&(192&h)==128&&(i=(15&b)<<18|(63&c)<<12|(63&d)<<6|63&h)>65535&&i<1114112&&(f=i)}}null===f?(f=65533,g=1):f>65535&&(f-=65536,d.push(f>>>10&1023|55296),f=56320|1023&f),d.push(f),e+=g}return I(d)}function I(a){let b=a.length;if(b<=4096)return String.fromCharCode.apply(String,a);let c="",d=0;for(;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=4096));return c}function J(a,b,c){let d="";c=Math.min(a.length,c);for(let e=b;e<c;++e)d+=String.fromCharCode(127&a[e]);return d}function K(a,b,c){let d="";c=Math.min(a.length,c);for(let e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}function L(a,b,c){let d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);let e="";for(let d=b;d<c;++d)e+=ai[a[d]];return e}function M(a,b,c){let d=a.slice(b,c),e="";for(let a=0;a<d.length-1;a+=2)e+=String.fromCharCode(d[a]+256*d[a+1]);return e}function N(a,b,c){if(a%1!=0||a<0)throw RangeError("offset is not uint");if(a+b>c)throw RangeError("Trying to access beyond buffer length")}function O(a,b,c,d,e,f){if(!g.isBuffer(a))throw TypeError('"buffer" argument must be a Buffer instance');if(b>e||b<f)throw RangeError('"value" argument is out of bounds');if(c+d>a.length)throw RangeError("Index out of range")}function P(a,b,c,d,e){Y(b,d,e,a,c,7);let f=Number(b&BigInt(0xffffffff));a[c++]=f,f>>=8,a[c++]=f,f>>=8,a[c++]=f,f>>=8,a[c++]=f;let g=Number(b>>BigInt(32)&BigInt(0xffffffff));return a[c++]=g,g>>=8,a[c++]=g,g>>=8,a[c++]=g,g>>=8,a[c++]=g,c}function Q(a,b,c,d,e){Y(b,d,e,a,c,7);let f=Number(b&BigInt(0xffffffff));a[c+7]=f,f>>=8,a[c+6]=f,f>>=8,a[c+5]=f,f>>=8,a[c+4]=f;let g=Number(b>>BigInt(32)&BigInt(0xffffffff));return a[c+3]=g,g>>=8,a[c+2]=g,g>>=8,a[c+1]=g,g>>=8,a[c]=g,c+8}function R(a,b,c,d,e,f){if(c+d>a.length||c<0)throw RangeError("Index out of range")}function S(a,b,d,e,f){return b*=1,d>>>=0,f||R(a,b,d,4,34028234663852886e22,-34028234663852886e22),c.write(a,b,d,e,23,4),d+4}function T(a,b,d,e,f){return b*=1,d>>>=0,f||R(a,b,d,8,17976931348623157e292,-17976931348623157e292),c.write(a,b,d,e,52,8),d+8}a.Buffer=g,a.SlowBuffer=s,a.INSPECT_MAX_BYTES=50,a.kMaxLength=0x7fffffff,g.TYPED_ARRAY_SUPPORT=e(),!g.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),n(e,"typedArraySupport"),Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:n(function(){if(g.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:n(function(){if(g.isBuffer(this))return this.byteOffset},"get")}),n(f,"createBuffer"),n(g,"Buffer"),g.poolSize=8192,n(h,"from"),g.from=function(a,b,c){return h(a,b,c)},Object.setPrototypeOf(g.prototype,Uint8Array.prototype),Object.setPrototypeOf(g,Uint8Array),n(i,"assertSize"),n(j,"alloc"),g.alloc=function(a,b,c){return j(a,b,c)},n(k,"allocUnsafe"),g.allocUnsafe=function(a){return k(a)},g.allocUnsafeSlow=function(a){return k(a)},n(l,"fromString"),n(m,"fromArrayLike"),n(o,"fromArrayView"),n(p,"fromArrayBuffer"),n(q,"fromObject"),n(r,"checked"),n(s,"SlowBuffer"),g.isBuffer=n(function(a){return null!=a&&!0===a._isBuffer&&a!==g.prototype},"isBuffer"),g.compare=n(function(a,b){if(ag(a,Uint8Array)&&(a=g.from(a,a.offset,a.byteLength)),ag(b,Uint8Array)&&(b=g.from(b,b.offset,b.byteLength)),!g.isBuffer(a)||!g.isBuffer(b))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===b)return 0;let c=a.length,d=b.length;for(let e=0,f=Math.min(c,d);e<f;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return c<d?-1:+(d<c)},"compare"),g.isEncoding=n(function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),g.concat=n(function(a,b){let c;if(!Array.isArray(a))throw TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return g.alloc(0);if(void 0===b)for(b=0,c=0;c<a.length;++c)b+=a[c].length;let d=g.allocUnsafe(b),e=0;for(c=0;c<a.length;++c){let b=a[c];if(ag(b,Uint8Array))e+b.length>d.length?(g.isBuffer(b)||(b=g.from(b)),b.copy(d,e)):Uint8Array.prototype.set.call(d,b,e);else if(g.isBuffer(b))b.copy(d,e);else throw TypeError('"list" argument must be an Array of Buffers');e+=b.length}return d},"concat"),n(t,"byteLength"),g.byteLength=t,n(u,"slowToString"),g.prototype._isBuffer=!0,n(x,"swap"),g.prototype.swap16=n(function(){let a=this.length;if(a%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let b=0;b<a;b+=2)x(this,b,b+1);return this},"swap16"),g.prototype.swap32=n(function(){let a=this.length;if(a%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let b=0;b<a;b+=4)x(this,b,b+3),x(this,b+1,b+2);return this},"swap32"),g.prototype.swap64=n(function(){let a=this.length;if(a%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let b=0;b<a;b+=8)x(this,b,b+7),x(this,b+1,b+6),x(this,b+2,b+5),x(this,b+3,b+4);return this},"swap64"),g.prototype.toString=n(function(){let a=this.length;return 0===a?"":0==arguments.length?H(this,0,a):u.apply(this,arguments)},"toString"),g.prototype.toLocaleString=g.prototype.toString,g.prototype.equals=n(function(a){if(!g.isBuffer(a))throw TypeError("Argument must be a Buffer");return this===a||0===g.compare(this,a)},"equals"),g.prototype.inspect=n(function(){let b="",c=a.INSPECT_MAX_BYTES;return b=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(b+=" ... "),"<Buffer "+b+">"},"inspect"),d&&(g.prototype[d]=g.prototype.inspect),g.prototype.compare=n(function(a,b,c,d,e){if(ag(a,Uint8Array)&&(a=g.from(a,a.offset,a.byteLength)),!g.isBuffer(a))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(void 0===b&&(b=0),void 0===c&&(c=a?a.length:0),void 0===d&&(d=0),void 0===e&&(e=this.length),b<0||c>a.length||d<0||e>this.length)throw RangeError("out of range index");if(d>=e&&b>=c)return 0;if(d>=e)return -1;if(b>=c)return 1;if(b>>>=0,c>>>=0,d>>>=0,e>>>=0,this===a)return 0;let f=e-d,h=c-b,i=Math.min(f,h),j=this.slice(d,e),k=a.slice(b,c);for(let a=0;a<i;++a)if(j[a]!==k[a]){f=j[a],h=k[a];break}return f<h?-1:+(h<f)},"compare"),n(z,"bidirectionalIndexOf"),n(A,"arrayIndexOf"),g.prototype.includes=n(function(a,b,c){return -1!==this.indexOf(a,b,c)},"includes"),g.prototype.indexOf=n(function(a,b,c){return z(this,a,b,c,!0)},"indexOf"),g.prototype.lastIndexOf=n(function(a,b,c){return z(this,a,b,c,!1)},"lastIndexOf"),n(B,"hexWrite"),n(C,"utf8Write"),n(D,"asciiWrite"),n(E,"base64Write"),n(F,"ucs2Write"),g.prototype.write=n(function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b>>>=0,isFinite(c)?(c>>>=0,void 0===d&&(d="utf8")):(d=c,c=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(c<0||b<0)||b>this.length)throw RangeError("Attempt to write outside buffer bounds");d||(d="utf8");let f=!1;for(;;)switch(d){case"hex":return B(this,a,b,c);case"utf8":case"utf-8":return C(this,a,b,c);case"ascii":case"latin1":case"binary":return D(this,a,b,c);case"base64":return E(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,a,b,c);default:if(f)throw TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},"write"),g.prototype.toJSON=n(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON"),n(G,"base64Slice"),n(H,"utf8Slice"),n(I,"decodeCodePointsArray"),n(J,"asciiSlice"),n(K,"latin1Slice"),n(L,"hexSlice"),n(M,"utf16leSlice"),g.prototype.slice=n(function(a,b){let c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c)<0&&(a=0):a>c&&(a=c),b<0?(b+=c)<0&&(b=0):b>c&&(b=c),b<a&&(b=a);let d=this.subarray(a,b);return Object.setPrototypeOf(d,g.prototype),d},"slice"),n(N,"checkOffset"),g.prototype.readUintLE=g.prototype.readUIntLE=n(function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=this[a],e=1,f=0;for(;++f<b&&(e*=256);)d+=this[a+f]*e;return d},"readUIntLE"),g.prototype.readUintBE=g.prototype.readUIntBE=n(function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=this[a+--b],e=1;for(;b>0&&(e*=256);)d+=this[a+--b]*e;return d},"readUIntBE"),g.prototype.readUint8=g.prototype.readUInt8=n(function(a,b){return a>>>=0,b||N(a,1,this.length),this[a]},"readUInt8"),g.prototype.readUint16LE=g.prototype.readUInt16LE=n(function(a,b){return a>>>=0,b||N(a,2,this.length),this[a]|this[a+1]<<8},"readUInt16LE"),g.prototype.readUint16BE=g.prototype.readUInt16BE=n(function(a,b){return a>>>=0,b||N(a,2,this.length),this[a]<<8|this[a+1]},"readUInt16BE"),g.prototype.readUint32LE=g.prototype.readUInt32LE=n(function(a,b){return a>>>=0,b||N(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+0x1000000*this[a+3]},"readUInt32LE"),g.prototype.readUint32BE=g.prototype.readUInt32BE=n(function(a,b){return a>>>=0,b||N(a,4,this.length),0x1000000*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},"readUInt32BE"),g.prototype.readBigUInt64LE=aj(n(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b||void 0===c)&&$(a,this.length-8);let d=b+256*this[++a]+65536*this[++a]+0x1000000*this[++a],e=this[++a]+256*this[++a]+65536*this[++a]+0x1000000*c;return BigInt(d)+(BigInt(e)<<BigInt(32))},"readBigUInt64LE")),g.prototype.readBigUInt64BE=aj(n(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];(void 0===b||void 0===c)&&$(a,this.length-8);let d=0x1000000*b+65536*this[++a]+256*this[++a]+this[++a],e=0x1000000*this[++a]+65536*this[++a]+256*this[++a]+c;return(BigInt(d)<<BigInt(32))+BigInt(e)},"readBigUInt64BE")),g.prototype.readIntLE=n(function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=this[a],e=1,f=0;for(;++f<b&&(e*=256);)d+=this[a+f]*e;return d>=(e*=128)&&(d-=Math.pow(2,8*b)),d},"readIntLE"),g.prototype.readIntBE=n(function(a,b,c){a>>>=0,b>>>=0,c||N(a,b,this.length);let d=b,e=1,f=this[a+--d];for(;d>0&&(e*=256);)f+=this[a+--d]*e;return f>=(e*=128)&&(f-=Math.pow(2,8*b)),f},"readIntBE"),g.prototype.readInt8=n(function(a,b){return a>>>=0,b||N(a,1,this.length),128&this[a]?-((255-this[a]+1)*1):this[a]},"readInt8"),g.prototype.readInt16LE=n(function(a,b){a>>>=0,b||N(a,2,this.length);let c=this[a]|this[a+1]<<8;return 32768&c?0xffff0000|c:c},"readInt16LE"),g.prototype.readInt16BE=n(function(a,b){a>>>=0,b||N(a,2,this.length);let c=this[a+1]|this[a]<<8;return 32768&c?0xffff0000|c:c},"readInt16BE"),g.prototype.readInt32LE=n(function(a,b){return a>>>=0,b||N(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},"readInt32LE"),g.prototype.readInt32BE=n(function(a,b){return a>>>=0,b||N(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},"readInt32BE"),g.prototype.readBigInt64LE=aj(n(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];return(void 0===b||void 0===c)&&$(a,this.length-8),(BigInt(this[a+4]+256*this[a+5]+65536*this[a+6]+(c<<24))<<BigInt(32))+BigInt(b+256*this[++a]+65536*this[++a]+0x1000000*this[++a])},"readBigInt64LE")),g.prototype.readBigInt64BE=aj(n(function(a){Z(a>>>=0,"offset");let b=this[a],c=this[a+7];return(void 0===b||void 0===c)&&$(a,this.length-8),(BigInt((b<<24)+65536*this[++a]+256*this[++a]+this[++a])<<BigInt(32))+BigInt(0x1000000*this[++a]+65536*this[++a]+256*this[++a]+c)},"readBigInt64BE")),g.prototype.readFloatLE=n(function(a,b){return a>>>=0,b||N(a,4,this.length),c.read(this,a,!0,23,4)},"readFloatLE"),g.prototype.readFloatBE=n(function(a,b){return a>>>=0,b||N(a,4,this.length),c.read(this,a,!1,23,4)},"readFloatBE"),g.prototype.readDoubleLE=n(function(a,b){return a>>>=0,b||N(a,8,this.length),c.read(this,a,!0,52,8)},"readDoubleLE"),g.prototype.readDoubleBE=n(function(a,b){return a>>>=0,b||N(a,8,this.length),c.read(this,a,!1,52,8)},"readDoubleBE"),n(O,"checkInt"),g.prototype.writeUintLE=g.prototype.writeUIntLE=n(function(a,b,c,d){if(a*=1,b>>>=0,c>>>=0,!d){let d=Math.pow(2,8*c)-1;O(this,a,b,c,d,0)}let e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},"writeUIntLE"),g.prototype.writeUintBE=g.prototype.writeUIntBE=n(function(a,b,c,d){if(a*=1,b>>>=0,c>>>=0,!d){let d=Math.pow(2,8*c)-1;O(this,a,b,c,d,0)}let e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},"writeUIntBE"),g.prototype.writeUint8=g.prototype.writeUInt8=n(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,1,255,0),this[b]=255&a,b+1},"writeUInt8"),g.prototype.writeUint16LE=g.prototype.writeUInt16LE=n(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,2,65535,0),this[b]=255&a,this[b+1]=a>>>8,b+2},"writeUInt16LE"),g.prototype.writeUint16BE=g.prototype.writeUInt16BE=n(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,2,65535,0),this[b]=a>>>8,this[b+1]=255&a,b+2},"writeUInt16BE"),g.prototype.writeUint32LE=g.prototype.writeUInt32LE=n(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,4,0xffffffff,0),this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a,b+4},"writeUInt32LE"),g.prototype.writeUint32BE=g.prototype.writeUInt32BE=n(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,4,0xffffffff,0),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},"writeUInt32BE"),n(P,"wrtBigUInt64LE"),n(Q,"wrtBigUInt64BE"),g.prototype.writeBigUInt64LE=aj(n(function(a,b=0){return P(this,a,b,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),g.prototype.writeBigUInt64BE=aj(n(function(a,b=0){return Q(this,a,b,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),g.prototype.writeIntLE=n(function(a,b,c,d){if(a*=1,b>>>=0,!d){let d=Math.pow(2,8*c-1);O(this,a,b,c,d-1,-d)}let e=0,f=1,g=0;for(this[b]=255&a;++e<c&&(f*=256);)a<0&&0===g&&0!==this[b+e-1]&&(g=1),this[b+e]=(a/f|0)-g&255;return b+c},"writeIntLE"),g.prototype.writeIntBE=n(function(a,b,c,d){if(a*=1,b>>>=0,!d){let d=Math.pow(2,8*c-1);O(this,a,b,c,d-1,-d)}let e=c-1,f=1,g=0;for(this[b+e]=255&a;--e>=0&&(f*=256);)a<0&&0===g&&0!==this[b+e+1]&&(g=1),this[b+e]=(a/f|0)-g&255;return b+c},"writeIntBE"),g.prototype.writeInt8=n(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,1,127,-128),a<0&&(a=255+a+1),this[b]=255&a,b+1},"writeInt8"),g.prototype.writeInt16LE=n(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,2,32767,-32768),this[b]=255&a,this[b+1]=a>>>8,b+2},"writeInt16LE"),g.prototype.writeInt16BE=n(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,2,32767,-32768),this[b]=a>>>8,this[b+1]=255&a,b+2},"writeInt16BE"),g.prototype.writeInt32LE=n(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,4,0x7fffffff,-0x80000000),this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24,b+4},"writeInt32LE"),g.prototype.writeInt32BE=n(function(a,b,c){return a*=1,b>>>=0,c||O(this,a,b,4,0x7fffffff,-0x80000000),a<0&&(a=0xffffffff+a+1),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},"writeInt32BE"),g.prototype.writeBigInt64LE=aj(n(function(a,b=0){return P(this,a,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),g.prototype.writeBigInt64BE=aj(n(function(a,b=0){return Q(this,a,b,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE")),n(R,"checkIEEE754"),n(S,"writeFloat"),g.prototype.writeFloatLE=n(function(a,b,c){return S(this,a,b,!0,c)},"writeFloatLE"),g.prototype.writeFloatBE=n(function(a,b,c){return S(this,a,b,!1,c)},"writeFloatBE"),n(T,"writeDouble"),g.prototype.writeDoubleLE=n(function(a,b,c){return T(this,a,b,!0,c)},"writeDoubleLE"),g.prototype.writeDoubleBE=n(function(a,b,c){return T(this,a,b,!1,c)},"writeDoubleBE"),g.prototype.copy=n(function(a,b,c,d){if(!g.isBuffer(a))throw TypeError("argument should be a Buffer");if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c||0===a.length||0===this.length)return 0;if(b<0)throw RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw RangeError("Index out of range");if(d<0)throw RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);let e=d-c;return this===a&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(b,c,d):Uint8Array.prototype.set.call(a,this.subarray(c,d),b),e},"copy"),g.prototype.fill=n(function(a,b,c,d){let e;if("string"==typeof a){if("string"==typeof b?(d=b,b=0,c=this.length):"string"==typeof c&&(d=c,c=this.length),void 0!==d&&"string"!=typeof d)throw TypeError("encoding must be a string");if("string"==typeof d&&!g.isEncoding(d))throw TypeError("Unknown encoding: "+d);if(1===a.length){let b=a.charCodeAt(0);("utf8"===d&&b<128||"latin1"===d)&&(a=b)}}else"number"==typeof a?a&=255:"boolean"==typeof a&&(a=Number(a));if(b<0||this.length<b||this.length<c)throw RangeError("Out of range index");if(c<=b)return this;if(b>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0),"number"==typeof a)for(e=b;e<c;++e)this[e]=a;else{let f=g.isBuffer(a)?a:g.from(a,d),h=f.length;if(0===h)throw TypeError('The value "'+a+'" is invalid for argument "value"');for(e=0;e<c-b;++e)this[e+b]=f[e%h]}return this},"fill");var U={};function V(a,b,c){var d;U[a]=(n(d=class extends c{constructor(){super(),Object.defineProperty(this,"message",{value:b.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${a}]`,this.stack,delete this.name}get code(){return a}set code(a){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:a,writable:!0})}toString(){return`${this.name} [${a}\
]: ${this.message}`}},"NodeError"),d)}function W(a){let b="",c=a.length,d=+("-"===a[0]);for(;c>=d+4;c-=3)b=`\
_${a.slice(c-3,c)}${b}`;return`${a.slice(0,c)}${b}`}function X(a,b,c){Z(b,"offset"),(void 0===a[b]||void 0===a[b+c])&&$(b,a.length-(c+1))}function Y(a,b,c,d,e,f){if(a>c||a<b){let d="bigint"==typeof b?"n":"",e;throw e=f>3?0===b||b===BigInt(0)?`>= 0${d} and < 2${d}\
 ** ${(f+1)*8}${d}`:`>= -(2${d} ** ${(f+1)*8-1}${d}) and < 2 ** ${(f+1)*8-1}${d}`:`>= ${b}${d} a\
nd <= ${c}${d}`,new U.ERR_OUT_OF_RANGE("value",e,a)}X(d,e,f)}function Z(a,b){if("number"!=typeof a)throw new U.ERR_INVALID_ARG_TYPE(b,"number",a)}function $(a,b,c){throw Math.floor(a)!==a?(Z(a,c),new U.ERR_OUT_OF_RANGE(c||"offset","an integer",a)):b<0?new U.ERR_BUFFER_OUT_OF_BOUNDS:new U.ERR_OUT_OF_RANGE(c||"offset",`>= ${+!!c} and <= ${b}`,a)}n(V,"E"),V("ERR_BUFFER_OUT_OF_BOUNDS",function(a){return a?`${a} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),V("ERR_INVALID_ARG_TYPE",function(a,b){return`The "${a}" argument must be of type number. Received typ\
e ${typeof b}`},TypeError),V("ERR_OUT_OF_RANGE",function(a,b,c){let d=`The value of "${a}" is out o\
f range.`,e=c;return Number.isInteger(c)&&Math.abs(c)>0x100000000?e=W(String(c)):"bigint"==typeof c&&(e=String(c),(c>BigInt(2)**BigInt(32)||c<-(BigInt(2)**BigInt(32)))&&(e=W(e)),e+="n"),d+=` It must be ${b}. Re\
ceived ${e}`},RangeError),n(W,"addNumericalSeparator"),n(X,"checkBounds"),n(Y,"checkIntBI"),n(Z,"validateNumber"),n($,"boundsError");var _=/[^+/0-9A-Za-z-_]/g;function aa(a){if((a=(a=a.split("=")[0]).trim().replace(_,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}function ab(a,b){b=b||1/0;let c,d=a.length,e=null,f=[];for(let g=0;g<d;++g){if((c=a.charCodeAt(g))>55295&&c<57344){if(!e){if(c>56319||g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else if(c<1114112){if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}else throw Error("Invalid code point")}return f}function ac(a){let b=[];for(let c=0;c<a.length;++c)b.push(255&a.charCodeAt(c));return b}function ad(a,b){let c,d,e=[];for(let f=0;f<a.length&&!((b-=2)<0);++f)d=(c=a.charCodeAt(f))>>8,e.push(c%256),e.push(d);return e}function ae(a){return b.toByteArray(aa(a))}function af(a,b,c,d){let e;for(e=0;e<d&&!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}function ag(a,b){return a instanceof b||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===b.name}function ah(a){return a!=a}n(aa,"base64clean"),n(ab,"utf8ToBytes"),n(ac,"asciiToBytes"),n(ad,"utf16leToBytes"),n(ae,"base64ToBytes"),n(af,"blitBuffer"),n(ag,"isInstance"),n(ah,"numberIsNaN");var ai=function(){let a="0123456789abcdef",b=Array(256);for(let c=0;c<16;++c){let d=16*c;for(let e=0;e<16;++e)b[d+e]=a[c]+a[e]}return b}();function aj(a){return typeof BigInt>"u"?ak:a}function ak(){throw Error("BigInt not supported")}n(aj,"defineBigIntMethod"),n(ak,"BufferBigIntNotDefined")}),y=o(()=>{d=globalThis,e=globalThis.setImmediate??(a=>setTimeout(a,0)),globalThis.clearImmediate??(a=>clearTimeout(a)),f="function"==typeof globalThis.Buffer&&"function"==typeof globalThis.Buffer.allocUnsafe?globalThis.Buffer:x().Buffer,(g=globalThis.process??{}).env??(g.env={});try{g.nextTick(()=>{})}catch{let a=Promise.resolve();g.nextTick=a.then.bind(a)}}),z=p((a,b)=>{y();var c,d="object"==typeof Reflect?Reflect:null,e=d&&"function"==typeof d.apply?d.apply:n(function(a,b,c){return Function.prototype.apply.call(a,b,c)},"ReflectApply");function f(a){console&&console.warn&&console.warn(a)}c=d&&"function"==typeof d.ownKeys?d.ownKeys:Object.getOwnPropertySymbols?n(function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))},"ReflectOwnKeys"):n(function(a){return Object.getOwnPropertyNames(a)},"ReflectOwnKeys"),n(f,"ProcessEmitWarning");var g=Number.isNaN||n(function(a){return a!=a},"NumberIsNaN");function h(){h.init.call(this)}n(h,"EventEmitter"),b.exports=h,b.exports.once=u,h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var i=10;function j(a){if("function"!=typeof a)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function k(a){return void 0===a._maxListeners?h.defaultMaxListeners:a._maxListeners}function l(a,b,c,d){var e,g,h;if(j(c),void 0===(g=a._events)?(g=a._events=Object.create(null),a._eventsCount=0):(void 0!==g.newListener&&(a.emit("newListener",b,c.listener?c.listener:c),g=a._events),h=g[b]),void 0===h)h=g[b]=c,++a._eventsCount;else if("function"==typeof h?h=g[b]=d?[c,h]:[h,c]:d?h.unshift(c):h.push(c),(e=k(a))>0&&h.length>e&&!h.warned){h.warned=!0;var i=Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");i.name="MaxListenersExceededWarning",i.emitter=a,i.type=b,i.count=h.length,f(i)}return a}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function o(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=m.bind(d);return e.listener=c,d.wrapFn=e,e}function p(a,b,c){var d=a._events;if(void 0===d)return[];var e=d[b];return void 0===e?[]:"function"==typeof e?c?[e.listener||e]:[e]:c?t(e):r(e,e.length)}function q(a){var b=this._events;if(void 0!==b){var c=b[a];if("function"==typeof c)return 1;if(void 0!==c)return c.length}return 0}function r(a,b){for(var c=Array(b),d=0;d<b;++d)c[d]=a[d];return c}function s(a,b){for(;b+1<a.length;b++)a[b]=a[b+1];a.pop()}function t(a){for(var b=Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}function u(a,b){return new Promise(function(c,d){function e(c){a.removeListener(b,f),d(c)}function f(){"function"==typeof a.removeListener&&a.removeListener("error",e),c([].slice.call(arguments))}n(e,"errorListener"),n(f,"resolver"),w(a,b,f,{once:!0}),"error"!==b&&v(a,e,{once:!0})})}function v(a,b,c){"function"==typeof a.on&&w(a,"error",b,c)}function w(a,b,c,d){if("function"==typeof a.on)d.once?a.once(b,c):a.on(b,c);else if("function"==typeof a.addEventListener)a.addEventListener(b,n(function e(f){d.once&&a.removeEventListener(b,e),c(f)},"wrapListener"));else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}n(j,"checkListener"),Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:n(function(){return i},"get"),set:n(function(a){if("number"!=typeof a||a<0||g(a))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");i=a},"set")}),h.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=n(function(a){if("number"!=typeof a||a<0||g(a))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this},"setMaxListeners"),n(k,"_getMaxListeners"),h.prototype.getMaxListeners=n(function(){return k(this)},"getMaxListeners"),h.prototype.emit=n(function(a){for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);var d="error"===a,f=this._events;if(void 0!==f)d=d&&void 0===f.error;else if(!d)return!1;if(d){if(b.length>0&&(g=b[0]),g instanceof Error)throw g;var g,h=Error("Unhandled error."+(g?" ("+g.message+")":""));throw h.context=g,h}var i=f[a];if(void 0===i)return!1;if("function"==typeof i)e(i,this,b);else for(var j=i.length,k=r(i,j),c=0;c<j;++c)e(k[c],this,b);return!0},"emit"),n(l,"_addListener"),h.prototype.addListener=n(function(a,b){return l(this,a,b,!1)},"addListener"),h.prototype.on=h.prototype.addListener,h.prototype.prependListener=n(function(a,b){return l(this,a,b,!0)},"prependListener"),n(m,"onceWrapper"),n(o,"_onceWrap"),h.prototype.once=n(function(a,b){return j(b),this.on(a,o(this,a,b)),this},"once"),h.prototype.prependOnceListener=n(function(a,b){return j(b),this.prependListener(a,o(this,a,b)),this},"prependOnceListener"),h.prototype.removeListener=n(function(a,b){var c,d,e,f,g;if(j(b),void 0===(d=this._events)||void 0===(c=d[a]))return this;if(c===b||c.listener===b)0==--this._eventsCount?this._events=Object.create(null):(delete d[a],d.removeListener&&this.emit("removeListener",a,c.listener||b));else if("function"!=typeof c){for(e=-1,f=c.length-1;f>=0;f--)if(c[f]===b||c[f].listener===b){g=c[f].listener,e=f;break}if(e<0)return this;0===e?c.shift():s(c,e),1===c.length&&(d[a]=c[0]),void 0!==d.removeListener&&this.emit("removeListener",a,g||b)}return this},"removeListener"),h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=n(function(a){var b,c,d;if(void 0===(c=this._events))return this;if(void 0===c.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==c[a]&&(0==--this._eventsCount?this._events=Object.create(null):delete c[a]),this;if(0==arguments.length){var e,f=Object.keys(c);for(d=0;d<f.length;++d)"removeListener"!==(e=f[d])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(b=c[a]))this.removeListener(a,b);else if(void 0!==b)for(d=b.length-1;d>=0;d--)this.removeListener(a,b[d]);return this},"removeAllListeners"),n(p,"_listeners"),h.prototype.listeners=n(function(a){return p(this,a,!0)},"listeners"),h.prototype.rawListeners=n(function(a){return p(this,a,!1)},"rawListeners"),h.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):q.call(a,b)},h.prototype.listenerCount=q,n(q,"listenerCount"),h.prototype.eventNames=n(function(){return this._eventsCount>0?c(this._events):[]},"eventNames"),n(r,"arrayClone"),n(s,"spliceOne"),n(t,"unwrapListeners"),n(u,"once"),n(v,"addErrorHandlerIfEventEmitter"),n(w,"eventTargetAgnosticAddListener")}),A={};function B(a){return 0}q(A,{Socket:()=>F,isIP:()=>B});var C,D,E,F,G=o(()=>{y(),C=s(z(),1),n(B,"isIP"),D=/^[^.]+\./,E=class a extends C.EventEmitter{constructor(){super(...arguments),u(this,"opts",{}),u(this,"connecting",!1),u(this,"pending",!0),u(this,"writable",!0),u(this,"encrypted",!1),u(this,"authorized",!1),u(this,"destroyed",!1),u(this,"ws",null),u(this,"writeBuffer"),u(this,"tlsState",0),u(this,"tlsRead"),u(this,"tlsWrite")}static get poolQueryViaFetch(){return a.opts.poolQueryViaFetch??a.defaults.poolQueryViaFetch}static set poolQueryViaFetch(b){a.opts.poolQueryViaFetch=b}static get fetchEndpoint(){return a.opts.fetchEndpoint??a.defaults.fetchEndpoint}static set fetchEndpoint(b){a.opts.fetchEndpoint=b}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(a){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return a.opts.fetchFunction??a.defaults.fetchFunction}static set fetchFunction(b){a.opts.fetchFunction=b}static get webSocketConstructor(){return a.opts.webSocketConstructor??a.defaults.webSocketConstructor}static set webSocketConstructor(b){a.opts.webSocketConstructor=b}get webSocketConstructor(){return this.opts.webSocketConstructor??a.webSocketConstructor}set webSocketConstructor(a){this.opts.webSocketConstructor=a}static get wsProxy(){return a.opts.wsProxy??a.defaults.wsProxy}static set wsProxy(b){a.opts.wsProxy=b}get wsProxy(){return this.opts.wsProxy??a.wsProxy}set wsProxy(a){this.opts.wsProxy=a}static get coalesceWrites(){return a.opts.coalesceWrites??a.defaults.coalesceWrites}static set coalesceWrites(b){a.opts.coalesceWrites=b}get coalesceWrites(){return this.opts.coalesceWrites??a.coalesceWrites}set coalesceWrites(a){this.opts.coalesceWrites=a}static get useSecureWebSocket(){return a.opts.useSecureWebSocket??a.defaults.useSecureWebSocket}static set useSecureWebSocket(b){a.opts.useSecureWebSocket=b}get useSecureWebSocket(){return this.opts.useSecureWebSocket??a.useSecureWebSocket}set useSecureWebSocket(a){this.opts.useSecureWebSocket=a}static get forceDisablePgSSL(){return a.opts.forceDisablePgSSL??a.defaults.forceDisablePgSSL}static set forceDisablePgSSL(b){a.opts.forceDisablePgSSL=b}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??a.forceDisablePgSSL}set forceDisablePgSSL(a){this.opts.forceDisablePgSSL=a}static get disableSNI(){return a.opts.disableSNI??a.defaults.disableSNI}static set disableSNI(b){a.opts.disableSNI=b}get disableSNI(){return this.opts.disableSNI??a.disableSNI}set disableSNI(a){this.opts.disableSNI=a}static get disableWarningInBrowsers(){return a.opts.disableWarningInBrowsers??a.defaults.disableWarningInBrowsers}static set disableWarningInBrowsers(b){a.opts.disableWarningInBrowsers=b}get disableWarningInBrowsers(){return this.opts.disableWarningInBrowsers??a.disableWarningInBrowsers}set disableWarningInBrowsers(a){this.opts.disableWarningInBrowsers=a}static get pipelineConnect(){return a.opts.pipelineConnect??a.defaults.pipelineConnect}static set pipelineConnect(b){a.opts.pipelineConnect=b}get pipelineConnect(){return this.opts.pipelineConnect??a.pipelineConnect}set pipelineConnect(a){this.opts.pipelineConnect=a}static get subtls(){return a.opts.subtls??a.defaults.subtls}static set subtls(b){a.opts.subtls=b}get subtls(){return this.opts.subtls??a.subtls}set subtls(a){this.opts.subtls=a}static get pipelineTLS(){return a.opts.pipelineTLS??a.defaults.pipelineTLS}static set pipelineTLS(b){a.opts.pipelineTLS=b}get pipelineTLS(){return this.opts.pipelineTLS??a.pipelineTLS}set pipelineTLS(a){this.opts.pipelineTLS=a}static get rootCerts(){return a.opts.rootCerts??a.defaults.rootCerts}static set rootCerts(b){a.opts.rootCerts=b}get rootCerts(){return this.opts.rootCerts??a.rootCerts}set rootCerts(a){this.opts.rootCerts=a}wsProxyAddrForHost(a,b){let c=this.wsProxy;if(void 0===c)throw Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return"function"==typeof c?c(a,b):`${c}?address=${a}:${b}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(a,b,c){this.connecting=!0,c&&this.once("connect",c);let d=n(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),e=n((a,b=!1)=>{a.binaryType="arraybuffer",a.addEventListener("error",a=>{this.emit("error",a),this.emit("close")}),a.addEventListener("message",a=>{if(0===this.tlsState){let b=f.from(a.data);this.emit("data",b)}}),a.addEventListener("close",()=>{this.emit("close")}),b?d():a.addEventListener("open",d)},"configureWebSocket"),g;try{g=this.wsProxyAddrForHost(b,"string"==typeof a?parseInt(a,10):a)}catch(a){this.emit("error",a),this.emit("close");return}try{let a=(this.useSecureWebSocket?"wss:":"ws:")+"//"+g;if(void 0!==this.webSocketConstructor)this.ws=new this.webSocketConstructor(a),e(this.ws);else try{this.ws=new WebSocket(a),e(this.ws)}catch{this.ws=new __unstable_WebSocket(a),e(this.ws)}}catch(a){fetch((this.useSecureWebSocket?"https:":"http:")+"//"+g,{headers:{Upgrade:"websocket"}}).then(b=>{if(this.ws=b.webSocket,null==this.ws)throw a;this.ws.accept(),e(this.ws,!0)}).catch(a=>{this.emit("error",Error(`All attempts to open a WebSocket to connect to the database failed. Please refer \
to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websoc\
ket--undefined. Details: ${a}`)),this.emit("close")})}}async startTls(a){if(void 0===this.subtls)throw Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let b=await this.subtls.TrustedCert.databaseFromPEM(this.rootCerts),c=new this.subtls.WebSocketReadQueue(this.ws),d=c.read.bind(c),e=this.rawWrite.bind(this),{read:f,write:g}=await this.subtls.startTls(a,b,d,e,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=f,this.tlsWrite=g,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let a=await this.tlsRead();if(void 0===a)break;{let b=f.from(a);this.emit("data",b)}}}rawWrite(a){if(!this.coalesceWrites){this.ws&&this.ws.send(a);return}if(void 0===this.writeBuffer)this.writeBuffer=a,setTimeout(()=>{this.ws&&this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let b=new Uint8Array(this.writeBuffer.length+a.length);b.set(this.writeBuffer),b.set(a,this.writeBuffer.length),this.writeBuffer=b}}write(a,b="utf8",c=a=>{}){return 0===a.length?c():("string"==typeof a&&(a=f.from(a,b)),0===this.tlsState?(this.rawWrite(a),c()):1===this.tlsState?this.once("secureConnection",()=>{this.write(a,b,c)}):(this.tlsWrite(a),c())),!0}end(a=f.alloc(0),b="utf8",c=()=>{}){return this.write(a,b,()=>{this.ws.close(),c()}),this}destroy(){return this.destroyed=!0,this.end()}},n(E,"Socket"),u(E,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:n((a,b,c)=>"https://"+(c?.jwtAuth?a.replace(D,"apiauth."):a.replace(D,"api."))+"/sql","fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:n(a=>a+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1,disableWarningInBrowsers:!1}),u(E,"opts",{}),F=E}),H={};function I(a,b=!1){let{protocol:c}=new URL(a),{username:d,password:e,host:f,hostname:g,port:h,pathname:i,search:j,searchParams:k,hash:l}=new URL("http:"+a.substring(c.length));e=decodeURIComponent(e),d=decodeURIComponent(d),i=decodeURIComponent(i);let m=d+":"+e,n=b?Object.fromEntries(k.entries()):j;return{href:a,protocol:c,auth:m,username:d,password:e,host:f,hostname:g,port:h,pathname:i,search:j,query:n,hash:l}}q(H,{parse:()=>I});var J=o(()=>{y(),n(I,"parse")}),K=p(a=>{y(),a.parse=function(a,b){return new c(a,b).parse()};var b=class a{constructor(a,b){this.source=a,this.transform=b||d,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var a=this.source[this.position++];return"\\"===a?{value:this.source[this.position++],escaped:!0}:{value:a,escaped:!1}}record(a){this.recorded.push(a)}newEntry(a){var b;(this.recorded.length>0||a)&&("NULL"!==(b=this.recorded.join(""))||a||(b=null),null!==b&&(b=this.transform(b)),this.entries.push(b),this.recorded=[])}consumeDimensions(){if("["===this.source[0])for(;!this.isEof()&&"="!==this.nextCharacter().value;);}parse(b){var c,d,e;for(this.consumeDimensions();!this.isEof();)if("{"!==(c=this.nextCharacter()).value||e){if("}"!==c.value||e)'"'!==c.value||c.escaped?","!==c.value||e?this.record(c.value):this.newEntry():(e&&this.newEntry(!0),e=!e);else if(this.dimension--,!this.dimension&&(this.newEntry(),b))return this.entries}else this.dimension++,this.dimension>1&&(d=new a(this.source.substr(this.position-1),this.transform),this.entries.push(d.parse(!0)),this.position+=d.position-2);if(0!==this.dimension)throw Error("array dimension not balanced");return this.entries}};n(b,"ArrayParser");var c=b;function d(a){return a}n(d,"identity")}),L=p((a,b)=>{y();var c=K();b.exports={create:n(function(a,b){return{parse:n(function(){return c.parse(a,b)},"parse")}},"create")}}),M=p((a,b)=>{y();var c=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,d=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,e=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,f=/^-?infinity$/;function g(a){var b=d.exec(a);if(b){var c=parseInt(b[1],10);b[4]&&(c=i(c));var e=new Date(c,parseInt(b[2],10)-1,b[3]);return j(c)&&e.setFullYear(c),e}}function h(a){if(a.endsWith("+00"))return 0;var b=e.exec(a.split(" ")[1]);if(b){var c=b[1];return"Z"===c?0:(3600*parseInt(b[2],10)+60*parseInt(b[3]||0,10)+parseInt(b[4]||0,10))*("-"===c?-1:1)*1e3}}function i(a){return-(a-1)}function j(a){return a>=0&&a<100}b.exports=n(function(a){if(f.test(a))return Number(a.replace("i","I"));var b=c.exec(a);if(!b)return g(a)||null;var d=!!b[8],e=parseInt(b[1],10);d&&(e=i(e));var k=parseInt(b[2],10)-1,l=b[3],m=parseInt(b[4],10),n=parseInt(b[5],10),o=parseInt(b[6],10),p=b[7];p=p?1e3*parseFloat(p):0;var q,r=h(a);return null!=r?(q=new Date(Date.UTC(e,k,l,m,n,o,p)),j(e)&&q.setUTCFullYear(e),0!==r&&q.setTime(q.getTime()-r)):(q=new Date(e,k,l,m,n,o,p),j(e)&&q.setFullYear(e)),q},"parseDate"),n(g,"getDate"),n(h,"timeZoneOffset"),n(i,"bcYearToNegativeYear"),n(j,"is0To99")}),N=p((a,b)=>{y(),b.exports=d;var c=Object.prototype.hasOwnProperty;function d(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var e in d)c.call(d,e)&&(a[e]=d[e])}return a}n(d,"extend")}),O=p((a,b)=>{y();var c=N();function d(a){if(!(this instanceof d))return new d(a);c(this,o(a))}b.exports=d,n(d,"PostgresInterval");var e=["seconds","minutes","hours","days","months","years"];d.prototype.toPostgres=function(){var a=e.filter(this.hasOwnProperty,this);return this.milliseconds&&0>a.indexOf("seconds")&&a.push("seconds"),0===a.length?"0":a.map(function(a){var b=this[a]||0;return"seconds"===a&&this.milliseconds&&(b=(b+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),b+" "+a},this).join(" ")};var f={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},g=["years","months","days"],h=["hours","minutes","seconds"];d.prototype.toISOString=d.prototype.toISO=function(){return"P"+g.map(a,this).join("")+"T"+h.map(a,this).join("");function a(a){var b=this[a]||0;return"seconds"===a&&this.milliseconds&&(b=(b+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),b+f[a]}};var i="([+-]?\\d+)",j=new RegExp([i+"\\s+years?",i+"\\s+mons?",i+"\\s+days?","([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?"].map(function(a){return"("+a+")?"}).join("\\s*")),k={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},l=["hours","minutes","seconds","milliseconds"];function m(a){return parseInt(a+"000000".slice(a.length),10)/1e3}function o(a){if(!a)return{};var b=j.exec(a),c="-"===b[8];return Object.keys(k).reduce(function(a,d){var e=b[k[d]];return e&&(e="milliseconds"===d?m(e):parseInt(e,10))&&(c&&~l.indexOf(d)&&(e*=-1),a[d]=e),a},{})}n(m,"parseMilliseconds"),n(o,"parse")}),P=p((a,b)=>{y(),b.exports=n(function(a){if(/^\\x/.test(a))return new f(a.substr(2),"hex");for(var b="",c=0;c<a.length;)if("\\"!==a[c])b+=a[c],++c;else if(/[0-7]{3}/.test(a.substr(c+1,3)))b+=String.fromCharCode(parseInt(a.substr(c+1,3),8)),c+=4;else{for(var d=1;c+d<a.length&&"\\"===a[c+d];)d++;for(var e=0;e<Math.floor(d/2);++e)b+="\\";c+=2*Math.floor(d/2)}return new f(b,"binary")},"parseBytea")}),Q=p((a,b)=>{y();var c=K(),d=L(),e=M(),f=O(),g=P();function h(a){return n(function(b){return null===b?b:a(b)},"nullAllowed")}function i(a){return null===a?a:"TRUE"===a||"t"===a||"true"===a||"y"===a||"yes"===a||"on"===a||"1"===a}function j(a){return a?c.parse(a,i):null}function k(a){return parseInt(a,10)}function l(a){return a?c.parse(a,h(k)):null}function m(a){return a?c.parse(a,h(function(a){return v(a).trim()})):null}n(h,"allowNull"),n(i,"parseBool"),n(j,"parseBoolArray"),n(k,"parseBaseTenInt"),n(l,"parseIntegerArray"),n(m,"parseBigIntegerArray");var o=n(function(a){return a?d.create(a,function(a){return null!==a&&(a=x(a)),a}).parse():null},"parsePointArray"),p=n(function(a){return a?d.create(a,function(a){return null!==a&&(a=parseFloat(a)),a}).parse():null},"parseFloatArray"),q=n(function(a){return a?d.create(a).parse():null},"parseStringArray"),r=n(function(a){return a?d.create(a,function(a){return null!==a&&(a=e(a)),a}).parse():null},"parseDateArray"),s=n(function(a){return a?d.create(a,function(a){return null!==a&&(a=f(a)),a}).parse():null},"parseIntervalArray"),t=n(function(a){return a?c.parse(a,h(g)):null},"parseByteAArray"),u=n(function(a){return parseInt(a,10)},"parseInteger"),v=n(function(a){var b=String(a);return/^\d+$/.test(b)?b:a},"parseBigInteger"),w=n(function(a){return a?c.parse(a,h(JSON.parse)):null},"parseJsonArray"),x=n(function(a){return"("!==a[0]?null:{x:parseFloat((a=a.substring(1,a.length-1).split(","))[0]),y:parseFloat(a[1])}},"parsePoint"),z=n(function(a){if("<"!==a[0]&&"("!==a[1])return null;for(var b="(",c="",d=!1,e=2;e<a.length-1;e++){if(d||(b+=a[e]),")"===a[e]){d=!0;continue}d&&","!==a[e]&&(c+=a[e])}var f=x(b);return f.radius=parseFloat(c),f},"parseCircle");b.exports={init:n(function(a){a(20,v),a(21,u),a(23,u),a(26,u),a(700,parseFloat),a(701,parseFloat),a(16,i),a(1082,e),a(1114,e),a(1184,e),a(600,x),a(651,q),a(718,z),a(1e3,j),a(1001,t),a(1005,l),a(1007,l),a(1028,l),a(1016,m),a(1017,o),a(1021,p),a(1022,p),a(1231,p),a(1014,q),a(1015,q),a(1008,q),a(1009,q),a(1040,q),a(1041,q),a(1115,r),a(1182,r),a(1185,r),a(1186,f),a(1187,s),a(17,g),a(114,JSON.parse.bind(JSON)),a(3802,JSON.parse.bind(JSON)),a(199,w),a(3807,w),a(3907,q),a(2951,q),a(791,q),a(1183,q),a(1270,q)},"init")}}),R=p((a,b)=>{function c(a){var b=a.readInt32BE(0),c=a.readUInt32BE(4),d="";b<0&&(b=~b+(0===c),c=~c+1>>>0,d="-");var e,f,g,h,i,j,k="";if(e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";if(k=h+g+k,e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";if(k=h+g+k,e=b%1e6,b=b/1e6>>>0,c=(f=0x100000000*e+c)/1e6>>>0,g=""+(f-1e6*c),0===c&&0===b)return d+g+k;for(h="",i=6-g.length,j=0;j<i;j++)h+="0";return k=h+g+k,d+(g=""+(f=0x100000000*(e=b%1e6)+c)%1e6)+k}y(),n(c,"readInt8"),b.exports=c}),S=p((a,b)=>{y();var c=R(),d=n(function(a,b,c,d,e){c=c||0,d=d||!1,e=e||function(a,b,c){return a*Math.pow(2,c)+b};var f=c>>3,g=n(function(a){return d?255&~a:a},"inv"),h=255,i=8-c%8;b<i&&(h=255<<8-b&255,i=b),c&&(h>>=c%8);var j=0;c%8+b>=8&&(j=e(0,g(a[f])&h,i));for(var k=b+c>>3,l=f+1;l<k;l++)j=e(j,g(a[l]),8);var m=(b+c)%8;return m>0&&(j=e(j,g(a[k])>>8-m,m)),j},"parseBits"),e=n(function(a,b,c){var e=Math.pow(2,c-1)-1,f=d(a,1),g=d(a,c,1);if(0===g)return 0;var h=1,i=d(a,b,c+1,!1,n(function(a,b,c){0===a&&(a=1);for(var d=1;d<=c;d++)h/=2,(b&1<<c-d)>0&&(a+=h);return a},"parsePrecisionBits"));return g==Math.pow(2,c+1)-1?0===i?0===f?1/0:-1/0:NaN:(0===f?1:-1)*Math.pow(2,g-e)*i},"parseFloatFromBits"),f=n(function(a){return 1==d(a,1)?-1*(d(a,15,1,!0)+1):d(a,15,1)},"parseInt16"),g=n(function(a){return 1==d(a,1)?-1*(d(a,31,1,!0)+1):d(a,31,1)},"parseInt32"),h=n(function(a){return e(a,23,8)},"parseFloat32"),i=n(function(a){return e(a,52,11)},"parseFloat64"),j=n(function(a){var b=d(a,16,32);if(49152==b)return NaN;for(var c=Math.pow(1e4,d(a,16,16)),e=0,f=d(a,16),g=0;g<f;g++)e+=d(a,16,64+16*g)*c,c/=1e4;var h=Math.pow(10,d(a,16,48));return(0===b?1:-1)*Math.round(e*h)/h},"parseNumeric"),k=n(function(a,b){var c=d(b,1),e=d(b,63,1),f=new Date((0===c?1:-1)*e/1e3+9466848e5);return a||f.setTime(f.getTime()+6e4*f.getTimezoneOffset()),f.usec=e%1e3,f.getMicroSeconds=function(){return this.usec},f.setMicroSeconds=function(a){this.usec=a},f.getUTCMicroSeconds=function(){return this.usec},f},"parseDate"),l=n(function(a){for(var b=d(a,32),c=(d(a,32,32),d(a,32,64)),e=96,f=[],g=0;g<b;g++)f[g]=d(a,32,e),e+=64;var h=n(function(b){var c,f=d(a,32,e);return(e+=32,0xffffffff==f)?null:23==b||20==b?(c=d(a,8*f,e),e+=8*f,c):25==b?a.toString(this.encoding,e>>3,(e+=f<<3)>>3):void console.log("ERROR: ElementType not implemented: "+b)},"parseElement"),i=n(function(a,b){var c,d=[];if(a.length>1){var e=a.shift();for(c=0;c<e;c++)d[c]=i(a,b);a.unshift(e)}else for(c=0;c<a[0];c++)d[c]=h(b);return d},"parse");return i(f,c)},"parseArray"),m=n(function(a){return a.toString("utf8")},"parseText"),o=n(function(a){return null===a?null:d(a,8)>0},"parseBool");b.exports={init:n(function(a){a(20,c),a(21,f),a(23,g),a(26,g),a(1700,j),a(700,h),a(701,i),a(16,o),a(1114,k.bind(null,!1)),a(1184,k.bind(null,!0)),a(1e3,l),a(1007,l),a(1016,l),a(1008,l),a(1009,l),a(25,m)},"init")}}),T=p((a,b)=>{y(),b.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),U=p(a=>{y();var b=Q(),c=S(),d=L(),e=T();a.getTypeParser=h,a.setTypeParser=i,a.arrayParser=d,a.builtins=e;var f={text:{},binary:{}};function g(a){return String(a)}function h(a,b){return f[b=b||"text"]&&f[b][a]||g}function i(a,b,c){"function"==typeof b&&(c=b,b="text"),f[b][a]=c}n(g,"noParse"),n(h,"getTypeParser"),n(i,"setTypeParser"),b.init(function(a,b){f.text[a]=b}),c.init(function(a,b){f.binary[a]=b})}),V=p((a,b)=>{y();var c=U();function d(a){this._types=a||c,this.text={},this.binary={}}n(d,"TypeOverrides"),d.prototype.getOverrides=function(a){switch(a){case"text":return this.text;case"binary":return this.binary;default:return{}}},d.prototype.setTypeParser=function(a,b,c){"function"==typeof b&&(c=b,b="text"),this.getOverrides(b)[a]=c},d.prototype.getTypeParser=function(a,b){return b=b||"text",this.getOverrides(b)[a]||this._types.getTypeParser(a,b)},b.exports=d});function W(a){let b=0x6a09e667,c=0xbb67ae85,d=0x3c6ef372,e=0xa54ff53a,f=0x510e527f,g=0x9b05688c,h=0x1f83d9ab,i=0x5be0cd19,j=0,k=0,l=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2],m=n((a,b)=>a>>>b|a<<32-b,"rrot"),o=new Uint32Array(64),p=new Uint8Array(64),q=n(()=>{for(let a=0,b=0;a<16;a++,b+=4)o[a]=p[b]<<24|p[b+1]<<16|p[b+2]<<8|p[b+3];for(let a=16;a<64;a++){let b=m(o[a-15],7)^m(o[a-15],18)^o[a-15]>>>3,c=m(o[a-2],17)^m(o[a-2],19)^o[a-2]>>>10;o[a]=o[a-16]+b+o[a-7]+c|0}let a=b,j=c,n=d,q=e,r=f,s=g,t=h,u=i;for(let b=0;b<64;b++){let c=u+(m(r,6)^m(r,11)^m(r,25))+(r&s^~r&t)+l[b]+o[b]|0,d=(m(a,2)^m(a,13)^m(a,22))+(a&j^a&n^j&n)|0;u=t,t=s,s=r,r=q+c|0,q=n,n=j,j=a,a=c+d|0}b=b+a|0,c=c+j|0,d=d+n|0,e=e+q|0,f=f+r|0,g=g+s|0,h=h+t|0,i=i+u|0,k=0},"process"),r=n(a=>{"string"==typeof a&&(a=new TextEncoder().encode(a));for(let b=0;b<a.length;b++)p[k++]=a[b],64===k&&q();j+=a.length},"add"),s=n(()=>{if(p[k++]=128,64==k&&q(),k+8>64){for(;k<64;)p[k++]=0;q()}for(;k<58;)p[k++]=0;let a=8*j;p[k++]=a/0x10000000000&255,p[k++]=a/0x100000000&255,p[k++]=a>>>24,p[k++]=a>>>16&255,p[k++]=a>>>8&255,p[k++]=255&a,q();let l=new Uint8Array(32);return l[0]=b>>>24,l[1]=b>>>16&255,l[2]=b>>>8&255,l[3]=255&b,l[4]=c>>>24,l[5]=c>>>16&255,l[6]=c>>>8&255,l[7]=255&c,l[8]=d>>>24,l[9]=d>>>16&255,l[10]=d>>>8&255,l[11]=255&d,l[12]=e>>>24,l[13]=e>>>16&255,l[14]=e>>>8&255,l[15]=255&e,l[16]=f>>>24,l[17]=f>>>16&255,l[18]=f>>>8&255,l[19]=255&f,l[20]=g>>>24,l[21]=g>>>16&255,l[22]=g>>>8&255,l[23]=255&g,l[24]=h>>>24,l[25]=h>>>16&255,l[26]=h>>>8&255,l[27]=255&h,l[28]=i>>>24,l[29]=i>>>16&255,l[30]=i>>>8&255,l[31]=255&i,l},"digest");return void 0===a?{add:r,digest:s}:(r(a),s())}var X,Y,Z=o(()=>{y(),n(W,"sha256")}),$=o(()=>{y(),n(X=class a{constructor(){u(this,"_dataLength",0),u(this,"_bufferLength",0),u(this,"_state",new Int32Array(4)),u(this,"_buffer",new ArrayBuffer(68)),u(this,"_buffer8"),u(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(a,b=!1){return this.onePassHasher.start().appendByteArray(a).end(b)}static hashStr(a,b=!1){return this.onePassHasher.start().appendStr(a).end(b)}static hashAsciiStr(a,b=!1){return this.onePassHasher.start().appendAsciiStr(a).end(b)}static _hex(b){let c=a.hexChars,d=a.hexOut,e,f,g,h;for(h=0;h<4;h+=1)for(f=8*h,e=b[h],g=0;g<8;g+=2)d[f+1+g]=c.charAt(15&e),e>>>=4,d[f+0+g]=c.charAt(15&e),e>>>=4;return d.join("")}static _md5cycle(a,b){let c=a[0],d=a[1],e=a[2],f=a[3];c+=(d&e|~d&f)+b[0]-0x28955b88|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[1]-0x173848aa|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[2]+0x242070db|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[3]-0x3e423112|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[4]-0xa83f051|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[5]+0x4787c62a|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[6]-0x57cfb9ed|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[7]-0x2b96aff|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[8]+0x698098d8|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[9]-0x74bb0851|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[10]-42063|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[11]-0x76a32842|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[12]+0x6b901122|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[13]-0x2678e6d|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[14]-0x5986bc72|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[15]+0x49b40821|0,c+=((d=(d<<22|d>>>10)+e|0)&f|e&~f)+b[1]-0x9e1da9e|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[6]-0x3fbf4cc0|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[11]+0x265e5a51|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[0]-0x16493856|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[5]-0x29d0efa3|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[10]+0x2441453|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[15]-0x275e197f|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[4]-0x182c0438|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[9]+0x21e1cde6|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[14]-0x3cc8f82a|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[3]-0xb2af279|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[8]+0x455a14ed|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[13]-0x561c16fb|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[2]-0x3105c08|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[7]+0x676f02d9|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[12]-0x72d5b376|0,c+=((d=(d<<20|d>>>12)+e|0)^e^f)+b[5]-378558|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[8]-0x788e097f|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[11]+0x6d9d6122|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[14]-0x21ac7f4|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[1]-0x5b4115bc|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[4]+0x4bdecfa9|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[7]-0x944b4a0|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[10]-0x41404390|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[13]+0x289b7ec6|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[0]-0x155ed806|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[3]-0x2b10cf7b|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[6]+0x4881d05|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[9]-0x262b2fc7|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[12]-0x1924661b|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[15]+0x1fa27cf8|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[2]-0x3b53a99b|0,d=(d<<23|d>>>9)+e|0,c+=(e^(d|~f))+b[0]-0xbd6ddbc|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[7]+0x432aff97|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[14]-0x546bdc59|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[5]-0x36c5fc7|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[12]+0x655b59c3|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[3]-0x70f3336e|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[10]-1051523|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[1]-0x7a7ba22f|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[8]+0x6fa87e4f|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[15]-0x1d31920|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[6]-0x5cfebcec|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[13]+0x4e0811a1|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[4]-0x8ac817e|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[11]-0x42c50dcb|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[2]+0x2ad7d2bb|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[9]-0x14792c6f|0,d=(d<<21|d>>>11)+e|0,a[0]=c+a[0]|0,a[1]=d+a[1]|0,a[2]=e+a[2]|0,a[3]=f+a[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(a.stateIdentity),this}appendStr(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g;for(g=0;g<b.length;g+=1){if((f=b.charCodeAt(g))<128)c[e++]=f;else if(f<2048)c[e++]=(f>>>6)+192,c[e++]=63&f|128;else if(f<55296||f>56319)c[e++]=(f>>>12)+224,c[e++]=f>>>6&63|128,c[e++]=63&f|128;else{if((f=(f-55296)*1024+(b.charCodeAt(++g)-56320)+65536)>1114111)throw Error("Unicode standard supports code points up to U+10FFFF");c[e++]=(f>>>18)+240,c[e++]=f>>>12&63|128,c[e++]=f>>>6&63|128,c[e++]=63&f|128}e>=64&&(this._dataLength+=64,a._md5cycle(this._state,d),e-=64,d[0]=d[16])}return this._bufferLength=e,this}appendAsciiStr(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g=0;for(;;){for(f=Math.min(b.length-g,64-e);f--;)c[e++]=b.charCodeAt(g++);if(e<64)break;this._dataLength+=64,a._md5cycle(this._state,d),e=0}return this._bufferLength=e,this}appendByteArray(b){let c=this._buffer8,d=this._buffer32,e=this._bufferLength,f,g=0;for(;;){for(f=Math.min(b.length-g,64-e);f--;)c[e++]=b[g++];if(e<64)break;this._dataLength+=64,a._md5cycle(this._state,d),e=0}return this._bufferLength=e,this}getState(){let a=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[a[0],a[1],a[2],a[3]]}}setState(a){let b=a.buffer,c=a.state,d=this._state,e;for(this._dataLength=a.length,this._bufferLength=a.buflen,d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],e=0;e<b.length;e+=1)this._buffer8[e]=b.charCodeAt(e)}end(b=!1){let c=this._bufferLength,d=this._buffer8,e=this._buffer32,f=(c>>2)+1;this._dataLength+=c;let g=8*this._dataLength;if(d[c]=128,d[c+1]=d[c+2]=d[c+3]=0,e.set(a.buffer32Identity.subarray(f),f),c>55&&(a._md5cycle(this._state,e),e.set(a.buffer32Identity)),g<=0xffffffff)e[14]=g;else{let a=g.toString(16).match(/(.*?)(.{0,8})$/);if(null===a)return;let b=parseInt(a[2],16),c=parseInt(a[1],16)||0;e[14]=b,e[15]=c}return a._md5cycle(this._state,e),b?this._state:a._hex(this._state)}},"Md5"),u(X,"stateIdentity",new Int32Array([0x67452301,-0x10325477,-0x67452302,0x10325476])),u(X,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),u(X,"hexChars","0123456789abcdef"),u(X,"hexOut",[]),u(X,"onePassHasher",new X),Y=X}),_={};function aa(a){return crypto.getRandomValues(f.alloc(a))}function ab(a){if("sha256"===a)return{update:n(function(a){return{digest:n(function(){return f.from(W(a))},"digest")}},"update")};if("md5"===a)return{update:n(function(a){return{digest:n(function(){return"string"==typeof a?Y.hashStr(a):Y.hashByteArray(a)},"digest")}},"update")};throw Error(`Hash type '${a}' not supported`)}function ac(a,b){if("sha256"!==a)throw Error(`\
Only sha256 is supported (requested: '${a}')`);return{update:n(function(a){return{digest:n(function(){"string"==typeof b&&(b=new TextEncoder().encode(b)),"string"==typeof a&&(a=new TextEncoder().encode(a));let c=b.length;if(c>64)b=W(b);else if(c<64){let a=new Uint8Array(64);a.set(b),b=a}let d=new Uint8Array(64),e=new Uint8Array(64);for(let a=0;a<64;a++)d[a]=54^b[a],e[a]=92^b[a];let g=new Uint8Array(a.length+64);g.set(d,0),g.set(a,64);let h=new Uint8Array(96);return h.set(e,0),h.set(W(g),64),f.from(W(h))},"digest")}},"update")}}q(_,{createHash:()=>ab,createHmac:()=>ac,randomBytes:()=>aa});var ad=o(()=>{y(),Z(),$(),n(aa,"randomBytes"),n(ab,"createHash"),n(ac,"createHmac")}),ae=p((a,b)=>{y(),b.exports={host:"localhost",user:"win32"===g.platform?g.env.USERNAME:g.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var c=U(),d=c.getTypeParser(20,"text"),e=c.getTypeParser(1016,"text");b.exports.__defineSetter__("parseInt8",function(a){c.setTypeParser(20,"text",a?c.getTypeParser(23,"text"):d),c.setTypeParser(1016,"text",a?c.getTypeParser(1007,"text"):e)})}),af=p((a,b)=>{y();var c=(ad(),t(_)),d=ae();function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function g(a){for(var b="{",c=0;c<a.length;c++)c>0&&(b+=","),null===a[c]||typeof a[c]>"u"?b+="NULL":Array.isArray(a[c])?b+=g(a[c]):a[c]instanceof f?b+="\\\\x"+a[c].toString("hex"):b+=e(h(a[c]));return b+"}"}n(e,"escapeElement"),n(g,"arrayString");var h=n(function(a,b){if(null==a)return null;if(a instanceof f)return a;if(ArrayBuffer.isView(a)){var c=f.from(a.buffer,a.byteOffset,a.byteLength);return c.length===a.byteLength?c:c.slice(a.byteOffset,a.byteOffset+a.byteLength)}return a instanceof Date?d.parseInputDatesAsUTC?l(a):k(a):Array.isArray(a)?g(a):"object"==typeof a?i(a,b):a.toString()},"prepareValue");function i(a,b){if(a&&"function"==typeof a.toPostgres){if(-1!==(b=b||[]).indexOf(a))throw Error('circular reference detected while preparing "'+a+'" for query');return b.push(a),h(a.toPostgres(h),b)}return JSON.stringify(a)}function j(a,b){for(a=""+a;a.length<b;)a="0"+a;return a}function k(a){var b=-a.getTimezoneOffset(),c=a.getFullYear(),d=c<1;d&&(c=Math.abs(c)+1);var e=j(c,4)+"-"+j(a.getMonth()+1,2)+"-"+j(a.getDate(),2)+"T"+j(a.getHours(),2)+":"+j(a.getMinutes(),2)+":"+j(a.getSeconds(),2)+"."+j(a.getMilliseconds(),3);return b<0?(e+="-",b*=-1):e+="+",e+=j(Math.floor(b/60),2)+":"+j(b%60,2),d&&(e+=" BC"),e}function l(a){var b=a.getUTCFullYear(),c=b<1;c&&(b=Math.abs(b)+1);var d=j(b,4)+"-"+j(a.getUTCMonth()+1,2)+"-"+j(a.getUTCDate(),2)+"T"+j(a.getUTCHours(),2)+":"+j(a.getUTCMinutes(),2)+":"+j(a.getUTCSeconds(),2)+"."+j(a.getUTCMilliseconds(),3);return d+="+00:00",c&&(d+=" BC"),d}function m(a,b,c){return a="string"==typeof a?{text:a}:a,b&&("function"==typeof b?a.callback=b:a.values=b),c&&(a.callback=c),a}n(i,"prepareObject"),n(j,"pad"),n(k,"dateToString"),n(l,"dateToStringUTC"),n(m,"normalizeQueryConfig");var o=n(function(a){return c.createHash("md5").update(a,"utf-8").digest("hex")},"md5"),p=n(function(a,b,c){var d=o(b+a);return"md5"+o(f.concat([f.from(d),c]))},"postgresMd5PasswordHash");b.exports={prepareValue:n(function(a){return h(a)},"prepareValueWrapper"),normalizeQueryConfig:m,postgresMd5PasswordHash:p,md5:o}}),ag={};q(ag,{default:()=>ah});var ah,ai=o(()=>{y(),ah={}}),aj=p((a,b)=>{y();var c=(ad(),t(_));function d(a){if(-1===a.indexOf("SCRAM-SHA-256"))throw Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let b=c.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:b,response:"n,,n=*,r="+b,message:"SASLInitialResponse"}}function e(a,b,c){if("SASLInitialResponse"!==a.message)throw Error("SASL: Last message was not SASLInitialResponse");if("string"!=typeof b)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if("string"!=typeof c)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let d=k(c);if(d.nonce.startsWith(a.clientNonce)){if(d.nonce.length===a.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var e=q(b,f.from(d.salt,"base64"),d.iteration),g=p(e,"Client Key"),h=o(g),i="n=*,r="+a.clientNonce,j="r="+d.nonce+",s="+d.salt+",i="+d.iteration,l="c=biws,r="+d.nonce,n=i+","+j+","+l,r=m(g,p(h,n)).toString("base64"),s=p(e,"Server Key"),t=p(s,n);a.message="SASLResponse",a.serverSignature=t.toString("base64"),a.response=l+",p="+r}function g(a,b){if("SASLResponse"!==a.message)throw Error("SASL: Last message was not SASLResponse");if("string"!=typeof b)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:c}=l(b);if(c!==a.serverSignature)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function h(a){if("string"!=typeof a)throw TypeError("SASL: text must be a string");return a.split("").map((b,c)=>a.charCodeAt(c)).every(a=>a>=33&&a<=43||a>=45&&a<=126)}function i(a){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(a)}function j(a){if("string"!=typeof a)throw TypeError("SASL: attribute pairs text must be a string");return new Map(a.split(",").map(a=>{if(!/^.=/.test(a))throw Error("SASL: Invalid attribute pair entry");return[a[0],a.substring(2)]}))}function k(a){let b=j(a),c=b.get("r");if(c){if(!h(c))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let d=b.get("s");if(d){if(!i(d))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let e=b.get("i");if(e){if(!/^[1-9][0-9]*$/.test(e))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");return{nonce:c,salt:d,iteration:parseInt(e,10)}}function l(a){let b=j(a).get("v");if(b){if(!i(b))throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:b}}function m(a,b){if(!f.isBuffer(a))throw TypeError("first argument must be a Buffer");if(!f.isBuffer(b))throw TypeError("second argument must be a Buffer");if(a.length!==b.length)throw Error("Buffer lengths must match");if(0===a.length)throw Error("Buffers cannot be empty");return f.from(a.map((c,d)=>a[d]^b[d]))}function o(a){return c.createHash("sha256").update(a).digest()}function p(a,b){return c.createHmac("sha256",a).update(b).digest()}function q(a,b,c){for(var d=p(a,f.concat([b,f.from([0,0,0,1])])),e=d,g=0;g<c-1;g++)e=m(e,d=p(a,d));return e}n(d,"startSession"),n(e,"continueSession"),n(g,"finalizeSession"),n(h,"isPrintableChars"),n(i,"isBase64"),n(j,"parseAttributePairs"),n(k,"parseServerFirstMessage"),n(l,"parseServerFinalMessage"),n(m,"xorBuffers"),n(o,"sha256"),n(p,"hmacSha256"),n(q,"Hi"),b.exports={startSession:d,continueSession:e,finalizeSession:g}}),ak={};function al(...a){return a.join("/")}q(ak,{join:()=>al});var am=o(()=>{y(),n(al,"join")}),an={};function ao(a,b){b(Error("No filesystem"))}q(an,{stat:()=>ao});var ap=o(()=>{y(),n(ao,"stat")}),aq={};q(aq,{default:()=>ar});var ar,as=o(()=>{y(),ar={}}),at={};q(at,{StringDecoder:()=>av});var au,av,aw=o(()=>{y(),n(au=class{constructor(a){u(this,"td"),this.td=new TextDecoder(a)}write(a){return this.td.decode(a,{stream:!0})}end(a){return this.td.decode(a)}},"StringDecoder"),av=au}),ax=p((a,b)=>{y();var{Transform:c}=(as(),t(aq)),{StringDecoder:d}=(aw(),t(at)),e=Symbol("last"),f=Symbol("decoder");function g(a,b,c){let d;if(this.overflow){if(1===(d=this[f].write(a).split(this.matcher)).length)return c();d.shift(),this.overflow=!1}else this[e]+=this[f].write(a),d=this[e].split(this.matcher);this[e]=d.pop();for(let a=0;a<d.length;a++)try{i(this,this.mapper(d[a]))}catch(a){return c(a)}(this.overflow=this[e].length>this.maxLength,this.overflow&&!this.skipOverflow)?c(Error("maximum buffer reached")):c()}function h(a){if(this[e]+=this[f].end(),this[e])try{i(this,this.mapper(this[e]))}catch(b){return a(b)}a()}function i(a,b){void 0!==b&&a.push(b)}function j(a){return a}function k(a,b,i){switch(a=a||/\r?\n/,b=b||j,i=i||{},arguments.length){case 1:"function"==typeof a?(b=a,a=/\r?\n/):"object"!=typeof a||a instanceof RegExp||a[Symbol.split]||(i=a,a=/\r?\n/);break;case 2:"function"==typeof a?(i=b,b=a,a=/\r?\n/):"object"==typeof b&&(i=b,b=j)}(i=Object.assign({},i)).autoDestroy=!0,i.transform=g,i.flush=h,i.readableObjectMode=!0;let k=new c(i);return k[e]="",k[f]=new d("utf8"),k.matcher=a,k.mapper=b,k.maxLength=i.maxLength,k.skipOverflow=i.skipOverflow||!1,k.overflow=!1,k._destroy=function(a,b){this._writableState.errorEmitted=!1,b(a)},k}n(g,"transform"),n(h,"flush"),n(i,"push"),n(j,"noop"),n(k,"split"),b.exports=k}),ay=p((a,b)=>{y();var c=(am(),t(ak)),d=(as(),t(aq)).Stream,e=ax(),f=(ai(),t(ag)),h="win32"===g.platform,i=g.stderr;function j(a){return(61440&a)==32768}n(j,"isRegFile");var k=["host","port","database","user","password"],l=k.length,m=k[l-1];function o(){if(i instanceof d&&!0===i.writable){var a=Array.prototype.slice.call(arguments).concat(`
`);i.write(f.format.apply(f,a))}}n(o,"warn"),Object.defineProperty(b.exports,"isWin",{get:n(function(){return h},"get"),set:n(function(a){h=a},"set")}),b.exports.warnTo=function(a){var b=i;return i=a,b},b.exports.getFileName=function(a){var b=a||g.env;return b.PGPASSFILE||(h?c.join(b.APPDATA||"./","postgresql","pgpass.conf"):c.join(b.HOME||"./",".pgpass"))},b.exports.usePgPass=function(a,b){return!Object.prototype.hasOwnProperty.call(g.env,"PGPASSWORD")&&(!!h||(b=b||"<unkn>",j(a.mode)?!(63&a.mode)||(o('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',b),!1):(o('WARNING: password file "%s" is not a plain file',b),!1)))};var p=b.exports.match=function(a,b){return k.slice(0,-1).reduce(function(c,d,e){return 1==e&&Number(a[d]||5432)===Number(b[d])?c&&!0:c&&("*"===b[d]||b[d]===a[d])},!0)};b.exports.getPassword=function(a,b,c){var d,f=b.pipe(e());function g(b){var c=q(b);c&&r(c)&&p(a,c)&&(d=c[m],f.end())}n(g,"onLine");var h=n(function(){b.destroy(),c(d)},"onEnd"),i=n(function(a){b.destroy(),o("WARNING: error on reading file: %s",a),c(void 0)},"onErr");b.on("error",i),f.on("data",g).on("end",h).on("error",i)};var q=b.exports.parseLine=function(a){if(a.length<11||a.match(/^\s+#/))return null;for(var b="",c="",d=0,e=0,f={},h=n(function(b,c,d){var e=a.substring(c,d);Object.hasOwnProperty.call(g.env,"PGPASS_NO_DEESCAPE")||(e=e.replace(/\\([:\\])/g,"$1")),f[k[b]]=e},"addToObj"),i=0;i<a.length-1;i+=1){if(b=a.charAt(i+1),c=a.charAt(i),d==l-1){h(d,e);break}i>=0&&":"==b&&"\\"!==c&&(h(d,e,i+1),e=i+2,d+=1)}return f=Object.keys(f).length===l?f:null},r=b.exports.isValidEntry=function(a){for(var b={0:function(a){return a.length>0},1:function(a){return"*"===a||isFinite(a=Number(a))&&a>0&&a<0x20000000000000&&Math.floor(a)===a},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},c=0;c<k.length;c+=1)if(!(0,b[c])(a[k[c]]||""))return!1;return!0}}),az=p((a,b)=>{y(),am(),t(ak);var c=(ap(),t(an)),d=ay();b.exports=function(a,b){var e=d.getFileName();c.stat(e,function(f,g){if(f||!d.usePgPass(g,e))return b(void 0);var h=c.createReadStream(e);d.getPassword(a,h,b)})},b.exports.warnTo=d.warnTo}),aA={};q(aA,{default:()=>aB});var aB,aC=o(()=>{y(),aB={}}),aD=p((a,b)=>{y();var c=(J(),t(H)),d=(ap(),t(an));function e(a){if("/"===a.charAt(0)){var b=a.split(" ");return{host:b[0],database:b[1]}}var e=c.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(a)?encodeURI(a).replace(/\%25(\d\d)/g,"%$1"):a,!0),b=e.query;for(var f in b)Array.isArray(b[f])&&(b[f]=b[f][b[f].length-1]);var g=(e.auth||":").split(":");if(b.user=g[0],b.password=g.splice(1).join(":"),b.port=e.port,"socket:"==e.protocol)return b.host=decodeURI(e.pathname),b.database=e.query.db,b.client_encoding=e.query.encoding,b;b.host||(b.host=e.hostname);var h=e.pathname;if(!b.host&&h&&/^%2f/i.test(h)){var i=h.split("/");b.host=decodeURIComponent(i[0]),h=i.splice(1).join("/")}switch(h&&"/"===h.charAt(0)&&(h=h.slice(1)||null),b.database=h&&decodeURI(h),("true"===b.ssl||"1"===b.ssl)&&(b.ssl=!0),"0"===b.ssl&&(b.ssl=!1),(b.sslcert||b.sslkey||b.sslrootcert||b.sslmode)&&(b.ssl={}),b.sslcert&&(b.ssl.cert=d.readFileSync(b.sslcert).toString()),b.sslkey&&(b.ssl.key=d.readFileSync(b.sslkey).toString()),b.sslrootcert&&(b.ssl.ca=d.readFileSync(b.sslrootcert).toString()),b.sslmode){case"disable":b.ssl=!1;break;case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":b.ssl.rejectUnauthorized=!1}return b}n(e,"parse"),b.exports=e,e.parse=e}),aE=p((a,b)=>{y();var c=(aC(),t(aA)),d=ae(),e=aD().parse,f=n(function(a,b,c){return void 0===c?c=g.env["PG"+a.toUpperCase()]:!1===c||(c=g.env[c]),b[a]||c||d[a]},"val"),h=n(function(){switch(g.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return d.ssl},"readSSLConfigFromEnvironment"),i=n(function(a){return"'"+(""+a).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),j=n(function(a,b,c){var d=b[c];null!=d&&a.push(c+"="+i(d))},"add"),k=class{constructor(a){(a="string"==typeof a?e(a):a||{}).connectionString&&(a=Object.assign({},a,e(a.connectionString))),this.user=f("user",a),this.database=f("database",a),void 0===this.database&&(this.database=this.user),this.port=parseInt(f("port",a),10),this.host=f("host",a),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:f("password",a)}),this.binary=f("binary",a),this.options=f("options",a),this.ssl=typeof a.ssl>"u"?h():a.ssl,"string"==typeof this.ssl&&"true"===this.ssl&&(this.ssl=!0),"no-verify"===this.ssl&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=f("client_encoding",a),this.replication=f("replication",a),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=f("application_name",a,"PGAPPNAME"),this.fallback_application_name=f("fallback_application_name",a,!1),this.statement_timeout=f("statement_timeout",a,!1),this.lock_timeout=f("lock_timeout",a,!1),this.idle_in_transaction_session_timeout=f("idle_in_transaction_session_timeout",a,!1),this.query_timeout=f("query_timeout",a,!1),void 0===a.connectionTimeoutMillis?this.connect_timeout=g.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(a.connectionTimeoutMillis/1e3),!1===a.keepAlive?this.keepalives=0:!0===a.keepAlive&&(this.keepalives=1),"number"==typeof a.keepAliveInitialDelayMillis&&(this.keepalives_idle=Math.floor(a.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(a){var b=[];j(b,this,"user"),j(b,this,"password"),j(b,this,"port"),j(b,this,"application_name"),j(b,this,"fallback_application_name"),j(b,this,"connect_timeout"),j(b,this,"options");var d="object"==typeof this.ssl?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(j(b,d,"sslmode"),j(b,d,"sslca"),j(b,d,"sslkey"),j(b,d,"sslcert"),j(b,d,"sslrootcert"),this.database&&b.push("dbname="+i(this.database)),this.replication&&b.push("replication="+i(this.replication)),this.host&&b.push("host="+i(this.host)),this.isDomainSocket)return a(null,b.join(" "));this.client_encoding&&b.push("client_encoding="+i(this.client_encoding)),c.lookup(this.host,function(c,d){return c?a(c,null):(b.push("hostaddr="+i(d)),a(null,b.join(" ")))})}};n(k,"ConnectionParameters"),b.exports=k}),aF=p((a,b)=>{y();var c=U(),d=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,e=class{constructor(a,b){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=b,this.RowCtor=null,this.rowAsArray="array"===a,this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(a){var b;(b=a.text?d.exec(a.text):d.exec(a.command))&&(this.command=b[1],b[3]?(this.oid=parseInt(b[2],10),this.rowCount=parseInt(b[3],10)):b[2]&&(this.rowCount=parseInt(b[2],10)))}_parseRowAsArray(a){for(var b=Array(a.length),c=0,d=a.length;c<d;c++){var e=a[c];null!==e?b[c]=this._parsers[c](e):b[c]=null}return b}parseRow(a){for(var b={},c=0,d=a.length;c<d;c++){var e=a[c],f=this.fields[c].name;null!==e?b[f]=this._parsers[c](e):b[f]=null}return b}addRow(a){this.rows.push(a)}addFields(a){this.fields=a,this.fields.length&&(this._parsers=Array(a.length));for(var b=0;b<a.length;b++){var d=a[b];this._types?this._parsers[b]=this._types.getTypeParser(d.dataTypeID,d.format||"text"):this._parsers[b]=c.getTypeParser(d.dataTypeID,d.format||"text")}}};n(e,"Result"),b.exports=e}),aG=p((a,b)=>{y();var{EventEmitter:c}=z(),d=aF(),e=af(),f=class extends c{constructor(a,b,c){super(),a=e.normalizeQueryConfig(a,b,c),this.text=a.text,this.values=a.values,this.rows=a.rows,this.types=a.types,this.name=a.name,this.binary=a.binary,this.portal=a.portal||"",this.callback=a.callback,this._rowMode=a.rowMode,g.domain&&a.callback&&(this.callback=g.domain.bind(a.callback)),this._result=new d(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return!!this.name||!!this.rows||!!this.text&&!!this.values&&this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new d(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(a){this._checkForMultirow(),this._result.addFields(a.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(a){let b;if(!this._canceledDueToError){try{b=this._result.parseRow(a.fields)}catch(a){this._canceledDueToError=a;return}this.emit("row",b,this._result),this._accumulateRows&&this._result.addRow(b)}}handleCommandComplete(a,b){this._checkForMultirow(),this._result.addCommandComplete(a),this.rows&&b.sync()}handleEmptyQuery(a){this.rows&&a.sync()}handleError(a,b){if(this._canceledDueToError&&(a=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(a);this.emit("error",a)}handleReadyForQuery(a){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,a);if(this.callback)try{this.callback(null,this._results)}catch(a){g.nextTick(()=>{throw a})}this.emit("end",this._results)}submit(a){if("string"!=typeof this.text&&"string"!=typeof this.name)return Error("A query must have either text or a name. Supplying neither is unsupported.");let b=a.parsedStatements[this.name];return this.text&&b&&this.text!==b?Error(`Prepared statements must be unique - '${this.name}\
' was used for a different statement`):this.values&&!Array.isArray(this.values)?Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(a):a.query(this.text),null)}hasBeenParsed(a){return this.name&&a.parsedStatements[this.name]}handlePortalSuspended(a){this._getRows(a,this.rows)}_getRows(a,b){a.execute({portal:this.portal,rows:b}),b?a.flush():a.sync()}prepare(a){this.isPreparedStatement=!0,this.hasBeenParsed(a)||a.parse({text:this.text,name:this.name,types:this.types});try{a.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:e.prepareValue})}catch(b){this.handleError(b,a);return}a.describe({type:"P",name:this.portal||""}),this._getRows(a,this.rows)}handleCopyInResponse(a){a.sendCopyFail("No source stream defined")}handleCopyData(a,b){}};n(f,"Query"),b.exports=f}),aH=p(a=>{y(),Object.defineProperty(a,"__esModule",{value:!0}),a.NoticeMessage=a.DataRowMessage=a.CommandCompleteMessage=a.ReadyForQueryMessage=a.NotificationResponseMessage=a.BackendKeyDataMessage=a.AuthenticationMD5Password=a.ParameterStatusMessage=a.ParameterDescriptionMessage=a.RowDescriptionMessage=a.Field=a.CopyResponse=a.CopyDataMessage=a.DatabaseError=a.copyDone=a.emptyQuery=a.replicationStart=a.portalSuspended=a.noData=a.closeComplete=a.bindComplete=a.parseComplete=void 0,a.parseComplete={name:"parseComplete",length:5},a.bindComplete={name:"bindComplete",length:5},a.closeComplete={name:"closeComplete",length:5},a.noData={name:"noData",length:5},a.portalSuspended={name:"portalSuspended",length:5},a.replicationStart={name:"replicationStart",length:4},a.emptyQuery={name:"emptyQuery",length:4},a.copyDone={name:"copyDone",length:4};var b=class extends Error{constructor(a,b,c){super(a),this.length=b,this.name=c}};n(b,"DatabaseError"),a.DatabaseError=b;var c=class{constructor(a,b){this.length=a,this.chunk=b,this.name="copyData"}};n(c,"CopyDataMessage"),a.CopyDataMessage=c;var d=class{constructor(a,b,c,d){this.length=a,this.name=b,this.binary=c,this.columnTypes=Array(d)}};n(d,"CopyResponse"),a.CopyResponse=d;var e=class{constructor(a,b,c,d,e,f,g){this.name=a,this.tableID=b,this.columnID=c,this.dataTypeID=d,this.dataTypeSize=e,this.dataTypeModifier=f,this.format=g}};n(e,"Field"),a.Field=e;var f=class{constructor(a,b){this.length=a,this.fieldCount=b,this.name="rowDescription",this.fields=Array(this.fieldCount)}};n(f,"RowDescriptionMessage"),a.RowDescriptionMessage=f;var g=class{constructor(a,b){this.length=a,this.parameterCount=b,this.name="parameterDescription",this.dataTypeIDs=Array(this.parameterCount)}};n(g,"ParameterDescriptionMessage"),a.ParameterDescriptionMessage=g;var h=class{constructor(a,b,c){this.length=a,this.parameterName=b,this.parameterValue=c,this.name="parameterStatus"}};n(h,"ParameterStatusMessage"),a.ParameterStatusMessage=h;var i=class{constructor(a,b){this.length=a,this.salt=b,this.name="authenticationMD5Password"}};n(i,"AuthenticationMD5Password"),a.AuthenticationMD5Password=i;var j=class{constructor(a,b,c){this.length=a,this.processID=b,this.secretKey=c,this.name="backendKeyData"}};n(j,"BackendKeyDataMessage"),a.BackendKeyDataMessage=j;var k=class{constructor(a,b,c,d){this.length=a,this.processId=b,this.channel=c,this.payload=d,this.name="notification"}};n(k,"NotificationResponseMessage"),a.NotificationResponseMessage=k;var l=class{constructor(a,b){this.length=a,this.status=b,this.name="readyForQuery"}};n(l,"ReadyForQueryMessage"),a.ReadyForQueryMessage=l;var m=class{constructor(a,b){this.length=a,this.text=b,this.name="commandComplete"}};n(m,"CommandCompleteMessage"),a.CommandCompleteMessage=m;var o=class{constructor(a,b){this.length=a,this.fields=b,this.name="dataRow",this.fieldCount=b.length}};n(o,"DataRowMessage"),a.DataRowMessage=o;var p=class{constructor(a,b){this.length=a,this.message=b,this.name="notice"}};n(p,"NoticeMessage"),a.NoticeMessage=p}),aI=p(a=>{y(),Object.defineProperty(a,"__esModule",{value:!0}),a.Writer=void 0;var b=class{constructor(a=256){this.size=a,this.offset=5,this.headerPosition=0,this.buffer=f.allocUnsafe(a)}ensure(a){if(this.buffer.length-this.offset<a){let b=this.buffer,c=b.length+(b.length>>1)+a;this.buffer=f.allocUnsafe(c),b.copy(this.buffer)}}addInt32(a){return this.ensure(4),this.buffer[this.offset++]=a>>>24&255,this.buffer[this.offset++]=a>>>16&255,this.buffer[this.offset++]=a>>>8&255,this.buffer[this.offset++]=a>>>0&255,this}addInt16(a){return this.ensure(2),this.buffer[this.offset++]=a>>>8&255,this.buffer[this.offset++]=a>>>0&255,this}addCString(a){if(a){let b=f.byteLength(a);this.ensure(b+1),this.buffer.write(a,this.offset,"utf-8"),this.offset+=b}else this.ensure(1);return this.buffer[this.offset++]=0,this}addString(a=""){let b=f.byteLength(a);return this.ensure(b),this.buffer.write(a,this.offset),this.offset+=b,this}add(a){return this.ensure(a.length),a.copy(this.buffer,this.offset),this.offset+=a.length,this}join(a){if(a){this.buffer[this.headerPosition]=a;let b=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(b,this.headerPosition+1)}return this.buffer.slice(5*!a,this.offset)}flush(a){let b=this.join(a);return this.offset=5,this.headerPosition=0,this.buffer=f.allocUnsafe(this.size),b}};n(b,"Writer"),a.Writer=b}),aJ=p(a=>{y(),Object.defineProperty(a,"__esModule",{value:!0}),a.serialize=void 0;var b=aI(),c=new b.Writer,d=n(a=>{for(let b of(c.addInt16(3).addInt16(0),Object.keys(a)))c.addCString(b).addCString(a[b]);c.addCString("client_encoding").addCString("UTF8");let d=c.addCString("").flush(),e=d.length+4;return new b.Writer().addInt32(e).add(d).flush()},"startup"),e=n(()=>{let a=f.allocUnsafe(8);return a.writeInt32BE(8,0),a.writeInt32BE(0x4d2162f,4),a},"requestSsl"),g=n(a=>c.addCString(a).flush(112),"password"),h=n(function(a,b){return c.addCString(a).addInt32(f.byteLength(b)).addString(b),c.flush(112)},"sendSASLInitialResponseMessage"),i=n(function(a){return c.addString(a).flush(112)},"sendSCRAMClientFinalMessage"),j=n(a=>c.addCString(a).flush(81),"query"),k=[],l=n(a=>{let b=a.name||"";b.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",b,b.length),console.error("This can cause conflicts and silent errors executing queries"));let d=a.types||k,e=d.length,f=c.addCString(b).addCString(a.text).addInt16(e);for(let a=0;a<e;a++)f.addInt32(d[a]);return c.flush(80)},"parse"),m=new b.Writer,o=n(function(a,b){for(let d=0;d<a.length;d++){let e=b?b(a[d],d):a[d];null==e?(c.addInt16(0),m.addInt32(-1)):e instanceof f?(c.addInt16(1),m.addInt32(e.length),m.add(e)):(c.addInt16(0),m.addInt32(f.byteLength(e)),m.addString(e))}},"writeValues"),p=n((a={})=>{let b=a.portal||"",d=a.statement||"",e=a.binary||!1,f=a.values||k,g=f.length;return c.addCString(b).addCString(d),c.addInt16(g),o(f,a.valueMapper),c.addInt16(g),c.add(m.flush()),c.addInt16(+!!e),c.flush(66)},"bind"),q=f.from([69,0,0,0,9,0,0,0,0,0]),r=n(a=>{if(!a||!a.portal&&!a.rows)return q;let b=a.portal||"",c=a.rows||0,d=f.byteLength(b),e=4+d+1+4,g=f.allocUnsafe(1+e);return g[0]=69,g.writeInt32BE(e,1),g.write(b,5,"utf-8"),g[d+5]=0,g.writeUInt32BE(c,g.length-4),g},"execute"),s=n((a,b)=>{let c=f.allocUnsafe(16);return c.writeInt32BE(16,0),c.writeInt16BE(1234,4),c.writeInt16BE(5678,6),c.writeInt32BE(a,8),c.writeInt32BE(b,12),c},"cancel"),t=n((a,b)=>{let c=4+f.byteLength(b)+1,d=f.allocUnsafe(1+c);return d[0]=a,d.writeInt32BE(c,1),d.write(b,5,"utf-8"),d[c]=0,d},"cstringMessage"),u=c.addCString("P").flush(68),v=c.addCString("S").flush(68),w=n(a=>a.name?t(68,`${a.type}${a.name||""}`):"P"===a.type?u:v,"describe"),x=n(a=>t(67,`${a.type}${a.name||""}`),"close"),z=n(a=>c.add(a).flush(100),"copyData"),A=n(a=>t(102,a),"copyFail"),B=n(a=>f.from([a,0,0,0,4]),"codeOnlyBuffer"),C=B(72),D=B(83),E=B(88),F=B(99);a.serialize={startup:d,password:g,requestSsl:e,sendSASLInitialResponseMessage:h,sendSCRAMClientFinalMessage:i,query:j,parse:l,bind:p,execute:r,describe:w,close:x,flush:n(()=>C,"flush"),sync:n(()=>D,"sync"),end:n(()=>E,"end"),copyData:z,copyDone:n(()=>F,"copyDone"),copyFail:A,cancel:s}}),aK=p(a=>{y(),Object.defineProperty(a,"__esModule",{value:!0}),a.BufferReader=void 0;var b=f.allocUnsafe(0),c=class{constructor(a=0){this.offset=a,this.buffer=b,this.encoding="utf-8"}setBuffer(a,b){this.offset=a,this.buffer=b}int16(){let a=this.buffer.readInt16BE(this.offset);return this.offset+=2,a}byte(){let a=this.buffer[this.offset];return this.offset++,a}int32(){let a=this.buffer.readInt32BE(this.offset);return this.offset+=4,a}uint32(){let a=this.buffer.readUInt32BE(this.offset);return this.offset+=4,a}string(a){let b=this.buffer.toString(this.encoding,this.offset,this.offset+a);return this.offset+=a,b}cstring(){let a=this.offset,b=a;for(;0!==this.buffer[b++];);return this.offset=b,this.buffer.toString(this.encoding,a,b-1)}bytes(a){let b=this.buffer.slice(this.offset,this.offset+a);return this.offset+=a,b}};n(c,"BufferReader"),a.BufferReader=c}),aL=p(a=>{y(),Object.defineProperty(a,"__esModule",{value:!0}),a.Parser=void 0;var b=aH(),c=aK(),d=f.allocUnsafe(0),e=class{constructor(a){if(this.buffer=d,this.bufferLength=0,this.bufferOffset=0,this.reader=new c.BufferReader,a?.mode==="binary")throw Error("Binary mode not supported yet");this.mode=a?.mode||"text"}parse(a,b){this.mergeBuffer(a);let c=this.bufferOffset+this.bufferLength,e=this.bufferOffset;for(;e+5<=c;){let a=this.buffer[e],d=this.buffer.readUInt32BE(e+1),f=1+d;if(f+e<=c)b(this.handlePacket(e+5,a,d,this.buffer)),e+=f;else break}e===c?(this.buffer=d,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=c-e,this.bufferOffset=e)}mergeBuffer(a){if(this.bufferLength>0){let b=this.bufferLength+a.byteLength;if(b+this.bufferOffset>this.buffer.byteLength){let a;if(b<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)a=this.buffer;else{let c=2*this.buffer.byteLength;for(;b>=c;)c*=2;a=f.allocUnsafe(c)}this.buffer.copy(a,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=a,this.bufferOffset=0}a.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=b}else this.buffer=a,this.bufferOffset=0,this.bufferLength=a.byteLength}handlePacket(a,c,d,e){switch(c){case 50:return b.bindComplete;case 49:return b.parseComplete;case 51:return b.closeComplete;case 110:return b.noData;case 115:return b.portalSuspended;case 99:return b.copyDone;case 87:return b.replicationStart;case 73:return b.emptyQuery;case 68:return this.parseDataRowMessage(a,d,e);case 67:return this.parseCommandCompleteMessage(a,d,e);case 90:return this.parseReadyForQueryMessage(a,d,e);case 65:return this.parseNotificationMessage(a,d,e);case 82:return this.parseAuthenticationResponse(a,d,e);case 83:return this.parseParameterStatusMessage(a,d,e);case 75:return this.parseBackendKeyData(a,d,e);case 69:return this.parseErrorMessage(a,d,e,"error");case 78:return this.parseErrorMessage(a,d,e,"notice");case 84:return this.parseRowDescriptionMessage(a,d,e);case 116:return this.parseParameterDescriptionMessage(a,d,e);case 71:return this.parseCopyInMessage(a,d,e);case 72:return this.parseCopyOutMessage(a,d,e);case 100:return this.parseCopyData(a,d,e);default:return new b.DatabaseError("received invalid response: "+c.toString(16),d,"error")}}parseReadyForQueryMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.string(1);return new b.ReadyForQueryMessage(c,e)}parseCommandCompleteMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.cstring();return new b.CommandCompleteMessage(c,e)}parseCopyData(a,c,d){let e=d.slice(a,a+(c-4));return new b.CopyDataMessage(c,e)}parseCopyInMessage(a,b,c){return this.parseCopyMessage(a,b,c,"copyInResponse")}parseCopyOutMessage(a,b,c){return this.parseCopyMessage(a,b,c,"copyOutResponse")}parseCopyMessage(a,c,d,e){this.reader.setBuffer(a,d);let f=0!==this.reader.byte(),g=this.reader.int16(),h=new b.CopyResponse(c,e,f,g);for(let a=0;a<g;a++)h.columnTypes[a]=this.reader.int16();return h}parseNotificationMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f=this.reader.cstring(),g=this.reader.cstring();return new b.NotificationResponseMessage(c,e,f,g)}parseRowDescriptionMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=new b.RowDescriptionMessage(c,e);for(let a=0;a<e;a++)f.fields[a]=this.parseField();return f}parseField(){let a=this.reader.cstring(),c=this.reader.uint32(),d=this.reader.int16(),e=this.reader.uint32(),f=this.reader.int16(),g=this.reader.int32(),h=0===this.reader.int16()?"text":"binary";return new b.Field(a,c,d,e,f,g,h)}parseParameterDescriptionMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=new b.ParameterDescriptionMessage(c,e);for(let a=0;a<e;a++)f.dataTypeIDs[a]=this.reader.int32();return f}parseDataRowMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int16(),f=Array(e);for(let a=0;a<e;a++){let b=this.reader.int32();f[a]=-1===b?null:this.reader.string(b)}return new b.DataRowMessage(c,f)}parseParameterStatusMessage(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.cstring(),f=this.reader.cstring();return new b.ParameterStatusMessage(c,e,f)}parseBackendKeyData(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f=this.reader.int32();return new b.BackendKeyDataMessage(c,e,f)}parseAuthenticationResponse(a,c,d){this.reader.setBuffer(a,d);let e=this.reader.int32(),f={name:"authenticationOk",length:c};switch(e){case 0:break;case 3:8===f.length&&(f.name="authenticationCleartextPassword");break;case 5:if(12===f.length){f.name="authenticationMD5Password";let a=this.reader.bytes(4);return new b.AuthenticationMD5Password(c,a)}break;case 10:{let a;f.name="authenticationSASL",f.mechanisms=[];do(a=this.reader.cstring())&&f.mechanisms.push(a);while(a)}break;case 11:f.name="authenticationSASLContinue",f.data=this.reader.string(c-8);break;case 12:f.name="authenticationSASLFinal",f.data=this.reader.string(c-8);break;default:throw Error("Unknown authenticationOk message type "+e)}return f}parseErrorMessage(a,c,d,e){this.reader.setBuffer(a,d);let f={},g=this.reader.string(1);for(;"\0"!==g;)f[g]=this.reader.cstring(),g=this.reader.string(1);let h=f.M,i="notice"===e?new b.NoticeMessage(c,h):new b.DatabaseError(h,c,e);return i.severity=f.S,i.code=f.C,i.detail=f.D,i.hint=f.H,i.position=f.P,i.internalPosition=f.p,i.internalQuery=f.q,i.where=f.W,i.schema=f.s,i.table=f.t,i.column=f.c,i.dataType=f.d,i.constraint=f.n,i.file=f.F,i.line=f.L,i.routine=f.R,i}};n(e,"Parser"),a.Parser=e}),aM=p(a=>{y(),Object.defineProperty(a,"__esModule",{value:!0}),a.DatabaseError=a.serialize=a.parse=void 0;var b=aH();Object.defineProperty(a,"DatabaseError",{enumerable:!0,get:n(function(){return b.DatabaseError},"get")});var c=aJ();Object.defineProperty(a,"serialize",{enumerable:!0,get:n(function(){return c.serialize},"get")});var d=aL();function e(a,b){let c=new d.Parser;return a.on("data",a=>c.parse(a,b)),new Promise(b=>a.on("end",()=>b()))}n(e,"parse"),a.parse=e}),aN={};function aO({socket:a,servername:b}){return a.startTls(b),a}q(aN,{connect:()=>aO});var aP=o(()=>{y(),n(aO,"connect")}),aQ=p((a,b)=>{y();var c=(G(),t(A)),d=z().EventEmitter,{parse:e,serialize:f}=aM(),g=f.flush(),h=f.sync(),i=f.end(),j=class extends d{constructor(a){super(),a=a||{},this.stream=a.stream||new c.Socket,this._keepAlive=a.keepAlive,this._keepAliveInitialDelayMillis=a.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=a.ssl||!1,this._ending=!1,this._emitMessage=!1;var b=this;this.on("newListener",function(a){"message"===a&&(b._emitMessage=!0)})}connect(a,b){var d=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(a,b),this.stream.once("connect",function(){d._keepAlive&&d.stream.setKeepAlive(!0,d._keepAliveInitialDelayMillis),d.emit("connect")});let e=n(function(a){d._ending&&("ECONNRESET"===a.code||"EPIPE"===a.code)||d.emit("error",a)},"reportStreamError");if(this.stream.on("error",e),this.stream.on("close",function(){d.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(a){switch(a.toString("utf8")){case"S":break;case"N":return d.stream.end(),d.emit("error",Error("The server does not support SSL connections"));default:return d.stream.end(),d.emit("error",Error("There was an error establishing an SSL connection"))}var f=(aP(),t(aN));let g={socket:d.stream};!0!==d.ssl&&(Object.assign(g,d.ssl),"key"in d.ssl&&(g.key=d.ssl.key)),0===c.isIP(b)&&(g.servername=b);try{d.stream=f.connect(g)}catch(a){return d.emit("error",a)}d.attachListeners(d.stream),d.stream.on("error",e),d.emit("sslconnect")})}attachListeners(a){a.on("end",()=>{this.emit("end")}),e(a,a=>{var b="error"===a.name?"errorMessage":a.name;this._emitMessage&&this.emit("message",a),this.emit(b,a)})}requestSsl(){this.stream.write(f.requestSsl())}startup(a){this.stream.write(f.startup(a))}cancel(a,b){this._send(f.cancel(a,b))}password(a){this._send(f.password(a))}sendSASLInitialResponseMessage(a,b){this._send(f.sendSASLInitialResponseMessage(a,b))}sendSCRAMClientFinalMessage(a){this._send(f.sendSCRAMClientFinalMessage(a))}_send(a){return!!this.stream.writable&&this.stream.write(a)}query(a){this._send(f.query(a))}parse(a){this._send(f.parse(a))}bind(a){this._send(f.bind(a))}execute(a){this._send(f.execute(a))}flush(){this.stream.writable&&this.stream.write(g)}sync(){this._ending=!0,this._send(g),this._send(h)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){return(this._ending=!0,this._connecting&&this.stream.writable)?this.stream.write(i,()=>{this.stream.end()}):void this.stream.end()}close(a){this._send(f.close(a))}describe(a){this._send(f.describe(a))}sendCopyFromChunk(a){this._send(f.copyData(a))}endCopyFrom(){this._send(f.copyDone())}sendCopyFail(a){this._send(f.copyFail(a))}};n(j,"Connection"),b.exports=j}),aR=p((a,b)=>{y();var c=z().EventEmitter,e=(ai(),t(ag),af()),f=aj(),h=az(),i=V(),j=aE(),k=aG(),l=ae(),m=aQ(),o=class extends c{constructor(a){super(),this.connectionParameters=new j(a),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var b=a||{};this._Promise=b.Promise||d.Promise,this._types=new i(b.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=b.connection||new m({stream:b.stream,ssl:this.connectionParameters.ssl,keepAlive:b.keepAlive||!1,keepAliveInitialDelayMillis:b.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=b.binary||l.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=b.connectionTimeoutMillis||0}_errorAllQueries(a){let b=n(b=>{g.nextTick(()=>{b.handleError(a,this.connection)})},"enqueueError");this.activeQuery&&(b(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(b),this.queryQueue.length=0}_connect(a){var b=this,c=this.connection;if(this._connectionCallback=a,this._connecting||this._connected){let b=Error("Client has already been connected. You cannot reuse a client.");g.nextTick(()=>{a(b)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{c._ending=!0,c.stream.destroy(Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&0===this.host.indexOf("/")?c.connect(this.host+"/.s.PGSQL."+this.port):c.connect(this.port,this.host),c.on("connect",function(){b.ssl?c.requestSsl():c.startup(b.getStartupConf())}),c.on("sslconnect",function(){c.startup(b.getStartupConf())}),this._attachListeners(c),c.once("end",()=>{let a=this._ending?Error("Connection terminated"):Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(a),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(a):this._handleErrorEvent(a):this._connectionError||this._handleErrorEvent(a)),g.nextTick(()=>{this.emit("end")})})}connect(a){return a?void this._connect(a):new this._Promise((a,b)=>{this._connect(c=>{c?b(c):a()})})}_attachListeners(a){a.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),a.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),a.on("authenticationSASL",this._handleAuthSASL.bind(this)),a.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),a.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),a.on("backendKeyData",this._handleBackendKeyData.bind(this)),a.on("error",this._handleErrorEvent.bind(this)),a.on("errorMessage",this._handleErrorMessage.bind(this)),a.on("readyForQuery",this._handleReadyForQuery.bind(this)),a.on("notice",this._handleNotice.bind(this)),a.on("rowDescription",this._handleRowDescription.bind(this)),a.on("dataRow",this._handleDataRow.bind(this)),a.on("portalSuspended",this._handlePortalSuspended.bind(this)),a.on("emptyQuery",this._handleEmptyQuery.bind(this)),a.on("commandComplete",this._handleCommandComplete.bind(this)),a.on("parseComplete",this._handleParseComplete.bind(this)),a.on("copyInResponse",this._handleCopyInResponse.bind(this)),a.on("copyData",this._handleCopyData.bind(this)),a.on("notification",this._handleNotification.bind(this))}_checkPgPass(a){let b=this.connection;"function"==typeof this.password?this._Promise.resolve().then(()=>this.password()).then(c=>{if(void 0!==c){if("string"!=typeof c)return void b.emit("error",TypeError("Password must be a string"));this.connectionParameters.password=this.password=c}else this.connectionParameters.password=this.password=null;a()}).catch(a=>{b.emit("error",a)}):null!==this.password?a():h(this.connectionParameters,b=>{void 0!==b&&(this.connectionParameters.password=this.password=b),a()})}_handleAuthCleartextPassword(a){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(a){this._checkPgPass(()=>{let b=e.postgresMd5PasswordHash(this.user,this.password,a.salt);this.connection.password(b)})}_handleAuthSASL(a){this._checkPgPass(()=>{this.saslSession=f.startSession(a.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(a){f.continueSession(this.saslSession,this.password,a.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(a){f.finalizeSession(this.saslSession,a.data),this.saslSession=null}_handleBackendKeyData(a){this.processID=a.processID,this.secretKey=a.secretKey}_handleReadyForQuery(a){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:b}=this;this.activeQuery=null,this.readyForQuery=!0,b&&b.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(a){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(a);this.emit("error",a)}}_handleErrorEvent(a){if(this._connecting)return this._handleErrorWhileConnecting(a);this._queryable=!1,this._errorAllQueries(a),this.emit("error",a)}_handleErrorMessage(a){if(this._connecting)return this._handleErrorWhileConnecting(a);let b=this.activeQuery;b?(this.activeQuery=null,b.handleError(a,this.connection)):this._handleErrorEvent(a)}_handleRowDescription(a){this.activeQuery.handleRowDescription(a)}_handleDataRow(a){this.activeQuery.handleDataRow(a)}_handlePortalSuspended(a){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(a){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(a){this.activeQuery.handleCommandComplete(a,this.connection)}_handleParseComplete(a){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(a){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(a){this.activeQuery.handleCopyData(a,this.connection)}_handleNotification(a){this.emit("notification",a)}_handleNotice(a){this.emit("notice",a)}getStartupConf(){var a=this.connectionParameters,b={user:a.user,database:a.database},c=a.application_name||a.fallback_application_name;return c&&(b.application_name=c),a.replication&&(b.replication=""+a.replication),a.statement_timeout&&(b.statement_timeout=String(parseInt(a.statement_timeout,10))),a.lock_timeout&&(b.lock_timeout=String(parseInt(a.lock_timeout,10))),a.idle_in_transaction_session_timeout&&(b.idle_in_transaction_session_timeout=String(parseInt(a.idle_in_transaction_session_timeout,10))),a.options&&(b.options=a.options),b}cancel(a,b){if(a.activeQuery===b){var c=this.connection;this.host&&0===this.host.indexOf("/")?c.connect(this.host+"/.s.PGSQL."+this.port):c.connect(this.port,this.host),c.on("connect",function(){c.cancel(a.processID,a.secretKey)})}else -1!==a.queryQueue.indexOf(b)&&a.queryQueue.splice(a.queryQueue.indexOf(b),1)}setTypeParser(a,b,c){return this._types.setTypeParser(a,b,c)}getTypeParser(a,b){return this._types.getTypeParser(a,b)}escapeIdentifier(a){return'"'+a.replace(/"/g,'""')+'"'}escapeLiteral(a){for(var b=!1,c="'",d=0;d<a.length;d++){var e=a[d];"'"===e?c+=e+e:"\\"===e?(c+=e+e,b=!0):c+=e}return c+="'",!0===b&&(c=" E"+c),c}_pulseQueryQueue(){if(!0===this.readyForQuery)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let a=this.activeQuery.submit(this.connection);a&&g.nextTick(()=>{this.activeQuery.handleError(a,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(a,b,c){var d,e,f,h,i;if(null==a)throw TypeError("Client was passed a null or undefined query");return"function"==typeof a.submit?(f=a.query_timeout||this.connectionParameters.query_timeout,e=d=a,"function"==typeof b&&(d.callback=d.callback||b)):(f=this.connectionParameters.query_timeout,(d=new k(a,b,c)).callback||(e=new this._Promise((a,b)=>{d.callback=(c,d)=>c?b(c):a(d)}))),f&&(i=d.callback,h=setTimeout(()=>{var a=Error("Query read timeout");g.nextTick(()=>{d.handleError(a,this.connection)}),i(a),d.callback=()=>{};var b=this.queryQueue.indexOf(d);b>-1&&this.queryQueue.splice(b,1),this._pulseQueryQueue()},f),d.callback=(a,b)=>{clearTimeout(h),i(a,b)}),this.binary&&!d.binary&&(d.binary=!0),d._result&&!d._result._types&&(d._result._types=this._types),this._queryable?this._ending?g.nextTick(()=>{d.handleError(Error("Client was closed and is not queryable"),this.connection)}):(this.queryQueue.push(d),this._pulseQueryQueue()):g.nextTick(()=>{d.handleError(Error("Client has encountered a connection error and is not queryable"),this.connection)}),e}ref(){this.connection.ref()}unref(){this.connection.unref()}end(a){if(this._ending=!0,!this.connection._connecting)if(!a)return this._Promise.resolve();else a();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),!a)return new this._Promise(a=>{this.connection.once("end",a)});this.connection.once("end",a)}};n(o,"Client"),o.Query=k,b.exports=o}),aS=p((a,b)=>{y();var c=z().EventEmitter,f=n(function(){},"NOOP"),h=n((a,b)=>{let c=a.findIndex(b);return -1===c?void 0:a.splice(c,1)[0]},"removeWhere"),i=class{constructor(a,b,c){this.client=a,this.idleListener=b,this.timeoutId=c}};n(i,"IdleItem");var j=class{constructor(a){this.callback=a}};function k(){throw Error("Release called on client which has already been released to the pool.")}function l(a,b){let c,d;return b?{callback:b,result:void 0}:{callback:n(function(a,b){a?c(a):d(b)},"cb"),result:new a(function(a,b){d=a,c=b}).catch(a=>{throw Error.captureStackTrace(a),a})}}function m(a,b){return n(function c(d){d.client=b,b.removeListener("error",c),b.on("error",()=>{a.log("additional client error after disconnection due to error",d)}),a._remove(b),a.emit("error",d,b)},"idleListener")}n(j,"PendingItem"),n(k,"throwOnDoubleRelease"),n(l,"promisify"),n(m,"makeIdleListener");var o=class extends c{constructor(a,b){super(),this.options=Object.assign({},a),null!=a&&"password"in a&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:a.password}),null!=a&&a.ssl&&a.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||b||a$().Client,this.Promise=this.options.Promise||d.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended)return void this.log("pulse queue ended");if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length)return void this.log("no queued requests");if(!this._idle.length&&this._isFull())return;let a=this._pendingQueue.shift();if(this._idle.length){let b=this._idle.pop();clearTimeout(b.timeoutId);let c=b.client;c.ref&&c.ref();let d=b.idleListener;return this._acquireClient(c,a,d,!1)}if(!this._isFull())return this.newClient(a);throw Error("unexpected condition")}_remove(a){let b=h(this._idle,b=>b.client===a);void 0!==b&&clearTimeout(b.timeoutId),this._clients=this._clients.filter(b=>b!==a),a.end(),this.emit("remove",a)}connect(a){if(this.ending){let b=Error("Cannot use a pool after calling end on the pool");return a?a(b):this.Promise.reject(b)}let b=l(this.Promise,a),c=b.result;if(this._isFull()||this._idle.length){if(this._idle.length&&g.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new j(b.callback)),c;let a=n((a,c,d)=>{clearTimeout(e),b.callback(a,c,d)},"queueCallback"),d=new j(a),e=setTimeout(()=>{h(this._pendingQueue,b=>b.callback===a),d.timedOut=!0,b.callback(Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return e.unref&&e.unref(),this._pendingQueue.push(d),c}return this.newClient(new j(b.callback)),c}newClient(a){let b=new this.Client(this.options);this._clients.push(b);let c=m(this,b);this.log("checking client timeout");let d,e=!1;this.options.connectionTimeoutMillis&&(d=setTimeout(()=>{this.log("ending client due to timeout"),e=!0,b.connection?b.connection.stream.destroy():b.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),b.connect(g=>{if(d&&clearTimeout(d),b.on("error",c),g)this.log("client failed to connect",g),this._clients=this._clients.filter(a=>a!==b),e&&(g=Error("Connection terminated due to connection timeout",{cause:g})),this._pulseQueue(),a.timedOut||a.callback(g,void 0,f);else{if(this.log("new client connected"),0!==this.options.maxLifetimeSeconds){let a=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(b),-1!==this._idle.findIndex(a=>a.client===b)&&this._acquireClient(b,new j((a,b,c)=>c()),c,!1)},1e3*this.options.maxLifetimeSeconds);a.unref(),b.once("end",()=>clearTimeout(a))}return this._acquireClient(b,a,c,!0)}})}_acquireClient(a,b,c,d){d&&this.emit("connect",a),this.emit("acquire",a),a.release=this._releaseOnce(a,c),a.removeListener("error",c),b.timedOut?d&&this.options.verify?this.options.verify(a,a.release):a.release():d&&this.options.verify?this.options.verify(a,c=>{if(c)return a.release(c),b.callback(c,void 0,f);b.callback(void 0,a,a.release)}):b.callback(void 0,a,a.release)}_releaseOnce(a,b){let c=!1;return d=>{c&&k(),c=!0,this._release(a,b,d)}}_release(a,b,c){let d;if(a.on("error",b),a._poolUseCount=(a._poolUseCount||0)+1,this.emit("release",c,a),c||this.ending||!a._queryable||a._ending||a._poolUseCount>=this.options.maxUses){a._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(a),this._pulseQueue();return}if(this._expired.has(a)){this.log("remove expired client"),this._expired.delete(a),this._remove(a),this._pulseQueue();return}this.options.idleTimeoutMillis&&this._isAboveMin()&&(d=setTimeout(()=>{this.log("remove idle client"),this._remove(a)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&d.unref()),this.options.allowExitOnIdle&&a.unref(),this._idle.push(new i(a,b,d)),this._pulseQueue()}query(a,b,c){if("function"==typeof a){let b=l(this.Promise,a);return e(function(){return b.callback(Error("Passing a function as the first parameter to pool.query is not supported"))}),b.result}"function"==typeof b&&(c=b,b=void 0);let d=l(this.Promise,c);return c=d.callback,this.connect((d,e)=>{if(d)return c(d);let f=!1,g=n(a=>{f||(f=!0,e.release(a),c(a))},"onError");e.once("error",g),this.log("dispatching query");try{e.query(a,b,(a,b)=>{if(this.log("query dispatched"),e.removeListener("error",g),!f)return f=!0,e.release(a),a?c(a):c(void 0,b)})}catch(a){return e.release(a),c(a)}}),d.result}end(a){if(this.log("ending"),this.ending){let b=Error("Called end on pool more than once");return a?a(b):this.Promise.reject(b)}this.ending=!0;let b=l(this.Promise,a);return this._endCallback=b.callback,this._pulseQueue(),b.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((a,b)=>a+ +!!this._expired.has(b),0)}get totalCount(){return this._clients.length}};n(o,"Pool"),b.exports=o}),aT={};q(aT,{default:()=>aU});var aU,aV=o(()=>{y(),aU={}}),aW=p((a,b)=>{b.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),aX=p((a,b)=>{y();var c=z().EventEmitter,d=(ai(),t(ag)),f=af(),h=b.exports=function(a,b,d){c.call(this),a=f.normalizeQueryConfig(a,b,d),this.text=a.text,this.values=a.values,this.name=a.name,this.callback=a.callback,this.state="new",this._arrayMode="array"===a.rowMode,this._emitRowEvents=!1,this.on("newListener",(function(a){"row"===a&&(this._emitRowEvents=!0)}).bind(this))};d.inherits(h,c);var i={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};h.prototype.handleError=function(a){var b=this.native.pq.resultErrorFields();if(b)for(var c in b)a[i[c]||c]=b[c];this.callback?this.callback(a):this.emit("error",a),this.state="error"},h.prototype.then=function(a,b){return this._getPromise().then(a,b)},h.prototype.catch=function(a){return this._getPromise().catch(a)},h.prototype._getPromise=function(){return this._promise||(this._promise=new Promise((function(a,b){this._once("end",a),this._once("error",b)}).bind(this))),this._promise},h.prototype.submit=function(a){this.state="running";var b=this;this.native=a.native,a.native.arrayMode=this._arrayMode;var c=n(function(c,d,f){if(a.native.arrayMode=!1,e(function(){b.emit("_done")}),c)return b.handleError(c);b._emitRowEvents&&(f.length>1?d.forEach((a,c)=>{a.forEach(a=>{b.emit("row",a,f[c])})}):d.forEach(function(a){b.emit("row",a,f)})),b.state="end",b.emit("end",f),b.callback&&b.callback(null,f)},"after");if(g.domain&&(c=g.domain.bind(c)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var d=(this.values||[]).map(f.prepareValue);if(a.namedQueries[this.name]){if(this.text&&a.namedQueries[this.name]!==this.text){let a=Error(`Prepa\
red statements must be unique - '${this.name}' was used for a different statement`);return c(a)}return a.native.execute(this.name,d,c)}return a.native.prepare(this.name,this.text,d.length,function(e){return e?c(e):(a.namedQueries[b.name]=b.text,b.native.execute(b.name,d,c))})}if(this.values){if(!Array.isArray(this.values)){let a=Error("Query values must be an array");return c(a)}var h=this.values.map(f.prepareValue);a.native.query(this.text,h,c)}else a.native.query(this.text,c)}}),aY=p((a,b)=>{y();var c=(aV(),t(aT)),e=V(),f=(aW(),z().EventEmitter),h=(ai(),t(ag)),i=aE(),j=aX(),k=b.exports=function(a){f.call(this),a=a||{},this._Promise=a.Promise||d.Promise,this._types=new e(a.types),this.native=new c({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var b=this.connectionParameters=new i(a);this.user=b.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:b.password}),this.database=b.database,this.host=b.host,this.port=b.port,this.namedQueries={}};k.Query=j,h.inherits(k,f),k.prototype._errorAllQueries=function(a){let b=n(b=>{g.nextTick(()=>{b.native=this.native,b.handleError(a)})},"enqueueError");this._hasActiveQuery()&&(b(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(b),this._queryQueue.length=0},k.prototype._connect=function(a){var b=this;this._connecting?g.nextTick(()=>a(Error("Client has already been connected. You cannot reuse a client."))):(this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(c,d){if(c)return a(c);b.native.connect(d,function(c){if(c)return b.native.end(),a(c);b._connected=!0,b.native.on("error",function(a){b._queryable=!1,b._errorAllQueries(a),b.emit("error",a)}),b.native.on("notification",function(a){b.emit("notification",{channel:a.relname,payload:a.extra})}),b.emit("connect"),b._pulseQueryQueue(!0),a()})}))},k.prototype.connect=function(a){return a?void this._connect(a):new this._Promise((a,b)=>{this._connect(c=>{c?b(c):a()})})},k.prototype.query=function(a,b,c){var d,e,f,h,i;if(null==a)throw TypeError("Client was passed a null or undefined query");if("function"==typeof a.submit)f=a.query_timeout||this.connectionParameters.query_timeout,e=d=a,"function"==typeof b&&(a.callback=b);else if(f=this.connectionParameters.query_timeout,!(d=new j(a,b,c)).callback){let a,b;e=new this._Promise((c,d)=>{a=c,b=d}),d.callback=(c,d)=>c?b(c):a(d)}return f&&(i=d.callback,h=setTimeout(()=>{var a=Error("Query read timeout");g.nextTick(()=>{d.handleError(a,this.connection)}),i(a),d.callback=()=>{};var b=this._queryQueue.indexOf(d);b>-1&&this._queryQueue.splice(b,1),this._pulseQueryQueue()},f),d.callback=(a,b)=>{clearTimeout(h),i(a,b)}),this._queryable?this._ending?(d.native=this.native,g.nextTick(()=>{d.handleError(Error("Client was closed and is not queryable"))})):(this._queryQueue.push(d),this._pulseQueryQueue()):(d.native=this.native,g.nextTick(()=>{d.handleError(Error("Client has encountered a connection error and is not queryable"))})),e},k.prototype.end=function(a){var b,c=this;return this._ending=!0,this._connected||this.once("connect",this.end.bind(this,a)),a||(b=new this._Promise(function(b,c){a=n(a=>a?c(a):b(),"cb")})),this.native.end(function(){c._errorAllQueries(Error("Connection terminated")),g.nextTick(()=>{c.emit("end"),a&&a()})}),b},k.prototype._hasActiveQuery=function(){return this._activeQuery&&"error"!==this._activeQuery.state&&"end"!==this._activeQuery.state},k.prototype._pulseQueryQueue=function(a){if(this._connected&&!this._hasActiveQuery()){var b=this._queryQueue.shift();if(!b){a||this.emit("drain");return}this._activeQuery=b,b.submit(this);var c=this;b.once("_done",function(){c._pulseQueryQueue()})}},k.prototype.cancel=function(a){this._activeQuery===a?this.native.cancel(function(){}):-1!==this._queryQueue.indexOf(a)&&this._queryQueue.splice(this._queryQueue.indexOf(a),1)},k.prototype.ref=function(){},k.prototype.unref=function(){},k.prototype.setTypeParser=function(a,b,c){return this._types.setTypeParser(a,b,c)},k.prototype.getTypeParser=function(a,b){return this._types.getTypeParser(a,b)}}),aZ=p((a,b)=>{y(),b.exports=aY()}),a$=p((a,b)=>{y();var c=aR(),d=ae(),e=aQ(),f=aS(),{DatabaseError:h}=aM(),i=n(a=>{var b;return n(b=class extends f{constructor(b){super(b,a)}},"BoundPool"),b},"poolFactory"),j=n(function(a){this.defaults=d,this.Client=a,this.Query=this.Client.Query,this.Pool=i(this.Client),this._pools=[],this.Connection=e,this.types=U(),this.DatabaseError=h},"PG");"u">typeof g.env.NODE_PG_FORCE_NATIVE?b.exports=new j(aZ()):(b.exports=new j(c),Object.defineProperty(b.exports,"native",{configurable:!0,enumerable:!1,get(){var a=null;try{a=new j(aZ())}catch(a){if("MODULE_NOT_FOUND"!==a.code)throw a}return Object.defineProperty(b.exports,"native",{value:a}),a}}))});y(),y(),G(),J(),y();var a_=Object.defineProperty,a0=Object.defineProperties,a1=Object.getOwnPropertyDescriptors,a2=Object.getOwnPropertySymbols,a3=Object.prototype.hasOwnProperty,a4=Object.prototype.propertyIsEnumerable,a5=n((a,b,c)=>b in a?a_(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,"__defNormalProp"),a6=n((a,b)=>{for(var c in b||(b={}))a3.call(b,c)&&a5(a,c,b[c]);if(a2)for(var c of a2(b))a4.call(b,c)&&a5(a,c,b[c]);return a},"__spreadValues"),a7=n((a,b)=>a0(a,a1(b)),"__spreadProps"),a8=2===new Uint8Array(new Uint16Array([258]).buffer)[0],a9=new TextDecoder,ba=new TextEncoder,bb=ba.encode("0123456789abcdef"),bc=ba.encode("0123456789ABCDEF"),bd=ba.encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").slice();function be(a,{alphabet:d,scratchArr:e}={}){if(!b)if(b=new Uint16Array(256),c=new Uint16Array(256),a8)for(let a=0;a<256;a++)b[a]=bb[15&a]<<8|bb[a>>>4],c[a]=bc[15&a]<<8|bc[a>>>4];else for(let a=0;a<256;a++)b[a]=bb[15&a]|bb[a>>>4]<<8,c[a]=bc[15&a]|bc[a>>>4]<<8;a.byteOffset%4!=0&&(a=new Uint8Array(a));let f=a.length,g=f>>>2,h=e||new Uint16Array(f),i=new Uint32Array(a.buffer,a.byteOffset,g),j=new Uint32Array(h.buffer,h.byteOffset,f>>>1),k="upper"===d?c:b,l=0,m=0,n;if(a8)for(;l<g;)n=i[l++],j[m++]=k[n>>>8&255]<<16|k[255&n],j[m++]=k[n>>>24]<<16|k[n>>>16&255];else for(;l<g;)n=i[l++],j[m++]=k[n>>>24]<<16|k[n>>>16&255],j[m++]=k[n>>>8&255]<<16|k[255&n];for(l<<=2;l<f;)h[l]=k[a[l++]];return a9.decode(h.subarray(0,f))}function bf(a,b={}){let c="",d=a.length,e=Math.ceil(d/504e3),f=new Uint16Array(e>1?504e3:d);for(let d=0;d<e;d++){let e=504e3*d,g=e+504e3;c+=be(a.subarray(e,g),a7(a6({},b),{scratchArr:f}))}return c}function bg(a,b={}){return"upper"!==b.alphabet&&"function"==typeof a.toHex?a.toHex():bf(a,b)}bd[62]=45,bd[63]=95,n(be,"_toHex"),n(bf,"_toHexChunked"),n(bg,"toHex"),y();var bh=class a{constructor(a,b){this.strings=a,this.values=b}toParameterizedQuery(b={query:"",params:[]}){let{strings:c,values:d}=this;for(let e=0,g=c.length;e<g;e++)if(b.query+=c[e],e<d.length){let c=d[e];if(c instanceof bj)b.query+=c.sql;else if(c instanceof bu)if(c.queryData instanceof a)c.queryData.toParameterizedQuery(b);else{if(c.queryData.params?.length)throw Error("This query is not composable");b.query+=c.queryData.query}else{let{params:a}=b;a.push(c),b.query+="$"+a.length,(c instanceof f||ArrayBuffer.isView(c))&&(b.query+="::bytea")}}return b}};n(bh,"SqlTemplate");var bi=class{constructor(a){this.sql=a}};n(bi,"UnsafeRawSql");var bj=bi;function bk(){}y(),n(bk,"warnIfBrowser"),G();var bl=s(V()),bm=s(af()),bn=class a extends Error{constructor(b){super(b),u(this,"name","NeonDbError"),u(this,"severity"),u(this,"code"),u(this,"detail"),u(this,"hint"),u(this,"position"),u(this,"internalPosition"),u(this,"internalQuery"),u(this,"where"),u(this,"schema"),u(this,"table"),u(this,"column"),u(this,"dataType"),u(this,"constraint"),u(this,"file"),u(this,"line"),u(this,"routine"),u(this,"sourceError"),"captureStackTrace"in Error&&"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,a)}};n(bn,"NeonDbError");var bo="transaction() expects an array of queries, or a function returning an array of queries",bp=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function bq(a){return a instanceof f?"\\x"+bg(a):a}function br(a){let{query:b,params:c}=a instanceof bh?a.toParameterizedQuery():a;return{query:b,params:c.map(a=>bq((0,bm.prepareValue)(a)))}}function bs(a,{arrayMode:b,fullResults:c,fetchOptions:d,isolationLevel:e,readOnly:f,deferrable:g,authToken:h,disableWarningInBrowsers:i}={}){let j;if(!a)throw Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");try{j=I(a)}catch{throw Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(a))}let{protocol:k,username:l,hostname:m,port:o,pathname:p}=j;if("postgres:"!==k&&"postgresql:"!==k||!l||!m||!p)throw Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function q(a,...b){if(!(Array.isArray(a)&&Array.isArray(a.raw)&&Array.isArray(b)))throw Error('This function can now be called only as a tagged-template function: sql`SELECT ${value}`, not sql("SELECT $1", [value], options). For a conventional function call with value placeholders ($1, $2, etc.), use sql.query("SELECT $1", [value], options).');return new bu(r,new bh(a,b))}async function r(j,k,l){let n,{fetchEndpoint:p,fetchFunction:q}=F,r=Array.isArray(j)?{queries:j.map(a=>br(a))}:br(j),s=d??{},t=b??!1,u=c??!1,v=e,w=f,x=g;void 0!==l&&(void 0!==l.fetchOptions&&(s={...s,...l.fetchOptions}),void 0!==l.arrayMode&&(t=l.arrayMode),void 0!==l.fullResults&&(u=l.fullResults),void 0!==l.isolationLevel&&(v=l.isolationLevel),void 0!==l.readOnly&&(w=l.readOnly),void 0!==l.deferrable&&(x=l.deferrable)),void 0===k||Array.isArray(k)||void 0===k.fetchOptions||(s={...s,...k.fetchOptions});let y=h;Array.isArray(k)||k?.authToken===void 0||(y=k.authToken);let z="function"==typeof p?p(m,o,{jwtAuth:void 0!==y}):p,A={"Neon-Connection-String":a,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},B=await bw(y);B&&(A.Authorization=`Bearer ${B}`),Array.isArray(j)&&(void 0!==v&&(A["Neon-Batch-Isolation-Level"]=v),void 0!==w&&(A["Neon-Batch-Read-Only"]=String(w)),void 0!==x&&(A["Neon-Batch-Deferrable"]=String(x))),i||F.disableWarningInBrowsers||bk();try{n=await (q??fetch)(z,{method:"POST",body:JSON.stringify(r),headers:A,...s})}catch(b){let a=new bn(`Error connecting to database: ${b}`);throw a.sourceError=b,a}if(n.ok){let a=await n.json();if(Array.isArray(j)){let b=a.results;if(!Array.isArray(b))throw new bn("Neon internal error: unexpected result format");return b.map((a,b)=>{let c=k[b]??{};return bv(a,{arrayMode:c.arrayMode??t,fullResults:c.fullResults??u,types:c.types})})}{let b=k??{};return bv(a,{arrayMode:b.arrayMode??t,fullResults:b.fullResults??u,types:b.types})}}{let{status:a}=n;if(400===a){let a=await n.json(),b=new bn(a.message);for(let c of bp)b[c]=a[c]??void 0;throw b}{let b=await n.text();throw new bn(`Server error (HTTP status ${a}): ${b}`)}}}return n(q,"templateFn"),q.query=(a,b,c)=>new bu(r,{query:a,params:b??[]},c),q.unsafe=a=>new bj(a),q.transaction=async(a,b)=>{if("function"==typeof a&&(a=a(q)),!Array.isArray(a))throw Error(bo);return a.forEach(a=>{if(!(a instanceof bu))throw Error(bo)}),r(a.map(a=>a.queryData),a.map(a=>a.opts??{}),b)},n(r,"execute"),q}n(bq,"encodeBuffersAsBytea"),n(br,"prepareQuery"),n(bs,"neon");var bt=class{constructor(a,b,c){this.execute=a,this.queryData=b,this.opts=c}then(a,b){return this.execute(this.queryData,this.opts).then(a,b)}catch(a){return this.execute(this.queryData,this.opts).catch(a)}finally(a){return this.execute(this.queryData,this.opts).finally(a)}};n(bt,"NeonQueryPromise");var bu=bt;function bv(a,{arrayMode:b,fullResults:c,types:d}){let e=new bl.default(d),f=a.fields.map(a=>a.name),g=a.fields.map(a=>e.getTypeParser(a.dataTypeID)),h=!0===b?a.rows.map(a=>a.map((a,b)=>null===a?null:g[b](a))):a.rows.map(a=>Object.fromEntries(a.map((a,b)=>[f[b],null===a?null:g[b](a)])));return c?(a.viaNeonFetch=!0,a.rowAsArray=b,a.rows=h,a._parsers=g,a._types=e,a):h}async function bw(a){if("string"==typeof a)return a;if("function"==typeof a)try{return await Promise.resolve(a())}catch(b){let a=new bn("Error getting auth token.");throw b instanceof Error&&(a=new bn(`Error getting auth token: ${b.message}`)),a}}n(bv,"processQueryResult"),n(bw,"getAuthToken"),y();var bx=s(a$());y();var by=s(a$()),bz=class extends by.Client{constructor(a){super(a),this.config=a}get neonConfig(){return this.connection.stream}connect(a){let{neonConfig:b}=this;b.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&b.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let c="string"!=typeof this.config&&this.config?.host!==void 0||"string"!=typeof this.config&&this.config?.connectionString!==void 0||void 0!==g.env.PGHOST,d=g.env.USER??g.env.USERNAME;if(!c&&"localhost"===this.host&&this.user===d&&this.database===d&&null===this.password)throw Error(`No database host or connection string wa\
s set, and key parameters have default values (host: localhost, user: ${d}, db: ${d}, password: null\
). Is an environment variable missing? Alternatively, if you intended to connect with these paramete\
rs, please set the host to 'localhost' explicitly.`);let e=super.connect(a),f=b.pipelineTLS&&this.ssl,h="password"===b.pipelineConnect;if(!f&&!b.pipelineConnect)return e;let i=this.connection;if(f&&i.on("connect",()=>i.stream.emit("data","S")),h){i.removeAllListeners("authenticationCleartextPassword"),i.removeAllListeners("readyForQuery"),i.once("readyForQuery",()=>i.on("readyForQuery",this._handleReadyForQuery.bind(this)));let a=this.ssl?"sslconnect":"connect";i.on(a,()=>{this.neonConfig.disableWarningInBrowsers||bk(),this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return e}async _handleAuthSASLContinue(a){if(typeof crypto>"u"||void 0===crypto.subtle||void 0===crypto.subtle.importKey)throw Error("Cannot use SASL auth when `crypto.subtle` is not defined");let b=crypto.subtle,c=this.saslSession,d=this.password,e=a.data;if("SASLInitialResponse"!==c.message||"string"!=typeof d||"string"!=typeof e)throw Error("SASL: protocol error");let g=Object.fromEntries(e.split(",").map(a=>{if(!/^.=/.test(a))throw Error("SASL: Invalid attribute pair entry");return[a[0],a.substring(2)]})),h=g.r,i=g.s,j=g.i;if(!h||!/^[!-+--~]+$/.test(h))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!i||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(i))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!j||!/^[1-9][0-9]*$/.test(j))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!h.startsWith(c.clientNonce))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(h.length===c.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let k=parseInt(j,10),l=f.from(i,"base64"),m=new TextEncoder,n=m.encode(d),o=await b.importKey("raw",n,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),p=new Uint8Array(await b.sign("HMAC",o,f.concat([l,f.from([0,0,0,1])]))),q=p;for(var r=0;r<k-1;r++)p=new Uint8Array(await b.sign("HMAC",o,p)),q=f.from(q.map((a,b)=>q[b]^p[b]));let s=q,t=await b.importKey("raw",s,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),u=new Uint8Array(await b.sign("HMAC",t,m.encode("Client Key"))),v=await b.digest("SHA-256",u),w="n=*,r="+c.clientNonce,x="r="+h+",s="+i+",i="+k,y="c=biws,r="+h,z=w+","+x+","+y,A=await b.importKey("raw",v,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var B=new Uint8Array(await b.sign("HMAC",A,m.encode(z))),C=f.from(u.map((a,b)=>u[b]^B[b])).toString("base64");let D=await b.importKey("raw",s,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),E=await b.sign("HMAC",D,m.encode("Server Key")),F=await b.importKey("raw",E,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var G=f.from(await b.sign("HMAC",F,m.encode(z)));c.message="SASLResponse",c.serverSignature=G.toString("base64"),c.response=y+",p="+C,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};n(bz,"NeonClient"),G();var bA=s(aE());function bB(a,b){let c,d;return b?{callback:b,result:void 0}:{callback:n(function(a,b){a?c(a):d(b)},"cb"),result:new a(function(a,b){d=a,c=b})}}n(bB,"promisify"),n(class extends bx.Pool{constructor(){super(...arguments),u(this,"Client",bz),u(this,"hasFetchUnsupportedListeners",!1),u(this,"addListener",this.on)}on(a,b){return"error"!==a&&(this.hasFetchUnsupportedListeners=!0),super.on(a,b)}query(a,b,c){if(!F.poolQueryViaFetch||this.hasFetchUnsupportedListeners||"function"==typeof a)return super.query(a,b,c);"function"==typeof b&&(c=b,b=void 0);let d=bB(this.Promise,c);c=d.callback;try{let d=new bA.default(this.options),e=encodeURIComponent,f=encodeURI,g=`postgresql://${e(d.user)}:${e(d.password)}@${e(d.host)}\
/${f(d.database)}`,h="string"==typeof a?a:a.text,i=b??a.values??[];bs(g,{fullResults:!0,arrayMode:"array"===a.rowMode}).query(h,i,{types:a.types??this.options?.types}).then(a=>c(void 0,a)).catch(a=>c(a))}catch(a){c(a)}return d.result}},"NeonPool"),G();var bC=s(a$());bC.DatabaseError,bC.defaults,bC.escapeIdentifier,bC.escapeLiteral;var bD=bC.types,bE=a.i(63227);class bF{static [bE.entityKind]="ConsoleLogWriter";write(a){console.log(a)}}class bG{static [bE.entityKind]="DefaultLogger";writer;constructor(a){this.writer=a?.writer??new bF}logQuery(a,b){let c=b.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),d=c.length?` -- params: [${c.join(", ")}]`:"";this.writer.write(`Query: ${a}${d}`)}}class bH{static [bE.entityKind]="NoopLogger";logQuery(){}}var bI=a.i(63343),bJ=a.i(81562),bK=a.i(68540),bL=a.i(44551);class bM{static [bE.entityKind]="Cache"}class bN extends bM{strategy(){return"all"}static [bE.entityKind]="NoopCache";async get(a){}async put(a,b,c,d){}async onMutate(a){}}async function bO(a,b){let c=`${a}-${JSON.stringify(b)}`,d=new TextEncoder().encode(c);return[...new Uint8Array(await crypto.subtle.digest("SHA-256",d))].map(a=>a.toString(16).padStart(2,"0")).join("")}var bP=a.i(11832),bQ=a.i(51674),bR=a.i(84113),bS=bI;class bT{constructor(a,b,c,d){this.query=a,this.cache=b,this.queryMetadata=c,this.cacheConfig=d,b&&"all"===b.strategy()&&void 0===d&&(this.cacheConfig={enable:!0,autoInvalidate:!0}),this.cacheConfig?.enable||(this.cacheConfig=void 0)}authToken;getQuery(){return this.query}mapResult(a,b){return a}setToken(a){return this.authToken=a,this}static [bE.entityKind]="PgPreparedQuery";joinsNotNullableMap;async queryWithCache(a,b,c){if(void 0===this.cache||(0,bE.is)(this.cache,bN)||void 0===this.queryMetadata||this.cacheConfig&&!this.cacheConfig.enable)try{return await c()}catch(c){throw new bP.DrizzleQueryError(a,b,c)}if(("insert"===this.queryMetadata.type||"update"===this.queryMetadata.type||"delete"===this.queryMetadata.type)&&this.queryMetadata.tables.length>0)try{let[a]=await Promise.all([c(),this.cache.onMutate({tables:this.queryMetadata.tables})]);return a}catch(c){throw new bP.DrizzleQueryError(a,b,c)}if(!this.cacheConfig)try{return await c()}catch(c){throw new bP.DrizzleQueryError(a,b,c)}if("select"===this.queryMetadata.type){let d=await this.cache.get(this.cacheConfig.tag??await bO(a,b),this.queryMetadata.tables,void 0!==this.cacheConfig.tag,this.cacheConfig.autoInvalidate);if(void 0===d){let d;try{d=await c()}catch(c){throw new bP.DrizzleQueryError(a,b,c)}return await this.cache.put(this.cacheConfig.tag??await bO(a,b),d,this.cacheConfig.autoInvalidate?this.queryMetadata.tables:[],void 0!==this.cacheConfig.tag,this.cacheConfig.config),d}return d}try{return await c()}catch(c){throw new bP.DrizzleQueryError(a,b,c)}}}class bU{constructor(a){this.dialect=a}static [bE.entityKind]="PgSession";execute(a,b){return bR.tracer.startActiveSpan("drizzle.operation",()=>bR.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(a),void 0,void 0,!1)).setToken(b).execute(void 0,b))}all(a){return this.prepareQuery(this.dialect.sqlToQuery(a),void 0,void 0,!1).all()}async count(a,b){return Number((await this.execute(a,b))[0].count)}}class bV extends bS.PgDatabase{constructor(a,b,c,d=0){super(a,b,c),this.schema=c,this.nestedIndex=d}static [bE.entityKind]="PgTransaction";rollback(){throw new bP.TransactionRollbackError}getTransactionConfigSQL(a){let b=[];return a.isolationLevel&&b.push(`isolation level ${a.isolationLevel}`),a.accessMode&&b.push(a.accessMode),"boolean"==typeof a.deferrable&&b.push(a.deferrable?"deferrable":"not deferrable"),bQ.sql.raw(b.join(" "))}setTransaction(a){return this.session.execute(bQ.sql`set transaction ${this.getTransactionConfigSQL(a)}`)}}let bW={arrayMode:!1,fullResults:!0},bX={arrayMode:!0,fullResults:!0};class bY extends bT{constructor(a,b,c,d,e,f,g,h,i){super(b,d,e,f),this.client=a,this.logger=c,this.fields=g,this._isResponseInArrayMode=h,this.customResultMapper=i,this.clientQuery=a.query??a}static [bE.entityKind]="NeonHttpPreparedQuery";clientQuery;async execute(a={},b=this.authToken){let c=(0,bQ.fillPlaceholders)(this.query.params,a);this.logger.logQuery(this.query.sql,c);let{fields:d,clientQuery:e,query:f,customResultMapper:g}=this;if(!d&&!g)return this.queryWithCache(f.sql,c,async()=>e(f.sql,c,void 0===b?bW:{...bW,authToken:b}));let h=await this.queryWithCache(f.sql,c,async()=>await e(f.sql,c,void 0===b?bX:{...bX,authToken:b}));return this.mapResult(h)}mapResult(a){if(!this.fields&&!this.customResultMapper)return a;let b=a.rows;return this.customResultMapper?this.customResultMapper(b):b.map(a=>(0,bL.mapResultRow)(this.fields,a,this.joinsNotNullableMap))}all(a={}){let b=(0,bQ.fillPlaceholders)(this.query.params,a);return this.logger.logQuery(this.query.sql,b),this.clientQuery(this.query.sql,b,void 0===this.authToken?bW:{...bW,authToken:this.authToken}).then(a=>a.rows)}values(a={},b){let c=(0,bQ.fillPlaceholders)(this.query.params,a);return this.logger.logQuery(this.query.sql,c),this.clientQuery(this.query.sql,c,{arrayMode:!0,fullResults:!0,authToken:b}).then(a=>a.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}}class bZ extends bU{constructor(a,b,c,d={}){super(b),this.client=a,this.schema=c,this.options=d,this.clientQuery=a.query??a,this.logger=d.logger??new bH,this.cache=d.cache??new bN}static [bE.entityKind]="NeonHttpSession";clientQuery;logger;cache;prepareQuery(a,b,c,d,e,f,g){return new bY(this.client,a,this.logger,this.cache,f,g,b,d,e)}async batch(a){let b=[],c=[];for(let d of a){let a=d._prepare(),e=a.getQuery();b.push(a),c.push(this.clientQuery(e.sql,e.params,{fullResults:!0,arrayMode:a.isResponseInArrayMode()}))}return(await this.client.transaction(c,bX)).map((a,c)=>b[c].mapResult(a,!0))}async query(a,b){return this.logger.logQuery(a,b),await this.clientQuery(a,b,{arrayMode:!0,fullResults:!0})}async queryObjects(a,b){return this.clientQuery(a,b,{arrayMode:!1,fullResults:!0})}async count(a,b){return Number((await this.execute(a,b)).rows[0].count)}async transaction(a,b={}){throw Error("No transactions support in neon-http driver")}}class b$ extends bV{static [bE.entityKind]="NeonHttpTransaction";async transaction(a){throw Error("No transactions support in neon-http driver")}}class b_{constructor(a,b,c={}){this.client=a,this.dialect=b,this.options=c,this.initMappers()}static [bE.entityKind]="NeonHttpDriver";createSession(a){return new bZ(this.client,this.dialect,a,{logger:this.options.logger,cache:this.options.cache})}initMappers(){bD.setTypeParser(bD.builtins.TIMESTAMPTZ,a=>a),bD.setTypeParser(bD.builtins.TIMESTAMP,a=>a),bD.setTypeParser(bD.builtins.DATE,a=>a),bD.setTypeParser(bD.builtins.INTERVAL,a=>a),bD.setTypeParser(1231,a=>a),bD.setTypeParser(1115,a=>a),bD.setTypeParser(1185,a=>a),bD.setTypeParser(1187,a=>a),bD.setTypeParser(1182,a=>a)}}function b0(a,b,c,d){return new Proxy(a,{get(a,e){let f=a[e];return"function"!=typeof f&&("object"!=typeof f||null===f)?f:d?b0(f,b,c):"query"===e?b0(f,b,c,!0):new Proxy(f,{apply(a,d,f){let g=a.call(d,...f);return"object"==typeof g&&null!==g&&"setToken"in g&&"function"==typeof g.setToken&&g.setToken(b),c(a,e,g)}})}})}class b1 extends bI.PgDatabase{static [bE.entityKind]="NeonHttpDatabase";$withAuth(a){return this.authToken=a,b0(this,a,(b,c,d)=>"with"===c?b0(d,a,(a,b,c)=>c):d)}async batch(a){return this.session.batch(a)}}function b2(a,b={}){let c,d,e=new bJ.PgDialect({casing:b.casing});if(!0===b.logger?c=new bG:!1!==b.logger&&(c=b.logger),b.schema){let a=(0,bK.extractTablesRelationalConfig)(b.schema,bK.createTableRelationsHelpers);d={fullSchema:b.schema,schema:a.tables,tableNamesMap:a.tableNamesMap}}let f=new b_(a,e,{logger:c,cache:b.cache}).createSession(d),g=new b1(e,f,d);return g.$client=a,g.$cache=b.cache,g.$cache&&(g.$cache.invalidate=b.cache?.onMutate),g}function b3(...a){if("string"==typeof a[0])return b2(bs(a[0]),a[1]);if((0,bL.isConfig)(a[0])){let{connection:b,client:c,...d}=a[0];if(c)return b2(c,d);if("object"==typeof b){let{connectionString:a,...c}=b;return b2(bs(a,c),d)}return b2(bs(b),d)}return b2(a[0],a[1])}(b3||(b3={})).mock=function(a){return b2({},a)};var b4=a.i(1531),b5=a.i(13148);F.fetchConnectionCache=!0;let b6=b3(bs(b4.env.DATABASE_URL),{schema:b5});a.s(["db",0,b6],42116)},35488,a=>a.a(async(b,c)=>{try{var d=a.i(29229),e=b([d]);[d]=e.then?(await e)():e;let f=async(a,b)=>!!b&&d.default.compare(a,b);a.s(["verifyPassword",0,f]),c()}catch(a){c(a)}},!1),68021,a=>a.a(async(b,c)=>{try{var d=a.i(33957),e=a.i(78255),f=a.i(93321),g=a.i(53112),h=a.i(1531),i=a.i(42116),j=a.i(13148),k=a.i(35488),l=b([k]);[k]=l.then?(await l)():l;let m=g.z.object({email:g.z.string().email(),password:g.z.string().min(6)}),n={adapter:(0,d.DrizzleAdapter)(i.db),session:{strategy:"jwt"},pages:{signIn:"/auth/signin"},providers:[(0,e.default)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},authorize:async a=>{let b=m.safeParse(a);if(!b.success)return null;let{email:c,password:d}=b.data,e=await i.db.query.users.findFirst({where:(0,f.eq)(j.users.email,c.toLowerCase())});return e?.hashedPassword&&await (0,k.verifyPassword)(d,e.hashedPassword)?{id:e.id,email:e.email,name:e.name}:null}})],secret:h.env.NEXTAUTH_SECRET,callbacks:{session:async({session:a,token:b})=>(a.user&&b.sub&&(a.user.id=b.sub),a),jwt:async({token:a,user:b})=>(b?.id&&(a.sub=b.id),a)}};a.s(["authOptions",0,n]),c()}catch(a){c(a)}},!1),58840,a=>a.a(async(b,c)=>{try{var d=a.i(20971),e=a.i(68021),f=b([e]);[e]=f.then?(await f)():f,a.s(["getCurrentSession",0,()=>(0,d.getServerSession)(e.authOptions)]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=_1116ff3a._.js.map