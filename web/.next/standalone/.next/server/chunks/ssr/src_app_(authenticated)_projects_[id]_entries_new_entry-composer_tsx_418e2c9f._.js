module.exports=[9900,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(99570),e=a.i(91119),f=a.i(66718),g=a.i(70430),h=a.i(80701),i=a.i(29246),j=a.i(70121),k=a.i(7554),l=a.i(25152),m=a.i(77994),n=a.i(3688),o=a.i(77192);a.i(35112);var p=Symbol("radix.slottable");function q(a){return c.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===p}var r=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,d)=>{var e,f;let g,h,i,k=(f=e=`Primitive.${d}`,(g=c.forwardRef((a,b)=>{let{children:d,...e}=a;if(c.isValidElement(d)){var f;let a,g,h=(f=d,(g=(a=Object.getOwnPropertyDescriptor(f.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?f.ref:(g=(a=Object.getOwnPropertyDescriptor(f,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?f.props.ref:f.props.ref||f.ref),i=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(e,d.props);return d.type!==c.Fragment&&(i.ref=b?(0,j.composeRefs)(b,h):h),c.cloneElement(d,i)}return c.Children.count(d)>1?c.Children.only(null):null})).displayName=`${f}.SlotClone`,h=g,(i=c.forwardRef((a,d)=>{let{children:e,...f}=a,g=c.Children.toArray(e),i=g.find(q);if(i){let a=i.props.children,e=g.map(b=>b!==i?b:c.Children.count(a)>1?c.Children.only(null):c.isValidElement(a)?a.props.children:null);return(0,b.jsx)(h,{...f,ref:d,children:c.isValidElement(a)?c.cloneElement(a,void 0,e):null})}return(0,b.jsx)(h,{...f,ref:d,children:e})})).displayName=`${e}.Slot`,i),l=c.forwardRef((a,c)=>{let{asChild:e,...f}=a;return(0,b.jsx)(e?k:d,{...f,ref:c})});return l.displayName=`Primitive.${d}`,{...a,[d]:l}},{}),s="Checkbox",[t,u]=function(a,d=[]){let e=[],f=()=>{let b=e.map(a=>c.createContext(a));return function(d){let e=d?.[a]||b;return c.useMemo(()=>({[`__scope${a}`]:{...d,[a]:e}}),[d,e])}};return f.scopeName=a,[function(d,f){let g=c.createContext(f),h=e.length;e=[...e,f];let i=d=>{let{scope:e,children:f,...i}=d,j=e?.[a]?.[h]||g,k=c.useMemo(()=>i,Object.values(i));return(0,b.jsx)(j.Provider,{value:k,children:f})};return i.displayName=d+"Provider",[i,function(b,e){let i=e?.[a]?.[h]||g,j=c.useContext(i);if(j)return j;if(void 0!==f)return f;throw Error(`\`${b}\` must be used within \`${d}\``)}]},function(...a){let b=a[0];if(1===a.length)return b;let d=()=>{let d=a.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){let e=d.reduce((b,{useScope:c,scopeName:d})=>{let e=c(a)[`__scope${d}`];return{...b,...e}},{});return c.useMemo(()=>({[`__scope${b.scopeName}`]:e}),[e])}};return d.scopeName=b.scopeName,d}(f,...d)]}(s),[v,w]=t(s);function x(a){let{__scopeCheckbox:d,checked:e,children:f,defaultChecked:g,disabled:h,form:i,name:j,onCheckedChange:k,required:m,value:n="on",internal_do_not_use_render:o}=a,[p,q]=(0,l.useControllableState)({prop:e,defaultProp:g??!1,onChange:k,caller:s}),[r,t]=c.useState(null),[u,w]=c.useState(null),x=c.useRef(!1),y=!r||!!i||!!r.closest("form"),z={checked:p,disabled:h,setChecked:q,control:r,setControl:t,name:j,form:i,value:n,hasConsumerStoppedPropagationRef:x,required:m,defaultChecked:!F(g)&&g,isFormControl:y,bubbleInput:u,setBubbleInput:w};return(0,b.jsx)(v,{scope:d,...z,children:"function"==typeof o?o(z):f})}var y="CheckboxTrigger",z=c.forwardRef(({__scopeCheckbox:a,onKeyDown:d,onClick:e,...f},g)=>{let{control:h,value:i,disabled:l,checked:m,required:n,setControl:o,setChecked:p,hasConsumerStoppedPropagationRef:q,isFormControl:s,bubbleInput:t}=w(y,a),u=(0,j.useComposedRefs)(g,o),v=c.useRef(m);return c.useEffect(()=>{let a=h?.form;if(a){let b=()=>p(v.current);return a.addEventListener("reset",b),()=>a.removeEventListener("reset",b)}},[h,p]),(0,b.jsx)(r.button,{type:"button",role:"checkbox","aria-checked":F(m)?"mixed":m,"aria-required":n,"data-state":G(m),"data-disabled":l?"":void 0,disabled:l,value:i,...f,ref:u,onKeyDown:(0,k.composeEventHandlers)(d,a=>{"Enter"===a.key&&a.preventDefault()}),onClick:(0,k.composeEventHandlers)(e,a=>{p(a=>!!F(a)||!a),t&&s&&(q.current=a.isPropagationStopped(),q.current||a.stopPropagation())})})});z.displayName=y;var A=c.forwardRef((a,c)=>{let{__scopeCheckbox:d,name:e,checked:f,defaultChecked:g,required:h,disabled:i,value:j,onCheckedChange:k,form:l,...m}=a;return(0,b.jsx)(x,{__scopeCheckbox:d,checked:f,defaultChecked:g,disabled:i,required:h,onCheckedChange:k,name:e,form:l,value:j,internal_do_not_use_render:({isFormControl:a})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(z,{...m,ref:c,__scopeCheckbox:d}),a&&(0,b.jsx)(E,{__scopeCheckbox:d})]})})});A.displayName=s;var B="CheckboxIndicator",C=c.forwardRef((a,c)=>{let{__scopeCheckbox:d,forceMount:e,...f}=a,g=w(B,d);return(0,b.jsx)(o.Presence,{present:e||F(g.checked)||!0===g.checked,children:(0,b.jsx)(r.span,{"data-state":G(g.checked),"data-disabled":g.disabled?"":void 0,...f,ref:c,style:{pointerEvents:"none",...a.style}})})});C.displayName=B;var D="CheckboxBubbleInput",E=c.forwardRef(({__scopeCheckbox:a,...d},e)=>{let{control:f,hasConsumerStoppedPropagationRef:g,checked:h,defaultChecked:i,required:k,disabled:l,name:o,value:p,form:q,bubbleInput:s,setBubbleInput:t}=w(D,a),u=(0,j.useComposedRefs)(e,t),v=(0,m.usePrevious)(h),x=(0,n.useSize)(f);c.useEffect(()=>{if(!s)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,b=!g.current;if(v!==h&&a){let c=new Event("click",{bubbles:b});s.indeterminate=F(h),a.call(s,!F(h)&&h),s.dispatchEvent(c)}},[s,v,h,g]);let y=c.useRef(!F(h)&&h);return(0,b.jsx)(r.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??y.current,required:k,disabled:l,name:o,value:p,form:q,...d,tabIndex:-1,ref:u,style:{...d.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function F(a){return"indeterminate"===a}function G(a){return F(a)?"indeterminate":a?"checked":"unchecked"}E.displayName=D;var H=a.i(6406),I=a.i(68114);function J({className:a,...c}){return(0,b.jsx)(A,{"data-slot":"checkbox",className:(0,I.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...c,children:(0,b.jsx)(C,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:(0,b.jsx)(H.CheckIcon,{className:"size-3.5"})})})}var K=a.i(86304);let L=[{label:"Meeting",value:"meeting"},{label:"Update",value:"update"},{label:"Decision",value:"decision"},{label:"Note",value:"note"},{label:"Self note",value:"self_note"}];a.s(["EntryComposer",0,({projectId:a})=>{let[j,k]=(0,c.useState)("meeting"),[l,m]=(0,c.useState)("idle"),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(null),v=(0,c.useMemo)(()=>r.filter(a=>a.selected).length,[r]),w=async b=>{b.preventDefault(),u(null),m("saving");let c=new FormData(b.currentTarget),d={title:c.get("title")?.toString()??"",kind:j,occurredAt:c.get("occurredAt")?.toString()??new Date().toISOString(),rawContent:c.get("rawContent")?.toString()??""},e=await fetch(`/api/secure/projects/${a}/entries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!e.ok){u((await e.json().catch(()=>({}))).message??"Unable to save entry"),m("idle");return}let f=await e.json();o({id:f.id,title:f.title}),m("ready")},x=async()=>{if(!n)return;m("summarizing"),u(null);let a=await fetch(`/api/secure/entries/${n.id}/summarize`,{method:"POST"});if(!a.ok){u((await a.json().catch(()=>({}))).message??"AI summarization failed"),m("ready");return}let b=await a.json();q(b.summary),s(b.suggestedActions.map((a,b)=>({...a,id:`${b}-${a.title}`,selected:!0}))),m("ready")},y=(a,b)=>{s(c=>c.map(c=>c.id===a?{...c,...b}:c))},z=async()=>{if(!n)return;let b=r.filter(a=>a.selected);if(!b.length)return;m("summarizing");let c=await fetch(`/api/secure/entries/${n.id}/commitments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:a,actions:b.map(a=>({title:a.title,direction:a.direction,counterparty:a.counterparty,dueDate:a.dueDate,notes:a.notes,importance:a.importance,urgency:a.urgency}))})});if(!c.ok){u((await c.json().catch(()=>({}))).message??"Failed to create commitments"),m("ready");return}m("ready")};return(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1.5fr_1fr]",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Entry details"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(g.Label,{htmlFor:"title",children:"Title"}),(0,b.jsx)(f.Input,{id:"title",name:"title",placeholder:"Weekly sync with product",required:!0})]}),(0,b.jsxs)("div",{className:"w-48",children:[(0,b.jsx)(g.Label,{htmlFor:"kind",children:"Kind"}),(0,b.jsxs)(h.Select,{value:j,onValueChange:k,children:[(0,b.jsx)(h.SelectTrigger,{id:"kind",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsx)(h.SelectContent,{children:L.map(a=>(0,b.jsx)(h.SelectItem,{value:a.value,children:a.label},a.value))})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"occurredAt",children:"Occurred at"}),(0,b.jsx)(f.Input,{id:"occurredAt",name:"occurredAt",type:"datetime-local"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"rawContent",children:"Notes / transcript"}),(0,b.jsx)(i.Textarea,{id:"rawContent",name:"rawContent",className:"min-h-[200px]",placeholder:"Paste meeting notes or key points..."})]}),t?(0,b.jsx)("p",{className:"text-sm text-destructive",children:t}):null,(0,b.jsx)(d.Button,{type:"submit",disabled:"saving"===l,children:"saving"===l?"Saving...":"Save entry"})]})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"AI summary & actions"})}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(0,b.jsx)(d.Button,{variant:"outline",className:"w-full",disabled:!n||"summarizing"===l,onClick:x,children:"summarizing"===l?"Running AI...":"Generate summary"}),p?(0,b.jsxs)("div",{className:"space-y-2 rounded-lg border p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(K.Badge,{variant:"secondary",children:"Summary"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"Saved automatically to the entry"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:p})]}):null,r.length?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"text-sm font-medium",children:"Suggested commitments"}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[v," selected"]})]}),(0,b.jsx)("div",{className:"space-y-3",children:r.map(a=>(0,b.jsxs)("div",{className:"rounded-lg border p-3 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(J,{checked:a.selected,onCheckedChange:b=>y(a.id,{selected:!!b})}),(0,b.jsx)(f.Input,{value:a.title,onChange:b=>y(a.id,{title:b.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Direction"}),(0,b.jsxs)(h.Select,{value:a.direction,onValueChange:b=>y(a.id,{direction:b}),children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"i_owe",children:"I Owe"}),(0,b.jsx)(h.SelectItem,{value:"waiting_for",children:"Waiting For"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Counterparty"}),(0,b.jsx)(f.Input,{value:a.counterparty??"",placeholder:"Person or team",onChange:b=>y(a.id,{counterparty:b.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Due date"}),(0,b.jsx)(f.Input,{type:"date",value:a.dueDate??"",onChange:b=>y(a.id,{dueDate:b.target.value})})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Importance"}),(0,b.jsx)(f.Input,{type:"number",min:1,max:5,value:a.importance??3,onChange:b=>y(a.id,{importance:Number(b.target.value)})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Urgency"}),(0,b.jsx)(f.Input,{type:"number",min:1,max:5,value:a.urgency??3,onChange:b=>y(a.id,{urgency:Number(b.target.value)})})]})]})]})]},a.id))}),(0,b.jsx)(d.Button,{className:"w-full",variant:"secondary",disabled:!v||"summarizing"===l,onClick:z,children:"Create commitments"})]}):null]})]})]})}],9900)}];

//# sourceMappingURL=src_app_%28authenticated%29_projects_%5Bid%5D_entries_new_entry-composer_tsx_418e2c9f._.js.map